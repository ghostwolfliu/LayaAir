{"version":3,"file":"laya.core.js","sources":["../../../src/layaAir/Config.ts","../../../src/layaAir/ILaya.ts","../../../src/layaAir/laya/utils/Pool.ts","../../../src/layaAir/laya/display/cmd/AlphaCmd.ts","../../../src/layaAir/laya/display/cmd/DrawCircleCmd.ts","../../../src/layaAir/laya/display/cmd/DrawCurvesCmd.ts","../../../src/layaAir/laya/display/cmd/DrawImageCmd.ts","../../../src/layaAir/laya/display/cmd/DrawLineCmd.ts","../../../src/layaAir/laya/display/cmd/DrawLinesCmd.ts","../../../src/layaAir/laya/display/cmd/DrawPathCmd.ts","../../../src/layaAir/laya/display/cmd/DrawPieCmd.ts","../../../src/layaAir/laya/display/cmd/DrawPolyCmd.ts","../../../src/layaAir/laya/display/cmd/DrawRectCmd.ts","../../../src/layaAir/laya/maths/Matrix.ts","../../../src/layaAir/laya/maths/Point.ts","../../../src/layaAir/laya/maths/Rectangle.ts","../../../src/layaAir/laya/layagl/LayaGL.ts","../../../src/layaAir/laya/webgl/WebGLContext.ts","../../../src/layaAir/laya/utils/Handler.ts","../../../src/layaAir/laya/events/EventDispatcher.ts","../../../src/layaAir/laya/net/URL.ts","../../../src/layaAir/laya/resource/Resource.ts","../../../src/layaAir/laya/resource/Bitmap.ts","../../../src/layaAir/laya/resource/FilterMode.ts","../../../src/layaAir/laya/resource/TextureFormat.ts","../../../src/layaAir/laya/resource/WrapMode.ts","../../../src/layaAir/laya/resource/BaseTexture.ts","../../../src/layaAir/laya/utils/Byte.ts","../../../src/layaAir/laya/resource/Texture2D.ts","../../../src/layaAir/laya/webgl/shader/BaseShader.ts","../../../src/layaAir/laya/webgl/utils/RenderState2D.ts","../../../src/layaAir/laya/resource/RenderTextureFormat.ts","../../../src/layaAir/laya/resource/RenderTexture2D.ts","../../../src/layaAir/laya/resource/WebGLRTMgr.ts","../../../src/layaAir/laya/webgl/canvas/BlendMode.ts","../../../src/layaAir/laya/webgl/shader/ShaderDefinesBase.ts","../../../src/layaAir/laya/webgl/shader/d2/ShaderDefines2D.ts","../../../src/layaAir/laya/utils/Stat.ts","../../../src/layaAir/laya/utils/StringKey.ts","../../../src/layaAir/laya/webgl/shader/Shader.ts","../../../src/layaAir/laya/webgl/shader/d2/Shader2X.ts","../../../src/layaAir/laya/webgl/shader/d2/value/Value2D.ts","../../../src/layaAir/laya/webgl/submit/SubmitKey.ts","../../../src/layaAir/laya/webgl/submit/SubmitCMD.ts","../../../src/layaAir/laya/filters/Filter.ts","../../../src/layaAir/laya/utils/Utils.ts","../../../src/layaAir/laya/utils/ColorUtils.ts","../../../src/layaAir/laya/filters/ColorFilter.ts","../../../src/layaAir/laya/display/cmd/DrawTextureCmd.ts","../../../src/layaAir/laya/display/cmd/FillTextureCmd.ts","../../../src/layaAir/laya/display/cmd/RestoreCmd.ts","../../../src/layaAir/laya/display/cmd/RotateCmd.ts","../../../src/layaAir/laya/display/cmd/ScaleCmd.ts","../../../src/layaAir/laya/display/cmd/TransformCmd.ts","../../../src/layaAir/laya/display/cmd/TranslateCmd.ts","../../../src/layaAir/laya/maths/Bezier.ts","../../../src/layaAir/laya/maths/GrahamScan.ts","../../../src/layaAir/laya/webgl/canvas/DrawStyle.ts","../../../src/layaAir/laya/webgl/canvas/Path.ts","../../../src/layaAir/laya/webgl/submit/SubmitBase.ts","../../../src/layaAir/laya/webgl/canvas/save/SaveBase.ts","../../../src/layaAir/laya/webgl/canvas/save/SaveClipRect.ts","../../../src/layaAir/laya/webgl/canvas/save/SaveMark.ts","../../../src/layaAir/laya/webgl/canvas/save/SaveTransform.ts","../../../src/layaAir/laya/webgl/canvas/save/SaveTranslate.ts","../../../src/layaAir/laya/webgl/BufferStateBase.ts","../../../src/layaAir/laya/webgl/BufferState2D.ts","../../../src/layaAir/laya/webgl/utils/Buffer.ts","../../../src/layaAir/laya/renders/RenderInfo.ts","../../../src/layaAir/laya/webgl/utils/Buffer2D.ts","../../../src/layaAir/laya/webgl/utils/IndexBuffer2D.ts","../../../src/layaAir/laya/webgl/utils/VertexBuffer2D.ts","../../../src/layaAir/laya/webgl/utils/Mesh2D.ts","../../../src/layaAir/laya/webgl/utils/MeshQuadTexture.ts","../../../src/layaAir/laya/webgl/utils/MeshTexture.ts","../../../src/layaAir/laya/webgl/utils/MeshVG.ts","../../../src/layaAir/laya/webgl/canvas/WebGLCacheAsNormalCanvas.ts","../../../src/layaAir/laya/webgl/shader/d2/files/texture.vs.glsl","../../../src/layaAir/laya/webgl/shader/d2/files/texture.ps.glsl","../../../src/layaAir/laya/webgl/shader/d2/files/primitive.vs.glsl","../../../src/layaAir/laya/webgl/shader/d2/files/primitive.ps.glsl","../../../src/layaAir/laya/webgl/shader/d2/skinAnishader/skinShader.vs.glsl","../../../src/layaAir/laya/webgl/shader/d2/skinAnishader/skinShader.ps.glsl","../../../src/layaAir/laya/webgl/shader/d2/Shader2D.ts","../../../src/layaAir/laya/webgl/shader/d2/skinAnishader/SkinMeshBuffer.ts","../../../src/layaAir/laya/webgl/shapes/BasePoly.ts","../../../src/layaAir/laya/webgl/shapes/EarcutNode.ts","../../../src/layaAir/laya/webgl/shapes/Earcut.ts","../../../src/layaAir/laya/webgl/utils/CONST3D2D.ts","../../../src/layaAir/laya/webgl/submit/Submit.ts","../../../src/layaAir/laya/webgl/submit/SubmitCanvas.ts","../../../src/layaAir/laya/webgl/submit/SubmitTarget.ts","../../../src/layaAir/laya/webgl/submit/SubmitTexture.ts","../../../src/layaAir/laya/webgl/text/CharSubmitCache.ts","../../../src/layaAir/laya/webgl/text/AtlasGrid.ts","../../../src/layaAir/laya/webgl/text/TextTexture.ts","../../../src/layaAir/laya/webgl/text/TextAtlas.ts","../../../src/layaAir/laya/events/Event.ts","../../../src/layaAir/laya/resource/Texture.ts","../../../src/layaAir/laya/utils/FontInfo.ts","../../../src/layaAir/laya/utils/WordText.ts","../../../src/layaAir/laya/webgl/text/CharRenderInfo.ts","../../../src/layaAir/laya/webgl/text/ICharRender.ts","../../../src/layaAir/laya/utils/Browser.ts","../../../src/layaAir/laya/webgl/text/CharRender_Canvas.ts","../../../src/layaAir/laya/webgl/text/CharRender_Native.ts","../../../src/layaAir/laya/webgl/text/TextRender.ts","../../../src/layaAir/laya/resource/Context.ts","../../../src/layaAir/laya/webgl/WebGL.ts","../../../src/layaAir/laya/webgl/VertexArrayObject.ts","../../../src/layaAir/laya/webgl/SystemUtils.ts","../../../src/layaAir/laya/webgl/LayaGPU.ts","../../../src/layaAir/laya/renders/Render.ts","../../../src/layaAir/laya/display/cmd/DrawTrianglesCmd.ts","../../../src/layaAir/laya/display/cmd/Draw9GridTexture.ts","../../../src/layaAir/laya/display/cmd/SaveCmd.ts","../../../src/layaAir/laya/display/GraphicsBounds.ts","../../../src/layaAir/laya/display/SpriteConst.ts","../../../src/layaAir/laya/display/cmd/ClipRectCmd.ts","../../../src/layaAir/laya/display/cmd/DrawTexturesCmd.ts","../../../src/layaAir/laya/display/cmd/FillTextCmd.ts","../../../src/layaAir/laya/utils/CacheManger.ts","../../../src/layaAir/laya/utils/VectorGraphManager.ts","../../../src/layaAir/laya/display/Graphics.ts","../../../src/layaAir/laya/Const.ts","../../../src/layaAir/laya/renders/LayaGLQuickRunner.ts","../../../src/layaAir/laya/renders/RenderSprite.ts","../../../src/layaAir/laya/resource/HTMLCanvas.ts","../../../src/layaAir/laya/utils/HitArea.ts","../../../src/layaAir/laya/utils/ClassUtils.ts","../../../src/layaAir/laya/display/css/BoundsStyle.ts","../../../src/layaAir/laya/display/css/CacheStyle.ts","../../../src/layaAir/laya/display/css/SpriteStyle.ts","../../../src/layaAir/laya/display/Node.ts","../../../src/layaAir/laya/display/Sprite.ts","../../../src/layaAir/laya/display/css/TextStyle.ts","../../../src/layaAir/laya/display/Text.ts","../../../src/layaAir/laya/display/Input.ts","../../../src/layaAir/laya/events/TouchManager.ts","../../../src/layaAir/laya/events/MouseManager.ts","../../../src/layaAir/laya/utils/CallLater.ts","../../../src/layaAir/laya/utils/RunDriver.ts","../../../src/layaAir/laya/display/Stage.ts","../../../src/layaAir/laya/events/KeyBoardManager.ts","../../../src/layaAir/laya/media/SoundChannel.ts","../../../src/layaAir/laya/media/h5audio/AudioSoundChannel.ts","../../../src/layaAir/laya/media/h5audio/AudioSound.ts","../../../src/layaAir/laya/media/webaudio/WebAudioSoundChannel.ts","../../../src/layaAir/laya/media/webaudio/WebAudioSound.ts","../../../src/layaAir/laya/media/SoundManager.ts","../../../src/layaAir/laya/components/Prefab.ts","../../../src/layaAir/laya/display/BitmapFont.ts","../../../src/layaAir/laya/net/HttpRequest.ts","../../../src/layaAir/laya/net/Loader.ts","../../../src/layaAir/laya/net/AtlasInfoManager.ts","../../../src/layaAir/laya/net/LoaderManager.ts","../../../src/layaAir/laya/net/LocalStorage.ts","../../../src/layaAir/laya/net/TTFLoader.ts","../../../src/layaAir/laya/utils/Ease.ts","../../../src/layaAir/laya/utils/Tween.ts","../../../src/layaAir/laya/utils/Dragging.ts","../../../src/layaAir/laya/components/Component.ts","../../../src/layaAir/laya/display/AnimationBase.ts","../../../src/layaAir/laya/maths/MathUtil.ts","../../../src/layaAir/laya/display/FrameAnimation.ts","../../../src/layaAir/laya/utils/WeakObject.ts","../../../src/layaAir/laya/utils/SceneUtils.ts","../../../src/layaAir/laya/utils/IStatRender.ts","../../../src/layaAir/laya/utils/StatUI.ts","../../../src/layaAir/laya/utils/Timer.ts","../../../src/layaAir/laya/webgl/shader/d2/skinAnishader/SkinSV.ts","../../../src/layaAir/laya/webgl/shader/d2/value/PrimitiveSV.ts","../../../src/layaAir/laya/webgl/shader/d2/value/TextureSV.ts","../../../src/layaAir/laya/webgl/utils/InlcudeFile.ts","../../../src/layaAir/laya/webgl/utils/ShaderNode.ts","../../../src/layaAir/laya/webgl/utils/ShaderCompile.ts","../../../src/layaAir/laya/net/WorkerLoader.ts","../../../src/layaAir/laya/utils/Mouse.ts","../../../src/layaAir/laya/webgl/utils/MeshParticle2D.ts","../../../src/layaAir/laya/resource/HTMLImage.ts","../../../src/layaAir/Laya.ts","../../../src/layaAir/laya/components/CommonScript.ts","../../../src/layaAir/laya/components/Script.ts","../../../src/layaAir/laya/utils/GraphicAnimation.ts","../../../src/layaAir/laya/display/Animation.ts","../../../src/layaAir/laya/display/EffectAnimation.ts","../../../src/layaAir/laya/net/SceneLoader.ts","../../../src/layaAir/laya/display/Scene.ts","../../../src/layaAir/laya/display/cmd/DrawParticleCmd.ts","../../../src/layaAir/laya/effect/FilterSetterBase.ts","../../../src/layaAir/laya/filters/BlurFilterGLRender.ts","../../../src/layaAir/laya/filters/BlurFilter.ts","../../../src/layaAir/laya/effect/BlurFilterSetter.ts","../../../src/layaAir/laya/effect/ButtonEffect.ts","../../../src/layaAir/laya/effect/ColorFilterSetter.ts","../../../src/layaAir/laya/effect/EffectBase.ts","../../../src/layaAir/laya/effect/FadeIn.ts","../../../src/layaAir/laya/effect/FadeOut.ts","../../../src/layaAir/laya/filters/GlowFilterGLRender.ts","../../../src/layaAir/laya/filters/GlowFilter.ts","../../../src/layaAir/laya/effect/GlowFilterSetter.ts","../../../src/layaAir/laya/events/KeyLocation.ts","../../../src/layaAir/laya/events/Keyboard.ts","../../../src/layaAir/laya/layagl/CommandEncoder.ts","../../../src/layaAir/laya/layagl/LayaGLRunner.ts","../../../src/layaAir/laya/layagl/QuickTestTool.ts","../../../src/layaAir/laya/media/Sound.ts","../../../src/layaAir/laya/media/SoundNode.ts","../../../src/layaAir/laya/net/ResourceVersion.ts","../../../src/layaAir/laya/net/Socket.ts","../../../src/layaAir/laya/resource/TextureDecodeFormat.ts","../../../src/layaAir/laya/resource/VideoTexture.ts","../../../src/layaAir/laya/system/System.ts","../../../src/layaAir/laya/utils/HTMLChar.ts","../../../src/layaAir/laya/utils/Log.ts","../../../src/layaAir/laya/utils/PerfData.ts","../../../src/layaAir/laya/utils/PerfHUD.ts","../../../src/layaAir/laya/utils/PoolCache.ts","../../../src/layaAir/laya/utils/TimeLine.ts","../../../src/layaAir/laya/webgl/shader/ShaderValue.ts","../../../src/layaAir/laya/webgl/text/ArabicReshaper.ts","../../../src/layaAir/laya/webgl/utils/MatirxArray.ts"],"sourcesContent":["/**\r\n *  Config 用于配置一些全局参数。如需更改，请在初始化引擎之前设置。\r\n */\r\nexport class Config {\r\n    /**\r\n     * 动画 Animation 的默认播放时间间隔，单位为毫秒。\r\n     */\r\n    static animationInterval: number = 50;\r\n    /**\r\n     * 设置是否抗锯齿，只对2D(WebGL)、3D有效。\r\n     */\r\n    static isAntialias: boolean = false;\r\n    /**\r\n     * 设置画布是否透明，只对2D(WebGL)、3D有效。\r\n     */\r\n    static isAlpha: boolean = false;\r\n    /**\r\n     * 设置画布是否预乘，只对2D(WebGL)、3D有效。\r\n     */\r\n    static premultipliedAlpha: boolean = true;\r\n    /**\r\n     * 设置画布的是否开启模板缓冲，只对2D(WebGL)、3D有效。\r\n     */\r\n    static isStencil: boolean = true;\r\n    /**\r\n     * 是否保留渲染缓冲区。\r\n     */\r\n    static preserveDrawingBuffer: boolean = false;\r\n\r\n    /**\r\n     * 当使用webGL渲染2d的时候，每次创建vb是否直接分配足够64k个顶点的缓存。这样可以提高效率。\r\n     */\r\n    static webGL2D_MeshAllocMaxMem: boolean = true;\r\n\r\n    /**\r\n     * 是否强制使用像素采样。适用于像素风格游戏\r\n     */\r\n    static is2DPixelArtGame: boolean = false;\r\n\r\n    /**\r\n     * 是否使用webgl2\r\n     */\r\n    static useWebGL2: boolean = true;\r\n    \r\n    /** 是否允许GPUInstance动态合并,仅对3D有效。*/\r\n\tstatic allowGPUInstanceDynamicBatch: boolean = true;\r\n\r\n    static useRetinalCanvas: boolean = false;\r\n}\r\n(window as any).Config = Config;\r\n\r\n","import { Dragging } from \"./laya/utils/Dragging\";\r\nimport { GraphicsBounds } from \"./laya/display/GraphicsBounds\";\r\nimport { Sprite } from \"./laya/display/Sprite\";\r\nimport { TextRender } from \"./laya/webgl/text/TextRender\";\r\nimport { Timer } from \"./laya/utils/Timer\";\r\nimport { Loader } from \"./laya/net/Loader\";\r\nimport { TTFLoader } from \"./laya/net/TTFLoader\";\r\nimport { SoundManager } from \"./laya/media/SoundManager\";\r\nimport { WebAudioSound } from \"./laya/media/webaudio/WebAudioSound\";\r\nimport { ShaderCompile } from \"./laya/webgl/utils/ShaderCompile\";\r\nimport { TextAtlas } from \"./laya/webgl/text/TextAtlas\";\r\nimport { ClassUtils } from \"./laya/utils/ClassUtils\";\r\nimport { SceneUtils } from \"./laya/utils/SceneUtils\";\r\nimport { Stage } from \"./laya/display/Stage\";\r\nimport { Context } from \"./laya/resource/Context\";\r\nimport { Render } from \"./laya/renders/Render\";\r\nimport { LoaderManager } from \"./laya/net/LoaderManager\";\r\nimport { WorkerLoader} from \"./laya/net/WorkerLoader\";\r\nimport { MouseManager } from \"./laya/events/MouseManager\";\r\nimport { Text } from \"./laya/display/Text\";\r\nimport { Browser } from \"./laya/utils/Browser\";\r\nimport { WebGL } from \"./laya/webgl/WebGL\";\r\nimport { AudioSound } from \"./laya/media/h5audio/AudioSound\";\r\nimport { Pool } from \"./laya/utils/Pool\";\r\nimport { Utils } from \"./laya/utils/Utils\";\r\nimport { Graphics } from \"./laya/display/Graphics\";\r\nimport { Submit } from \"./laya/webgl/submit/Submit\";\r\nimport { Resource } from \"./laya/resource/Resource\";\r\n\r\n/**\r\n * 使用全局类的时候，避免引用其他模块\r\n */\r\n export class ILaya{\r\n     static Laya:any=null;\r\n     //static classMap:Object=null;\r\n     static Timer:typeof Timer = null;\r\n     static WorkerLoader:typeof WorkerLoader=null;\r\n     static Dragging:typeof Dragging =null;\r\n     static GraphicsBounds:typeof GraphicsBounds =null;\r\n     static Sprite:typeof Sprite = null;\r\n     static TextRender:typeof TextRender = null;\r\n     static TextAtlas:typeof TextAtlas = null;\r\n     static timer:Timer=null;\r\n     static systemTimer:Timer=null;\r\n     static startTimer:Timer = null;\r\n     static updateTimer:Timer=null;\r\n     static lateTimer:Timer=null;\r\n     static physicsTimer:Timer = null;\r\n     static stage:Stage = null;\r\n     static Loader:typeof Loader=null;\r\n     static loader:LoaderManager = null;\r\n     static TTFLoader:typeof TTFLoader = null;\r\n     static SoundManager:typeof SoundManager=null;\r\n     static WebAudioSound:typeof WebAudioSound=null;\r\n     static AudioSound:typeof AudioSound = null;\r\n     static ShaderCompile: typeof ShaderCompile=null;\r\n     static ClassUtils:typeof ClassUtils=null;\r\n     static SceneUtils:typeof SceneUtils=null;\r\n     static Context:typeof Context = null;\r\n     static Render:typeof Render = null;\r\n     static MouseManager:typeof MouseManager=null;\r\n     static Text:typeof Text = null;\r\n     static Browser:typeof Browser = null;\r\n     static WebGL:typeof WebGL = null;\r\n     static Pool:typeof Pool=null;\r\n     static Utils:typeof Utils = null;\r\n     static Graphics:typeof Graphics = null;\r\n     static Submit:typeof Submit = null;\r\n     static Stage:typeof Stage=null;\r\n     static Resource:typeof Resource=null;\r\n\r\n     /**@internal */\r\n     static __classMap:Object = {};\r\n     static regClass(c:any){\r\n        ILaya.__classMap[c.name]=c;\r\n     }\r\n }\r\n ","/**\r\n\t * <p> <code>Pool</code> 是对象池类，用于对象的存储、重复使用。</p>\r\n\t * <p>合理使用对象池，可以有效减少对象创建的开销，避免频繁的垃圾回收，从而优化游戏流畅度。</p>\r\n\t */\r\nexport class Pool {\r\n    /**@private */\r\n    private static _CLSID: number = 0;\r\n    /**@private */\r\n    private static POOLSIGN: string = \"__InPool\";\r\n    /**@private  对象存放池。*/\r\n    private static _poolDic: any = {};\r\n\r\n    /**\r\n     * 根据对象类型标识字符，获取对象池。\r\n     * @param sign 对象类型标识字符。\r\n     * @return 对象池。\r\n     */\r\n    static getPoolBySign(sign: string): any[] {\r\n        return Pool._poolDic[sign] || (Pool._poolDic[sign] = []);\r\n    }\r\n\r\n    /**\r\n     * 清除对象池的对象。\r\n     * @param sign 对象类型标识字符。\r\n     */\r\n    static clearBySign(sign: string): void {\r\n        if (Pool._poolDic[sign]) Pool._poolDic[sign].length = 0;\r\n    }\r\n\r\n    /**\r\n     * 将对象放到对应类型标识的对象池中。\r\n     * @param sign 对象类型标识字符。\r\n     * @param item 对象。\r\n     */\r\n    static recover(sign: string, item: any): void {\r\n        if (item[Pool.POOLSIGN]) return;\r\n        item[Pool.POOLSIGN] = true;\r\n        Pool.getPoolBySign(sign).push(item);\r\n    }\r\n\r\n    /**\r\n     * 根据类名进行回收，如果类有类名才进行回收，没有则不回收\r\n     * @param\tinstance 类的具体实例\r\n     */\r\n    static recoverByClass(instance: any): void {\r\n        if (instance) {\r\n            var className: string = instance[\"__className\"] || instance.constructor._$gid;\r\n            if (className) Pool.recover(className, instance);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 返回类的唯一标识\r\n     */\r\n    private static _getClassSign(cla: new () => any): string {\r\n        var className: string = cla[\"__className\"] || cla[\"_$gid\"];\r\n        if (!className) {\r\n            cla[\"_$gid\"] = className = Pool._CLSID + \"\";\r\n            Pool._CLSID++;\r\n        }\r\n        return className;\r\n    }\r\n\r\n    /**\r\n     * 根据类名回收类的实例\r\n     * @param\tinstance 类的具体实例\r\n     */\r\n    static createByClass<T>(cls: new () => T): T {\r\n        return Pool.getItemByClass(Pool._getClassSign(cls), cls);\r\n    }\r\n\r\n    /**\r\n     * <p>根据传入的对象类型标识字符，获取对象池中此类型标识的一个对象实例。</p>\r\n     * <p>当对象池中无此类型标识的对象时，则根据传入的类型，创建一个新的对象返回。</p>\r\n     * @param sign 对象类型标识字符。\r\n     * @param cls 用于创建该类型对象的类。\r\n     * @return 此类型标识的一个对象。\r\n     */\r\n    static getItemByClass<T>(sign: string, cls: new () => T): T {\r\n        if (!Pool._poolDic[sign]) return new cls();\r\n\r\n        var pool = Pool.getPoolBySign(sign);\r\n        if (pool.length) {\r\n            var rst = pool.pop();\r\n            rst[Pool.POOLSIGN] = false;\r\n        } else {\r\n            rst = new cls();\r\n        }\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     * <p>根据传入的对象类型标识字符，获取对象池中此类型标识的一个对象实例。</p>\r\n     * <p>当对象池中无此类型标识的对象时，则使用传入的创建此类型对象的函数，新建一个对象返回。</p>\r\n     * @param sign 对象类型标识字符。\r\n     * @param createFun 用于创建该类型对象的方法。\r\n     * @param caller this对象\r\n     * @return 此类型标识的一个对象。\r\n     */\r\n    static getItemByCreateFun(sign: string, createFun: Function, caller: any = null): any {\r\n        var pool: any[] = Pool.getPoolBySign(sign);\r\n        var rst: any = pool.length ? pool.pop() : createFun.call(caller);\r\n        rst[Pool.POOLSIGN] = false;\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     * 根据传入的对象类型标识字符，获取对象池中已存储的此类型的一个对象，如果对象池中无此类型的对象，则返回 null 。\r\n     * @param sign 对象类型标识字符。\r\n     * @return 对象池中此类型的一个对象，如果对象池中无此类型的对象，则返回 null 。\r\n     */\r\n    static getItem(sign: string): any {\r\n        var pool: any[] = Pool.getPoolBySign(sign);\r\n        var rst: any = pool.length ? pool.pop() : null;\r\n        if (rst) {\r\n            rst[Pool.POOLSIGN] = false;\r\n        }\r\n        return rst;\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 透明命令\r\n */\r\nexport class AlphaCmd {\r\n    static ID: string = \"Alpha\";\r\n\r\n    /**\r\n     * 透明度\r\n     */\r\n    alpha: number;\r\n\r\n    /**@private */\r\n    static create(alpha: number): AlphaCmd {\r\n        var cmd: AlphaCmd = Pool.getItemByClass(\"AlphaCmd\", AlphaCmd);\r\n        cmd.alpha = alpha;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        Pool.recover(\"AlphaCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context.alpha(this.alpha);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return AlphaCmd.ID;\r\n    }\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 绘制圆形\r\n */\r\nexport class DrawCircleCmd {\r\n    static ID: string = \"DrawCircle\";\r\n\r\n    /**\r\n     * 圆点X 轴位置。\r\n     */\r\n    x: number;\r\n    /**\r\n     * 圆点Y 轴位置。\r\n     */\r\n    y: number;\r\n    /**\r\n     * 半径。\r\n     */\r\n    radius: number;\r\n    /**\r\n     * 填充颜色，或者填充绘图的渐变对象。\r\n     */\r\n    fillColor: any;\r\n    /**\r\n     * （可选）边框颜色，或者填充绘图的渐变对象。\r\n     */\r\n    lineColor: any;\r\n    /**\r\n     * （可选）边框宽度。\r\n     */\r\n    lineWidth: number;\r\n    /**@private */\r\n    vid: number;\r\n\r\n    /**@private */\r\n    static create(x: number, y: number, radius: number, fillColor: any, lineColor: any, lineWidth: number, vid: number): DrawCircleCmd {\r\n        var cmd: DrawCircleCmd = Pool.getItemByClass(\"DrawCircleCmd\", DrawCircleCmd);\r\n        cmd.x = x;\r\n        cmd.y = y;\r\n        cmd.radius = radius;\r\n        cmd.fillColor = fillColor;\r\n        cmd.lineColor = lineColor;\r\n        cmd.lineWidth = lineWidth;\r\n        cmd.vid = vid;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this.fillColor = null;\r\n        this.lineColor = null;\r\n        Pool.recover(\"DrawCircleCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context._drawCircle(this.x + gx, this.y + gy, this.radius, this.fillColor, this.lineColor, this.lineWidth, this.vid);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return DrawCircleCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 绘制曲线\r\n */\r\nexport class DrawCurvesCmd {\r\n    static ID: string = \"DrawCurves\";\r\n\r\n    /**\r\n     * 开始绘制的 X 轴位置。\r\n     */\r\n    x: number;\r\n    /**\r\n     * 开始绘制的 Y 轴位置。\r\n     */\r\n    y: number;\r\n    /**\r\n     * 线段的点集合，格式[controlX, controlY, anchorX, anchorY...]。\r\n     */\r\n    points: number[]|null;\r\n    /**\r\n     * 线段颜色，或者填充绘图的渐变对象。\r\n     */\r\n    lineColor: any;\r\n    /**\r\n     * （可选）线段宽度。\r\n     */\r\n    lineWidth: number;\r\n\r\n    /**@private */\r\n    static create(x: number, y: number, points: any[], lineColor: any, lineWidth: number): DrawCurvesCmd {\r\n        var cmd: DrawCurvesCmd = Pool.getItemByClass(\"DrawCurvesCmd\", DrawCurvesCmd);\r\n        cmd.x = x;\r\n        cmd.y = y;\r\n        cmd.points = points;\r\n        cmd.lineColor = lineColor;\r\n        cmd.lineWidth = lineWidth;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this.points = null;\r\n        this.lineColor = null;\r\n        Pool.recover(\"DrawCurvesCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n\t\tif(this.points)\r\n        \tcontext.drawCurves(this.x + gx, this.y + gy, this.points, this.lineColor, this.lineWidth);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return DrawCurvesCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Texture } from \"../../resource/Texture\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 绘制图片\r\n */\r\nexport class DrawImageCmd {\r\n    static ID: string = \"DrawImage\";\r\n\r\n    /**\r\n     * 纹理。\r\n     */\r\n    texture: Texture|null;\r\n    /**\r\n     * （可选）X轴偏移量。\r\n     */\r\n    x: number;\r\n    /**\r\n     * （可选）Y轴偏移量。\r\n     */\r\n    y: number;\r\n    /**\r\n     * （可选）宽度。\r\n     */\r\n    width: number;\r\n    /**\r\n     * （可选）高度。\r\n     */\r\n    height: number;\r\n\r\n    /**@private */\r\n    static create(texture: Texture, x: number, y: number, width: number, height: number): DrawImageCmd {\r\n        var cmd: DrawImageCmd = Pool.getItemByClass(\"DrawImageCmd\", DrawImageCmd);\r\n        cmd.texture = texture;\r\n        texture._addReference();\r\n        cmd.x = x;\r\n        cmd.y = y;\r\n        cmd.width = width;\r\n        cmd.height = height;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this.texture && this.texture._removeReference();\r\n        this.texture = null;\r\n        Pool.recover(\"DrawImageCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n\t\tif(this.texture)\r\n        \tcontext.drawTexture(this.texture, this.x + gx, this.y + gy, this.width, this.height);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return DrawImageCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 绘制单条曲线\r\n */\r\nexport class DrawLineCmd {\r\n    static ID: string = \"DrawLine\";\r\n\r\n    /**\r\n     * X轴开始位置。\r\n     */\r\n    fromX: number;\r\n    /**\r\n     * Y轴开始位置。\r\n     */\r\n    fromY: number;\r\n    /**\r\n     * X轴结束位置。\r\n     */\r\n    toX: number;\r\n    /**\r\n     * Y轴结束位置。\r\n     */\r\n    toY: number;\r\n    /**\r\n     * 颜色。\r\n     */\r\n    lineColor: string;\r\n    /**\r\n     * （可选）线条宽度。\r\n     */\r\n    lineWidth: number;\r\n    /**@private */\r\n    vid: number;\r\n\r\n    /**@private */\r\n    static create(fromX: number, fromY: number, toX: number, toY: number, lineColor: string, lineWidth: number, vid: number): DrawLineCmd {\r\n        var cmd: DrawLineCmd = Pool.getItemByClass(\"DrawLineCmd\", DrawLineCmd);\r\n        cmd.fromX = fromX;\r\n        cmd.fromY = fromY;\r\n        cmd.toX = toX;\r\n        cmd.toY = toY;\r\n        cmd.lineColor = lineColor;\r\n        cmd.lineWidth = lineWidth;\r\n        cmd.vid = vid;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        Pool.recover(\"DrawLineCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context._drawLine(gx, gy, this.fromX, this.fromY, this.toX, this.toY, this.lineColor, this.lineWidth, this.vid);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return DrawLineCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 绘制连续曲线\r\n */\r\nexport class DrawLinesCmd {\r\n    static ID: string = \"DrawLines\";\r\n\r\n    /**\r\n     * 开始绘制的X轴位置。\r\n     */\r\n    x: number;\r\n    /**\r\n     * 开始绘制的Y轴位置。\r\n     */\r\n    y: number;\r\n    /**\r\n     * 线段的点集合。格式:[x1,y1,x2,y2,x3,y3...]。\r\n     */\r\n    points: number[]|null;\r\n    /**\r\n     * 线段颜色，或者填充绘图的渐变对象。\r\n     */\r\n    lineColor: any;\r\n    /**\r\n     * （可选）线段宽度。\r\n     */\r\n    lineWidth: number;\r\n    /**@private */\r\n    vid: number;\r\n\r\n    /**@private */\r\n    static create(x: number, y: number, points: any[], lineColor: any, lineWidth: number, vid: number): DrawLinesCmd {\r\n        var cmd: DrawLinesCmd = Pool.getItemByClass(\"DrawLinesCmd\", DrawLinesCmd);\r\n        cmd.x = x;\r\n        cmd.y = y;\r\n        cmd.points = points;\r\n        cmd.lineColor = lineColor;\r\n        cmd.lineWidth = lineWidth;\r\n        cmd.vid = vid;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this.points = null;\r\n        this.lineColor = null;\r\n        Pool.recover(\"DrawLinesCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        this.points && context._drawLines(this.x + gx, this.y + gy, this.points, this.lineColor, this.lineWidth, this.vid);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return DrawLinesCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 根据路径绘制矢量图形\r\n */\r\nexport class DrawPathCmd {\r\n    static ID: string = \"DrawPath\";\r\n\r\n    /**\r\n     * 开始绘制的 X 轴位置。\r\n     */\r\n    x: number;\r\n    /**\r\n     * 开始绘制的 Y 轴位置。\r\n     */\r\n    y: number;\r\n    /**\r\n     * 路径集合，路径支持以下格式：[[\"moveTo\",x,y],[\"lineTo\",x,y],[\"arcTo\",x1,y1,x2,y2,r],[\"closePath\"]]。\r\n     */\r\n    paths: any[]|null;\r\n    /**\r\n     * （可选）刷子定义，支持以下设置{fillStyle:\"#FF0000\"}。\r\n     */\r\n    brush: any;\r\n    /**\r\n     * （可选）画笔定义，支持以下设置{strokeStyle,lineWidth,lineJoin:\"bevel|round|miter\",lineCap:\"butt|round|square\",miterLimit}。\r\n     */\r\n    pen: any;\r\n\r\n    /**@private */\r\n    static create(x: number, y: number, paths: any[], brush: any, pen: any): DrawPathCmd {\r\n        var cmd: DrawPathCmd = Pool.getItemByClass(\"DrawPathCmd\", DrawPathCmd);\r\n        cmd.x = x;\r\n        cmd.y = y;\r\n        cmd.paths = paths;\r\n        cmd.brush = brush;\r\n        cmd.pen = pen;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this.paths = null;\r\n        this.brush = null;\r\n        this.pen = null;\r\n        Pool.recover(\"DrawPathCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        this.paths && context._drawPath(this.x + gx, this.y + gy, this.paths, this.brush, this.pen);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return DrawPathCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 绘制扇形\r\n */\r\nexport class DrawPieCmd {\r\n    static ID: string = \"DrawPie\";\r\n\r\n    /**\r\n     * 开始绘制的 X 轴位置。\r\n     */\r\n    x: number;\r\n    /**\r\n     * 开始绘制的 Y 轴位置。\r\n     */\r\n    y: number;\r\n    /**\r\n     * 扇形半径。\r\n     */\r\n    radius: number;\r\n    private _startAngle: number;\r\n    private _endAngle: number;\r\n    /**\r\n     * 填充颜色，或者填充绘图的渐变对象。\r\n     */\r\n    fillColor: any;\r\n    /**\r\n     * （可选）边框颜色，或者填充绘图的渐变对象。\r\n     */\r\n    lineColor: any;\r\n    /**\r\n     * （可选）边框宽度。\r\n     */\r\n    lineWidth: number;\r\n    /**@private */\r\n    vid: number;\r\n\r\n    /**@private */\r\n    static create(x: number, y: number, radius: number, startAngle: number, endAngle: number, fillColor: any, lineColor: any, lineWidth: number, vid: number): DrawPieCmd {\r\n        var cmd: DrawPieCmd = Pool.getItemByClass(\"DrawPieCmd\", DrawPieCmd);\r\n        cmd.x = x;\r\n        cmd.y = y;\r\n        cmd.radius = radius;\r\n        cmd._startAngle = startAngle;\r\n        cmd._endAngle = endAngle;\r\n        cmd.fillColor = fillColor;\r\n        cmd.lineColor = lineColor;\r\n        cmd.lineWidth = lineWidth;\r\n        cmd.vid = vid;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this.fillColor = null;\r\n        this.lineColor = null;\r\n        Pool.recover(\"DrawPieCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context._drawPie(this.x + gx, this.y + gy, this.radius, this._startAngle, this._endAngle, this.fillColor, this.lineColor, this.lineWidth, this.vid);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return DrawPieCmd.ID;\r\n    }\r\n\r\n    /**\r\n     * 开始角度。\r\n     */\r\n    get startAngle(): number {\r\n        return this._startAngle * 180 / Math.PI;\r\n    }\r\n\r\n    set startAngle(value: number) {\r\n        this._startAngle = value * Math.PI / 180;\r\n    }\r\n\r\n    /**\r\n     * 结束角度。\r\n     */\r\n    get endAngle(): number {\r\n        return this._endAngle * 180 / Math.PI;\r\n    }\r\n\r\n    set endAngle(value: number) {\r\n        this._endAngle = value * Math.PI / 180;\r\n    }\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 绘制多边形\r\n */\r\nexport class DrawPolyCmd {\r\n    static ID: string = \"DrawPoly\";\r\n\r\n    /**\r\n     * 开始绘制的 X 轴位置。\r\n     */\r\n    x: number;\r\n    /**\r\n     * 开始绘制的 Y 轴位置。\r\n     */\r\n    y: number;\r\n    /**\r\n     * 多边形的点集合。\r\n     */\r\n    points: number[]|null;\r\n    /**\r\n     * 填充颜色，或者填充绘图的渐变对象。\r\n     */\r\n    fillColor: any;\r\n    /**\r\n     * （可选）边框颜色，或者填充绘图的渐变对象。\r\n     */\r\n    lineColor: any;\r\n    /**\r\n     * 可选）边框宽度。\r\n     */\r\n    lineWidth: number;\r\n    /**@private */\r\n    isConvexPolygon: boolean;\r\n    /**@private */\r\n    vid: number;\r\n\r\n    /**@private */\r\n    static create(x: number, y: number, points: any[], fillColor: any, lineColor: any, lineWidth: number, isConvexPolygon: boolean, vid: number): DrawPolyCmd {\r\n        var cmd: DrawPolyCmd = Pool.getItemByClass(\"DrawPolyCmd\", DrawPolyCmd);\r\n        cmd.x = x;\r\n        cmd.y = y;\r\n        cmd.points = points;\r\n        cmd.fillColor = fillColor;\r\n        cmd.lineColor = lineColor;\r\n        cmd.lineWidth = lineWidth;\r\n        cmd.isConvexPolygon = isConvexPolygon;\r\n        cmd.vid = vid;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this.points = null;\r\n        this.fillColor = null;\r\n        this.lineColor = null;\r\n        Pool.recover(\"DrawPolyCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        this.points && context._drawPoly(this.x + gx, this.y + gy, this.points, this.fillColor, this.lineColor, this.lineWidth, this.isConvexPolygon, this.vid);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return DrawPolyCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 绘制矩形\r\n */\r\nexport class DrawRectCmd {\r\n    static ID: string = \"DrawRect\";\r\n\r\n    /**\r\n     * 开始绘制的 X 轴位置。\r\n     */\r\n    x: number;\r\n    /**\r\n     * 开始绘制的 Y 轴位置。\r\n     */\r\n    y: number;\r\n    /**\r\n     * 矩形宽度。\r\n     */\r\n    width: number;\r\n    /**\r\n     * 矩形高度。\r\n     */\r\n    height: number;\r\n    /**\r\n     * 填充颜色，或者填充绘图的渐变对象。\r\n     */\r\n    fillColor: any;\r\n    /**\r\n     * （可选）边框颜色，或者填充绘图的渐变对象。\r\n     */\r\n    lineColor: any;\r\n    /**\r\n     * （可选）边框宽度。\r\n     */\r\n    lineWidth: number;\r\n\r\n    /**@private */\r\n    static create(x: number, y: number, width: number, height: number, fillColor: any, lineColor: any, lineWidth: number): DrawRectCmd {\r\n        var cmd: DrawRectCmd = Pool.getItemByClass(\"DrawRectCmd\", DrawRectCmd);\r\n        cmd.x = x;\r\n        cmd.y = y;\r\n        cmd.width = width;\r\n        cmd.height = height;\r\n        cmd.fillColor = fillColor;\r\n        cmd.lineColor = lineColor;\r\n        cmd.lineWidth = lineWidth;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this.fillColor = null;\r\n        this.lineColor = null;\r\n        Pool.recover(\"DrawRectCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context.drawRect(this.x + gx, this.y + gy, this.width, this.height, this.fillColor, this.lineColor, this.lineWidth);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return DrawRectCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Point } from \"./Point\";\r\nimport { Pool } from \"../utils/Pool\"\r\n\r\n/**\r\n * <p> <code>Matrix</code> 类表示一个转换矩阵，它确定如何将点从一个坐标空间映射到另一个坐标空间。</p>\r\n * <p>您可以对一个显示对象执行不同的图形转换，方法是设置 Matrix 对象的属性，将该 Matrix 对象应用于 Transform 对象的 matrix 属性，然后应用该 Transform 对象作为显示对象的 transform 属性。这些转换函数包括平移（x 和 y 重新定位）、旋转、缩放和倾斜。</p>\r\n */\r\nexport class Matrix {\r\n\r\n    /**@private 一个初始化的 <code>Matrix</code> 对象，不允许修改此对象内容。*/\r\n    static EMPTY: Matrix = new Matrix();\r\n    /**用于中转使用的 <code>Matrix</code> 对象。*/\r\n    static TEMP: Matrix = new Matrix();\r\n    /**@internal */\r\n    static _createFun: Function|null = null;\r\n\r\n    /**缩放或旋转图像时影响像素沿 x 轴定位的值。*/\r\n    a: number;\r\n    /**旋转或倾斜图像时影响像素沿 y 轴定位的值。*/\r\n    b: number;\r\n    /**旋转或倾斜图像时影响像素沿 x 轴定位的值。*/\r\n    c: number;\r\n    /**缩放或旋转图像时影响像素沿 y 轴定位的值。*/\r\n    d: number;\r\n    /**沿 x 轴平移每个点的距离。*/\r\n    tx: number;\r\n    /**沿 y 轴平移每个点的距离。*/\r\n    ty: number;\r\n    /**@internal 是否有旋转缩放操作*/\r\n    _bTransform: boolean = false;\r\n\r\n    /**\r\n     * 使用指定参数创建新的 <code>Matrix</code> 对象。\r\n     * @param a\t\t（可选）缩放或旋转图像时影响像素沿 x 轴定位的值。\r\n     * @param b\t\t（可选）旋转或倾斜图像时影响像素沿 y 轴定位的值。\r\n     * @param c\t\t（可选）旋转或倾斜图像时影响像素沿 x 轴定位的值。\r\n     * @param d\t\t（可选）缩放或旋转图像时影响像素沿 y 轴定位的值。\r\n     * @param tx\t（可选）沿 x 轴平移每个点的距离。\r\n     * @param ty\t（可选）沿 y 轴平移每个点的距离。\r\n     */\r\n    constructor(a: number = 1, b: number = 0, c: number = 0, d: number = 1, tx: number = 0, ty: number = 0, nums: number = 0) {\r\n        if (Matrix._createFun != null) {\r\n            return Matrix._createFun(a, b, c, d, tx, ty, nums);\r\n        }\r\n        this.a = a;\r\n        this.b = b;\r\n        this.c = c;\r\n        this.d = d;\r\n        this.tx = tx;\r\n        this.ty = ty;\r\n        this._checkTransform();\r\n    }\r\n\r\n    /**\r\n     * 将本矩阵设置为单位矩阵。\r\n     * @return 返回当前矩形。\r\n     */\r\n    identity(): Matrix {\r\n        this.a = this.d = 1;\r\n        this.b = this.tx = this.ty = this.c = 0;\r\n        this._bTransform = false;\r\n        return this;\r\n    }\r\n\r\n    /**@internal */\r\n    _checkTransform(): boolean {\r\n        return this._bTransform = (this.a !== 1 || this.b !== 0 || this.c !== 0 || this.d !== 1);\r\n    }\r\n\r\n    /**\r\n     * 设置沿 x 、y 轴平移每个点的距离。\r\n     * @param\tx 沿 x 轴平移每个点的距离。\r\n     * @param\ty 沿 y 轴平移每个点的距离。\r\n     * @return\t返回对象本身\r\n     */\r\n    setTranslate(x: number, y: number): Matrix {\r\n        this.tx = x;\r\n        this.ty = y;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 沿 x 和 y 轴平移矩阵，平移的变化量由 x 和 y 参数指定。\r\n     * @param\tx 沿 x 轴向右移动的量（以像素为单位）。\r\n     * @param\ty 沿 y 轴向下移动的量（以像素为单位）。\r\n     * @return 返回此矩形对象。\r\n     */\r\n    translate(x: number, y: number): Matrix {\r\n        this.tx += x;\r\n        this.ty += y;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 对矩阵应用缩放转换。\r\n     * @param\tx 用于沿 x 轴缩放对象的乘数。\r\n     * @param\ty 用于沿 y 轴缩放对象的乘数。\r\n     * @return\t返回矩阵对象本身\r\n     */\r\n    scale(x: number, y: number): Matrix {\r\n        this.a *= x;\r\n        this.d *= y;\r\n        this.c *= x;\r\n        this.b *= y;\r\n        this.tx *= x;\r\n        this.ty *= y;\r\n        this._bTransform = true;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 对 Matrix 对象应用旋转转换。\r\n     * @param\tangle 以弧度为单位的旋转角度。\r\n     * @return\t返回矩阵对象本身\r\n     */\r\n    rotate(angle: number): Matrix {\r\n        var cos: number = Math.cos(angle);\r\n        var sin: number = Math.sin(angle);\r\n        var a1: number = this.a;\r\n        var c1: number = this.c;\r\n        var tx1: number = this.tx;\r\n\r\n        this.a = a1 * cos - this.b * sin;\r\n        this.b = a1 * sin + this.b * cos;\r\n        this.c = c1 * cos - this.d * sin;\r\n        this.d = c1 * sin + this.d * cos;\r\n        this.tx = tx1 * cos - this.ty * sin;\r\n        this.ty = tx1 * sin + this.ty * cos;\r\n        this._bTransform = true;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 对 Matrix 对象应用倾斜转换。\r\n     * @param\tx 沿着 X 轴的 2D 倾斜弧度。\r\n     * @param\ty 沿着 Y 轴的 2D 倾斜弧度。\r\n     * @return 当前 Matrix 对象。\r\n     */\r\n    skew(x: number, y: number): Matrix {\r\n        var tanX: number = Math.tan(x);\r\n        var tanY: number = Math.tan(y);\r\n        var a1: number = this.a;\r\n        var b1: number = this.b;\r\n        this.a += tanY * this.c;\r\n        this.b += tanY * this.d;\r\n        this.c += tanX * a1;\r\n        this.d += tanX * b1;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 对指定的点应用当前矩阵的逆转化并返回此点。\r\n     * @param\tout 待转化的点 Point 对象。\r\n     * @return\t返回out\r\n     */\r\n    invertTransformPoint(out: Point): Point {\r\n        var a1: number = this.a;\r\n        var b1: number = this.b;\r\n        var c1: number = this.c;\r\n        var d1: number = this.d;\r\n        var tx1: number = this.tx;\r\n        var n: number = a1 * d1 - b1 * c1;\r\n\r\n        var a2: number = d1 / n;\r\n        var b2: number = -b1 / n;\r\n        var c2: number = -c1 / n;\r\n        var d2: number = a1 / n;\r\n        var tx2: number = (c1 * this.ty - d1 * tx1) / n;\r\n        var ty2: number = -(a1 * this.ty - b1 * tx1) / n;\r\n        return out.setTo(a2 * out.x + c2 * out.y + tx2, b2 * out.x + d2 * out.y + ty2);\r\n    }\r\n\r\n    /**\r\n     * 将 Matrix 对象表示的几何转换应用于指定点。\r\n     * @param\tout 用来设定输出结果的点。\r\n     * @return\t返回out\r\n     */\r\n    transformPoint(out: Point): Point {\r\n        return out.setTo(this.a * out.x + this.c * out.y + this.tx, this.b * out.x + this.d * out.y + this.ty);\r\n    }\r\n\r\n    /**\r\n     * 将 Matrix 对象表示的几何转换应用于指定点，忽略tx、ty。\r\n     * @param\tout 用来设定输出结果的点。\r\n     * @return\t返回out\r\n     */\r\n    transformPointN(out: Point): Point {\r\n        return out.setTo(this.a * out.x + this.c * out.y /*+ tx*/, this.b * out.x + this.d * out.y /*+ ty*/);\r\n    }\r\n\r\n    /**\r\n     * 获取 X 轴缩放值。\r\n     * @return  X 轴缩放值。\r\n     */\r\n    getScaleX(): number {\r\n        return this.b === 0 ? this.a : Math.sqrt(this.a * this.a + this.b * this.b);\r\n    }\r\n\r\n    /**\r\n     * 获取 Y 轴缩放值。\r\n     * @return Y 轴缩放值。\r\n     */\r\n    getScaleY(): number {\r\n        return this.c === 0 ? this.d : Math.sqrt(this.c * this.c + this.d * this.d);\r\n    }\r\n\r\n    /**\r\n     * 执行原始矩阵的逆转换。\r\n     * @return 当前矩阵对象。\r\n     */\r\n    invert(): Matrix {\r\n        var a1: number = this.a;\r\n        var b1: number = this.b;\r\n        var c1: number = this.c;\r\n        var d1: number = this.d;\r\n        var tx1: number = this.tx;\r\n        var n: number = a1 * d1 - b1 * c1;\r\n        this.a = d1 / n;\r\n        this.b = -b1 / n;\r\n        this.c = -c1 / n;\r\n        this.d = a1 / n;\r\n        this.tx = (c1 * this.ty - d1 * tx1) / n;\r\n        this.ty = -(a1 * this.ty - b1 * tx1) / n;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     *  将 Matrix 的成员设置为指定值。\r\n     * @param\ta 缩放或旋转图像时影响像素沿 x 轴定位的值。\r\n     * @param\tb 旋转或倾斜图像时影响像素沿 y 轴定位的值。\r\n     * @param\tc 旋转或倾斜图像时影响像素沿 x 轴定位的值。\r\n     * @param\td 缩放或旋转图像时影响像素沿 y 轴定位的值。\r\n     * @param\ttx 沿 x 轴平移每个点的距离。\r\n     * @param\tty 沿 y 轴平移每个点的距离。\r\n     * @return 当前矩阵对象。\r\n     */\r\n    setTo(a: number, b: number, c: number, d: number, tx: number, ty: number): Matrix {\r\n        this.a = a, this.b = b, this.c = c, this.d = d, this.tx = tx, this.ty = ty;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 将指定矩阵与当前矩阵连接，从而将这两个矩阵的几何效果有效地结合在一起。\r\n     * @param\tmatrix 要连接到源矩阵的矩阵。\r\n     * @return\t当前矩阵。\r\n     */\r\n    concat(matrix: Matrix): Matrix {\r\n        var a: number = this.a;\r\n        var c: number = this.c;\r\n        var tx: number = this.tx;\r\n        this.a = a * matrix.a + this.b * matrix.c;\r\n        this.b = a * matrix.b + this.b * matrix.d;\r\n        this.c = c * matrix.a + this.d * matrix.c;\r\n        this.d = c * matrix.b + this.d * matrix.d;\r\n        this.tx = tx * matrix.a + this.ty * matrix.c + matrix.tx;\r\n        this.ty = tx * matrix.b + this.ty * matrix.d + matrix.ty;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 将指定的两个矩阵相乘后的结果赋值给指定的输出对象。\r\n     * @param\tm1 矩阵一。\r\n     * @param\tm2 矩阵二。\r\n     * @param\tout 输出对象。\r\n     * @return\t结果输出对象 out。\r\n     */\r\n    static mul(m1: Matrix, m2: Matrix, out: Matrix): Matrix {\r\n        var aa: number = m1.a, ab: number = m1.b, ac: number = m1.c, ad: number = m1.d, atx: number = m1.tx, aty: number = m1.ty;\r\n        var ba: number = m2.a, bb: number = m2.b, bc: number = m2.c, bd: number = m2.d, btx: number = m2.tx, bty: number = m2.ty;\r\n        if (bb !== 0 || bc !== 0) {\r\n            out.a = aa * ba + ab * bc;\r\n            out.b = aa * bb + ab * bd;\r\n            out.c = ac * ba + ad * bc;\r\n            out.d = ac * bb + ad * bd;\r\n            out.tx = ba * atx + bc * aty + btx;\r\n            out.ty = bb * atx + bd * aty + bty;\r\n        } else {\r\n            out.a = aa * ba;\r\n            out.b = ab * bd;\r\n            out.c = ac * ba;\r\n            out.d = ad * bd;\r\n            out.tx = ba * atx + btx;\r\n            out.ty = bd * aty + bty;\r\n        }\r\n        return out;\r\n    }\r\n\r\n    /**\r\n     * 将指定的两个矩阵相乘，结果赋值给指定的输出数组，长度为16。\r\n     * @param m1\t矩阵一。\r\n     * @param m2\t矩阵二。\r\n     * @param out\t输出对象Array。\r\n     * @return 结果输出对象 out。\r\n     */\r\n    static mul16(m1: Matrix, m2: Matrix, out: any[]): any[] {\r\n        var aa: number = m1.a, ab: number = m1.b, ac: number = m1.c, ad: number = m1.d, atx: number = m1.tx, aty: number = m1.ty;\r\n        var ba: number = m2.a, bb: number = m2.b, bc: number = m2.c, bd: number = m2.d, btx: number = m2.tx, bty: number = m2.ty;\r\n        if (bb !== 0 || bc !== 0) {\r\n            out[0] = aa * ba + ab * bc;\r\n            out[1] = aa * bb + ab * bd;\r\n            out[4] = ac * ba + ad * bc;\r\n            out[5] = ac * bb + ad * bd;\r\n            out[12] = ba * atx + bc * aty + btx;\r\n            out[13] = bb * atx + bd * aty + bty;\r\n        } else {\r\n            out[0] = aa * ba;\r\n            out[1] = ab * bd;\r\n            out[4] = ac * ba;\r\n            out[5] = ad * bd;\r\n            out[12] = ba * atx + btx;\r\n            out[13] = bd * aty + bty;\r\n        }\r\n        return out;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 对矩阵应用缩放转换。反向相乘\r\n     * @param\tx 用于沿 x 轴缩放对象的乘数。\r\n     * @param\ty 用于沿 y 轴缩放对象的乘数。\r\n     */\r\n    scaleEx(x: number, y: number): void {\r\n        var ba: number = this.a, bb: number = this.b, bc: number = this.c, bd: number = this.d;\r\n        if (bb !== 0 || bc !== 0) {\r\n            this.a = x * ba;\r\n            this.b = x * bb;\r\n            this.c = y * bc;\r\n            this.d = y * bd;\r\n        } else {\r\n            this.a = x * ba;\r\n            this.b = 0 * bd;\r\n            this.c = 0 * ba;\r\n            this.d = y * bd;\r\n        }\r\n        this._bTransform = true;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 对 Matrix 对象应用旋转转换。反向相乘\r\n     * @param\tangle 以弧度为单位的旋转角度。\r\n     */\r\n    rotateEx(angle: number): void {\r\n        var cos: number = Math.cos(angle);\r\n        var sin: number = Math.sin(angle);\r\n        var ba: number = this.a, bb: number = this.b, bc: number = this.c, bd: number = this.d;\r\n        if (bb !== 0 || bc !== 0) {\r\n            this.a = cos * ba + sin * bc;\r\n            this.b = cos * bb + sin * bd;\r\n            this.c = -sin * ba + cos * bc;\r\n            this.d = -sin * bb + cos * bd;\r\n        } else {\r\n            this.a = cos * ba;\r\n            this.b = sin * bd;\r\n            this.c = -sin * ba;\r\n            this.d = cos * bd;\r\n        }\r\n        this._bTransform = true;\r\n    }\r\n\r\n    /**\r\n     * 返回此 Matrix 对象的副本。\r\n     * @return 与原始实例具有完全相同的属性的新 Matrix 实例。\r\n     */\r\n    clone(): Matrix {\r\n        var dec: Matrix = Matrix.create();\r\n        dec.a = this.a;\r\n        dec.b = this.b;\r\n        dec.c = this.c;\r\n        dec.d = this.d;\r\n        dec.tx = this.tx;\r\n        dec.ty = this.ty;\r\n        dec._bTransform = this._bTransform;\r\n        return dec;\r\n    }\r\n\r\n    /**\r\n     * 将当前 Matrix 对象中的所有矩阵数据复制到指定的 Matrix 对象中。\r\n     * @param\tdec 要复制当前矩阵数据的 Matrix 对象。\r\n     * @return\t已复制当前矩阵数据的 Matrix 对象。\r\n     */\r\n    copyTo(dec: Matrix): Matrix {\r\n        dec.a = this.a;\r\n        dec.b = this.b;\r\n        dec.c = this.c;\r\n        dec.d = this.d;\r\n        dec.tx = this.tx;\r\n        dec.ty = this.ty;\r\n        dec._bTransform = this._bTransform;\r\n        return dec;\r\n    }\r\n\r\n    /**\r\n     * 返回列出该 Matrix 对象属性的文本值。\r\n     * @return 一个字符串，它包含 Matrix 对象的属性值：a、b、c、d、tx 和 ty。\r\n     */\r\n    toString(): string {\r\n        return this.a + \",\" + this.b + \",\" + this.c + \",\" + this.d + \",\" + this.tx + \",\" + this.ty;\r\n    }\r\n\r\n    /**\r\n     * 销毁此对象。\r\n     */\r\n    destroy(): void {\r\n        this.recover();\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池，方便复用\r\n     */\r\n    recover(): void {\r\n        Pool.recover(\"Matrix\", this.identity());\r\n    }\r\n\r\n    /**\r\n     * 从对象池中创建一个 <code>Matrix</code> 对象。\r\n     * @return <code>Matrix</code> 对象。\r\n     */\r\n    static create(): Matrix {\r\n        return Pool.getItemByClass(\"Matrix\", Matrix);\r\n    }\r\n}\r\n\r\n","import { Pool } from \"../utils/Pool\"\r\n\r\n/**\r\n * <code>Point</code> 对象表示二维坐标系统中的某个位置，其中 x 表示水平轴，y 表示垂直轴。\r\n */\r\nexport class Point {\r\n\r\n    /**临时使用的公用对象。*/\r\n    static TEMP: Point = new Point();\r\n    /**@private 全局空的point对象(x=0，y=0)，不允许修改此对象内容*/\r\n    static EMPTY: Point = new Point();\r\n\r\n    /**该点的水平坐标。*/\r\n    x: number;\r\n    /**该点的垂直坐标。*/\r\n    y: number;\r\n\r\n    /**\r\n     * 根据指定坐标，创建一个新的 <code>Point</code> 对象。\r\n     * @param x\t（可选）水平坐标。\r\n     * @param y\t（可选）垂直坐标。\r\n     */\r\n    constructor(x: number = 0, y: number = 0) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n\r\n    /**\r\n     * 从对象池创建\r\n     */\r\n    static create(): Point {\r\n        return Pool.getItemByClass(\"Point\", Point);\r\n    }\r\n\r\n    /**\r\n     * 将 <code>Point</code> 的成员设置为指定值。\r\n     * @param\tx 水平坐标。\r\n     * @param\ty 垂直坐标。\r\n     * @return 当前 Point 对象。\r\n     */\r\n    setTo(x: number, y: number): Point {\r\n        this.x = x;\r\n        this.y = y;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 重置\r\n     */\r\n    reset(): Point {\r\n        this.x = this.y = 0;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池，方便复用\r\n     */\r\n    recover(): void {\r\n        Pool.recover(\"Point\", this.reset());\r\n    }\r\n\r\n    /**\r\n     * 计算当前点和目标点(x，y)的距离。\r\n     * @param\tx 水平坐标。\r\n     * @param\ty 垂直坐标。\r\n     * @return\t返回当前点和目标点之间的距离。\r\n     */\r\n    distance(x: number, y: number): number {\r\n        return Math.sqrt((this.x - x) * (this.x - x) + (this.y - y) * (this.y - y));\r\n    }\r\n\r\n    /**返回包含 x 和 y 坐标的值的字符串。*/\r\n    toString(): string {\r\n        return this.x + \",\" + this.y;\r\n    }\r\n\r\n    /**\r\n     * 标准化向量。\r\n     */\r\n    normalize(): void {\r\n        var d: number = Math.sqrt(this.x * this.x + this.y * this.y);\r\n        if (d > 0) {\r\n            var id: number = 1.0 / d;\r\n            this.x *= id;\r\n            this.y *= id;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * copy point坐标\r\n     * @param\tpoint 需要被copy的point\r\n     */\r\n    copy(point: Point): Point {\r\n        return this.setTo(point.x, point.y);\r\n    }\r\n}\r\n\r\n","import { Pool } from \"../utils/Pool\";\r\nimport { Point } from \"./Point\";\r\n\r\n/**\r\n * <p><code>Rectangle</code> 对象是按其位置（由它左上角的点 (x, y) 确定）以及宽度和高度定义的区域。</p>\r\n * <p>Rectangle 类的 x、y、width 和 height 属性相互独立；更改一个属性的值不会影响其他属性。</p>\r\n */\r\nexport class Rectangle {\r\n\r\n    /**@private 全局空的矩形区域x=0,y=0,width=0,height=0，不允许修改此对象内容*/\r\n    static EMPTY: Rectangle = new Rectangle();\r\n    /**全局临时的矩形区域，此对象用于全局复用，以减少对象创建*/\r\n    static TEMP: Rectangle = new Rectangle();\r\n\r\n    /** @private */\r\n    private static _temB: number[] = [];\r\n    /** @private */\r\n    private static _temA: number[] = [];\r\n\r\n    /** 矩形左上角的 X 轴坐标。*/\r\n    x: number;\r\n    /** 矩形左上角的 Y 轴坐标。*/\r\n    y: number;\r\n    /** 矩形的宽度。*/\r\n    width: number;\r\n    /** 矩形的高度。*/\r\n    height: number;\r\n\r\n\t/**\r\n\t * 创建一个 <code>Rectangle</code> 对象。\r\n\t * @param\tx 矩形左上角的 X 轴坐标。\r\n\t * @param\ty 矩形左上角的 Y 轴坐标。\r\n\t * @param\twidth 矩形的宽度。\r\n\t * @param\theight 矩形的高度。\r\n\t */\r\n    constructor(x: number = 0, y: number = 0, width: number = 0, height: number = 0) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n\r\n    /** 此矩形右侧的 X 轴坐标。 x 和 width 属性的和。*/\r\n    get right(): number {\r\n        return this.x + this.width;\r\n    }\r\n\r\n    /** 此矩形底端的 Y 轴坐标。y 和 height 属性的和。*/\r\n    get bottom(): number {\r\n        return this.y + this.height;\r\n    }\r\n\r\n\t/**\r\n\t * 将 Rectangle 的属性设置为指定值。\r\n\t * @param\tx\tx 矩形左上角的 X 轴坐标。\r\n\t * @param\ty\tx 矩形左上角的 Y 轴坐标。\r\n\t * @param\twidth\t矩形的宽度。\r\n\t * @param\theight\t矩形的高。\r\n\t * @return\t返回属性值修改后的矩形对象本身。\r\n\t */\r\n    setTo(x: number, y: number, width: number, height: number): Rectangle {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.width = width;\r\n        this.height = height;\r\n        return this;\r\n    }\r\n\r\n\t/**\r\n\t * 重置\r\n\t */\r\n    reset(): Rectangle {\r\n        this.x = this.y = this.width = this.height = 0;\r\n        return this;\r\n    }\r\n\r\n\t/**\r\n\t * 回收\r\n\t */\r\n    recover(): void {\r\n        if (this == Rectangle.TEMP || this == Rectangle.EMPTY) {\r\n            console.log(\"recover Temp or Empty:\", this);\r\n            return;\r\n        }\r\n        Pool.recover(\"Rectangle\", this.reset());\r\n    }\r\n\r\n\t/**\r\n\t * 创建\r\n\t */\r\n    static create(): Rectangle {\r\n        return Pool.getItemByClass(\"Rectangle\", Rectangle);\r\n    }\r\n\r\n\t/**\r\n\t * 复制 source 对象的属性值到此矩形对象中。\r\n\t * @param\tsourceRect\t源 Rectangle 对象。\r\n\t * @return\t返回属性值修改后的矩形对象本身。\r\n\t */\r\n    copyFrom(source: Rectangle): Rectangle {\r\n        this.x = source.x;\r\n        this.y = source.y;\r\n        this.width = source.width;\r\n        this.height = source.height;\r\n        return this;\r\n    }\r\n\r\n\t/**\r\n\t * 确定由此 Rectangle 对象定义的矩形区域内是否包含指定的点。\r\n\t * @param x\t点的 X 轴坐标值（水平位置）。\r\n\t * @param y\t点的 Y 轴坐标值（垂直位置）。\r\n\t * @return\t如果 Rectangle 对象包含指定的点，则值为 true；否则为 false。\r\n\t */\r\n    contains(x: number, y: number): boolean {\r\n        if (this.width <= 0 || this.height <= 0) return false;\r\n\r\n        if (x >= this.x && x < this.right) {\r\n            if (y >= this.y && y < this.bottom) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n\t/**\r\n\t * 确定在 rect 参数中指定的对象是否与此 Rectangle 对象相交。此方法检查指定的 Rectangle 对象的 x、y、width 和 height 属性，以查看它是否与此 Rectangle 对象相交。\r\n\t * @param\trect Rectangle 对象。\r\n\t * @return\t如果传入的矩形对象与此对象相交，则返回 true 值，否则返回 false。\r\n\t */\r\n    intersects(rect: Rectangle): boolean {\r\n        return !(rect.x > (this.x + this.width) || (rect.x + rect.width) < this.x || rect.y > (this.y + this.height) || (rect.y + rect.height) < this.y);\r\n    }\r\n\r\n\t/**\r\n\t * 如果在 rect 参数中指定的 Rectangle 对象与此 Rectangle 对象相交，则返回交集区域作为 Rectangle 对象。如果矩形不相交，则此方法返回null。\r\n\t * @param rect\t待比较的矩形区域。\r\n\t * @param out\t（可选）待输出的矩形区域。如果为空则创建一个新的。建议：尽量复用对象，减少对象创建消耗。\r\n\t * @return\t返回相交的矩形区域对象。\r\n\t */\r\n    intersection(rect: Rectangle, out: Rectangle|null = null): Rectangle|null {\r\n        if (!this.intersects(rect)) return null;\r\n        out || (out = new Rectangle());\r\n        out.x = Math.max(this.x, rect.x);\r\n        out.y = Math.max(this.y, rect.y);\r\n        out.width = Math.min(this.right, rect.right) - out.x;\r\n        out.height = Math.min(this.bottom, rect.bottom) - out.y;\r\n        return out;\r\n    }\r\n\r\n\t/**\r\n\t * <p>矩形联合，通过填充两个矩形之间的水平和垂直空间，将这两个矩形组合在一起以创建一个新的 Rectangle 对象。</p>\r\n\t * <p>注意：union() 方法忽略高度或宽度值为 0 的矩形，如：var rect2:Rectangle = new Rectangle(300,300,50,0);</p>\r\n\t * @param\t要添加到此 Rectangle 对象的 Rectangle 对象。\r\n\t * @param\tout\t用于存储输出结果的矩形对象。如果为空，则创建一个新的。建议：尽量复用对象，减少对象创建消耗。Rectangle.TEMP对象用于对象复用。\r\n\t * @return\t充当两个矩形的联合的新 Rectangle 对象。\r\n\t */\r\n    union(source: Rectangle, out: Rectangle|null = null): Rectangle {\r\n        out || (out = new Rectangle());\r\n        this.clone(out);\r\n        if (source.width <= 0 || source.height <= 0) return out;\r\n        out.addPoint(source.x, source.y);\r\n        out.addPoint(source.right, source.bottom);\r\n        return this;\r\n    }\r\n\r\n\t/**\r\n\t * 返回一个 Rectangle 对象，其 x、y、width 和 height 属性的值与当前 Rectangle 对象的对应值相同。\r\n\t * @param out\t（可选）用于存储结果的矩形对象。如果为空，则创建一个新的。建议：尽量复用对象，减少对象创建消耗。。Rectangle.TEMP对象用于对象复用。\r\n\t * @return Rectangle 对象，其 x、y、width 和 height 属性的值与当前 Rectangle 对象的对应值相同。\r\n\t */\r\n    clone(out: Rectangle|null = null): Rectangle {\r\n        out || (out = new Rectangle());\r\n        out.x = this.x;\r\n        out.y = this.y;\r\n        out.width = this.width;\r\n        out.height = this.height;\r\n        return out;\r\n    }\r\n\r\n\t/**\r\n\t * 当前 Rectangle 对象的水平位置 x 和垂直位置 y 以及高度 width 和宽度 height 以逗号连接成的字符串。\r\n\t */\r\n    toString(): string {\r\n        return this.x + \",\" + this.y + \",\" + this.width + \",\" + this.height;\r\n    }\r\n\r\n\t/**\r\n\t * 检测传入的 Rectangle 对象的属性是否与当前 Rectangle 对象的属性 x、y、width、height 属性值都相等。\r\n\t * @param\trect 待比较的 Rectangle 对象。\r\n\t * @return\t如果判断的属性都相等，则返回 true ,否则返回 false。\r\n\t */\r\n    equals(rect: Rectangle): boolean {\r\n        if (!rect || rect.x !== this.x || rect.y !== this.y || rect.width !== this.width || rect.height !== this.height) return false;\r\n        return true;\r\n    }\r\n\r\n\t/**\r\n\t * <p>为当前矩形对象加一个点，以使当前矩形扩展为包含当前矩形和此点的最小矩形。</p>\r\n\t * <p>此方法会修改本对象。</p>\r\n\t * @param x\t点的 X 坐标。\r\n\t * @param y\t点的 Y 坐标。\r\n\t * @return 返回此 Rectangle 对象。\r\n\t */\r\n    addPoint(x: number, y: number): Rectangle {\r\n        this.x > x && (this.width += this.x - x, this.x = x);//左边界比较\r\n        this.y > y && (this.height += this.y - y, this.y = y);//上边界比较\r\n        if (this.width < x - this.x) this.width = x - this.x;//右边界比较\r\n        if (this.height < y - this.y) this.height = y - this.y;//下边界比较\r\n        return this;\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t * 返回代表当前矩形的顶点数据。\r\n\t * @return 顶点数据。\r\n\t */\r\n    _getBoundPoints() {\r\n        var rst = Rectangle._temB;\r\n        rst.length = 0;\r\n        if (this.width == 0 || this.height == 0) return rst;\r\n        rst.push(this.x, this.y, this.x + this.width, this.y, this.x, this.y + this.height, this.x + this.width, this.y + this.height);\r\n        return rst;\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t * 返回矩形的顶点数据。\r\n\t */\r\n    static _getBoundPointS(x: number, y: number, width: number, height: number): any[] {\r\n        var rst: any[] = Rectangle._temA;\r\n        rst.length = 0;\r\n        if (width == 0 || height == 0) return rst;\r\n        rst.push(x, y, x + width, y, x, y + height, x + width, y + height);\r\n        return rst;\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t * 返回包含所有点的最小矩形。\r\n\t * @param pointList 点列表。\r\n\t * @return 包含所有点的最小矩形矩形对象。\r\n\t */\r\n    static _getWrapRec(pointList: ArrayLike<number>, rst: Rectangle|null = null): Rectangle {\r\n\r\n        if (!pointList || pointList.length < 1) return rst ? rst.setTo(0, 0, 0, 0) : Rectangle.TEMP.setTo(0, 0, 0, 0);\r\n        rst = rst ? rst : Rectangle.create();\r\n        var i: number, len: number = pointList.length, minX: number, maxX: number, minY: number, maxY: number, tPoint: Point = Point.TEMP;\r\n        minX = minY = 99999;\r\n        maxX = maxY = -minX;\r\n        for (i = 0; i < len; i += 2) {\r\n            tPoint.x = pointList[i];\r\n            tPoint.y = pointList[i + 1];\r\n            minX = minX < tPoint.x ? minX : tPoint.x;\r\n            minY = minY < tPoint.y ? minY : tPoint.y;\r\n            maxX = maxX > tPoint.x ? maxX : tPoint.x;\r\n            maxY = maxY > tPoint.y ? maxY : tPoint.y;\r\n        }\r\n        return rst.setTo(minX, minY, maxX - minX, maxY - minY);\r\n    }\r\n\r\n\t/**\r\n\t * 确定此 Rectangle 对象是否为空。\r\n\t * @return 如果 Rectangle 对象的宽度或高度小于等于 0，则返回 true 值，否则返回 false。\r\n\t */\r\n    isEmpty(): boolean {\r\n        if (this.width <= 0 || this.height <= 0) return true;\r\n        return false;\r\n    }\r\n}\r\n\r\n","import { LayaGPU } from \"../webgl/LayaGPU\";\r\n\r\n/**\r\n * @internal\r\n * 封装GL命令\r\n */\r\nexport class LayaGL {\r\n    static ARRAY_BUFFER_TYPE_DATA: number = 0;           \t//创建ArrayBuffer时的类型为Data\r\n    static ARRAY_BUFFER_TYPE_CMD: number = 1;            \t//创建ArrayBuffer时的类型为Command\r\n\r\n    static ARRAY_BUFFER_REF_REFERENCE: number = 0;\t\t\t//创建ArrayBuffer时的类型为引用\r\n    static ARRAY_BUFFER_REF_COPY: number = 1;\t\t\t\t//创建ArrayBuffer时的类型为拷贝\r\n\r\n    static UPLOAD_SHADER_UNIFORM_TYPE_ID: number = 0;      //data按照ID传入\r\n    static UPLOAD_SHADER_UNIFORM_TYPE_DATA: number = 1;    //data按照数据传入\r\n\r\n    static instance: WebGLRenderingContext;\r\n    static layaGPUInstance: LayaGPU;\r\n}\r\n\r\n\r\n\r\n","import { ILaya } from \"../../ILaya\";\r\nimport { LayaGL } from \"../layagl/LayaGL\";\r\n\r\n/**\r\n * @private\r\n */\r\nexport class WebGLContext {\r\n    /**@internal */\r\n    private static _activeTextures: any[] = new Array(8);\r\n    /**@internal */\r\n    private static _useProgram: any = null;\r\n    /**@internal */\r\n    private static _depthTest: boolean = true;\r\n    /**@internal */\r\n    private static _depthMask: boolean = true;\r\n    /**@internal */\r\n    private static _depthFunc: number;\r\n    /**@internal */\r\n    private static _blend: boolean = false;\r\n    /**@internal */\r\n    private static _blendEquation: number;\r\n    /**@internal */\r\n    private static _blendEquationRGB: number;\r\n    /**@internal */\r\n    private static _blendEquationAlpha: number;\r\n    /**@internal */\r\n    private static _sFactor: number;\r\n    /**@internal */\r\n    private static _dFactor: number;\r\n    /**@internal */\r\n    private static _sFactorRGB: number;\r\n    /**@internal */\r\n    private static _dFactorRGB: number;\r\n    /**@internal */\r\n    private static _sFactorAlpha: number;\r\n    /**@internal */\r\n    private static _dFactorAlpha: number;\r\n    /**@internal */\r\n    private static _cullFace: boolean = false;\r\n    /**@internal */\r\n    private static _frontFace: number;\r\n    /**@internal */\r\n    private static _activedTextureID: number;\r\n\r\n    /**@internal */\r\n    static _glTextureIDs: any[];\r\n\r\n    /**@internal */\r\n    static mainContext: WebGLRenderingContext = null;\r\n\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static __init__(): void {\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        WebGLContext._depthFunc = gl.LESS;\r\n        WebGLContext._blendEquation = gl.FUNC_ADD;\r\n        WebGLContext._blendEquationRGB = gl.FUNC_ADD;\r\n        WebGLContext._blendEquationAlpha = gl.FUNC_ADD;\r\n        WebGLContext._sFactor = gl.ONE;\r\n        WebGLContext._dFactor = gl.ZERO;\r\n        WebGLContext._sFactorAlpha = gl.ONE;\r\n        WebGLContext._dFactorAlpha = gl.ZERO;\r\n        WebGLContext._activedTextureID = gl.TEXTURE0;//默认激活纹理区为0\r\n        WebGLContext._glTextureIDs = [gl.TEXTURE0, gl.TEXTURE1, gl.TEXTURE2, gl.TEXTURE3, gl.TEXTURE4, gl.TEXTURE5, gl.TEXTURE6, gl.TEXTURE7];\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static useProgram(gl: WebGLRenderingContext, program: any): boolean {\r\n        if (WebGLContext._useProgram === program)\r\n            return false;\r\n        gl.useProgram(program);\r\n        WebGLContext._useProgram = program;\r\n        return true;\r\n    }\r\n\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setDepthTest(gl: WebGLRenderingContext, value: boolean): void {\r\n        value !== WebGLContext._depthTest && (WebGLContext._depthTest = value, value ? gl.enable(gl.DEPTH_TEST) : gl.disable(gl.DEPTH_TEST));\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setDepthMask(gl: WebGLRenderingContext, value: boolean): void {\r\n        value !== WebGLContext._depthMask && (WebGLContext._depthMask = value, gl.depthMask(value));\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setDepthFunc(gl: WebGLRenderingContext, value: number): void {\r\n        value !== WebGLContext._depthFunc && (WebGLContext._depthFunc = value, gl.depthFunc(value));\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setBlend(gl: WebGLRenderingContext, value: boolean): void {\r\n        value !== WebGLContext._blend && (WebGLContext._blend = value, value ? gl.enable(gl.BLEND) : gl.disable(gl.BLEND));\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    static setBlendEquation(gl: WebGLRenderingContext, blendEquation: number): void {\r\n        if (blendEquation !== WebGLContext._blendEquation) {\r\n            WebGLContext._blendEquation = blendEquation;\r\n            WebGLContext._blendEquationRGB = WebGLContext._blendEquationAlpha = null;\r\n            gl.blendEquation(blendEquation);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    static setBlendEquationSeparate(gl: WebGLRenderingContext, blendEquationRGB: number, blendEquationAlpha: number): void {\r\n        if (blendEquationRGB !== WebGLContext._blendEquationRGB || blendEquationAlpha !== WebGLContext._blendEquationAlpha) {\r\n            WebGLContext._blendEquationRGB = blendEquationRGB;\r\n            WebGLContext._blendEquationAlpha = blendEquationAlpha;\r\n            WebGLContext._blendEquation = null;\r\n            gl.blendEquationSeparate(blendEquationRGB, blendEquationAlpha);\r\n        }\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setBlendFunc(gl: WebGLRenderingContext, sFactor: number, dFactor: number,force:boolean=false): void {\r\n        if (force || sFactor !== WebGLContext._sFactor || dFactor !== WebGLContext._dFactor) {\r\n            WebGLContext._sFactor = sFactor;\r\n            WebGLContext._dFactor = dFactor;\r\n            WebGLContext._sFactorRGB = null;\r\n            WebGLContext._dFactorRGB = null;\r\n            WebGLContext._sFactorAlpha = null;\r\n            WebGLContext._dFactorAlpha = null;\r\n            gl.blendFunc(sFactor, dFactor);\r\n        }\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setBlendFuncSeperate(gl: WebGLRenderingContext, srcRGB: number, dstRGB: number, srcAlpha: number, dstAlpha: number): void {\r\n        if (srcRGB !== WebGLContext._sFactorRGB || dstRGB !== WebGLContext._dFactorRGB || srcAlpha !== WebGLContext._sFactorAlpha || dstAlpha !== WebGLContext._dFactorAlpha) {\r\n            WebGLContext._sFactorRGB = srcRGB;\r\n            WebGLContext._dFactorRGB = dstRGB;\r\n            WebGLContext._sFactorAlpha = srcAlpha;\r\n            WebGLContext._dFactorAlpha = dstAlpha;\r\n            WebGLContext._sFactor = null;\r\n            WebGLContext._dFactor = null;\r\n            gl.blendFuncSeparate(srcRGB, dstRGB, srcAlpha, dstAlpha);\r\n        }\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setCullFace(gl: WebGLRenderingContext, value: boolean): void {\r\n        value !== WebGLContext._cullFace && (WebGLContext._cullFace = value, value ? gl.enable(gl.CULL_FACE) : gl.disable(gl.CULL_FACE));\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setFrontFace(gl: WebGLRenderingContext, value: number): void {\r\n        value !== WebGLContext._frontFace && (WebGLContext._frontFace = value, gl.frontFace(value));\r\n    }\r\n\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static activeTexture(gl: WebGLRenderingContext, textureID: number): void {\r\n        if (WebGLContext._activedTextureID !== textureID) {\r\n            gl.activeTexture(textureID);\r\n            WebGLContext._activedTextureID = textureID;\r\n        }\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static bindTexture(gl: WebGLRenderingContext, target: any, texture: any): void {\r\n        if (WebGLContext._activeTextures[WebGLContext._activedTextureID - gl.TEXTURE0] !== texture) {\r\n            gl.bindTexture(target, texture);\r\n            WebGLContext._activeTextures[WebGLContext._activedTextureID - gl.TEXTURE0] = texture;\r\n        }\r\n    }\r\n\r\n    //--------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static __init_native(): void {\r\n        if (!ILaya.Render.supportWebGLPlusRendering) return;\r\n        var webGLContext: any = WebGLContext;\r\n        webGLContext.activeTexture = webGLContext.activeTextureForNative;\r\n        webGLContext.bindTexture = webGLContext.bindTextureForNative;\r\n        /*webGLContext.useProgram = webGLContext.useProgramForNative;\r\n        webGLContext.bindVertexArray = webGLContext.bindVertexArrayForNative;\r\n        webGLContext.setDepthTest = webGLContext.setDepthTestForNative;\r\n        webGLContext.setDepthMask = webGLContext.setDepthMaskForNative;\r\n        webGLContext.setDepthFunc = webGLContext.setDepthFuncForNative;\r\n        webGLContext.setBlend = webGLContext.setBlendForNative;\r\n        webGLContext.setBlendFunc = webGLContext.setBlendFuncForNative;\r\n        webGLContext.setCullFace = webGLContext.setCullFaceForNative;\r\n        webGLContext.setFrontFace = webGLContext.setFrontFaceForNative;*/\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static useProgramForNative(gl: WebGLRenderingContext, program: any): boolean {\r\n        gl.useProgram(program);\r\n        return true;\r\n    }\r\n\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setDepthTestForNative(gl: WebGLRenderingContext, value: boolean): void {\r\n        if (value) gl.enable(gl.DEPTH_TEST);\r\n        else gl.disable(gl.DEPTH_TEST);\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setDepthMaskForNative(gl: WebGLRenderingContext, value: boolean): void {\r\n        gl.depthMask(value);\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setDepthFuncForNative(gl: WebGLRenderingContext, value: number): void {\r\n        gl.depthFunc(value);\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setBlendForNative(gl: WebGLRenderingContext, value: boolean): void {\r\n        if (value) gl.enable(gl.BLEND);\r\n        else gl.disable(gl.BLEND);\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setBlendFuncForNative(gl: WebGLRenderingContext, sFactor: number, dFactor: number): void {\r\n        gl.blendFunc(sFactor, dFactor);\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setCullFaceForNative(gl: WebGLRenderingContext, value: boolean): void {\r\n        if (value) gl.enable(gl.CULL_FACE)\r\n        else gl.disable(gl.CULL_FACE);\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static setFrontFaceForNative(gl: WebGLRenderingContext, value: number): void {\r\n        gl.frontFace(value);\r\n    }\r\n\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static activeTextureForNative(gl: WebGLRenderingContext, textureID: number): void {\r\n        gl.activeTexture(textureID);\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static bindTextureForNative(gl: WebGLRenderingContext, target: any, texture: any): void {\r\n        gl.bindTexture(target, texture);\r\n    }\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n    static bindVertexArrayForNative(gl: WebGLContext, vertexArray: any): void {\r\n        (gl as any).bindVertexArray(vertexArray);\r\n    }\r\n\r\n}\r\n\r\n\r\n","/**\r\n\t * <p><code>Handler</code> 是事件处理器类。</p>\r\n\t * <p>推荐使用 Handler.create() 方法从对象池创建，减少对象创建消耗。创建的 Handler 对象不再使用后，可以使用 Handler.recover() 将其回收到对象池，回收后不要再使用此对象，否则会导致不可预料的错误。</p>\r\n\t * <p><b>注意：</b>由于鼠标事件也用本对象池，不正确的回收及调用，可能会影响鼠标事件的执行。</p>\r\n\t */\r\nexport class Handler {\r\n\r\n    /**@private handler对象池*/\r\n    protected static _pool: Handler[] = [];\r\n    /**@private */\r\n    private static _gid: number = 1;\r\n\r\n    /** 执行域(this)。*/\r\n    caller: Object|null;\r\n    /** 处理方法。*/\r\n    method: Function|null;\r\n    /** 参数。*/\r\n    args: any[]|null;\r\n    /** 表示是否只执行一次。如果为true，回调后执行recover()进行回收，回收后会被再利用，默认为false 。*/\r\n    once = false;\r\n\r\n    /**@private */\r\n    protected _id = 0;\r\n\r\n    /**\r\n     * 根据指定的属性值，创建一个 <code>Handler</code> 类的实例。\r\n     * @param\tcaller 执行域。\r\n     * @param\tmethod 处理函数。\r\n     * @param\targs 函数参数。\r\n     * @param\tonce 是否只执行一次。\r\n     */\r\n    constructor(caller: Object|null=null, method: Function|null=null, args: any[]|null = null, once: boolean = false) {\r\n        this.setTo(caller, method, args, once);\r\n    }\r\n\r\n    /**\r\n     * 设置此对象的指定属性值。\r\n     * @param\tcaller 执行域(this)。\r\n     * @param\tmethod 回调方法。\r\n     * @param\targs 携带的参数。\r\n     * @param\tonce 是否只执行一次，如果为true，执行后执行recover()进行回收。\r\n     * @return  返回 handler 本身。\r\n     */\r\n    setTo(caller: any, method: Function|null, args: any[]|null, once=false): Handler {\r\n        this._id = Handler._gid++;\r\n        this.caller = caller;\r\n        this.method = method;\r\n        this.args = args;\r\n        this.once = once;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 执行处理器。\r\n     */\r\n    run(): any {\r\n        if (this.method == null) return null;\r\n        var id: number = this._id;\r\n        var result: any = this.method.apply(this.caller, this.args);\r\n        this._id === id && this.once && this.recover();\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 执行处理器，并携带额外数据。\r\n     * @param\tdata 附加的回调数据，可以是单数据或者Array(作为多参)。\r\n     */\r\n    runWith(data: any): any {\r\n        if (this.method == null) return null;\r\n        var id: number = this._id;\r\n        if (data == null)\r\n            var result: any = this.method.apply(this.caller, this.args);\r\n        else if (!this.args && !data.unshift) result = this.method.call(this.caller, data);\r\n        else if (this.args) result = this.method.apply(this.caller, this.args.concat(data));\r\n        else result = this.method.apply(this.caller, data);\r\n        this._id === id && this.once && this.recover();\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 清理对象引用。\r\n     */\r\n    clear(): Handler {\r\n        this.caller = null;\r\n        this.method = null;\r\n        this.args = null;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 清理并回收到 Handler 对象池内。\r\n     */\r\n    recover(): void {\r\n        if (this._id > 0) {\r\n            this._id = 0;\r\n            Handler._pool.push(this.clear());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 从对象池内创建一个Handler，默认会执行一次并立即回收，如果不需要自动回收，设置once参数为false。\r\n     * @param\tcaller 执行域(this)。\r\n     * @param\tmethod 回调方法。\r\n     * @param\targs 携带的参数。\r\n     * @param\tonce 是否只执行一次，如果为true，回调后执行recover()进行回收，默认为true。\r\n     * @return  返回创建的handler实例。\r\n     */\r\n    static create(caller: any, method: Function|null, args: any[]|null = null, once: boolean = true): Handler {\r\n        if (Handler._pool.length) \r\n            return (Handler._pool.pop() as Handler).setTo(caller, method, args, once);\r\n        return new Handler(caller, method, args, once);\r\n    }\r\n}\r\n\r\n","import { Handler } from \"../utils/Handler\"\r\n\r\n/**\r\n * <code>EventDispatcher</code> 类是可调度事件的所有类的基类。\r\n */\r\nexport class EventDispatcher {\r\n    /**@private */\r\n    static MOUSE_EVENTS: any = { \"rightmousedown\": true, \"rightmouseup\": true, \"rightclick\": true, \"mousedown\": true, \"mouseup\": true, \"mousemove\": true, \"mouseover\": true, \"mouseout\": true, \"click\": true, \"doubleclick\": true };\r\n    /**@private */\r\n    private _events: any;\r\n\r\n    //[IF-JS]Object.defineProperty(EventDispatcher.prototype, \"_events\", {enumerable: false,writable:true});\r\n\r\n    /**\r\n     * 检查 EventDispatcher 对象是否为特定事件类型注册了任何侦听器。\r\n     * @param\ttype 事件的类型。\r\n     * @return 如果指定类型的侦听器已注册，则值为 true；否则，值为 false。\r\n     */\r\n    hasListener(type: string): boolean {\r\n        var listener: any = this._events && this._events[type];\r\n        return !!listener;\r\n    }\r\n\r\n    /**\r\n     * 派发事件。\r\n     * @param type\t事件类型。\r\n     * @param data\t（可选）回调数据。<b>注意：</b>如果是需要传递多个参数 p1,p2,p3,...可以使用数组结构如：[p1,p2,p3,...] ；如果需要回调单个参数 p ，且 p 是一个数组，则需要使用结构如：[p]，其他的单个参数 p ，可以直接传入参数 p。\r\n     * @return 此事件类型是否有侦听者，如果有侦听者则值为 true，否则值为 false。\r\n     */\r\n    event(type: string, data: any = null): boolean {\r\n        if (!this._events || !this._events[type]) return false;\r\n\r\n        var listeners: any = this._events[type];\r\n        if (listeners.run) {\r\n            if (listeners.once) delete this._events[type];\r\n            data != null ? listeners.runWith(data) : listeners.run();\r\n        } else {\r\n            for (var i: number = 0, n: number = listeners.length; i < n; i++) {\r\n                var listener: Handler = listeners[i];\r\n                if (listener) {\r\n                    (data != null) ? listener.runWith(data) : listener.run();\r\n                }\r\n                if (!listener || listener.once) {\r\n                    listeners.splice(i, 1);\r\n                    i--;\r\n                    n--;\r\n                }\r\n            }\r\n            if (listeners.length === 0 && this._events) delete this._events[type];\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * 使用 EventDispatcher 对象注册指定类型的事件侦听器对象，以使侦听器能够接收事件通知。\r\n     * @param type\t\t事件的类型。\r\n     * @param caller\t事件侦听函数的执行域。\r\n     * @param listener\t事件侦听函数。\r\n     * @param args\t\t（可选）事件侦听函数的回调参数。\r\n     * @return 此 EventDispatcher 对象。\r\n     */\r\n    on(type: string, caller: any, listener: Function, args: any[] = null): EventDispatcher {\r\n        return this._createListener(type, caller, listener, args, false);\r\n    }\r\n\r\n    /**\r\n     * 使用 EventDispatcher 对象注册指定类型的事件侦听器对象，以使侦听器能够接收事件通知，此侦听事件响应一次后自动移除。\r\n     * @param type\t\t事件的类型。\r\n     * @param caller\t事件侦听函数的执行域。\r\n     * @param listener\t事件侦听函数。\r\n     * @param args\t\t（可选）事件侦听函数的回调参数。\r\n     * @return 此 EventDispatcher 对象。\r\n     */\r\n    once(type: string, caller: any, listener: Function, args: any[] = null): EventDispatcher {\r\n        return this._createListener(type, caller, listener, args, true);\r\n    }\r\n\r\n    /**@internal */\r\n    _createListener(type: string, caller: any, listener: Function, args: any[], once: boolean, offBefore: boolean = true): EventDispatcher {\r\n        //移除之前相同的监听\r\n        offBefore && this.off(type, caller, listener, once);\r\n\r\n        //使用对象池进行创建回收\r\n        var handler: Handler = EventHandler.create(caller || this, listener, args, once);\r\n        this._events || (this._events = {});\r\n\r\n        var events: any = this._events;\r\n        //默认单个，每个对象只有多个监听才用数组，节省一个数组的消耗\r\n        if (!events[type]) events[type] = handler;\r\n        else {\r\n            if (!events[type].run) events[type].push(handler);\r\n            else events[type] = [events[type], handler];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 从 EventDispatcher 对象中删除侦听器。\r\n     * @param type\t\t事件的类型。\r\n     * @param caller\t事件侦听函数的执行域。\r\n     * @param listener\t事件侦听函数。\r\n     * @param onceOnly\t（可选）如果值为 true ,则只移除通过 once 方法添加的侦听器。\r\n     * @return 此 EventDispatcher 对象。\r\n     */\r\n    off(type: string, caller: any, listener: Function, onceOnly: boolean = false): EventDispatcher {\r\n        if (!this._events || !this._events[type]) return this;\r\n        var listeners: any = this._events[type];\r\n        if (listeners != null) {\r\n            if (listeners.run) {\r\n                if ((!caller || listeners.caller === caller) && (listener == null || listeners.method === listener) && (!onceOnly || listeners.once)) {\r\n                    delete this._events[type];\r\n                    listeners.recover();\r\n                }\r\n            } else {\r\n                var count: number = 0;\r\n                for (var i: number = 0, n: number = listeners.length; i < n; i++) {\r\n                    var item: Handler = listeners[i];\r\n                    if (!item) {\r\n                        count++;\r\n                        continue;\r\n                    }\r\n                    if (item && (!caller || item.caller === caller) && (listener == null || item.method === listener) && (!onceOnly || item.once)) {\r\n                        count++;\r\n                        listeners[i] = null;\r\n                        item.recover();\r\n                    }\r\n                }\r\n                //如果全部移除，则删除索引\r\n                if (count === n) delete this._events[type];\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 从 EventDispatcher 对象中删除指定事件类型的所有侦听器。\r\n     * @param type\t（可选）事件类型，如果值为 null，则移除本对象所有类型的侦听器。\r\n     * @return 此 EventDispatcher 对象。\r\n     */\r\n    offAll(type: string = null): EventDispatcher {\r\n        var events: any = this._events;\r\n        if (!events) return this;\r\n        if (type) {\r\n            this._recoverHandlers(events[type]);\r\n            delete events[type];\r\n        } else {\r\n            for (var name in events) {\r\n                this._recoverHandlers(events[name]);\r\n            }\r\n            this._events = null;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 移除caller为target的所有事件监听\r\n     * @param\tcaller caller对象\r\n     */\r\n    offAllCaller(caller: any): EventDispatcher {\r\n        if (caller && this._events) {\r\n            for (var name in this._events) {\r\n                this.off(name, caller, null);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    private _recoverHandlers(arr: any): void {\r\n        if (!arr) return;\r\n        if (arr.run) {\r\n            arr.recover();\r\n        } else {\r\n            for (var i: number = arr.length - 1; i > -1; i--) {\r\n                if (arr[i]) {\r\n                    arr[i].recover();\r\n                    arr[i] = null;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 检测指定事件类型是否是鼠标事件。\r\n     * @param\ttype 事件的类型。\r\n     * @return\t如果是鼠标事件，则值为 true;否则，值为 false。\r\n     */\r\n    isMouseEvent(type: string): boolean {\r\n        return EventDispatcher.MOUSE_EVENTS[type] || false;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n/**@private */\r\nclass EventHandler extends Handler {\r\n\r\n    /**@private handler对象池*/\r\n    protected static _pool: any[] = [];\r\n\r\n    constructor(caller: any, method: Function, args: any[], once: boolean) {\r\n        super(caller, method, args, once);\r\n    }\r\n\t/**\r\n\t * @override\r\n\t */\r\n    recover(): void {\r\n        if (this._id > 0) {\r\n            this._id = 0;\r\n            EventHandler._pool.push(this.clear());\r\n        }\r\n    }\r\n\r\n\t/**\r\n\t * 从对象池内创建一个Handler，默认会执行一次回收，如果不需要自动回收，设置once参数为false。\r\n\t * @param caller\t执行域(this)。\r\n\t * @param method\t回调方法。\r\n\t * @param args\t\t（可选）携带的参数。\r\n\t * @param once\t\t（可选）是否只执行一次，如果为true，回调后执行recover()进行回收，默认为true。\r\n\t * @return 返回创建的handler实例。\r\n\t */\r\n    static create(caller: any, method: Function, args: any[] = null, once: boolean = true): Handler {\r\n        if (EventHandler._pool.length) return EventHandler._pool.pop().setTo(caller, method, args, once);\r\n        return new EventHandler(caller, method, args, once);\r\n    }\r\n}\r\n\r\n","import { ILaya } from \"../../ILaya\";\r\n\r\n/**\r\n\t * <p><code>URL</code> 提供URL格式化，URL版本管理的类。</p>\r\n\t * <p>引擎加载资源的时候，会自动调用formatURL函数格式化URL路径</p>\r\n\t * <p>通过basePath属性可以设置网络基础路径</p>\r\n\t * <p>通过设置customFormat函数，可以自定义URL格式化的方式</p>\r\n\t * <p>除了默认的通过增加后缀的格式化外，通过VersionManager类，可以开启IDE提供的，基于目录的管理方式来替代 \"?v=\" 的管理方式</p>\r\n\t * @see laya.net.VersionManager\r\n\t */\r\nexport class URL {\r\n    /**URL地址版本映射表，比如{\"aaa/bb.png\":99,\"aaa/bb.png\":12}，默认情况下，通过formatURL格式化后，会自动生成为\"aaa/bb.png?v=99\"的一个地址*/\r\n    static version: any = {};\r\n    /**@private */\r\n    private _url: string;\r\n    /**@private */\r\n    private _path: string;\r\n    /**兼容微信不支持加载scene后缀场景，设置为true，则会把scene加载替换为json*/\r\n    static exportSceneToJson: boolean = false;\r\n\r\n    /**创建一个新的 <code>URL</code> 实例。*/\r\n    constructor(url: string) {\r\n        this._url = URL.formatURL(url);\r\n        this._path = URL.getPath(url);\r\n    }\r\n\r\n    /**格式化后的地址。*/\r\n    get url(): string {\r\n        return this._url;\r\n    }\r\n\r\n    /**地址的文件夹路径（不包括文件名）。*/\r\n    get path(): string {\r\n        return this._path;\r\n    }\r\n\r\n    /**@internal 基础路径。如果不设置，默认为当前网页的路径。最终地址将被格式化为 basePath+相对URL地址，*/\r\n    static _basePath: string = \"\";\r\n    /**root路径。只针对'~'类型的url路径有效*/\r\n    static rootPath: string = \"\";\r\n\r\n    static set basePath(value: string) {\r\n        URL._basePath = ILaya.Laya._getUrlPath();//还原BaseURL为Index目录\r\n        URL._basePath = URL.formatURL(value);\r\n    }\r\n\r\n    /**基础路径。如果不设置，默认为当前网页的路径。最终地址将被格式化为 basePath+相对URL地址，*/\r\n    static get basePath(): string {\r\n        return URL._basePath;\r\n    }\r\n\r\n    /** 自定义URL格式化的方式。例如： customFormat = function(url:String):String{} */\r\n    static customFormat: Function = function (url: string): string {\r\n        var newUrl: string = URL.version[url];\r\n        if (!((<any>window)).conch && newUrl) url += \"?v=\" + newUrl;\r\n        return url;\r\n    }\r\n\r\n    /**\r\n     * 格式化指定的地址并返回。\r\n     * @param\turl 地址。\r\n     * @param\tbase 基础路径，如果没有，则使用basePath。\r\n     * @return\t格式化处理后的地址。\r\n     */\r\n    static formatURL(url: string): string {\r\n        if (!url) return \"null path\";\r\n        //如果是全路径，直接返回，提高性能\r\n        if (url.indexOf(\":\") > 0) return url;\r\n        //自定义路径格式化\r\n        if (URL.customFormat != null) url = URL.customFormat(url);\r\n        //如果是全路径，直接返回，提高性能\r\n        if (url.indexOf(\":\") > 0) return url;\r\n\r\n        var char1: string = url.charAt(0);\r\n        if (char1 === \".\") {\r\n            return URL._formatRelativePath(URL._basePath + url);\r\n        } else if (char1 === '~') {\r\n            return URL.rootPath + url.substring(1);\r\n        } else if (char1 === \"d\") {\r\n            if (url.indexOf(\"data:image\") === 0) return url;\r\n        } else if (char1 === \"/\") {\r\n            return url;\r\n        }\r\n        return URL._basePath + url;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 格式化相对路径。\r\n     */\r\n    static _formatRelativePath(value: string): string {\r\n        var parts: any[] = value.split(\"/\");\r\n        for (var i: number = 0, len: number = parts.length; i < len; i++) {\r\n            if (parts[i] == '..') {\r\n                parts.splice(i - 1, 2);\r\n                i -= 2;\r\n            }\r\n        }\r\n        return parts.join('/');\r\n    }\r\n\r\n    /**\r\n     * 获取指定 URL 的文件夹路径（不包括文件名）。\r\n     * <p><b>注意：</b>末尾有斜杠（/）。</p>\r\n     * @param\turl url地址。\r\n     * @return  返回文件夹路径。\r\n     */\r\n    static getPath(url: string): string {\r\n        var ofs: number = url.lastIndexOf('/');\r\n        return ofs > 0 ? url.substr(0, ofs + 1) : \"\";\r\n    }\r\n\r\n    /**\r\n     * 获取指定 URL 的文件名。\r\n     * @param\turl 地址。\r\n     * @return \t返回文件名。\r\n     */\r\n    static getFileName(url: string): string {\r\n        var ofs: number = url.lastIndexOf('/');\r\n        return ofs > 0 ? url.substr(ofs + 1) : url;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private static _adpteTypeList: any[] = [[\".scene3d\", \".json\"], [\".scene\", \".json\"], [\".taa\", \".json\"], [\".prefab\", \".json\"]];\r\n\r\n    /**\r\n     * @private 兼容微信\r\n     */\r\n    static getAdptedFilePath(url: string): string {\r\n        if (!URL.exportSceneToJson || !url) return url;\r\n        var i: number, len: number;\r\n        len = URL._adpteTypeList.length;\r\n        var tArr: any[];\r\n        for (i = 0; i < len; i++) {\r\n            tArr = URL._adpteTypeList[i];\r\n            url = url.replace(tArr[0], tArr[1]);\r\n        }\r\n        return url;\r\n    }\r\n}\r\n\r\n","import { ILaya } from \"../../ILaya\";\r\nimport { EventDispatcher } from \"../events/EventDispatcher\";\r\nimport { URL } from \"../net/URL\";\r\nimport { ICreateResource } from \"./ICreateResource\";\r\nimport { IDestroy } from \"./IDestroy\";\r\n\r\n/**\r\n * <code>Resource</code> 资源存取类。\r\n */\r\nexport class Resource extends EventDispatcher implements ICreateResource, IDestroy {\r\n\t/** @private */\r\n\tprivate static _uniqueIDCounter: number = 0;\r\n\t/** @private */\r\n\tprivate static _idResourcesMap: any = {};\r\n\t/** @private */\r\n\tprivate static _urlResourcesMap: any = {};\r\n\t/** @private 以字节为单位。*/\r\n\tprivate static _cpuMemory: number = 0;\r\n\t/** @private 以字节为单位。*/\r\n\tprivate static _gpuMemory: number = 0;\r\n\r\n\t/**\r\n\t * 当前内存，以字节为单位。\r\n\t */\r\n\tstatic get cpuMemory(): number {\r\n\t\treturn Resource._cpuMemory;\r\n\t}\r\n\r\n\t/**\r\n\t * 当前显存，以字节为单位。\r\n\t */\r\n\tstatic get gpuMemory(): number {\r\n\t\treturn Resource._gpuMemory;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tstatic _addCPUMemory(size: number): void {\r\n\t\tResource._cpuMemory += size;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tstatic _addGPUMemory(size: number): void {\r\n\t\tResource._gpuMemory += size;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tstatic _addMemory(cpuSize: number, gpuSize: number): void {\r\n\t\tResource._cpuMemory += cpuSize;\r\n\t\tResource._gpuMemory += gpuSize;\r\n\t}\r\n\r\n\t/**\r\n\t * 通过资源ID返回已载入资源。\r\n\t * @param id 资源ID\r\n\t * @return 资源 <code>Resource</code> 对象。\r\n\t */\r\n\tstatic getResourceByID(id: number): Resource {\r\n\t\treturn Resource._idResourcesMap[id];\r\n\t}\r\n\r\n\t/**\r\n\t * 通过url返回已载入资源。\r\n\t * @param url 资源URL\r\n\t * @param index 索引\r\n\t * @return 资源 <code>Resource</code> 对象。\r\n\t */\r\n\tstatic getResourceByURL(url: string, index: number = 0): Resource {\r\n\t\treturn Resource._urlResourcesMap[url][index];\r\n\t}\r\n\r\n\t/**\r\n\t * 销毁当前没有被使用的资源,该函数会忽略lock=true的资源。\r\n\t * @param group 指定分组。\r\n\t */\r\n\tstatic destroyUnusedResources(): void {\r\n\t\tfor (var k in Resource._idResourcesMap) {\r\n\t\t\tvar res: Resource = Resource._idResourcesMap[k];\r\n\t\t\tif (!res.lock && res._referenceCount === 0)\r\n\t\t\t\tres.destroy();\r\n\t\t}\r\n\t}\r\n\r\n\t/**@private */\r\n\tprotected _id: number = 0;\r\n\t/**@private */\r\n\tprivate _url: string = null;\r\n\t/**@private */\r\n\tprivate _cpuMemory: number = 0;\r\n\t/**@private */\r\n\tprivate _gpuMemory: number = 0;\r\n\t/**@private */\r\n\tprivate _destroyed: boolean = false;\r\n\r\n\t/**@private */\r\n\tprotected _referenceCount: number = 0;\r\n\r\n\t/**是否加锁，如果true为不能使用自动释放机制。*/\r\n\tlock: boolean = false;\r\n\t/**名称。 */\r\n\tname: string = null;\r\n\r\n\t/**\r\n\t * 获取唯一标识ID,通常用于识别。\r\n\t */\r\n\tget id(): number {\r\n\t\treturn this._id;\r\n\t}\r\n\r\n\t/**\r\n\t * 获取资源的URL地址。\r\n\t * @return URL地址。\r\n\t */\r\n\tget url(): string {\r\n\t\treturn this._url;\r\n\t}\r\n\r\n\t/**\r\n\t * 内存大小。\r\n\t */\r\n\tget cpuMemory(): number {\r\n\t\treturn this._cpuMemory;\r\n\t}\r\n\r\n\t/**\r\n\t * 显存大小。\r\n\t */\r\n\tget gpuMemory(): number {\r\n\t\treturn this._gpuMemory;\r\n\t}\r\n\r\n\t/**\r\n\t * 是否已处理。\r\n\t */\r\n\tget destroyed(): boolean {\r\n\t\treturn this._destroyed;\r\n\t}\r\n\r\n\t/**\r\n\t * 获取资源的引用计数。\r\n\t */\r\n\tget referenceCount(): number {\r\n\t\treturn this._referenceCount;\r\n\t}\r\n\r\n\t/**\r\n\t * 创建一个 <code>Resource</code> 实例。\r\n\t */\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis._id = ++Resource._uniqueIDCounter;\r\n\t\tthis._destroyed = false;\r\n\t\tthis._referenceCount = 0;\r\n\t\tResource._idResourcesMap[this.id] = this;\r\n\t\tthis.lock = false;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_setCPUMemory(value: number): void {\r\n\t\tvar offsetValue: number = value - this._cpuMemory;\r\n\t\tthis._cpuMemory = value;\r\n\t\tResource._addCPUMemory(offsetValue);\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_setGPUMemory(value: number): void {\r\n\t\tvar offsetValue: number = value - this._gpuMemory;\r\n\t\tthis._gpuMemory = value;\r\n\t\tResource._addGPUMemory(offsetValue);\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\t_setCreateURL(url: string): void {\r\n\t\turl = URL.formatURL(url);//需要序列化为绝对路径\r\n\t\tif (this._url !== url) {\r\n\t\t\tvar resList: Resource[];\r\n\t\t\tif (this._url) {\r\n\t\t\t\tresList = Resource._urlResourcesMap[this._url];\r\n\t\t\t\tresList.splice(resList.indexOf(this), 1);\r\n\t\t\t\t(resList.length === 0) && (delete Resource._urlResourcesMap[this._url]);\r\n\t\t\t}\r\n\t\t\tif (url) {\r\n\t\t\t\tresList = Resource._urlResourcesMap[url];\r\n\t\t\t\t(resList) || (Resource._urlResourcesMap[url] = resList = []);\r\n\t\t\t\tresList.push(this);\r\n\t\t\t}\r\n\t\t\tthis._url = url;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t * @implements IReferenceCounter\r\n\t */\r\n\t_addReference(count: number = 1): void {\r\n\t\tthis._referenceCount += count;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t * @implements IReferenceCounter\r\n\t */\r\n\t_removeReference(count: number = 1): void {\r\n\t\tthis._referenceCount -= count;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t * @implements IReferenceCounter\r\n\t */\r\n\t_clearReference(): void {\r\n\t\tthis._referenceCount = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tprotected _recoverResource(): void {\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tprotected _disposeResource(): void {\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tprotected _activeResource(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 销毁资源,销毁后资源不能恢复。\r\n\t */\r\n\tdestroy(): void {\r\n\t\tif (this._destroyed)\r\n\t\t\treturn;\r\n\r\n\t\tthis._destroyed = true;\r\n\t\tthis.lock = false; //解锁资源，强制清理\r\n\t\tthis._disposeResource();\r\n\t\tdelete Resource._idResourcesMap[this.id];\r\n\t\tvar resList: Resource[];\r\n\t\tif (this._url) {\r\n\t\t\tresList = Resource._urlResourcesMap[this._url];\r\n\t\t\tif (resList) {\r\n\t\t\t\tresList.splice(resList.indexOf(this), 1);\r\n\t\t\t\t(resList.length === 0) && (delete Resource._urlResourcesMap[this._url]);\r\n\t\t\t}\r\n\r\n\t\t\tvar resou: Resource = ILaya.Loader.loadedMap[this._url];\r\n\t\t\t(resou == this) && (delete ILaya.Loader.loadedMap[this._url]);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n","import { Resource } from \"./Resource\";\r\n/**\r\n\t * @private\r\n\t * <code>Bitmap</code> 图片资源类。\r\n\t */\r\nexport class Bitmap extends Resource {\r\n    /**@private */\r\n    protected _width: number;\r\n    /**@private */\r\n    protected _height: number;\r\n\r\n    /**\r\n     * 获取宽度。\r\n     */\r\n    get width(): number {\r\n        return this._width;\r\n    }\r\n\r\n    set width(width: number) {\r\n        this._width = width;\r\n    }\r\n\r\n    /***\r\n     * 获取高度。\r\n     */\r\n    get height(): number {\r\n        return this._height;\r\n    }\r\n\r\n    set height(height: number) {\r\n        this._height = height;\r\n    }\r\n    /**\r\n     * 创建一个 <code>Bitmap</code> 实例。\r\n     */\r\n    constructor() {\r\n\r\n        super();\r\n        this._width = -1;\r\n        this._height = -1;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 获取纹理资源。\r\n     */\r\n    //TODO:coverage\r\n    _getSource(): any {\r\n        throw \"Bitmap: must override it.\";\r\n    }\r\n}\r\n\r\n","/**\r\n * 纹理的过滤模式。\r\n */\r\nexport enum FilterMode {\r\n    /**点过滤。*/\r\n    Point = 0,\r\n    /**双线性过滤。*/\r\n    Bilinear = 1,\r\n    /**三线性过滤。*/\r\n    Trilinear = 2,\r\n}","export enum TextureFormat {\r\n    /**纹理格式_R8G8B8。*/\r\n    R8G8B8 = 0,\r\n    /**纹理格式_R8G8B8A8。*/\r\n    R8G8B8A8 = 1,\r\n    /**RGB格式纹理,R通道5位，G通道6位，B通道5位。*/\r\n    R5G6B5 = 16,\r\n    /**纹理格式_ALPHA8。*/\r\n    Alpha8 = 2,\r\n    /**纹理格式_DXT1。*/\r\n    DXT1 = 3,\r\n    /**纹理格式_DXT5。*/\r\n    DXT5 = 4,\r\n    /**纹理格式_ETC2RGB。*/\r\n    ETC1RGB = 5,\r\n    ///**纹理格式_ETC2RGB。*/\r\n    //ETC2RGB:int = 6;\r\n    ///**纹理格式_ETC2RGBA。*/\r\n    //ETC2RGBA:int = 7;\r\n    /**纹理格式_ETC2RGB_PUNCHTHROUGHALPHA。*/\r\n    //ETC2RGB_PUNCHTHROUGHALPHA:int = 8;\r\n    /**纹理格式_PVRTCRGB_2BPPV。*/\r\n    PVRTCRGB_2BPPV = 9,\r\n    /**纹理格式_PVRTCRGBA_2BPPV。*/\r\n    PVRTCRGBA_2BPPV = 10,\r\n    /**纹理格式_PVRTCRGB_4BPPV。*/\r\n    PVRTCRGB_4BPPV = 11,\r\n    /**纹理格式_PVRTCRGBA_4BPPV。*/\r\n    PVRTCRGBA_4BPPV = 12,\r\n    /**RGBA格式纹理,每个通道32位浮点数。*/\r\n    R32G32B32A32 = 15,\r\n    /**RGBA格式纹理，每个通道16位浮点数。 */\r\n    R16G16B16A16 = 16\r\n}","/**\r\n * 纹理寻址模式。\r\n */\r\nexport enum WarpMode {\r\n    /** 循环平铺。*/\r\n    Repeat = 0,\r\n    /** 超过UV边界后采用最后一个像素。*/\r\n    Clamp = 1\r\n}","import { LayaGL } from \"../layagl/LayaGL\";\r\nimport { WebGLContext } from \"../webgl/WebGLContext\";\r\nimport { Bitmap } from \"./Bitmap\";\r\nimport { FilterMode } from \"./FilterMode\";\r\nimport { TextureFormat } from \"./TextureFormat\";\r\nimport { WarpMode } from \"./WrapMode\";\r\n\r\n\r\n/**\r\n * <code>BaseTexture</code> 纹理的父类，抽象类，不允许实例。\r\n */\r\nexport class BaseTexture extends Bitmap {\r\n\t/** @internal */\r\n\tstatic _rgbmRange: number = 5.0;\r\n\r\n\t/** @internal */\r\n\tprotected _readyed: boolean;\r\n\t/** @internal */\r\n\tprotected _glTextureType: number;\r\n\t/** @internal */\r\n\tprotected _glTexture: any;\r\n\t/** @internal */\r\n\tprotected _format: number;\r\n\t/** @internal */\r\n\tprotected _mipmap: boolean;\r\n\t/** @internal */\r\n\tprotected _wrapModeU: WarpMode;\r\n\t/** @internal */\r\n\tprotected _wrapModeV: WarpMode;\r\n\t/** @internal */\r\n\tprotected _filterMode: FilterMode;\r\n\t/** @internal */\r\n\tprotected _anisoLevel: number;\r\n\t/** @internal */\r\n\tprotected _mipmapCount: number;\r\n\r\n\t/**\r\n\t * 是否使用mipLevel\r\n\t */\r\n\tget mipmap(): boolean {\r\n\t\treturn this._mipmap;\r\n\t}\r\n\r\n\t/**\r\n\t * 纹理格式\r\n\t */\r\n\tget format(): number {\r\n\t\treturn this._format;\r\n\t}\r\n\r\n\t/**\r\n\t * 纹理横向循环模式。\r\n\t */\r\n\tget wrapModeU(): number {\r\n\t\treturn this._wrapModeU;\r\n\t}\r\n\r\n\tset wrapModeU(value: number) {\r\n\t\tif (this._wrapModeU !== value) {\r\n\t\t\tthis._wrapModeU = value;\r\n\t\t\t(this._width !== -1) && (this._setWarpMode(LayaGL.instance.TEXTURE_WRAP_S, value));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 纹理纵向循环模式。\r\n\t */\r\n\tget wrapModeV(): number {\r\n\t\treturn this._wrapModeV;\r\n\t}\r\n\r\n\tset wrapModeV(value: number) {\r\n\t\tif (this._wrapModeV !== value) {\r\n\t\t\tthis._wrapModeV = value;\r\n\t\t\t(this._height !== -1) && (this._setWarpMode(LayaGL.instance.TEXTURE_WRAP_T, value));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 缩小过滤器\r\n\t */\r\n\tget filterMode(): FilterMode {\r\n\t\treturn this._filterMode;\r\n\t}\r\n\r\n\tset filterMode(value: FilterMode) {\r\n\t\tif (value !== this._filterMode) {\r\n\t\t\tthis._filterMode = value;\r\n\t\t\t((this._width !== -1) && (this._height !== -1)) && (this._setFilterMode(value));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 各向异性等级\r\n\t */\r\n\tget anisoLevel(): number {\r\n\t\treturn this._anisoLevel;\r\n\t}\r\n\r\n\tset anisoLevel(value: number) {\r\n\t\tif (value !== this._anisoLevel) {\r\n\t\t\tthis._anisoLevel = Math.max(1, Math.min(16, value));\r\n\t\t\t((this._width !== -1) && (this._height !== -1)) && (this._setAnisotropy(value));\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * 获取mipmap数量。\r\n\t */\r\n\tget mipmapCount(): number {\r\n\t\treturn this._mipmapCount;\r\n\t}\r\n\r\n\tget defaulteTexture(): BaseTexture {\r\n\t\tthrow \"BaseTexture:must override it.\"\r\n\t}\r\n\r\n\t/**\r\n\t * 创建一个 <code>BaseTexture</code> 实例。\r\n\t */\r\n\tconstructor(format: number, mipMap: boolean) {\r\n\t\tsuper();\r\n\t\tthis._wrapModeU = WarpMode.Repeat;\r\n\t\tthis._wrapModeV = WarpMode.Repeat;\r\n\t\tthis._filterMode = FilterMode.Bilinear;\r\n\r\n\t\tthis._readyed = false;\r\n\t\tthis._width = -1;\r\n\t\tthis._height = -1;\r\n\t\tthis._format = format;\r\n\t\tthis._mipmap = mipMap;\r\n\t\tthis._anisoLevel = 1;\r\n\t\tthis._glTexture = LayaGL.instance.createTexture();\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_getFormatByteCount(): number {\r\n\t\tswitch (this._format) {\r\n\t\t\tcase TextureFormat.R8G8B8:\r\n\t\t\t\treturn 3;\r\n\t\t\tcase TextureFormat.R8G8B8A8:\r\n\t\t\t\treturn 4;\r\n\t\t\tcase TextureFormat.R5G6B5:\r\n\t\t\t\treturn 1;\r\n\t\t\tcase TextureFormat.Alpha8:\r\n\t\t\t\treturn 1;\r\n\t\t\tcase TextureFormat.R32G32B32A32:\r\n\t\t\t\treturn 4;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow \"Texture2D: unknown format.\";\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprotected _isPot(size: number): boolean {\r\n\t\treturn (size & (size - 1)) === 0;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprotected _getGLFormat(): number {\r\n\t\tvar glFormat: number;\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tvar gpu = LayaGL.layaGPUInstance;\r\n\t\tswitch (this._format) {\r\n\t\t\tcase TextureFormat.R8G8B8:\r\n\t\t\tcase TextureFormat.R5G6B5:\r\n\t\t\t\tglFormat = gl.RGB;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.R8G8B8A8:\r\n\t\t\t\tglFormat = gl.RGBA;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.Alpha8:\r\n\t\t\t\tglFormat = gl.ALPHA;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.R32G32B32A32:\r\n\t\t\tcase TextureFormat.R16G16B16A16://todo miner\r\n\t\t\t\tglFormat = gl.RGBA;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.DXT1:\r\n\t\t\t\tif (gpu._compressedTextureS3tc)\r\n\t\t\t\t\tglFormat = gpu._compressedTextureS3tc.COMPRESSED_RGB_S3TC_DXT1_EXT;\r\n\t\t\t\telse\r\n\t\t\t\t\tthrow \"BaseTexture: not support DXT1 format.\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.DXT5:\r\n\t\t\t\tif (gpu._compressedTextureS3tc)\r\n\t\t\t\t\tglFormat = gpu._compressedTextureS3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;\r\n\t\t\t\telse\r\n\t\t\t\t\tthrow \"BaseTexture: not support DXT5 format.\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.ETC1RGB:\r\n\t\t\t\tif (gpu._compressedTextureEtc1)\r\n\t\t\t\t\tglFormat = gpu._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL;\r\n\t\t\t\telse\r\n\t\t\t\t\tthrow \"BaseTexture: not support ETC1RGB format.\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.PVRTCRGB_2BPPV:\r\n\t\t\t\tif (gpu._compressedTexturePvrtc)\r\n\t\t\t\t\tglFormat = gpu._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\r\n\t\t\t\telse\r\n\t\t\t\t\tthrow \"BaseTexture: not support PVRTCRGB_2BPPV format.\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.PVRTCRGBA_2BPPV:\r\n\t\t\t\tif (gpu._compressedTexturePvrtc)\r\n\t\t\t\t\tglFormat = gpu._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\r\n\t\t\t\telse\r\n\t\t\t\t\tthrow \"BaseTexture: not support PVRTCRGBA_2BPPV format.\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.PVRTCRGB_4BPPV:\r\n\t\t\t\tif (gpu._compressedTexturePvrtc)\r\n\t\t\t\t\tglFormat = gpu._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\r\n\t\t\t\telse\r\n\t\t\t\t\tthrow \"BaseTexture: not support PVRTCRGB_4BPPV format.\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.PVRTCRGBA_4BPPV:\r\n\t\t\t\tif (gpu._compressedTexturePvrtc)\r\n\t\t\t\t\tglFormat = gpu._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\r\n\t\t\t\telse\r\n\t\t\t\t\tthrow \"BaseTexture: not support PVRTCRGBA_4BPPV format.\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow \"BaseTexture: unknown texture format.\";\r\n\t\t}\r\n\t\treturn glFormat;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprotected _setFilterMode(value: FilterMode): void {\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tWebGLContext.bindTexture(gl, this._glTextureType, this._glTexture);\r\n\t\tswitch (value) {\r\n\t\t\tcase FilterMode.Point:\r\n\t\t\t\tif (this._mipmap)\r\n\t\t\t\t\tgl.texParameteri(this._glTextureType, gl.TEXTURE_MIN_FILTER, gl.NEAREST_MIPMAP_NEAREST);\r\n\t\t\t\telse\r\n\t\t\t\t\tgl.texParameteri(this._glTextureType, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n\t\t\t\tgl.texParameteri(this._glTextureType, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n\t\t\t\tbreak;\r\n\t\t\tcase FilterMode.Bilinear:\r\n\t\t\t\tif (this._mipmap)\r\n\t\t\t\t\tgl.texParameteri(this._glTextureType, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);\r\n\t\t\t\telse\r\n\t\t\t\t\tgl.texParameteri(this._glTextureType, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n\t\t\t\tgl.texParameteri(this._glTextureType, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n\t\t\t\tbreak;\r\n\t\t\tcase FilterMode.Trilinear:\r\n\t\t\t\tif (this._mipmap)\r\n\t\t\t\t\tgl.texParameteri(this._glTextureType, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\r\n\t\t\t\telse\r\n\t\t\t\t\tgl.texParameteri(this._glTextureType, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n\t\t\t\tgl.texParameteri(this._glTextureType, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error(\"BaseTexture:unknown filterMode value.\");\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprotected _setWarpMode(orientation: number, mode: number): void {\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tWebGLContext.bindTexture(gl, this._glTextureType, this._glTexture);\r\n\t\tif (this._isPot(this._width) && this._isPot(this._height)) {\r\n\t\t\tswitch (mode) {\r\n\t\t\t\tcase WarpMode.Repeat:\r\n\t\t\t\t\tgl.texParameteri(this._glTextureType, orientation, gl.REPEAT);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase WarpMode.Clamp:\r\n\t\t\t\t\tgl.texParameteri(this._glTextureType, orientation, gl.CLAMP_TO_EDGE);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tgl.texParameteri(this._glTextureType, orientation, gl.CLAMP_TO_EDGE);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprotected _setAnisotropy(value: number): void {\r\n\t\tvar anisotropic: any = LayaGL.layaGPUInstance._extTextureFilterAnisotropic;\r\n\t\tif (anisotropic) {\r\n\t\t\tvalue = Math.max(value, 1);\r\n\t\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\t\tWebGLContext.bindTexture(gl, this._glTextureType, this._glTexture);\r\n\t\t\tvalue = Math.min(gl.getParameter(anisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT), value);\r\n\t\t\tgl.texParameterf(this._glTextureType, anisotropic.TEXTURE_MAX_ANISOTROPY_EXT, value);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @inheritDoc\r\n\t * @override\r\n\t */\r\n\tprotected _disposeResource(): void {\r\n\t\tif (this._glTexture) {\r\n\t\t\tLayaGL.instance.deleteTexture(this._glTexture);\r\n\t\t\tthis._glTexture = null;\r\n\t\t\tthis._setGPUMemory(0);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t * 获取纹理资源。\r\n\t * @override\r\n\t */\r\n\t_getSource(): any {\r\n\t\tif (this._readyed)\r\n\t\t\treturn this._glTexture;\r\n\t\telse\r\n\t\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * 通过基础数据生成mipMap。\r\n\t */\r\n\tgenerateMipmap(): void {\r\n\t\tif (this._isPot(this.width) && this._isPot(this.height))\r\n\t\t\tLayaGL.instance.generateMipmap(this._glTextureType);\r\n\t}\r\n\r\n\r\n\t/** @deprecated use TextureFormat.FORMAT_R8G8B8 instead.*/\r\n\tstatic FORMAT_R8G8B8: number = 0;\r\n\t/** @deprecated use TextureFormat.FORMAT_R8G8B8A8 instead.*/\r\n\tstatic FORMAT_R8G8B8A8: number = 1;\r\n\t/** @deprecated use TextureFormat.FORMAT_ALPHA8 instead.*/\r\n\tstatic FORMAT_ALPHA8: number = 2;\r\n\t/** @deprecated use TextureFormat.FORMAT_DXT1 instead.*/\r\n\tstatic FORMAT_DXT1: number = 3;\r\n\t/** @deprecated use TextureFormat.FORMAT_DXT5 instead.*/\r\n\tstatic FORMAT_DXT5: number = 4;\r\n\t/** @deprecated use TextureFormat.FORMAT_ETC1RGB instead.*/\r\n\tstatic FORMAT_ETC1RGB: number = 5;\r\n\t/** @deprecated use TextureFormat.FORMAT_PVRTCRGB_2BPPV instead.*/\r\n\tstatic FORMAT_PVRTCRGB_2BPPV: number = 9;\r\n\t/** @deprecated use TextureFormat.FORMAT_PVRTCRGBA_2BPPV instead.*/\r\n\tstatic FORMAT_PVRTCRGBA_2BPPV: number = 10;\r\n\t/** @deprecated use TextureFormat.FORMAT_PVRTCRGB_4BPPV instead.*/\r\n\tstatic FORMAT_PVRTCRGB_4BPPV: number = 11;\r\n\t/** @deprecated use TextureFormat.FORMAT_PVRTCRGBA_4BPPV instead.*/\r\n\tstatic FORMAT_PVRTCRGBA_4BPPV: number = 12;\r\n\r\n\t/** @deprecated use RenderTextureFormat.R16G16B16A16 instead.*/\r\n\tstatic RENDERTEXTURE_FORMAT_RGBA_HALF_FLOAT: number = 14;\r\n\t/** @deprecated use TextureFormat.R32G32B32A32 instead.*/\r\n\tstatic FORMAT_R32G32B32A32: number = 15;\r\n\r\n\t/** @deprecated use RenderTextureDepthFormat.DEPTH_16 instead.*/\r\n\tstatic FORMAT_DEPTH_16: number = 0;\r\n\t/** @deprecated use RenderTextureDepthFormat.STENCIL_8 instead.*/\r\n\tstatic FORMAT_STENCIL_8: number = 1;\r\n\t/** @deprecated use RenderTextureDepthFormat.DEPTHSTENCIL_16_8 instead.*/\r\n\tstatic FORMAT_DEPTHSTENCIL_16_8: number = 2;\r\n\t/** @deprecated use RenderTextureDepthFormat.DEPTHSTENCIL_NONE instead.*/\r\n\tstatic FORMAT_DEPTHSTENCIL_NONE: number = 3;\r\n\r\n\t/** @deprecated use FilterMode.Point instead.*/\r\n\tstatic FILTERMODE_POINT: number = 0;\r\n\t/** @deprecated use FilterMode.Bilinear instead.*/\r\n\tstatic FILTERMODE_BILINEAR: number = 1;\r\n\t/** @deprecated use FilterMode.Trilinear instead.*/\r\n\tstatic FILTERMODE_TRILINEAR: number = 2;\r\n\r\n\t/** @deprecated use WarpMode.Repeat instead.*/\r\n\tstatic WARPMODE_REPEAT: number = 0;\r\n\t/** @deprecated use WarpMode.Clamp instead.*/\r\n\tstatic WARPMODE_CLAMP: number = 1;\r\n}\r\n\r\n","import { Matrix } from \"../maths/Matrix\"\r\n\r\n/**\r\n * <p> <code>Byte</code> 类提供用于优化读取、写入以及处理二进制数据的方法和属性。</p>\r\n * <p> <code>Byte</code> 类适用于需要在字节层访问数据的高级开发人员。</p>\r\n */\r\nexport class Byte {\r\n\r\n    /**\r\n     * <p>主机字节序，是 CPU 存放数据的两种不同顺序，包括小端字节序和大端字节序。通过 <code>getSystemEndian</code> 可以获取当前系统的字节序。</p>\r\n     * <p> <code>BIG_ENDIAN</code> ：大端字节序，地址低位存储值的高位，地址高位存储值的低位。有时也称之为网络字节序。<br/>\r\n     * <code>LITTLE_ENDIAN</code> ：小端字节序，地址低位存储值的低位，地址高位存储值的高位。</p>\r\n     */\r\n    static BIG_ENDIAN: string = \"bigEndian\";\r\n    /**\r\n     * <p>主机字节序，是 CPU 存放数据的两种不同顺序，包括小端字节序和大端字节序。通过 <code>getSystemEndian</code> 可以获取当前系统的字节序。</p>\r\n     * <p> <code>LITTLE_ENDIAN</code> ：小端字节序，地址低位存储值的低位，地址高位存储值的高位。<br/>\r\n     * <code>BIG_ENDIAN</code> ：大端字节序，地址低位存储值的高位，地址高位存储值的低位。有时也称之为网络字节序。</p>\r\n     */\r\n    static LITTLE_ENDIAN: string = \"littleEndian\";\r\n    /**@private */\r\n    private static _sysEndian: string = null;\r\n    /**@private 是否为小端数据。*/\r\n    protected _xd_: boolean = true;\r\n    /**@private */\r\n    private _allocated_: number = 8;\r\n    /**@private 原始数据。*/\r\n    protected _d_: any\r\n    /**@private DataView*/\r\n    protected _u8d_: any;\r\n    /**@private */\r\n    protected _pos_: number = 0;\r\n    /**@private */\r\n    protected _length: number = 0;\r\n\r\n    /**\r\n     * <p>获取当前主机的字节序。</p>\r\n     * <p>主机字节序，是 CPU 存放数据的两种不同顺序，包括小端字节序和大端字节序。</p>\r\n     * <p> <code>BIG_ENDIAN</code> ：大端字节序，地址低位存储值的高位，地址高位存储值的低位。有时也称之为网络字节序。<br/>\r\n     * <code>LITTLE_ENDIAN</code> ：小端字节序，地址低位存储值的低位，地址高位存储值的高位。</p>\r\n     * @return 当前系统的字节序。\r\n     */\r\n    static getSystemEndian(): string {\r\n        if (!Byte._sysEndian) {\r\n            var buffer: any = new ArrayBuffer(2);\r\n            new DataView(buffer).setInt16(0, 256, true);\r\n            Byte._sysEndian = (new Int16Array(buffer))[0] === 256 ? Byte.LITTLE_ENDIAN : Byte.BIG_ENDIAN;\r\n        }\r\n        return Byte._sysEndian;\r\n    }\r\n\r\n    /**\r\n     * 创建一个 <code>Byte</code> 类的实例。\r\n     * @param\tdata\t用于指定初始化的元素数目，或者用于初始化的TypedArray对象、ArrayBuffer对象。如果为 null ，则预分配一定的内存空间，当可用空间不足时，优先使用这部分内存，如果还不够，则重新分配所需内存。\r\n     */\r\n    constructor(data: any = null) {\r\n        if (data) {\r\n            this._u8d_ = new Uint8Array(data);\r\n            this._d_ = new DataView(this._u8d_.buffer);\r\n            this._length = this._d_.byteLength;\r\n        } else {\r\n            this._resizeBuffer(this._allocated_);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 获取此对象的 ArrayBuffer 数据，数据只包含有效数据部分。\r\n     */\r\n    get buffer(): ArrayBuffer {\r\n        var rstBuffer: ArrayBuffer = this._d_.buffer;\r\n        if (rstBuffer.byteLength === this._length) return rstBuffer;\r\n        return rstBuffer.slice(0, this._length);\r\n    }\r\n\r\n    /**\r\n     * <p> <code>Byte</code> 实例的字节序。取值为：<code>BIG_ENDIAN</code> 或 <code>BIG_ENDIAN</code> 。</p>\r\n     * <p>主机字节序，是 CPU 存放数据的两种不同顺序，包括小端字节序和大端字节序。通过 <code>getSystemEndian</code> 可以获取当前系统的字节序。</p>\r\n     * <p> <code>BIG_ENDIAN</code> ：大端字节序，地址低位存储值的高位，地址高位存储值的低位。有时也称之为网络字节序。<br/>\r\n     *  <code>LITTLE_ENDIAN</code> ：小端字节序，地址低位存储值的低位，地址高位存储值的高位。</p>\r\n     */\r\n    get endian(): string {\r\n        return this._xd_ ? Byte.LITTLE_ENDIAN : Byte.BIG_ENDIAN;\r\n    }\r\n\r\n    set endian(value: string) {\r\n        this._xd_ = (value === Byte.LITTLE_ENDIAN);\r\n    }\r\n\r\n    /**\r\n     * <p> <code>Byte</code> 对象的长度（以字节为单位）。</p>\r\n     * <p>如果将长度设置为大于当前长度的值，则用零填充字节数组的右侧；如果将长度设置为小于当前长度的值，将会截断该字节数组。</p>\r\n     * <p>如果要设置的长度大于当前已分配的内存空间的字节长度，则重新分配内存空间，大小为以下两者较大者：要设置的长度、当前已分配的长度的2倍，并将原有数据拷贝到新的内存空间中；如果要设置的长度小于当前已分配的内存空间的字节长度，也会重新分配内存空间，大小为要设置的长度，并将原有数据从头截断为要设置的长度存入新的内存空间中。</p>\r\n     */\r\n    set length(value: number) {\r\n        if (this._allocated_ < value) this._resizeBuffer(this._allocated_ = Math.floor(Math.max(value, this._allocated_ * 2)));\r\n        else if (this._allocated_ > value) this._resizeBuffer(this._allocated_ = value);\r\n        this._length = value;\r\n    }\r\n\r\n    get length(): number {\r\n        return this._length;\r\n    }\r\n\r\n    /**@private */\r\n    private _resizeBuffer(len: number): void {\r\n        try {\r\n            var newByteView: any = new Uint8Array(len);\r\n            if (this._u8d_ != null) {\r\n                if (this._u8d_.length <= len) newByteView.set(this._u8d_);\r\n                else newByteView.set(this._u8d_.subarray(0, len));\r\n            }\r\n            this._u8d_ = newByteView;\r\n            this._d_ = new DataView(newByteView.buffer);\r\n        } catch (err) {\r\n            throw \"Invalid typed array length:\" + len;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * <p>常用于解析固定格式的字节流。</p>\r\n     * <p>先从字节流的当前字节偏移位置处读取一个 <code>Uint16</code> 值，然后以此值为长度，读取此长度的字符串。</p>\r\n     * @return 读取的字符串。\r\n     */\r\n    getString(): string {\r\n        return this.readString();\r\n    }\r\n\r\n    /**\r\n     * <p>常用于解析固定格式的字节流。</p>\r\n     * <p>先从字节流的当前字节偏移位置处读取一个 <code>Uint16</code> 值，然后以此值为长度，读取此长度的字符串。</p>\r\n     * @return 读取的字符串。\r\n     */\r\n    readString(): string {\r\n        return this._rUTF(this.getUint16());\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * <p>从字节流中 <code>start</code> 参数指定的位置开始，读取 <code>len</code> 参数指定的字节数的数据，用于创建一个 <code>Float32Array</code> 对象并返回此对象。</p>\r\n     * <p><b>注意：</b>返回的 Float32Array 对象，在 JavaScript 环境下，是原生的 HTML5 Float32Array 对象，对此对象的读取操作都是基于运行此程序的当前主机字节序，此顺序可能与实际数据的字节序不同，如果使用此对象进行读取，需要用户知晓实际数据的字节序和当前主机字节序，如果相同，可正常读取，否则需要用户对实际数据(Float32Array.buffer)包装一层 DataView ，使用 DataView 对象可按照指定的字节序进行读取。</p>\r\n     * @param\tstart\t开始位置。\r\n     * @param\tlen\t\t需要读取的字节长度。如果要读取的长度超过可读取范围，则只返回可读范围内的值。\r\n     * @return  读取的 Float32Array 对象。\r\n     */\r\n    getFloat32Array(start: number, len: number): any {\r\n        return this.readFloat32Array(start, len);\r\n    }\r\n\r\n    /**\r\n     * 从字节流中 <code>start</code> 参数指定的位置开始，读取 <code>len</code> 参数指定的字节数的数据，用于创建一个 <code>Float32Array</code> 对象并返回此对象。\r\n     * @param\tstart\t开始位置。\r\n     * @param\tlen\t\t需要读取的字节长度。如果要读取的长度超过可读取范围，则只返回可读范围内的值。\r\n     * @return  读取的 Float32Array 对象。\r\n     */\r\n    readFloat32Array(start: number, len: number): any {\r\n        var end: number = start + len;\r\n        end = (end > this._length) ? this._length : end;\r\n        var v: any = new Float32Array(this._d_.buffer.slice(start, end));\r\n        this._pos_ = end;\r\n        return v;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 从字节流中 <code>start</code> 参数指定的位置开始，读取 <code>len</code> 参数指定的字节数的数据，用于创建一个 <code>Uint8Array</code> 对象并返回此对象。\r\n     * @param\tstart\t开始位置。\r\n     * @param\tlen\t\t需要读取的字节长度。如果要读取的长度超过可读取范围，则只返回可读范围内的值。\r\n     * @return  读取的 Uint8Array 对象。\r\n     */\r\n    getUint8Array(start: number, len: number): Uint8Array {\r\n        return this.readUint8Array(start, len);\r\n    }\r\n\r\n    /**\r\n     * 从字节流中 <code>start</code> 参数指定的位置开始，读取 <code>len</code> 参数指定的字节数的数据，用于创建一个 <code>Uint8Array</code> 对象并返回此对象。\r\n     * @param\tstart\t开始位置。\r\n     * @param\tlen\t\t需要读取的字节长度。如果要读取的长度超过可读取范围，则只返回可读范围内的值。\r\n     * @return  读取的 Uint8Array 对象。\r\n     */\r\n    readUint8Array(start: number, len: number): Uint8Array {\r\n        var end: number = start + len;\r\n        end = (end > this._length) ? this._length : end;\r\n        var v: any = new Uint8Array(this._d_.buffer.slice(start, end));\r\n        this._pos_ = end;\r\n        return v;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * <p>从字节流中 <code>start</code> 参数指定的位置开始，读取 <code>len</code> 参数指定的字节数的数据，用于创建一个 <code>Int16Array</code> 对象并返回此对象。</p>\r\n     * <p><b>注意：</b>返回的 Int16Array 对象，在 JavaScript 环境下，是原生的 HTML5 Int16Array 对象，对此对象的读取操作都是基于运行此程序的当前主机字节序，此顺序可能与实际数据的字节序不同，如果使用此对象进行读取，需要用户知晓实际数据的字节序和当前主机字节序，如果相同，可正常读取，否则需要用户对实际数据(Int16Array.buffer)包装一层 DataView ，使用 DataView 对象可按照指定的字节序进行读取。</p>\r\n     * @param\tstart\t开始读取的字节偏移量位置。\r\n     * @param\tlen\t\t需要读取的字节长度。如果要读取的长度超过可读取范围，则只返回可读范围内的值。\r\n     * @return  读取的 Int16Array 对象。\r\n     */\r\n    getInt16Array(start: number, len: number): any {\r\n        return this.readInt16Array(start, len);\r\n    }\r\n\r\n    /**\r\n     * 从字节流中 <code>start</code> 参数指定的位置开始，读取 <code>len</code> 参数指定的字节数的数据，用于创建一个 <code>Int16Array</code> 对象并返回此对象。\r\n     * @param\tstart\t开始读取的字节偏移量位置。\r\n     * @param\tlen\t\t需要读取的字节长度。如果要读取的长度超过可读取范围，则只返回可读范围内的值。\r\n     * @return  读取的 Uint8Array 对象。\r\n     */\r\n    readInt16Array(start: number, len: number): any {\r\n        var end: number = start + len;\r\n        end = (end > this._length) ? this._length : end;\r\n        var v: any = new Int16Array(this._d_.buffer.slice(start, end));\r\n        this._pos_ = end;\r\n        return v;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 从字节流的当前字节偏移位置处读取一个 IEEE 754 单精度（32 位）浮点数。\r\n     * @return 单精度（32 位）浮点数。\r\n     */\r\n    getFloat32(): number {\r\n        return this.readFloat32();\r\n    }\r\n\r\n    /**\r\n     * 从字节流的当前字节偏移位置处读取一个 IEEE 754 单精度（32 位）浮点数。\r\n     * @return 单精度（32 位）浮点数。\r\n     */\r\n    readFloat32(): number {\r\n        if (this._pos_ + 4 > this._length) throw \"getFloat32 error - Out of bounds\";\r\n        var v: number = this._d_.getFloat32(this._pos_, this._xd_);\r\n        this._pos_ += 4;\r\n        return v;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 从字节流的当前字节偏移量位置处读取一个 IEEE 754 双精度（64 位）浮点数。\r\n     * @return 双精度（64 位）浮点数。\r\n     */\r\n    getFloat64(): number {\r\n        return this.readFloat64();\r\n    }\r\n\r\n    /**\r\n     * 从字节流的当前字节偏移量位置处读取一个 IEEE 754 双精度（64 位）浮点数。\r\n     * @return 双精度（64 位）浮点数。\r\n     */\r\n    readFloat64(): number {\r\n        if (this._pos_ + 8 > this._length) throw \"getFloat64 error - Out of bounds\";\r\n        var v: number = this._d_.getFloat64(this._pos_, this._xd_);\r\n        this._pos_ += 8;\r\n        return v;\r\n    }\r\n\r\n    /**\r\n     * 在字节流的当前字节偏移量位置处写入一个 IEEE 754 单精度（32 位）浮点数。\r\n     * @param\tvalue\t单精度（32 位）浮点数。\r\n     */\r\n    writeFloat32(value: number): void {\r\n        this._ensureWrite(this._pos_ + 4);\r\n        this._d_.setFloat32(this._pos_, value, this._xd_);\r\n        this._pos_ += 4;\r\n    }\r\n\r\n    /**\r\n     * 在字节流的当前字节偏移量位置处写入一个 IEEE 754 双精度（64 位）浮点数。\r\n     * @param\tvalue\t双精度（64 位）浮点数。\r\n     */\r\n    writeFloat64(value: number): void {\r\n        this._ensureWrite(this._pos_ + 8);\r\n        this._d_.setFloat64(this._pos_, value, this._xd_);\r\n        this._pos_ += 8;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 从字节流的当前字节偏移量位置处读取一个 Int32 值。\r\n     * @return Int32 值。\r\n     */\r\n    getInt32(): number {\r\n        return this.readInt32();\r\n    }\r\n\r\n    /**\r\n     * 从字节流的当前字节偏移量位置处读取一个 Int32 值。\r\n     * @return Int32 值。\r\n     */\r\n    readInt32(): number {\r\n        if (this._pos_ + 4 > this._length) throw \"getInt32 error - Out of bounds\";\r\n        var float: number = this._d_.getInt32(this._pos_, this._xd_);\r\n        this._pos_ += 4;\r\n        return float;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 从字节流的当前字节偏移量位置处读取一个 Uint32 值。\r\n     * @return Uint32 值。\r\n     */\r\n    getUint32(): number {\r\n        return this.readUint32();\r\n    }\r\n\r\n    /**\r\n     * 从字节流的当前字节偏移量位置处读取一个 Uint32 值。\r\n     * @return Uint32 值。\r\n     */\r\n    readUint32(): number {\r\n        if (this._pos_ + 4 > this._length) throw \"getUint32 error - Out of bounds\";\r\n        var v: number = this._d_.getUint32(this._pos_, this._xd_);\r\n        this._pos_ += 4;\r\n        return v;\r\n    }\r\n\r\n    /**\r\n     * 在字节流的当前字节偏移量位置处写入指定的 Int32 值。\r\n     * @param\tvalue\t需要写入的 Int32 值。\r\n     */\r\n    writeInt32(value: number): void {\r\n        this._ensureWrite(this._pos_ + 4);\r\n        this._d_.setInt32(this._pos_, value, this._xd_);\r\n        this._pos_ += 4;\r\n    }\r\n\r\n    /**\r\n     * 在字节流的当前字节偏移量位置处写入 Uint32 值。\r\n     * @param\tvalue\t需要写入的 Uint32 值。\r\n     */\r\n    writeUint32(value: number): void {\r\n        this._ensureWrite(this._pos_ + 4);\r\n        this._d_.setUint32(this._pos_, value, this._xd_);\r\n        this._pos_ += 4;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 从字节流的当前字节偏移量位置处读取一个 Int16 值。\r\n     * @return Int16 值。\r\n     */\r\n    getInt16(): number {\r\n        return this.readInt16();\r\n    }\r\n\r\n    /**\r\n     * 从字节流的当前字节偏移量位置处读取一个 Int16 值。\r\n     * @return Int16 值。\r\n     */\r\n    readInt16(): number {\r\n        if (this._pos_ + 2 > this._length) throw \"getInt16 error - Out of bounds\";\r\n        var us: number = this._d_.getInt16(this._pos_, this._xd_);\r\n        this._pos_ += 2;\r\n        return us;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 从字节流的当前字节偏移量位置处读取一个 Uint16 值。\r\n     * @return Uint16 值。\r\n     */\r\n    getUint16(): number {\r\n        return this.readUint16();\r\n    }\r\n\r\n    /**\r\n     * 从字节流的当前字节偏移量位置处读取一个 Uint16 值。\r\n     * @return Uint16 值。\r\n     */\r\n    readUint16(): number {\r\n        if (this._pos_ + 2 > this._length) throw \"getUint16 error - Out of bounds\";\r\n        var us: number = this._d_.getUint16(this._pos_, this._xd_);\r\n        this._pos_ += 2;\r\n        return us;\r\n    }\r\n\r\n    /**\r\n     * 在字节流的当前字节偏移量位置处写入指定的 Uint16 值。\r\n     * @param\tvalue\t需要写入的Uint16 值。\r\n     */\r\n    writeUint16(value: number): void {\r\n        this._ensureWrite(this._pos_ + 2);\r\n        this._d_.setUint16(this._pos_, value, this._xd_);\r\n        this._pos_ += 2;\r\n    }\r\n\r\n    /**\r\n     * 在字节流的当前字节偏移量位置处写入指定的 Int16 值。\r\n     * @param\tvalue\t需要写入的 Int16 值。\r\n     */\r\n    writeInt16(value: number): void {\r\n        this._ensureWrite(this._pos_ + 2);\r\n        this._d_.setInt16(this._pos_, value, this._xd_);\r\n        this._pos_ += 2;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 从字节流的当前字节偏移量位置处读取一个 Uint8 值。\r\n     * @return Uint8 值。\r\n     */\r\n    getUint8(): number {\r\n        return this.readUint8();\r\n    }\r\n\r\n    /**\r\n     * 从字节流的当前字节偏移量位置处读取一个 Uint8 值。\r\n     * @return Uint8 值。\r\n     */\r\n    readUint8(): number {\r\n        if (this._pos_ + 1 > this._length) throw \"getUint8 error - Out of bounds\";\r\n        return this._u8d_[this._pos_++];\r\n    }\r\n\r\n    /**\r\n     * 在字节流的当前字节偏移量位置处写入指定的 Uint8 值。\r\n     * @param\tvalue\t需要写入的 Uint8 值。\r\n     */\r\n    writeUint8(value: number): void {\r\n        this._ensureWrite(this._pos_ + 1);\r\n        this._d_.setUint8(this._pos_, value);\r\n        this._pos_++;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 从字节流的指定字节偏移量位置处读取一个 Uint8 值。\r\n     * @param\tpos\t字节读取位置。\r\n     * @return Uint8 值。\r\n     */\r\n    //TODO:coverage\r\n    _getUInt8(pos: number): number {\r\n        return this._readUInt8(pos);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 从字节流的指定字节偏移量位置处读取一个 Uint8 值。\r\n     * @param\tpos\t字节读取位置。\r\n     * @return Uint8 值。\r\n     */\r\n    //TODO:coverage\r\n    _readUInt8(pos: number): number {\r\n        return this._d_.getUint8(pos);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 从字节流的指定字节偏移量位置处读取一个 Uint16 值。\r\n     * @param\tpos\t字节读取位置。\r\n     * @return Uint16 值。\r\n     */\r\n    //TODO:coverage\r\n    _getUint16(pos: number): number {\r\n        return this._readUint16(pos);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 从字节流的指定字节偏移量位置处读取一个 Uint16 值。\r\n     * @param\tpos\t字节读取位置。\r\n     * @return Uint16 值。\r\n     */\r\n    //TODO:coverage\r\n    _readUint16(pos: number): number {\r\n        return this._d_.getUint16(pos, this._xd_);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 使用 getFloat32() 读取6个值，用于创建并返回一个 Matrix 对象。\r\n     * @return  Matrix 对象。\r\n     */\r\n    //TODO:coverage\r\n    _getMatrix(): Matrix {\r\n        return this._readMatrix();\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 使用 getFloat32() 读取6个值，用于创建并返回一个 Matrix 对象。\r\n     * @return  Matrix 对象。\r\n     */\r\n    //TODO:coverage\r\n    _readMatrix(): Matrix {\r\n        var rst: Matrix = new Matrix(this.getFloat32(), this.getFloat32(), this.getFloat32(), this.getFloat32(), this.getFloat32(), this.getFloat32());\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 读取指定长度的 UTF 型字符串。\r\n     * @param\tlen 需要读取的长度。\r\n     * @return 读取的字符串。\r\n     */\r\n    private _rUTF(len: number): string {\r\n        var v: string = \"\", max: number = this._pos_ + len, c: number, c2: number, c3: number, f: Function = String.fromCharCode;\r\n        var u: any = this._u8d_, i: number = 0;\r\n        var strs: any[] = [];\r\n        var n: number = 0;\r\n        strs.length = 1000;\r\n        while (this._pos_ < max) {\r\n            c = u[this._pos_++];\r\n            if (c < 0x80) {\r\n                if (c != 0)\r\n                    //v += f(c);\\\r\n                    strs[n++] = f(c);\r\n            } else if (c < 0xE0) {\r\n                //v += f(((c & 0x3F) << 6) | (u[_pos_++] & 0x7F));\r\n                strs[n++] = f(((c & 0x3F) << 6) | (u[this._pos_++] & 0x7F));\r\n            } else if (c < 0xF0) {\r\n                c2 = u[this._pos_++];\r\n                //v += f(((c & 0x1F) << 12) | ((c2 & 0x7F) << 6) | (u[_pos_++] & 0x7F));\r\n                strs[n++] = f(((c & 0x1F) << 12) | ((c2 & 0x7F) << 6) | (u[this._pos_++] & 0x7F));\r\n            } else {\r\n                c2 = u[this._pos_++];\r\n                c3 = u[this._pos_++];\r\n                //v += f(((c & 0x0F) << 18) | ((c2 & 0x7F) << 12) | ((c3 << 6) & 0x7F) | (u[_pos_++] & 0x7F));\r\n                const _code = ((c & 0x0F)<< 18)| ((c2 & 0x7F)<< 12)| ((c3 & 0x7F)<< 6)| (u[this._pos_++] & 0x7F);\r\n\t\t\t\tif( _code >= 0x10000 )\r\n\t\t\t\t{\r\n\t\t\t\t\tconst _offset = _code - 0x10000;\r\n\t\t\t\t\tconst _lead = 0xd800 | (_offset >> 10);\r\n\t\t\t\t\tconst _trail = 0xdc00 | (_offset & 0x3ff);\r\n\t\t\t\t\tstrs[n++]=f(_lead);\r\n\t\t\t\t\tstrs[n++]=f(_trail);\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tstrs[n++]=f(_code);\r\n\t\t\t\t}\r\n            }\r\n            i++;\r\n        }\r\n        strs.length = n;\r\n        return strs.join('');\r\n        //return v;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 读取 <code>len</code> 参数指定的长度的字符串。\r\n     * @param\tlen\t要读取的字符串的长度。\r\n     * @return 指定长度的字符串。\r\n     */\r\n    //TODO:coverage\r\n    getCustomString(len: number): string {\r\n        return this.readCustomString(len);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 读取 <code>len</code> 参数指定的长度的字符串。\r\n     * @param\tlen\t要读取的字符串的长度。\r\n     * @return 指定长度的字符串。\r\n     */\r\n    //TODO:coverage\r\n    readCustomString(len: number): string {\r\n        var v: string = \"\", ulen: number = 0, c: number, c2: number, f: Function = String.fromCharCode;\r\n        var u: any = this._u8d_, i: number = 0;\r\n        while (len > 0) {\r\n            c = u[this._pos_];\r\n            if (c < 0x80) {\r\n                v += f(c);\r\n                this._pos_++;\r\n                len--;\r\n            } else {\r\n                ulen = c - 0x80;\r\n                this._pos_++;\r\n                len -= ulen;\r\n                while (ulen > 0) {\r\n                    c = u[this._pos_++];\r\n                    c2 = u[this._pos_++];\r\n                    v += f((c2 << 8) | c);\r\n                    ulen--;\r\n                }\r\n            }\r\n        }\r\n\r\n        return v;\r\n    }\r\n\r\n    /**\r\n     * 移动或返回 Byte 对象的读写指针的当前位置（以字节为单位）。下一次调用读取方法时将在此位置开始读取，或者下一次调用写入方法时将在此位置开始写入。\r\n     */\r\n    get pos(): number {\r\n        return this._pos_;\r\n    }\r\n\r\n    set pos(value: number) {\r\n        this._pos_ = value;\r\n        //$MOD byteOffset是只读的，这里进行赋值没有意义。\r\n        //_d_.byteOffset = value;\r\n    }\r\n\r\n    /**\r\n     * 可从字节流的当前位置到末尾读取的数据的字节数。\r\n     */\r\n    get bytesAvailable(): number {\r\n        return this._length - this._pos_;\r\n    }\r\n\r\n    /**\r\n     * 清除字节数组的内容，并将 length 和 pos 属性重置为 0。调用此方法将释放 Byte 实例占用的内存。\r\n     */\r\n    clear(): void {\r\n        this._pos_ = 0;\r\n        this.length = 0;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 获取此对象的 ArrayBuffer 引用。\r\n     * @return\r\n     */\r\n    __getBuffer(): ArrayBuffer {\r\n        //this._d_.buffer.byteLength = this.length;\r\n        return this._d_.buffer;\r\n    }\r\n\r\n    /**\r\n     * <p>将 UTF-8 字符串写入字节流。类似于 writeUTF() 方法，但 writeUTFBytes() 不使用 16 位长度的字为字符串添加前缀。</p>\r\n     * <p>对应的读取方法为： getUTFBytes 。</p>\r\n     * @param value 要写入的字符串。\r\n     */\r\n    writeUTFBytes(value: string): void {\r\n        // utf8-decode\r\n        value = value + \"\";\r\n        for (var i: number = 0, sz: number = value.length; i < sz; i++) {\r\n            var c: number = value.charCodeAt(i);\r\n\r\n            if (c <= 0x7F) {\r\n                this.writeByte(c);\r\n            } else if (c <= 0x7FF) {\r\n                //优化为直接写入多个字节，而不必重复调用writeByte，免去额外的调用和逻辑开销。\r\n                this._ensureWrite(this._pos_ + 2);\r\n                this._u8d_.set([0xC0 | (c >> 6), 0x80 | (c & 0x3F)], this._pos_);\r\n                this._pos_ += 2;\r\n            } else if (c >= 0xD800 && c <=0xDBFF){\r\n\t\t\t\ti++;\r\n\t\t\t\tconst c2=value.charCodeAt(i);\r\n\t\t\t\tif( !Number.isNaN(c2) && c2>=0xDC00 && c2<=0xDFFF )\r\n\t\t\t\t{\r\n\t\t\t\t\tconst _p1 = (c & 0x3FF) + 0x40;\r\n\t\t\t\t\tconst _p2 = c2 & 0x3FF;\r\n\r\n\t\t\t\t\tconst _b1 = 0xF0 | ((_p1>>8) & 0x3F);\r\n\t\t\t\t\tconst _b2 = 0x80 | ((_p1>>2) & 0x3F);\r\n\t\t\t\t\tconst _b3 = 0x80 | ((_p1 & 0x3)<<4) | ((_p2>>6) & 0xF);\r\n\t\t\t\t\tconst _b4 = 0x80 | (_p2 & 0x3F);\r\n\r\n\t\t\t\t\tthis._ensureWrite(this._pos_+4);\r\n\t\t\t\t\tthis._u8d_.set([_b1, _b2, _b3, _b4],this._pos_);\r\n\t\t\t\t\tthis._pos_+=4;\r\n\t\t\t\t}\r\n\t\t\t} else if (c <= 0xFFFF) {\r\n                this._ensureWrite(this._pos_ + 3);\r\n                this._u8d_.set([0xE0 | (c >> 12), 0x80 | ((c >> 6) & 0x3F), 0x80 | (c & 0x3F)], this._pos_);\r\n                this._pos_ += 3;\r\n            } else {\r\n                this._ensureWrite(this._pos_ + 4);\r\n                this._u8d_.set([0xF0 | (c >> 18), 0x80 | ((c >> 12) & 0x3F), 0x80 | ((c >> 6) & 0x3F), 0x80 | (c & 0x3F)], this._pos_);\r\n                this._pos_ += 4;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * <p>将 UTF-8 字符串写入字节流。先写入以字节表示的 UTF-8 字符串长度（作为 16 位整数），然后写入表示字符串字符的字节。</p>\r\n     * <p>对应的读取方法为： getUTFString 。</p>\r\n     * @param\tvalue 要写入的字符串值。\r\n     */\r\n    writeUTFString(value: string): void {\r\n        var tPos: number = this.pos;\r\n        this.writeUint16(1);\r\n        this.writeUTFBytes(value);\r\n        var dPos: number = this.pos - tPos - 2;\r\n        //trace(\"writeLen:\",dPos,\"pos:\",tPos);\r\n        this._d_.setUint16(tPos, dPos, this._xd_);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 读取 UTF-8 字符串。\r\n     * @return 读取的字符串。\r\n     */\r\n    readUTFString(): string {\r\n        //var tPos:int = pos;\r\n        //var len:int = getUint16();\r\n        ////trace(\"readLen:\"+len,\"pos,\",tPos);\r\n        return this.readUTFBytes(this.getUint16());\r\n    }\r\n\r\n    /**\r\n     * <p>从字节流中读取一个 UTF-8 字符串。假定字符串的前缀是一个无符号的短整型（以此字节表示要读取的长度）。</p>\r\n     * <p>对应的写入方法为： writeUTFString 。</p>\r\n     * @return 读取的字符串。\r\n     */\r\n    getUTFString(): string {\r\n        return this.readUTFString();\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 读字符串，必须是 writeUTFBytes 方法写入的字符串。\r\n     * @param len\t要读的buffer长度，默认将读取缓冲区全部数据。\r\n     * @return 读取的字符串。\r\n     */\r\n    readUTFBytes(len: number = -1): string {\r\n        if (len === 0) return \"\";\r\n        var lastBytes: number = this.bytesAvailable;\r\n        if (len > lastBytes) throw \"readUTFBytes error - Out of bounds\";\r\n        len = len > 0 ? len : lastBytes;\r\n        return this._rUTF(len);\r\n    }\r\n\r\n    /**\r\n     * <p>从字节流中读取一个由 length 参数指定的长度的 UTF-8 字节序列，并返回一个字符串。</p>\r\n     * <p>一般读取的是由 writeUTFBytes 方法写入的字符串。</p>\r\n     * @param len\t要读的buffer长度，默认将读取缓冲区全部数据。\r\n     * @return 读取的字符串。\r\n     */\r\n    getUTFBytes(len: number = -1): string {\r\n        return this.readUTFBytes(len);\r\n    }\r\n\r\n    /**\r\n     * <p>在字节流中写入一个字节。</p>\r\n     * <p>使用参数的低 8 位。忽略高 24 位。</p>\r\n     * @param\tvalue\r\n     */\r\n    writeByte(value: number): void {\r\n        this._ensureWrite(this._pos_ + 1);\r\n        this._d_.setInt8(this._pos_, value);\r\n        this._pos_ += 1;\r\n    }\r\n\r\n    /**\r\n     * <p>从字节流中读取带符号的字节。</p>\r\n     * <p>返回值的范围是从 -128 到 127。</p>\r\n     * @return 介于 -128 和 127 之间的整数。\r\n     */\r\n    readByte(): number {\r\n        if (this._pos_ + 1 > this._length) throw \"readByte error - Out of bounds\";\r\n        return this._d_.getInt8(this._pos_++);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 从字节流中读取带符号的字节。\r\n     */\r\n    getByte(): number {\r\n        return this.readByte();\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * <p>保证该字节流的可用长度不小于 <code>lengthToEnsure</code> 参数指定的值。</p>\r\n     * @param\tlengthToEnsure\t指定的长度。\r\n     */\r\n    _ensureWrite(lengthToEnsure: number): void {\r\n        if (this._length < lengthToEnsure) this._length = lengthToEnsure;\r\n        if (this._allocated_ < lengthToEnsure) this.length = lengthToEnsure;\r\n    }\r\n\r\n    /**\r\n     * <p>将指定 arraybuffer 对象中的以 offset 为起始偏移量， length 为长度的字节序列写入字节流。</p>\r\n     * <p>如果省略 length 参数，则使用默认长度 0，该方法将从 offset 开始写入整个缓冲区；如果还省略了 offset 参数，则写入整个缓冲区。</p>\r\n     * <p>如果 offset 或 length 小于0，本函数将抛出异常。</p>\r\n     * @param\tarraybuffer\t需要写入的 Arraybuffer 对象。\r\n     * @param\toffset\t\tArraybuffer 对象的索引的偏移量（以字节为单位）\r\n     * @param\tlength\t\t从 Arraybuffer 对象写入到 Byte 对象的长度（以字节为单位）\r\n     */\r\n    writeArrayBuffer(arraybuffer: any, offset: number = 0, length: number = 0): void {\r\n        if (offset < 0 || length < 0) throw \"writeArrayBuffer error - Out of bounds\";\r\n        if (length == 0) length = arraybuffer.byteLength - offset;\r\n        this._ensureWrite(this._pos_ + length);\r\n        var uint8array: any = new Uint8Array(arraybuffer);\r\n        this._u8d_.set(uint8array.subarray(offset, offset + length), this._pos_);\r\n        this._pos_ += length;\r\n    }\r\n\r\n    /**\r\n     * 读取ArrayBuffer数据\r\n     * @param\tlength\r\n     * @return\r\n     */\r\n    readArrayBuffer(length: number): ArrayBuffer {\r\n        var rst: ArrayBuffer;\r\n        rst = this._u8d_.buffer.slice(this._pos_, this._pos_ + length);\r\n        this._pos_ = this._pos_ + length\r\n        return rst;\r\n    }\r\n}\r\n\r\n","import { ILaya } from \"../../ILaya\";\r\nimport { LayaGL } from \"../layagl/LayaGL\";\r\nimport { Handler } from \"../utils/Handler\";\r\nimport { WebGLContext } from \"../webgl/WebGLContext\";\r\nimport { BaseTexture } from \"./BaseTexture\";\r\nimport { TextureFormat } from \"./TextureFormat\";\r\nimport { Byte } from \"../utils/Byte\";\r\nimport { FilterMode } from \"./FilterMode\";\r\n\r\n/**\r\n * <code>Texture2D</code> 类用于生成2D纹理。\r\n */\r\nexport class Texture2D extends BaseTexture {\r\n\t/**Texture2D资源。*/\r\n\tstatic TEXTURE2D: string = \"TEXTURE2D\";\r\n\r\n\t/**纯灰色纹理。*/\r\n\tstatic grayTexture: Texture2D = null;\r\n\t/**纯白色纹理。*/\r\n\tstatic whiteTexture: Texture2D = null;\r\n\t/**纯黑色纹理。*/\r\n\tstatic blackTexture: Texture2D = null;\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tstatic __init__(): void {\r\n\t\tvar pixels: Uint8Array = new Uint8Array(3);\r\n\t\tpixels[0] = 128;\r\n\t\tpixels[1] = 128;\r\n\t\tpixels[2] = 128;\r\n\t\tTexture2D.grayTexture = new Texture2D(1, 1, TextureFormat.R8G8B8, false, false);\r\n\t\tTexture2D.grayTexture.setPixels(pixels);\r\n\t\tTexture2D.grayTexture.lock = true;//锁住资源防止被资源管理释放\r\n\t\tpixels[0] = 255;\r\n\t\tpixels[1] = 255;\r\n\t\tpixels[2] = 255;\r\n\t\tTexture2D.whiteTexture = new Texture2D(1, 1, TextureFormat.R8G8B8, false, false);\r\n\t\tTexture2D.whiteTexture.setPixels(pixels);\r\n\t\tTexture2D.whiteTexture.lock = true;//锁住资源防止被资源管理释放\r\n\t\tpixels[0] = 0;\r\n\t\tpixels[1] = 0;\r\n\t\tpixels[2] = 0;\r\n\t\tTexture2D.blackTexture = new Texture2D(1, 1, TextureFormat.R8G8B8, false, false);\r\n\t\tTexture2D.blackTexture.setPixels(pixels);\r\n\t\tTexture2D.blackTexture.lock = true;//锁住资源防止被资源管理释放\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tstatic _parse(data: any, propertyParams: any = null, constructParams: any[] = null): Texture2D {\r\n\t\tvar texture: Texture2D = constructParams ? new Texture2D(constructParams[0], constructParams[1], constructParams[2], constructParams[3], constructParams[4]) : new Texture2D(0, 0);\r\n\t\tif (propertyParams) {\r\n\t\t\ttexture.wrapModeU = propertyParams.wrapModeU;\r\n\t\t\ttexture.wrapModeV = propertyParams.wrapModeV;\r\n\t\t\ttexture.filterMode = propertyParams.filterMode;\r\n\t\t\ttexture.anisoLevel = propertyParams.anisoLevel;\r\n\t\t}\r\n\t\tswitch (texture._format) {\r\n\t\t\tcase TextureFormat.R8G8B8:\r\n\t\t\tcase TextureFormat.R8G8B8A8:\r\n\t\t\t\ttexture.loadImageSource(data);\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.DXT1:\r\n\t\t\tcase TextureFormat.DXT5:\r\n\t\t\tcase TextureFormat.ETC1RGB:\r\n\t\t\tcase TextureFormat.PVRTCRGB_2BPPV:\r\n\t\t\tcase TextureFormat.PVRTCRGBA_2BPPV:\r\n\t\t\tcase TextureFormat.PVRTCRGB_4BPPV:\r\n\t\t\tcase TextureFormat.PVRTCRGBA_4BPPV:\r\n\t\t\t\ttexture.setCompressData(data);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow \"Texture2D:unkonwn format.\";\r\n\t\t}\r\n\t\treturn texture;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tstatic _SimpleAnimatorTextureParse(data: any, propertyParams: any = null, constructParams: any[] = null):Texture2D{\r\n\t\tvar byte:Byte = new Byte(data);\r\n\t\tvar version:String = byte.readUTFString();\r\n\t\tif(version!=\"LAYAANIMATORTEXTURE:0000\")\r\n\t\t\tthrow \"Laya3D:unknow version.\";\r\n\t\tvar textureWidth:number = byte.readInt32();\r\n\t\tvar pixelDataLength:number = byte.readInt32();\r\n\t\tvar pixelDataArrays:Float32Array = new Float32Array(textureWidth*textureWidth*4); \r\n\t\tvar usePixelData:Float32Array =new Float32Array(byte.readArrayBuffer(pixelDataLength*4));\r\n\t\tpixelDataArrays.set(usePixelData,0);\r\n\t\tvar texture: Texture2D = new Texture2D(textureWidth,textureWidth,TextureFormat.R32G32B32A32,false,false);\r\n\t\ttexture.setPixels(pixelDataArrays,0);\r\n\t\ttexture.filterMode = FilterMode.Point;\r\n\t\treturn texture;\r\n\t}\r\n\r\n\t/**\r\n\t * 加载Texture2D。\r\n\t * @param url Texture2D地址。\r\n\t * @param complete 完成回掉。\r\n\t */\r\n\tstatic load(url: string, complete: Handler): void {\r\n\t\tILaya.loader.create(url, complete, null, ILaya.Loader.TEXTURE2D);\r\n\t}\r\n\r\n\t/** @internal */\r\n\tprivate _canRead: boolean;\r\n\t/** @internal */\r\n\tprivate _pixels: Uint8Array | Uint16Array | Float32Array;//TODO:是否合并格式\r\n\r\n\r\n\r\n\t/**\r\n\t * @inheritDoc\r\n\t * @override\r\n\t */\r\n\tget defaulteTexture(): BaseTexture {\r\n\t\treturn Texture2D.grayTexture;\r\n\t}\r\n\r\n\t/**\r\n\t * 创建一个 <code>Texture2D</code> 实例。\r\n\t * @param\twidth 宽。\r\n\t * @param\theight 高。\r\n\t * @param\tformat 贴图格式。\r\n\t * @param\tmipmap 是否生成mipmap。\r\n\t * @param\tcanRead 是否可读像素,如果为true,会在内存保留像素数据。\r\n\t */\r\n\tconstructor(width: number = 0, height: number = 0, format: TextureFormat = TextureFormat.R8G8B8A8, mipmap: boolean = true, canRead: boolean = false) {\r\n\t\tsuper(format, mipmap);\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tthis._glTextureType = gl.TEXTURE_2D;\r\n\t\tthis._width = width;\r\n\t\tthis._height = height;\r\n\t\tthis._canRead = canRead;\r\n\r\n\t\tthis._setWarpMode(gl.TEXTURE_WRAP_S, this._wrapModeU);//TODO:重置宽高需要调整\r\n\t\tthis._setWarpMode(gl.TEXTURE_WRAP_T, this._wrapModeV);//TODO:重置宽高需要调整\r\n\t\tthis._setFilterMode(this._filterMode);//TODO:重置宽高需要调整\r\n\t\tthis._setAnisotropy(this._anisoLevel);\r\n\r\n\t\tvar compress: boolean = this._gpuCompressFormat();//if the format is compress,_setPixels() will cause webgl error\r\n\t\tif (mipmap) {\r\n\t\t\tvar mipCount: number = Math.max(Math.ceil(Math.log2(width)) + 1, Math.ceil(Math.log2(height)) + 1);\r\n\t\t\tif (!compress) {\r\n\t\t\t\tfor (var i: number = 0; i < mipCount; i++)\r\n\t\t\t\t\tthis._setPixels(null, i, Math.max(width >> i, 1), Math.max(height >> i, 1));//init all level\r\n\t\t\t}\r\n\t\t\tthis._mipmapCount = mipCount;\r\n\t\t\tthis._setGPUMemory(width * height * 4 * (1 + 1 / 3));\r\n\t\t} else {\r\n\t\t\tif (!compress)\r\n\t\t\t\tthis._setPixels(null, 0, width, height);//init 0 level\r\n\t\t\tthis._mipmapCount = 1;\r\n\t\t\tthis._setGPUMemory(width * height * 4);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprivate _gpuCompressFormat(): boolean {\r\n\t\treturn this._format == TextureFormat.DXT1 || this._format == TextureFormat.DXT5 ||\r\n\t\t\tthis._format == TextureFormat.ETC1RGB ||\r\n\t\t\tthis._format == TextureFormat.PVRTCRGB_2BPPV || this._format == TextureFormat.PVRTCRGBA_2BPPV ||\r\n\t\t\tthis._format == TextureFormat.PVRTCRGB_4BPPV || this._format == TextureFormat.PVRTCRGBA_4BPPV;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprivate _setPixels(pixels: Uint8Array | Uint16Array | Float32Array, miplevel: number, width: number, height: number): void {\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tvar textureType: number = this._glTextureType;\r\n\t\tvar glFormat: number = this._getGLFormat();\r\n\t\tWebGLContext.bindTexture(gl, textureType, this._glTexture);\r\n\t\tswitch (this.format) {\r\n\t\t\tcase TextureFormat.R8G8B8:\r\n\t\t\t\tgl.pixelStorei(gl.UNPACK_ALIGNMENT, 1);//字节对齐\r\n\t\t\t\tgl.texImage2D(textureType, miplevel, glFormat, width, height, 0, glFormat, gl.UNSIGNED_BYTE, pixels);\r\n\t\t\t\tgl.pixelStorei(gl.UNPACK_ALIGNMENT, 4);\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.R5G6B5:\r\n\t\t\t\tgl.pixelStorei(gl.UNPACK_ALIGNMENT, 2);//字节对齐\r\n\t\t\t\tgl.texImage2D(textureType, miplevel, glFormat, width, height, 0, glFormat, gl.UNSIGNED_SHORT_5_6_5, pixels);\r\n\t\t\t\tgl.pixelStorei(gl.UNPACK_ALIGNMENT, 4);\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.R32G32B32A32:\r\n\t\t\t\tif (LayaGL.layaGPUInstance._isWebGL2)\r\n\t\t\t\t\tgl.texImage2D(textureType, miplevel, (<WebGL2RenderingContext>gl).RGBA32F, width, height, 0, glFormat, gl.FLOAT, pixels);\r\n\t\t\t\telse\r\n\t\t\t\t\tgl.texImage2D(textureType, miplevel, gl.RGBA, width, height, 0, glFormat, gl.FLOAT, pixels);\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.R16G16B16A16://todo miner\r\n\t\t\t\tif(LayaGL.layaGPUInstance._isWebGL2)\r\n\t\t\t\t\tgl.texImage2D(textureType,miplevel,(<WebGL2RenderingContext>gl).RGBA16F,width,height,0,glFormat,(<WebGL2RenderingContext>gl).HALF_FLOAT,pixels);\r\n\t\t\t\telse\t\r\n\t\t\t\t\tgl.texImage2D(textureType,miplevel,(<WebGL2RenderingContext>gl).RGBA16F,width,height,0,glFormat,LayaGL.layaGPUInstance._oesTextureHalfFloat.HALF_FLOAT_OES,pixels);\t\r\n\t\t\tdefault:\r\n\t\t\t\tgl.texImage2D(textureType, miplevel, glFormat, width, height, 0, glFormat, gl.UNSIGNED_BYTE, pixels);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprivate _calcualatesCompressedDataSize(format: number, width: number, height: number): number {\r\n\t\tswitch (format) {\r\n\t\t\tcase TextureFormat.DXT1:\r\n\t\t\tcase TextureFormat.ETC1RGB:\r\n\t\t\t\treturn ((width + 3) >> 2) * ((height + 3) >> 2) * 8;\r\n\t\t\tcase TextureFormat.DXT5:\r\n\t\t\t\treturn ((width + 3) >> 2) * ((height + 3) >> 2) * 16;\r\n\t\t\tcase TextureFormat.PVRTCRGB_4BPPV:\r\n\t\t\tcase TextureFormat.PVRTCRGBA_4BPPV:\r\n\t\t\t\treturn Math.floor((Math.max(width, 8) * Math.max(height, 8) * 4 + 7) / 8);\r\n\t\t\tcase TextureFormat.PVRTCRGB_2BPPV:\r\n\t\t\tcase TextureFormat.PVRTCRGBA_2BPPV:\r\n\t\t\t\treturn Math.floor((Math.max(width, 16) * Math.max(height, 8) * 2 + 7) / 8);\r\n\t\t\tdefault:\r\n\t\t\t\treturn 0;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprivate _pharseDDS(arrayBuffer: ArrayBuffer): void {\r\n\t\tconst FOURCC_DXT1: number = 827611204;\r\n\t\tconst FOURCC_DXT5: number = 894720068;\r\n\t\tconst DDPF_FOURCC: number = 0x4;\r\n\t\tconst DDSD_MIPMAPCOUNT: number = 0x20000;\r\n\t\tconst DDS_MAGIC: number = 0x20534444;\r\n\t\tconst DDS_HEADER_LENGTH: number = 31;\r\n\t\tconst DDS_HEADER_MAGIC: number = 0;\r\n\t\tconst DDS_HEADER_SIZE: number = 1;\r\n\t\tconst DDS_HEADER_FLAGS: number = 2;\r\n\t\tconst DDS_HEADER_HEIGHT: number = 3;\r\n\t\tconst DDS_HEADER_WIDTH: number = 4;\r\n\t\tconst DDS_HEADER_MIPMAPCOUNT: number = 7;\r\n\t\tconst DDS_HEADER_PF_FLAGS: number = 20;\r\n\t\tconst DDS_HEADER_PF_FOURCC: number = 21;\r\n\r\n\t\tvar header: Int32Array = new Int32Array(arrayBuffer, 0, DDS_HEADER_LENGTH);\r\n\r\n\t\tif (header[DDS_HEADER_MAGIC] != DDS_MAGIC)\r\n\t\t\tthrow \"Invalid magic number in DDS header\";\r\n\r\n\t\tif (!(header[DDS_HEADER_PF_FLAGS] & DDPF_FOURCC))\r\n\t\t\tthrow \"Unsupported format, must contain a FourCC code\";\r\n\r\n\t\tvar compressedFormat: number = header[DDS_HEADER_PF_FOURCC];\r\n\t\tswitch (this._format) {\r\n\t\t\tcase TextureFormat.DXT1:\r\n\t\t\t\tif (compressedFormat !== FOURCC_DXT1)\r\n\t\t\t\t\tthrow \"the FourCC code is not same with texture format.\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.DXT5:\r\n\t\t\t\tif (compressedFormat !== FOURCC_DXT5)\r\n\t\t\t\t\tthrow \"the FourCC code is not same with texture format.\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow \"unknown texture format.\";\r\n\t\t}\r\n\r\n\t\tvar mipLevels: number = 1;\r\n\t\tif (header[DDS_HEADER_FLAGS] & DDSD_MIPMAPCOUNT) {\r\n\t\t\tmipLevels = Math.max(1, header[DDS_HEADER_MIPMAPCOUNT]);\r\n\t\t\tif (!this._mipmap)\r\n\t\t\t\tthrow \"the mipmap is not same with Texture2D.\";\r\n\t\t} else {\r\n\t\t\tif (this._mipmap)\r\n\t\t\t\tthrow \"the mipmap is not same with Texture2D.\";\r\n\t\t}\r\n\r\n\t\tvar width: number = header[DDS_HEADER_WIDTH];\r\n\t\tvar height: number = header[DDS_HEADER_HEIGHT];\r\n\t\tthis._width = width;\r\n\t\tthis._height = height;\r\n\r\n\t\tvar dataOffset: number = header[DDS_HEADER_SIZE] + 4;\r\n\t\tthis._upLoadCompressedTexImage2D(arrayBuffer, width, height, mipLevels, dataOffset, 0);\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprivate _pharseKTX(arrayBuffer: ArrayBuffer): void {\r\n\t\tconst ETC_HEADER_LENGTH: number = 13;\r\n\t\tconst ETC_HEADER_FORMAT: number = 4;\r\n\t\tconst ETC_HEADER_HEIGHT: number = 7;\r\n\t\tconst ETC_HEADER_WIDTH: number = 6;\r\n\t\tconst ETC_HEADER_MIPMAPCOUNT: number = 11;\r\n\t\tconst ETC_HEADER_METADATA: number = 12;\r\n\r\n\t\tvar id: Uint8Array = new Uint8Array(arrayBuffer, 0, 12);\r\n\t\tif (id[0] != 0xAB || id[1] != 0x4B || id[2] != 0x54 || id[3] != 0x58 || id[4] != 0x20 || id[5] != 0x31 || id[6] != 0x31 || id[7] != 0xBB || id[8] != 0x0D || id[9] != 0x0A || id[10] != 0x1A || id[11] != 0x0A)\r\n\t\t\tthrow (\"Invalid fileIdentifier in KTX header\");\r\n\t\tvar header: Int32Array = new Int32Array(id.buffer, id.length, ETC_HEADER_LENGTH);\r\n\t\tvar compressedFormat: number = header[ETC_HEADER_FORMAT];\r\n\t\tswitch (compressedFormat) {\r\n\t\t\tcase LayaGL.layaGPUInstance._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL:\r\n\t\t\t\tthis._format = TextureFormat.ETC1RGB;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow \"unknown texture format.\";\r\n\t\t}\r\n\r\n\t\tvar mipLevels: number = header[ETC_HEADER_MIPMAPCOUNT];\r\n\t\tvar width: number = header[ETC_HEADER_WIDTH];\r\n\t\tvar height: number = header[ETC_HEADER_HEIGHT];\r\n\t\tthis._width = width;\r\n\t\tthis._height = height;\r\n\r\n\t\tvar dataOffset: number = 64 + header[ETC_HEADER_METADATA];\r\n\t\tthis._upLoadCompressedTexImage2D(arrayBuffer, width, height, mipLevels, dataOffset, 4);\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprivate _pharsePVR(arrayBuffer: ArrayBuffer): void {\r\n\t\tconst PVR_FORMAT_2BPP_RGB: number = 0;\r\n\t\tconst PVR_FORMAT_2BPP_RGBA: number = 1;\r\n\t\tconst PVR_FORMAT_4BPP_RGB: number = 2;\r\n\t\tconst PVR_FORMAT_4BPP_RGBA: number = 3;\r\n\t\tconst PVR_MAGIC: number = 0x03525650;\r\n\t\tconst PVR_HEADER_LENGTH: number = 13;\r\n\t\tconst PVR_HEADER_MAGIC: number = 0;\r\n\t\tconst PVR_HEADER_FORMAT: number = 2;\r\n\t\tconst PVR_HEADER_HEIGHT: number = 6;\r\n\t\tconst PVR_HEADER_WIDTH: number = 7;\r\n\t\tconst PVR_HEADER_MIPMAPCOUNT: number = 11;\r\n\t\tconst PVR_HEADER_METADATA: number = 12;\r\n\t\tvar header: Int32Array = new Int32Array(arrayBuffer, 0, PVR_HEADER_LENGTH);\r\n\r\n\t\tif (header[PVR_HEADER_MAGIC] != PVR_MAGIC)\r\n\t\t\tthrow (\"Invalid magic number in PVR header\");\r\n\t\tvar compressedFormat: number = header[PVR_HEADER_FORMAT];\r\n\t\tswitch (compressedFormat) {\r\n\t\t\tcase PVR_FORMAT_2BPP_RGB:\r\n\t\t\t\tthis._format = TextureFormat.PVRTCRGB_2BPPV;\r\n\t\t\t\tbreak;\r\n\t\t\tcase PVR_FORMAT_4BPP_RGB:\r\n\t\t\t\tthis._format = TextureFormat.PVRTCRGB_4BPPV;\r\n\t\t\t\tbreak;\r\n\t\t\tcase PVR_FORMAT_2BPP_RGBA:\r\n\t\t\t\tthis._format = TextureFormat.PVRTCRGBA_2BPPV;\r\n\t\t\t\tbreak;\r\n\t\t\tcase PVR_FORMAT_4BPP_RGBA:\r\n\t\t\t\tthis._format = TextureFormat.PVRTCRGBA_4BPPV;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow \"Texture2D:unknown PVR format.\";\r\n\t\t}\r\n\r\n\t\tvar mipLevels: number = header[PVR_HEADER_MIPMAPCOUNT];\r\n\t\tvar width: number = header[PVR_HEADER_WIDTH];\r\n\t\tvar height: number = header[PVR_HEADER_HEIGHT];\r\n\t\tthis._width = width;\r\n\t\tthis._height = height;\r\n\r\n\t\tvar dataOffset: number = header[PVR_HEADER_METADATA] + 52;\r\n\t\tthis._upLoadCompressedTexImage2D(arrayBuffer, width, height, mipLevels, dataOffset, 0);\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_upLoadCompressedTexImage2D(data: ArrayBuffer, width: number, height: number, miplevelCount: number, dataOffset: number, imageSizeOffset: number): void {\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tvar textureType: number = this._glTextureType;\r\n\t\tWebGLContext.bindTexture(gl, textureType, this._glTexture);\r\n\t\tvar glFormat: number = this._getGLFormat();\r\n\t\tvar offset: number = dataOffset;\r\n\t\tfor (var i: number = 0; i < miplevelCount; i++) {\r\n\t\t\toffset += imageSizeOffset;\r\n\t\t\tvar mipDataSize: number = this._calcualatesCompressedDataSize(this._format, width, height);\r\n\t\t\tvar mipData: Uint8Array = new Uint8Array(data, offset, mipDataSize);\r\n\t\t\tgl.compressedTexImage2D(textureType, i, glFormat, width, height, 0, mipData);\r\n\t\t\twidth = Math.max(width >> 1, 1.0);\r\n\t\t\theight = Math.max(height >> 1, 1.0);\r\n\t\t\toffset += mipDataSize;\r\n\t\t}\r\n\t\tvar memory: number = offset;\r\n\t\tthis._setGPUMemory(memory);\r\n\r\n\t\t//if (_canRead)\r\n\t\t//_pixels = pixels;\r\n\t\tthis._readyed = true;\r\n\t\tthis._activeResource();\r\n\t}\r\n\r\n\t/**\r\n\t * 通过图片源填充纹理,可为HTMLImageElement、HTMLCanvasElement、HTMLVideoElement、ImageBitmap、ImageData,\r\n\t * 设置之后纹理宽高可能会发生变化。\r\n\t */\r\n\tloadImageSource(source: any, premultiplyAlpha: boolean = false): void {\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tvar width: number = source.width;\r\n\t\tvar height: number = source.height;\r\n\t\tthis._width = width;\r\n\t\tthis._height = height;\r\n\t\tif (!(this._isPot(width) && this._isPot(height)))\r\n\t\t\tthis._mipmap = false;\r\n\t\tthis._setWarpMode(gl.TEXTURE_WRAP_S, this._wrapModeU);//宽高变化后需要重新设置\r\n\t\tthis._setWarpMode(gl.TEXTURE_WRAP_T, this._wrapModeV);//宽高变化后需要重新设置\r\n\t\tthis._setFilterMode(this._filterMode);//宽高变化后需要重新设置\r\n\r\n\r\n\r\n\t\tWebGLContext.bindTexture(gl, this._glTextureType, this._glTexture);\r\n\t\tvar glFormat: number = this._getGLFormat();\r\n\r\n\t\tif (ILaya.Render.isConchApp) {//[NATIVE]临时\r\n\t\t\tif (source.setPremultiplyAlpha) {\r\n\t\t\t\tsource.setPremultiplyAlpha(premultiplyAlpha);\r\n\t\t\t}\r\n\t\t\tgl.texImage2D(this._glTextureType, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source);\r\n\t\t} else {\r\n\t\t\t(premultiplyAlpha) && (gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true));\r\n\t\t\tif (this.format == TextureFormat.R5G6B5)\r\n\t\t\t\tgl.texImage2D(this._glTextureType, 0, gl.RGB, gl.RGB, gl.UNSIGNED_SHORT_5_6_5, source);\r\n\t\t\telse\r\n\t\t\t\tgl.texImage2D(this._glTextureType, 0, glFormat, glFormat, gl.UNSIGNED_BYTE, source);\r\n\t\t\t(premultiplyAlpha) && (gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false));\r\n\t\t}\r\n\t\tif (this._mipmap) {\r\n\t\t\tgl.generateMipmap(this._glTextureType);\r\n\t\t\tthis._setGPUMemory(width * height * 4 * (1 + 1 / 3));\r\n\t\t} else {\r\n\t\t\tthis._setGPUMemory(width * height * 4);\r\n\t\t}\r\n\r\n\t\tif (this._canRead) {//TODO:是否所有图源都可以\r\n\t\t\tif (ILaya.Render.isConchApp) {\r\n\t\t\t\tthis._pixels = new Uint8Array(source._nativeObj.getImageData(0, 0, width, height));//TODO:如果为RGB,会错误\r\n\t\t\t} else {\r\n\t\t\t\tILaya.Browser.canvas.size(width, height);\r\n\t\t\t\tILaya.Browser.canvas.clear();\r\n\t\t\t\tILaya.Browser.context.drawImage(source, 0, 0, width, height);\r\n\t\t\t\tthis._pixels = new Uint8Array(ILaya.Browser.context.getImageData(0, 0, width, height).data.buffer);//TODO:如果为RGB,会错误\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._readyed = true;\r\n\t\tthis._activeResource();\r\n\t}\r\n\r\n\t/**\r\n\t * 通过像素填充纹理。\r\n\t * @param\tpixels 像素。\r\n\t * @param   miplevel 层级。\r\n\t */\r\n\tsetPixels(pixels: Uint8Array | Uint16Array | Float32Array, miplevel: number = 0): void {\r\n\t\tif (this._gpuCompressFormat())\r\n\t\t\tthrow \"Texture2D:the format is GPU compression format.\";\r\n\t\tif (!pixels)\r\n\t\t\tthrow \"Texture2D:pixels can't be null.\";\r\n\t\tvar width: number = Math.max(this._width >> miplevel, 1);\r\n\t\tvar height: number = Math.max(this._height >> miplevel, 1);\r\n\t\tvar pixelsCount: number = width * height * this._getFormatByteCount();\r\n\t\tif (pixels.length < pixelsCount)\r\n\t\t\tthrow \"Texture2D:pixels length should at least \" + pixelsCount + \".\";\r\n\t\tthis._setPixels(pixels, miplevel, width, height);\r\n\r\n\t\tif (this._canRead)\r\n\t\t\tthis._pixels = pixels;\r\n\r\n\t\tthis._readyed = true;\r\n\t\tthis._activeResource();\r\n\t}\r\n\r\n\t/**\r\n\t * 通过像素填充部分纹理。\r\n\t * @param  x X轴像素起点。\r\n\t * @param  y Y轴像素起点。\r\n\t * @param  width 像素宽度。\r\n\t * @param  height 像素高度。\r\n\t * @param  pixels 像素数组。\r\n\t * @param  miplevel 层级。\r\n\t */\r\n\tsetSubPixels(x: number, y: number, width: number, height: number, pixels: Uint8Array | Uint16Array | Float32Array, miplevel: number = 0): void {\r\n\t\tif (this._gpuCompressFormat())\r\n\t\t\tthrow \"Texture2D:the format is GPU compression format.\";\r\n\t\tif (!pixels)\r\n\t\t\tthrow \"Texture2D:pixels can't be null.\";\r\n\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tvar textureType: number = this._glTextureType;\r\n\t\tWebGLContext.bindTexture(gl, textureType, this._glTexture);\r\n\t\tvar glFormat: number = this._getGLFormat();\r\n\r\n\t\tswitch (this.format) {\r\n\t\t\tcase TextureFormat.R8G8B8:\r\n\t\t\t\tgl.pixelStorei(gl.UNPACK_ALIGNMENT, 1);//字节对齐\r\n\t\t\t\tgl.texSubImage2D(textureType, miplevel, x, y, width, height, glFormat, gl.UNSIGNED_BYTE, pixels);\r\n\t\t\t\tgl.pixelStorei(gl.UNPACK_ALIGNMENT, 4);\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.R5G6B5:\r\n\t\t\t\tgl.pixelStorei(gl.UNPACK_ALIGNMENT, 2);//字节对齐\r\n\t\t\t\tgl.texSubImage2D(textureType, miplevel, x, y, width, height, glFormat, gl.UNSIGNED_SHORT_5_6_5, pixels);\r\n\t\t\t\tgl.pixelStorei(gl.UNPACK_ALIGNMENT, 4);\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.R32G32B32A32:\r\n\t\t\t\tgl.texSubImage2D(textureType, miplevel, x, y, width, height, glFormat, gl.FLOAT, pixels);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tgl.texSubImage2D(textureType, miplevel, x, y, width, height, glFormat, gl.UNSIGNED_BYTE, pixels);\r\n\t\t}\r\n\r\n\t\t//if (_canRead)\r\n\t\t//_pixels = pixels;//TODO:\r\n\r\n\t\tthis._readyed = true;\r\n\t\tthis._activeResource();\r\n\t}\r\n\r\n\t/**\r\n\t * 通过压缩数据填充纹理。\r\n\t * @param\tdata 压缩数据。\r\n\t * @param   miplevel 层级。\r\n\t */\r\n\tsetCompressData(data: ArrayBuffer): void {\r\n\t\tswitch (this._format) {\r\n\t\t\tcase TextureFormat.DXT1:\r\n\t\t\tcase TextureFormat.DXT5:\r\n\t\t\t\tthis._pharseDDS(data);\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.ETC1RGB:\r\n\t\t\t\tthis._pharseKTX(data);\r\n\t\t\t\tbreak;\r\n\t\t\tcase TextureFormat.PVRTCRGB_2BPPV:\r\n\t\t\tcase TextureFormat.PVRTCRGBA_2BPPV:\r\n\t\t\tcase TextureFormat.PVRTCRGB_4BPPV:\r\n\t\t\tcase TextureFormat.PVRTCRGBA_4BPPV:\r\n\t\t\t\tthis._pharsePVR(data);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow \"Texture2D:unkonwn format.\";\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 返回图片像素。\r\n\t * @return 图片像素。\r\n\t */\r\n\tgetPixels(): Uint8Array | Uint16Array | Float32Array {\r\n\t\tif (this._canRead)\r\n\t\t\treturn this._pixels;\r\n\t\telse\r\n\t\t\tthrow new Error(\"Texture2D: must set texture canRead is true.\");\r\n\t}\r\n\r\n}\r\n\r\n\r\n","import { Resource } from \"../../resource/Resource\"\r\n\r\n/**\r\n * ...\r\n * @author ...\r\n */\r\nexport class BaseShader extends Resource {\r\n    static activeShader: BaseShader|null;\t\t\t//等于bindShader或者null\r\n    static bindShader: BaseShader;\t\t\t//当前绑定的shader\r\n\r\n    constructor() {\r\n        super();\r\n\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { Matrix } from \"../../maths/Matrix\"\r\nimport { ShaderDefines2D } from \"../shader/d2/ShaderDefines2D\"\r\n\r\nexport class RenderState2D {\r\n    static _MAXSIZE: number = 99999999;\r\n    /**@private 一个初始化的 <code>Matrix</code> 对象，不允许修改此对象内容。*/\r\n    static EMPTYMAT4_ARRAY: any[] = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n    static TEMPMAT4_ARRAY: any[] = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n    static worldMatrix4: any[] = RenderState2D.TEMPMAT4_ARRAY;\r\n\r\n    static worldMatrix: Matrix = new Matrix();\r\n    static matWVP: any = null;// :Matrix4x4 = Matrix4x4.DEFAULT;\t\t// 3d矩阵\r\n    static worldAlpha: number = 1.0;\r\n\r\n    static worldScissorTest: boolean = false;\r\n\r\n    //public static var worldClipRect:Rectangle = new Rectangle(0, 0, _MAXSIZE, _MAXSIZE);\r\n    static worldShaderDefines: ShaderDefines2D;\r\n    static worldFilters: any[];\r\n\r\n    static width: number = 0;\r\n    static height: number = 0;\r\n    /* 不知道 有什么用，删掉先\r\n    public static function getMatrArray():Array {\r\n        return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n    }\r\n    */\r\n    //TODO:coverage\r\n    static mat2MatArray(mat: Matrix, matArray: any[]): any[] {\r\n        var m: Matrix = mat;\r\n        var m4: any[] = matArray;\r\n        m4[0] = m.a;\r\n        m4[1] = m.b;\r\n        m4[2] = RenderState2D.EMPTYMAT4_ARRAY[2];\r\n        m4[3] = RenderState2D.EMPTYMAT4_ARRAY[3];\r\n        m4[4] = m.c;\r\n        m4[5] = m.d;\r\n        m4[6] = RenderState2D.EMPTYMAT4_ARRAY[6];\r\n        m4[7] = RenderState2D.EMPTYMAT4_ARRAY[7];\r\n        m4[8] = RenderState2D.EMPTYMAT4_ARRAY[8];\r\n        m4[9] = RenderState2D.EMPTYMAT4_ARRAY[9];\r\n        m4[10] = RenderState2D.EMPTYMAT4_ARRAY[10];\r\n        m4[11] = RenderState2D.EMPTYMAT4_ARRAY[11];\r\n        m4[12] = m.tx;\r\n        m4[13] = m.ty;\r\n        m4[14] = RenderState2D.EMPTYMAT4_ARRAY[14];\r\n        m4[15] = RenderState2D.EMPTYMAT4_ARRAY[15];\r\n        return matArray;\r\n    }\r\n\r\n    static restoreTempArray(): void {\r\n        RenderState2D.TEMPMAT4_ARRAY[0] = 1;\r\n        RenderState2D.TEMPMAT4_ARRAY[1] = 0;\r\n        RenderState2D.TEMPMAT4_ARRAY[4] = 0;\r\n        RenderState2D.TEMPMAT4_ARRAY[5] = 1;\r\n        RenderState2D.TEMPMAT4_ARRAY[12] = 0;\r\n        RenderState2D.TEMPMAT4_ARRAY[13] = 0;\r\n    }\r\n\r\n    static clear(): void {\r\n        RenderState2D.worldScissorTest = false;\r\n        //worldFilters = null;\r\n        RenderState2D.worldAlpha = 1;\r\n        //worldClipRect.x = worldClipRect.y = 0;\r\n        //worldClipRect.width = width;\r\n        //worldClipRect.height = height;\r\n    }\r\n\r\n}\r\n\r\n\r\n","export enum RenderTextureFormat {\r\n    /**RGB格式,每个通道8位。*/\r\n    R8G8B8 = 0,\r\n    /**RGBA格式,每个通道8位。*/\r\n    R8G8B8A8 = 1,\r\n    /**Alpha格式,8位。*/\r\n    Alpha8 = 2,\r\n    /**RGBA格式,每个通道16位。*/\r\n    R16G16B16A16 = 14,\r\n    /**深度格式。*/\r\n    Depth = 15,\r\n    /**阴影贴图格式格式。*/\r\n    ShadowMap = 16\r\n}\r\n\r\nexport enum RenderTextureDepthFormat {\r\n    /**深度格式_DEPTH_16。*/\r\n    DEPTH_16 = 0,\r\n    /**深度格式_STENCIL_8。*/\r\n    STENCIL_8 = 1,\r\n    /**深度格式_DEPTHSTENCIL_24_8。*/\r\n    DEPTHSTENCIL_24_8 = 2,\r\n    /**深度格式_DEPTHSTENCIL_NONE。*/\r\n    DEPTHSTENCIL_NONE = 3,\r\n\r\n    /** @deprecated*/\r\n    DEPTHSTENCIL_16_8 = 2,\r\n}","import { Texture2D } from \"./Texture2D\";\r\nimport { LayaGL } from \"../layagl/LayaGL\"\r\nimport { BaseTexture } from \"./BaseTexture\"\r\nimport { WebGLContext } from \"../webgl/WebGLContext\"\r\nimport { BaseShader } from \"../webgl/shader/BaseShader\"\r\nimport { RenderState2D } from \"../webgl/utils/RenderState2D\"\r\nimport { ILaya } from \"../../ILaya\";\r\nimport { RenderTextureFormat, RenderTextureDepthFormat } from \"./RenderTextureFormat\";\r\n\r\n/**\r\n * <code>RenderTexture</code> 类用于创建渲染目标。\r\n */\r\nexport class RenderTexture2D extends BaseTexture {\r\n    /** @private */\r\n    private static _currentActive: RenderTexture2D;\r\n    private _lastRT: RenderTexture2D;\r\n    private _lastWidth: number;\r\n    private _lastHeight: number;\r\n\r\n    //为push,pop 用的。以后和上面只保留一份。\r\n    //由于可能递归，所以不能简单的用save，restore\r\n    private static rtStack: any[] = [];//rt:RenderTexture，w:int，h:int\r\n\r\n    static defuv: any[] = [0, 0, 1, 0, 1, 1, 0, 1];\r\n    static flipyuv: any[] = [0, 1, 1, 1, 1, 0, 0, 0];\r\n    /**\r\n     * 获取当前激活的Rendertexture\r\n     */\r\n    static get currentActive(): RenderTexture2D {\r\n        return RenderTexture2D._currentActive;\r\n    }\r\n\r\n    /** @private */\r\n    private _frameBuffer: any;\r\n    /** @private */\r\n    private _depthStencilBuffer: any;\r\n    /** @private */\r\n    private _depthStencilFormat: number;\r\n    /**@internal */\r\n    _mgrKey: number = 0;\t//给WebGLRTMgr用的\r\n\r\n    /**\r\n     * 获取深度格式。\r\n     *@return 深度格式。\r\n     */\r\n    get depthStencilFormat(): number {\r\n        return this._depthStencilFormat;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    get defaulteTexture(): BaseTexture {\r\n        return Texture2D.grayTexture;\r\n    }\r\n\r\n    getIsReady(): boolean {\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * 获取宽度。\r\n     */\r\n    get sourceWidth(): number {\r\n        return this._width;\r\n    }\r\n\r\n    /***\r\n     * 获取高度。\r\n     */\r\n    get sourceHeight(): number {\r\n        return this._height;\r\n    }\r\n\r\n    /**\r\n     * 获取offsetX。\r\n     */\r\n    get offsetX(): number {\r\n        return 0;\r\n    }\r\n\r\n    /***\r\n     * 获取offsetY\r\n     */\r\n    get offsetY(): number {\r\n        return 0;\r\n    }\r\n\r\n    /**\r\n     * @param width  宽度。\r\n     * @param height 高度。\r\n     * @param format 纹理格式。\r\n     * @param depthStencilFormat 深度格式。\r\n     * 创建一个 <code>RenderTexture</code> 实例。\r\n     */\r\n    constructor(width: number, height: number, format: number = RenderTextureFormat.R8G8B8, depthStencilFormat: number = RenderTextureDepthFormat.DEPTH_16) {//TODO:待老郭清理\r\n\r\n        super(format, false);\r\n        this._glTextureType = LayaGL.instance.TEXTURE_2D;\r\n        this._width = width;\r\n        this._height = height;\r\n        this._depthStencilFormat = depthStencilFormat;\r\n        this._create(width, height);\r\n        this.lock = true;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private _create(width: number, height: number): void {\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        this._frameBuffer = gl.createFramebuffer();\r\n        WebGLContext.bindTexture(gl, this._glTextureType, this._glTexture);\r\n        var glFormat: number = this._getGLFormat();\r\n        gl.texImage2D(this._glTextureType, 0, glFormat, width, height, 0, glFormat, gl.UNSIGNED_BYTE, null);\r\n        this._setGPUMemory(width * height * 4);\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this._frameBuffer);\r\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this._glTexture, 0);\r\n        if (this._depthStencilFormat !== RenderTextureDepthFormat.DEPTHSTENCIL_NONE) {\r\n            this._depthStencilBuffer = gl.createRenderbuffer();\r\n            gl.bindRenderbuffer(gl.RENDERBUFFER, this._depthStencilBuffer);\r\n            switch (this._depthStencilFormat) {\r\n                case RenderTextureDepthFormat.DEPTH_16:\r\n                    gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, width, height);\r\n                    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, this._depthStencilBuffer);\r\n                    break;\r\n                case RenderTextureDepthFormat.STENCIL_8:\r\n                    gl.renderbufferStorage(gl.RENDERBUFFER, gl.STENCIL_INDEX8, width, height);\r\n                    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.STENCIL_ATTACHMENT, gl.RENDERBUFFER, this._depthStencilBuffer);\r\n                    break;\r\n                case RenderTextureDepthFormat.DEPTHSTENCIL_24_8:\r\n                    gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_STENCIL, width, height);\r\n                    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, this._depthStencilBuffer);\r\n                    break;\r\n                default:\r\n                //console.log(\"RenderTexture: unkonw depth format.\");//2d并不需要depthbuffer\r\n            }\r\n        }\r\n\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        gl.bindRenderbuffer(gl.RENDERBUFFER, null);\r\n\r\n        this._setWarpMode(gl.TEXTURE_WRAP_S, this._wrapModeU);\r\n        this._setWarpMode(gl.TEXTURE_WRAP_T, this._wrapModeV);\r\n        this._setFilterMode(this._filterMode);\r\n        this._setAnisotropy(this._anisoLevel);\r\n\r\n        this._readyed = true;\r\n        this._activeResource();\r\n    }\r\n\r\n    /**\r\n     * 生成mipMap。\r\n     * @override\r\n     */\r\n    generateMipmap(): void {\r\n        if (this._isPot(this.width) && this._isPot(this.height)) {\r\n            this._mipmap = true;\r\n            LayaGL.instance.generateMipmap(this._glTextureType);\r\n            this._setFilterMode(this._filterMode);\r\n            this._setGPUMemory(this.width * this.height * 4 * (1 + 1 / 3));\r\n        } else {\r\n            this._mipmap = false;\r\n            this._setGPUMemory(this.width * this.height * 4);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 保存当前的RT信息。\r\n     */\r\n    static pushRT(): void {\r\n        RenderTexture2D.rtStack.push({ rt: RenderTexture2D._currentActive, w: RenderState2D.width, h: RenderState2D.height });\r\n    }\r\n    /**\r\n     * 恢复上次保存的RT信息\r\n     */\r\n    static popRT(): void {\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        var top: any = RenderTexture2D.rtStack.pop();\r\n        if (top) {\r\n            if (RenderTexture2D._currentActive != top.rt) {\r\n                LayaGL.instance.bindFramebuffer(gl.FRAMEBUFFER, top.rt ? top.rt._frameBuffer : null);\r\n                RenderTexture2D._currentActive = top.rt;\r\n            }\r\n            gl.viewport(0, 0, top.w, top.h);\r\n            RenderState2D.width = top.w;\r\n            RenderState2D.height = top.h;\r\n        }\r\n    }\r\n    /**\r\n     * 开始绑定。\r\n     */\r\n    start(): void {\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        //(memorySize == 0) && recreateResource();\r\n        LayaGL.instance.bindFramebuffer(gl.FRAMEBUFFER, this._frameBuffer);\r\n        this._lastRT = RenderTexture2D._currentActive;\r\n        RenderTexture2D._currentActive = this;\r\n        this._readyed = true;\r\n\r\n        //var gl:LayaGL = LayaGL.instance;//TODO:这段代码影响2D、3D混合\r\n        ////(memorySize == 0) && recreateResource();\r\n        //LayaGL.instance.bindFramebuffer(WebGLContext.FRAMEBUFFER, _frameBuffer);\r\n        //_lastRT = _currentActive;\r\n        //_currentActive = this;\r\n        ////_readyed = false;  \r\n        //_readyed = true;\t//这个没什么用。还会影响流程，比如我有时候并不调用end。所以直接改成true\r\n        //\r\n        ////if (_type == TYPE2D) {\r\n        gl.viewport(0, 0, this._width, this._height);//外部设置\r\n        this._lastWidth = RenderState2D.width;\r\n        this._lastHeight = RenderState2D.height;\r\n        RenderState2D.width = this._width;\r\n        RenderState2D.height = this._height;\r\n        BaseShader.activeShader = null;\r\n        ////}\r\n    }\r\n\r\n    /**\r\n     * 结束绑定。\r\n     */\r\n    end(): void {\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        RenderTexture2D._currentActive = null;\r\n        this._readyed = true;\r\n    }\r\n\r\n    /**\r\n     * 恢复上一次的RenderTarge.由于使用自己保存的，所以如果被外面打断了的话，会出错。\r\n     */\r\n    restore(): void {\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        if (this._lastRT != RenderTexture2D._currentActive) {\r\n            LayaGL.instance.bindFramebuffer(gl.FRAMEBUFFER, this._lastRT ? this._lastRT._frameBuffer : null);\r\n            RenderTexture2D._currentActive = this._lastRT;\r\n        }\r\n        this._readyed = true;\r\n        //if (_type == TYPE2D)//待调整\r\n        //{\r\n        gl.viewport(0, 0, this._lastWidth, this._lastHeight);\r\n        RenderState2D.width = this._lastWidth;\r\n        RenderState2D.height = this._lastHeight;\r\n        BaseShader.activeShader = null;\r\n        //} else \r\n        //\tgl.viewport(0, 0, Laya.stage.width, Laya.stage.height);\r\n\r\n    }\r\n\r\n    clear(r: number = 0.0, g: number = 0.0, b: number = 0.0, a: number = 1.0): void {\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        gl.clearColor(r, g, b, a);\r\n        var clearFlag: number = gl.COLOR_BUFFER_BIT;\r\n        switch (this._depthStencilFormat) {\r\n            //case WebGLContext.DEPTH_COMPONENT: \r\n            case gl.DEPTH_COMPONENT16:\r\n                clearFlag |= gl.DEPTH_BUFFER_BIT;\r\n                break;\r\n            //case WebGLContext.STENCIL_INDEX:\r\n            case gl.STENCIL_INDEX8:\r\n                clearFlag |= gl.STENCIL_BUFFER_BIT;\r\n                break;\r\n            case gl.DEPTH_STENCIL:\r\n                clearFlag |= gl.DEPTH_BUFFER_BIT;\r\n                clearFlag |= gl.STENCIL_BUFFER_BIT\r\n                break;\r\n        }\r\n        gl.clear(clearFlag);\r\n    }\r\n\r\n\r\n    /**\r\n     * 获得像素数据。\r\n     * @param x X像素坐标。\r\n     * @param y Y像素坐标。\r\n     * @param width 宽度。\r\n     * @param height 高度。\r\n     * @return 像素数据。\r\n     */\r\n    getData(x: number, y: number, width: number, height: number): Uint8Array {\r\n        if (ILaya.Render.isConchApp && (window as any).conchConfig.threadMode == 2) {\r\n            throw \"native 2 thread mode use getDataAsync\";\r\n        }\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this._frameBuffer);\r\n        var canRead: boolean = (gl.checkFramebufferStatus(gl.FRAMEBUFFER) === gl.FRAMEBUFFER_COMPLETE);\r\n\r\n        if (!canRead) {\r\n            gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n            return null;\r\n        }\r\n\r\n        var pixels: Uint8Array = new Uint8Array(this._width * this._height * 4);\r\n        var glFormat: number = this._getGLFormat();\r\n        gl.readPixels(x, y, width, height, glFormat, gl.UNSIGNED_BYTE, pixels);\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        return pixels;\r\n    }\r\n    /**\r\n     * native多线程\r\n     */\r\n    getDataAsync(x: number, y: number, width: number, height: number, callBack: Function): void {\r\n        var gl: any = LayaGL.instance;\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this._frameBuffer);\r\n        gl.readPixelsAsync(x, y, width, height, gl.RGBA, gl.UNSIGNED_BYTE, function (data: ArrayBuffer): void {\r\n            callBack(new Uint8Array(data));\r\n        });\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n    }\r\n    recycle(): void {\r\n\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @internal\r\n     */\r\n    _disposeResource(): void {\r\n        if (this._frameBuffer) {\r\n            var gl: WebGLRenderingContext = LayaGL.instance;\r\n            gl.deleteTexture(this._glTexture);\r\n            gl.deleteFramebuffer(this._frameBuffer);\r\n            gl.deleteRenderbuffer(this._depthStencilBuffer);\r\n            this._glTexture = null;\r\n            this._frameBuffer = null;\r\n            this._depthStencilBuffer = null;\r\n            this._setGPUMemory(0);\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n","import { RenderTexture2D } from \"./RenderTexture2D\";\r\nimport { RenderTextureFormat } from \"./RenderTextureFormat\";\r\n\r\n/**\r\n * WebGLRTMgr 管理WebGLRenderTarget的创建和回收\r\n * TODO 需求不大，管理成本高。先去掉。\r\n */\r\n\r\nexport class WebGLRTMgr {\r\n\r\n\tprivate static dict: any = {};\t\t//key=h*10000+w\r\n\t/**\r\n\t * 获得一个renderTarget\r\n\t * 暂时先按照严格大小判断。\r\n\t * \r\n\t * @param\tw\r\n\t * @param\th\r\n\t * @return\r\n\t */\r\n\tstatic getRT(w: number, h: number): RenderTexture2D {\r\n\t\tw = w | 0;\r\n\t\th = h | 0;\r\n\t\tif (w >= 10000) {\r\n\t\t\tconsole.error('getRT error! w too big');\r\n\t\t}\r\n\t\tvar ret: RenderTexture2D;\r\n        /*\r\n\t\tvar key: number = h * 10000 + w;\r\n\t\tvar sw: any[] = WebGLRTMgr.dict[key];\r\n\t\tif (sw) {\r\n\t\t\tif (sw.length > 0) {\r\n\t\t\t\tret = sw.pop();\r\n\t\t\t\tret._mgrKey = key;\t//只有不再mgr中的才有key\r\n\t\t\t\treturn ret;\r\n\t\t\t}\r\n        }\r\n        */\r\n\t\tret = new RenderTexture2D(w, h, RenderTextureFormat.R8G8B8A8, -1);\r\n\t\t//ret._mgrKey = key;\r\n\t\treturn ret;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * 回收一个renderTarget\r\n\t * @param\trt\r\n\t */\r\n\tstatic releaseRT(rt: RenderTexture2D): void {\r\n\t\trt.destroy();\r\n\t\t//rt._disposeResource();// 直接删除贴图。否则还要管理占用过多的时候的清理。  修改：去掉了，直接destroy，否则统计会以为没有释放掉。\r\n\t\treturn;\r\n        /*\r\n\t\t//如果_mgrKey<=0表示已经加进来了。\r\n\t\tif (rt._mgrKey <= 0)\r\n\t\t\treturn;\r\n\t\tvar sw: any[] = WebGLRTMgr.dict[rt._mgrKey];\r\n\t\t!sw && (sw = [], WebGLRTMgr.dict[rt._mgrKey] = sw);\r\n\t\trt._mgrKey = 0;\r\n        sw.push(rt);\r\n        */\r\n\t}\r\n}\r\n\r\n","import { WebGLContext } from \"../WebGLContext\"\r\n\r\nexport class BlendMode {\r\n    static activeBlendFunction: Function = null;\r\n    static NAMES: any[] = [\"normal\", \"add\", \"multiply\", \"screen\", \"overlay\", \"light\", \"mask\", \"destination-out\"];\r\n    static TOINT: any = { \"normal\": 0, \"add\": 1, \"multiply\": 2, \"screen\": 3, \"overlay\": 4, \"light\": 5, \"mask\": 6, \"destination-out\": 7, \"lighter\": 1 };\r\n\r\n    static NORMAL: string = \"normal\";\t\t\t\t\t//0\r\n    static ADD: string = \"add\";\t\t\t\t\t\t\t//1\r\n    static MULTIPLY: string = \"multiply\";\t\t\t\t//2\r\n    static SCREEN: string = \"screen\";\t\t\t\t\t//3\r\n    static OVERLAY: string = \"overlay\";\t\t\t\t\t//4\r\n    static LIGHT: string = \"light\";\t\t\t\t\t\t//5\r\n    static MASK: string = \"mask\";\t\t\t\t\t\t//6\r\n    static DESTINATIONOUT: string = \"destination-out\";\t//7\r\n    static LIGHTER: string = \"lighter\";\t\t\t\t\t//1  等同于加色法\r\n\r\n    static fns: any[] = [];\r\n    static targetFns: any[] = [];\r\n    /**@internal */\r\n    static _init_(gl: WebGLContext): void {\r\n        BlendMode.fns = [BlendMode.BlendNormal, BlendMode.BlendAdd, BlendMode.BlendMultiply, BlendMode.BlendScreen, BlendMode.BlendOverlay, BlendMode.BlendLight, BlendMode.BlendMask, BlendMode.BlendDestinationOut];\r\n        BlendMode.targetFns = [BlendMode.BlendNormalTarget, BlendMode.BlendAddTarget, BlendMode.BlendMultiplyTarget, BlendMode.BlendScreenTarget, BlendMode.BlendOverlayTarget, BlendMode.BlendLightTarget, BlendMode.BlendMask, BlendMode.BlendDestinationOut];\r\n    }\r\n\r\n    static BlendNormal(gl: WebGLRenderingContext): void {\r\n        //为了避免黑边，和canvas作为贴图的黑边\r\n        WebGLContext.setBlendFunc(gl, gl.ONE, gl.ONE_MINUS_SRC_ALPHA,true);\r\n    }\r\n\r\n    static BlendAdd(gl: WebGLRenderingContext): void {\r\n        WebGLContext.setBlendFunc(gl, gl.ONE, gl.DST_ALPHA,true);\r\n    }\r\n\r\n    //TODO:coverage\r\n    static BlendMultiply(gl: WebGLRenderingContext): void {\r\n        WebGLContext.setBlendFunc(gl, gl.DST_COLOR, gl.ONE_MINUS_SRC_ALPHA,true);\r\n    }\r\n\r\n    //TODO:coverage\r\n    static BlendScreen(gl: WebGLRenderingContext): void {\r\n        WebGLContext.setBlendFunc(gl, gl.ONE, gl.ONE,true);\r\n    }\r\n\r\n    //TODO:coverage\r\n    static BlendOverlay(gl: WebGLRenderingContext): void {\r\n        WebGLContext.setBlendFunc(gl, gl.ONE, gl.ONE_MINUS_SRC_COLOR,true);\r\n    }\r\n\r\n    //TODO:coverage\r\n    static BlendLight(gl: WebGLRenderingContext): void {\r\n        WebGLContext.setBlendFunc(gl, gl.ONE, gl.ONE,true);\r\n    }\r\n\r\n    static BlendNormalTarget(gl: WebGLRenderingContext): void {\r\n        WebGLContext.setBlendFunc(gl, gl.ONE, gl.ONE_MINUS_SRC_ALPHA,true);\r\n    }\r\n\r\n    //TODO:coverage\r\n    static BlendAddTarget(gl: WebGLRenderingContext): void {\r\n        WebGLContext.setBlendFunc(gl, gl.ONE, gl.DST_ALPHA,true);\r\n    }\r\n\r\n    //TODO:coverage\r\n    static BlendMultiplyTarget(gl: WebGLRenderingContext): void {\r\n        WebGLContext.setBlendFunc(gl, gl.DST_COLOR, gl.ONE_MINUS_SRC_ALPHA,true);\r\n    }\r\n\r\n    //TODO:coverage\r\n    static BlendScreenTarget(gl: WebGLRenderingContext): void {\r\n        WebGLContext.setBlendFunc(gl, gl.ONE, gl.ONE,true);\r\n    }\r\n\r\n    //TODO:coverage\r\n    static BlendOverlayTarget(gl: WebGLRenderingContext): void {\r\n        WebGLContext.setBlendFunc(gl, gl.ONE, gl.ONE_MINUS_SRC_COLOR,true);\r\n    }\r\n\r\n    //TODO:coverage\r\n    static BlendLightTarget(gl: WebGLRenderingContext): void {\r\n        WebGLContext.setBlendFunc(gl, gl.ONE, gl.ONE,true);\r\n    }\r\n\r\n    static BlendMask(gl: WebGLRenderingContext): void {\r\n        WebGLContext.setBlendFunc(gl, gl.ZERO, gl.SRC_ALPHA,true);\r\n    }\r\n\r\n    //TODO:coverage\r\n    static BlendDestinationOut(gl: WebGLRenderingContext): void {\r\n        WebGLContext.setBlendFunc(gl, gl.ZERO, gl.ZERO,true);\r\n    }\r\n}\r\n\r\n","export class ShaderDefinesBase {\r\n\r\n    /**@internal */\r\n    _value: number = 0;\r\n\r\n    private _name2int: { [id: string]: number };\r\n    private _int2name: any[];\r\n    private _int2nameMap: any[];\r\n\r\n    constructor(name2int: any, int2name: any[], int2nameMap: any[]) {\r\n        this._name2int = name2int;\r\n        this._int2name = int2name;\r\n        this._int2nameMap = int2nameMap;\r\n    }\r\n\r\n    //TODO:coverage\r\n    add(value: any): number {\r\n        if (typeof (value) == 'string') {\r\n            this._value |= this._name2int[(<string>value)];\r\n        } else {\r\n            this._value |= value;\r\n        }\r\n        return this._value;\r\n    }\r\n\r\n    addInt(value: number): number {\r\n        this._value |= value;\r\n        return this._value;\r\n    }\r\n\r\n    //TODO:coverage\r\n    remove(value: any): number {\r\n        if (typeof (value) == 'string') {\r\n            this._value &= ~(this._name2int[(<string>value)]);\r\n        } else {\r\n            this._value &= (~value);\r\n        }\r\n        return this._value;\r\n    }\r\n\r\n    //TODO:coverage\r\n    isDefine(def: number): boolean {\r\n        return (this._value & def) === def;\r\n    }\r\n\r\n    //TODO:coverage\r\n    getValue(): number {\r\n        return this._value;\r\n    }\r\n\r\n    setValue(value: number): void {\r\n        this._value = value;\r\n    }\r\n\r\n    toNameDic(): any {\r\n        var r: string = this._int2nameMap[this._value];\r\n        return r ? r : ShaderDefinesBase._toText(this._value, this._int2name, this._int2nameMap);\r\n    }\r\n\r\n    static _reg(name: string, value: number, _name2int: any, _int2name: any[]): void {\r\n        _name2int[name] = value;\r\n        _int2name[value] = name;\r\n    }\r\n\r\n    static _toText(value: number, _int2name: any[], _int2nameMap: any): any {\r\n        var r: string = _int2nameMap[value];\r\n        if (r) return r;\r\n        var o: any = {};\r\n        var d: number = 1;\r\n        for (var i: number = 0; i < 32; i++) {\r\n            d = 1 << i;\r\n            if (d > value) break;\r\n            if (value & d) {\r\n                var name: string = _int2name[d];\r\n                name && (o[name] = \"\");\r\n            }\r\n        }\r\n        _int2nameMap[value] = o;\r\n        return o;\r\n    }\r\n\r\n    //TODO:coverage\r\n    static _toInt(names: string, _name2int: any): number {\r\n        var words: any[] = names.split('.');\r\n        var num: number = 0;\r\n        for (var i: number = 0, n: number = words.length; i < n; i++) {\r\n            var value: number = _name2int[words[i]];\r\n            if (!value) throw new Error(\"Defines to int err:\" + names + \"/\" + words[i]);\r\n            num |= value;\r\n        }\r\n        return num;\r\n    }\r\n}\r\n\r\n\r\n","import { ShaderDefinesBase } from \"../ShaderDefinesBase\"\r\nexport class ShaderDefines2D extends ShaderDefinesBase {\r\n    static TEXTURE2D: number = 0x01;\r\n    static PRIMITIVE: number = 0x04;\r\n    static FILTERGLOW: number = 0x08;\r\n    static FILTERBLUR: number = 0x10;\r\n    static FILTERCOLOR: number = 0x20;\r\n    static COLORADD: number = 0x40;\r\n\r\n    static WORLDMAT: number = 0x80;\r\n    static FILLTEXTURE: number = 0x100;\r\n    static SKINMESH: number = 0x200;\r\n    static MVP3D: number = 0x800;\r\n\r\n    static NOOPTMASK: number = ShaderDefines2D.FILTERGLOW | ShaderDefines2D.FILTERBLUR | ShaderDefines2D.FILTERCOLOR | ShaderDefines2D.FILLTEXTURE;\t//有这些定义的不要优化。见submittexture\r\n\r\n    private static __name2int: any = {};\r\n    private static __int2name: any[] = [];\r\n    private static __int2nameMap: any[] = [];\r\n\r\n    static __init__(): void {\r\n        ShaderDefines2D.reg(\"TEXTURE2D\", ShaderDefines2D.TEXTURE2D);\r\n        ShaderDefines2D.reg(\"PRIMITIVE\", ShaderDefines2D.PRIMITIVE);\r\n\r\n        ShaderDefines2D.reg(\"GLOW_FILTER\", ShaderDefines2D.FILTERGLOW);\r\n        ShaderDefines2D.reg(\"BLUR_FILTER\", ShaderDefines2D.FILTERBLUR);\r\n        ShaderDefines2D.reg(\"COLOR_FILTER\", ShaderDefines2D.FILTERCOLOR);\r\n        ShaderDefines2D.reg(\"COLOR_ADD\", ShaderDefines2D.COLORADD);\r\n\r\n        ShaderDefines2D.reg(\"WORLDMAT\", ShaderDefines2D.WORLDMAT);\r\n        ShaderDefines2D.reg(\"FILLTEXTURE\", ShaderDefines2D.FILLTEXTURE);\r\n        ShaderDefines2D.reg('MVP3D', ShaderDefines2D.MVP3D);\r\n    }\r\n\r\n    constructor() {\r\n        super(ShaderDefines2D.__name2int, ShaderDefines2D.__int2name, ShaderDefines2D.__int2nameMap);\r\n    }\r\n\r\n    static reg(name: string, value: number): void {\r\n        this._reg(name, value, ShaderDefines2D.__name2int, ShaderDefines2D.__int2name);\r\n    }\r\n\r\n    //TODO:coverage\r\n    static toText(value: number, int2name: any[], int2nameMap: any): any {\r\n        return this._toText(value, int2name, int2nameMap);\r\n    }\r\n\r\n    //TODO:coverage\r\n    static toInt(names: string): number {\r\n        return this._toInt(names, ShaderDefines2D.__name2int);\r\n    }\r\n}\r\n\r\n\r\n","import { IStatRender } from \"./IStatRender\";\r\n/**\r\n\t * <p> <code>Stat</code> 是一个性能统计面板，可以实时更新相关的性能参数。</p>\r\n\t * <p>参与统计的性能参数如下（所有参数都是每大约1秒进行更新）：<br/>\r\n\t * FPS(WebGL)：WebGL 模式下的帧频，也就是每秒显示的帧数，值越高、越稳定，感觉越流畅；<br/>\r\n\t * Sprite：统计所有渲染节点（包括容器）数量，它的大小会影响引擎进行节点遍历、数据组织和渲染的效率。其值越小，游戏运行效率越高；<br/>\r\n\t * DrawCall：此值是决定性能的重要指标，其值越小，游戏运行效率越高。Canvas模式下表示每大约1秒的图像绘制次数；WebGL模式下表示每大约1秒的渲染提交批次，每次准备数据并通知GPU渲染绘制的过程称为1次DrawCall，在每次DrawCall中除了在通知GPU的渲染上比较耗时之外，切换材质与shader也是非常耗时的操作；<br/>\r\n\t * CurMem：Canvas模式下，表示内存占用大小，值越小越好，过高会导致游戏闪退；WebGL模式下，表示内存与显存的占用，值越小越好；<br/>\r\n\t * Shader：是 WebGL 模式独有的性能指标，表示每大约1秒 Shader 提交次数，值越小越好；<br/>\r\n\t * Canvas：由三个数值组成，只有设置 CacheAs 后才会有值，默认为0/0/0。从左到右数值的意义分别为：每帧重绘的画布数量 / 缓存类型为\"normal\"类型的画布数量 / 缓存类型为\"bitmap\"类型的画布数量。</p>\r\n\t */\r\nexport class Stat {\r\n    /** 每秒帧数。*/\r\n    static FPS: number = 0;\r\n    /**主舞台 <code>Stage</code> 渲染次数计数。 */\r\n    static loopCount: number = 0;\r\n    /** 着色器请求次数。*/\r\n    static shaderCall: number = 0;\r\n    /** 渲染批次。*/\r\n    static renderBatches: number = 0;\r\n    /** 节省的渲染批次。*/\r\n    static savedRenderBatches: number = 0;\r\n    /** 三角形面数。*/\r\n    static trianglesFaces: number = 0;\r\n    /** 精灵<code>Sprite</code> 的数量。*/\r\n    static spriteCount: number = 0;\r\n    /** 精灵渲染使用缓存<code>Sprite</code> 的数量。*/\r\n    static spriteRenderUseCacheCount: number = 0;\r\n    /** 视锥剔除次数。*/\r\n    static frustumCulling: number = 0;\r\n    /**\t八叉树节点剔除次数。*/\r\n    static octreeNodeCulling: number = 0;\r\n\r\n    /** 画布 canvas 使用标准渲染的次数。*/\r\n    static canvasNormal: number = 0;\r\n    /** 画布 canvas 使用位图渲染的次数。*/\r\n    static canvasBitmap: number = 0;\r\n    /** 画布 canvas 缓冲区重绘次数。*/\r\n    static canvasReCache: number = 0;\r\n    /** 表示当前使用的是否为慢渲染模式。*/\r\n    static renderSlow: boolean = false;\r\n    /** 资源管理器所管理资源的累计内存,以字节为单位。*/\r\n    static gpuMemory: number;\r\n    static cpuMemory: number;\r\n    /**@internal */\r\n    public static _fpsStr: string;\r\n    /**@internal */\r\n    public static _canvasStr: string;\r\n    /**@internal */\r\n    public static _spriteStr: string;\r\n    /**@internal */\r\n    public static _fpsData: any[] = [];\r\n    /**@internal */\r\n    public static _timer: number = 0;\r\n    /**@internal */\r\n    public static _count: number = 0;\r\n\r\n    /**@internal*/\r\n    static _StatRender: IStatRender = null;\r\n    /**\r\n     * 显示性能统计信息。\r\n     * @param\tx X轴显示位置。\r\n     * @param\ty Y轴显示位置。\r\n     */\r\n    static show(x: number = 0, y: number = 0): void {\r\n        Stat._StatRender.show(x, y);\r\n    }\r\n\r\n\r\n    /**激活性能统计*/\r\n    static enable(): void {\r\n        Stat._StatRender.enable();\r\n    }\r\n\r\n    /**\r\n     * 隐藏性能统计信息。\r\n     */\r\n    static hide(): void {\r\n        Stat._StatRender.hide();\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 清零性能统计计算相关的数据。\r\n     */\r\n    static clear(): void {\r\n        Stat.trianglesFaces = Stat.renderBatches = Stat.savedRenderBatches = Stat.shaderCall = Stat.spriteRenderUseCacheCount = Stat.frustumCulling = Stat.octreeNodeCulling = Stat.canvasNormal = Stat.canvasBitmap = Stat.canvasReCache = 0;\r\n    }\r\n\r\n    /**\r\n     * 点击性能统计显示区域的处理函数。\r\n     */\r\n    static set onclick(fn: Function) {\r\n        Stat._StatRender.set_onclick(fn);\r\n    }\r\n}\r\n\r\n","/**\r\n\t * @private\r\n\t * <code>StringKey</code> 类用于存取字符串对应的数字。\r\n\t */\r\nexport class StringKey {\r\n\r\n    private _strsToID: any = {};\r\n    private _idToStrs: any[] = [];\r\n    private _length: number = 0;\r\n    //TODO:\r\n\r\n    /**\r\n     * 添加一个字符。\r\n     * @param\tstr 字符，将作为key 存储相应生成的数字。\r\n     * @return 此字符对应的数字。\r\n     */\r\n    //TODO:coverage\r\n    add(str: string): number {\r\n        var index: any = this._strsToID[str];\r\n        if (index != null) return index;\r\n\r\n        this._idToStrs[this._length] = str;\r\n        return this._strsToID[str] = this._length++;\r\n    }\r\n\r\n    /**\r\n     * 获取指定字符对应的ID。\r\n     * @param\tstr 字符。\r\n     * @return 此字符对应的ID。\r\n     */\r\n    //TODO:coverage\r\n    getID(str: string): number {\r\n        var index: any = this._strsToID[str];\r\n        return index == null ? -1 : index;\r\n    }\r\n\r\n    /**\r\n     * 根据指定ID获取对应字符。\r\n     * @param  id ID。\r\n     * @return 此id对应的字符。\r\n     */\r\n    //TODO:coverage\r\n    getName(id: number): string {\r\n        var str: any = this._idToStrs[id];\r\n        return str == null ? undefined : str;\r\n    }\r\n}\r\n\r\n","import { ILaya } from \"../../../ILaya\";\r\nimport { Stat } from \"../../utils/Stat\";\r\nimport { StringKey } from \"../../utils/StringKey\";\r\nimport { ShaderCompile } from \"../utils/ShaderCompile\";\r\nimport { WebGLContext } from \"../WebGLContext\";\r\nimport { BaseShader } from \"./BaseShader\";\r\nimport { ShaderValue } from \"./ShaderValue\";\r\nimport { LayaGL } from \"../../layagl/LayaGL\";\r\n\r\nexport class Shader extends BaseShader {\r\n\r\n    //private static var _TEXTURES:Array =  [WebGLContext.TEXTURE0, WebGLContext.TEXTURE1, WebGLContext.TEXTURE2, WebGLContext.TEXTURE3, WebGLContext.TEXTURE4, WebGLContext.TEXTURE5, WebGLContext.TEXTURE6,, WebGLContext.TEXTURE7, WebGLContext.TEXTURE8];\r\n    private static _count: number = 0;\r\n    /**@internal */\r\n    static _preCompileShader: any = {}; //存储预编译结果，可以通过名字获得内容,目前不支持#ifdef嵌套和条件\r\n    private _attribInfo: any[]|null = null;\r\n\r\n    static SHADERNAME2ID: number = 0.0002;\r\n\r\n\r\n    static nameKey: StringKey = new StringKey();\r\n\r\n    static sharders: any[] = new Array(0x20);// (sharders = [], sharders.length = 0x20, sharders);\r\n\r\n    //TODO:coverage\r\n    static getShader(name: any): Shader {\r\n        return Shader.sharders[name];\r\n    }\r\n\r\n    //TODO:coverage\r\n    static create(vs: string, ps: string, saveName: any = null, nameMap: any = null, bindAttrib: any[] = null): Shader {\r\n        return new Shader(vs, ps, saveName, nameMap, bindAttrib);\r\n    }\r\n\r\n\t/**\r\n\t * 根据宏动态生成shader文件，支持#include?COLOR_FILTER \"parts/ColorFilter_ps_logic.glsl\";条件嵌入文件\r\n\t * @param\tname\r\n\t * @param\tvs\r\n\t * @param\tps\r\n\t * @param\tdefine 宏定义，格式:{name:value...}\r\n\t * @return\r\n\t */\r\n    //TODO:coverage\r\n    static withCompile(nameID: number, define: any, shaderName: any, createShader: Function): Shader {\r\n        if (shaderName && Shader.sharders[shaderName])\r\n            return Shader.sharders[shaderName];\r\n\r\n        var pre: ShaderCompile = Shader._preCompileShader[Shader.SHADERNAME2ID * nameID];\r\n        if (!pre)\r\n            throw new Error(\"withCompile shader err!\" + nameID);\r\n        return pre.createShader(define, shaderName, createShader, null);\r\n    }\r\n\r\n\t/**\r\n\t * 根据宏动态生成shader文件，支持#include?COLOR_FILTER \"parts/ColorFilter_ps_logic.glsl\";条件嵌入文件\r\n\t * @param\tname\r\n\t * @param\tvs\r\n\t * @param\tps\r\n\t * @param\tdefine 宏定义，格式:{name:value...}\r\n\t * @return\r\n\t */\r\n    static withCompile2D(nameID: number, mainID: number, define: any, shaderName: any, createShader: Function, bindAttrib: any[] = null): Shader {\r\n        if (shaderName && Shader.sharders[shaderName])\r\n            return Shader.sharders[shaderName];\r\n\r\n        var pre: ShaderCompile = Shader._preCompileShader[Shader.SHADERNAME2ID * nameID + mainID];\r\n        if (!pre)\r\n            throw new Error(\"withCompile shader err!\" + nameID + \" \" + mainID);\r\n        return pre.createShader(define, shaderName, createShader, bindAttrib);\r\n    }\r\n\r\n    static addInclude(fileName: string, txt: string): void {\r\n        ILaya.ShaderCompile.addInclude(fileName, txt);\r\n    }\r\n\r\n\t/**\r\n\t * 预编译shader文件，主要是处理宏定义\r\n\t * @param\tnameID,一般是特殊宏+shaderNameID*0.0002组成的一个浮点数当做唯一标识\r\n\t * @param\tvs\r\n\t * @param\tps\r\n\t */\r\n    //TODO:coverage\r\n    static preCompile(nameID: number, vs: string, ps: string, nameMap: any): void {\r\n        var id: number = Shader.SHADERNAME2ID * nameID;\r\n        Shader._preCompileShader[id] = new ILaya.ShaderCompile(vs, ps, nameMap);\r\n    }\r\n\r\n\t/**\r\n\t * 预编译shader文件，主要是处理宏定义\r\n\t * @param\tnameID,一般是特殊宏+shaderNameID*0.0002组成的一个浮点数当做唯一标识\r\n\t * @param\tvs\r\n\t * @param\tps\r\n\t */\r\n    static preCompile2D(nameID: number, mainID: number, vs: string, ps: string, nameMap: any): void {\r\n        var id: number = Shader.SHADERNAME2ID * nameID + mainID;\r\n        Shader._preCompileShader[id] = new ILaya.ShaderCompile(vs, ps, nameMap);\r\n    }\r\n\r\n    private customCompile: boolean = false;\r\n\r\n    private _nameMap: any; //shader参数别名，语义\r\n    private _vs: string\r\n    private _ps: string;\r\n    private _curActTexIndex: number = 0;\r\n    private _reCompile: boolean;\r\n\r\n    //存储一些私有变量\r\n    tag: any = {};\r\n    /**@internal */\r\n    _vshader: any;\r\n    /**@internal */\r\n    _pshader: any\r\n    /**@internal */\r\n    _program: any = null;\r\n    /**@internal */\r\n    _params: any[] = null;\r\n    /**@internal */\r\n    _paramsMap: any = {};\r\n\r\n\t/**\r\n\t * 根据vs和ps信息生成shader对象\r\n\t * 把自己存储在 sharders 数组中\r\n\t * @param\tvs\r\n\t * @param\tps\r\n\t * @param\tname:\r\n\t * @param\tnameMap 帮助里要详细解释为什么需要nameMap\r\n\t */\r\n    constructor(vs: string, ps: string, saveName: any = null, nameMap: any = null, bindAttrib: any[]|null = null) {\r\n        super();\r\n        if ((!vs) || (!ps)) throw \"Shader Error\";\r\n        this._attribInfo = bindAttrib;\r\n        this._id = ++Shader._count;\r\n        this._vs = vs;\r\n        this._ps = ps;\r\n        this._nameMap = nameMap ? nameMap : {};\r\n        saveName != null && (Shader.sharders[saveName] = this);\r\n        this.recreateResource();\r\n        this.lock = true;\r\n    }\r\n\r\n    protected recreateResource(): void {\r\n        this._compile();\r\n        this._setGPUMemory(0);//忽略尺寸尺寸\r\n    }\r\n\r\n    //TODO:coverage\r\n    /**\r\n     * @override\r\n     */\r\n    protected _disposeResource(): void {\r\n        WebGLContext.mainContext.deleteShader(this._vshader);\r\n        WebGLContext.mainContext.deleteShader(this._pshader);\r\n        WebGLContext.mainContext.deleteProgram(this._program);\r\n        this._vshader = this._pshader = this._program = null;\r\n        this._params = null;\r\n        this._paramsMap = {};\r\n        this._setGPUMemory(0);\r\n        this._curActTexIndex = 0;\r\n    }\r\n\r\n    private _compile(): void {\r\n        if (!this._vs || !this._ps || this._params)\r\n            return;\r\n\t\t/*\r\n\t\ttrace(\"================================\");\r\n\t\ttrace(_vs);\r\n\t\ttrace(_ps);\r\n\t\ttrace(\"\\n\");\r\n\t\t*/\r\n        this._reCompile = true;\r\n        this._params = [];\r\n\r\n        var result: any;\r\n        if (this.customCompile)\r\n            result = ILaya.ShaderCompile.preGetParams(this._vs, this._ps);\r\n        var gl: WebGLRenderingContext = WebGLContext.mainContext;\r\n        this._program = gl.createProgram();\r\n        this._vshader = Shader._createShader(gl, this._vs, gl.VERTEX_SHADER);\r\n        this._pshader = Shader._createShader(gl, this._ps, gl.FRAGMENT_SHADER);\r\n\r\n        gl.attachShader(this._program, this._vshader);\r\n        gl.attachShader(this._program, this._pshader);\r\n\r\n        var one: any, i: number, j: number, n: number, location: any;\r\n\r\n        //属性用指定location的方法，这样更灵活，更方便与vao结合。\r\n        //注意注意注意 这个必须放到link前面\r\n        var attribDescNum: number = this._attribInfo ? this._attribInfo.length : 0;\r\n        for (i = 0; i < attribDescNum; i += 2) {\r\n            gl.bindAttribLocation(this._program, this._attribInfo[i + 1], this._attribInfo[i]);\r\n        }\r\n\r\n        gl.linkProgram(this._program);\r\n        if (!this.customCompile && !gl.getProgramParameter(this._program, gl.LINK_STATUS)) {\r\n            throw gl.getProgramInfoLog(this._program);\r\n        }\r\n        //trace(_vs);\r\n        //trace(_ps);\r\n\r\n\t\t/*\r\n\t\tvar attribNum:int = customCompile ? result.attributes.length : gl.getProgramParameter(_program, WebGLContext.ACTIVE_ATTRIBUTES); //得到attribute的个数\r\n\t\t\r\n\t\tfor (i = 0; i < attribNum; i++) {\r\n\t\t\tvar attrib:* = customCompile ? result.attributes[i] : gl.getActiveAttrib(_program, i); //attrib对象，{name,size,type}\r\n\t\t\tlocation = gl.getAttribLocation(_program, attrib.name); //用名字来得到location\t\r\n\t\t\tone = {vartype: \"attribute\", glfun:null, ivartype: 0, attrib: attrib, location: location, name: attrib.name, type: attrib.type, isArray: false, isSame: false, preValue: null, indexOfParams: 0};\r\n\t\t\t_params.push(one);\r\n\t\t}\r\n\t\t*/\r\n        var nUniformNum: number = this.customCompile ? result.uniforms.length : gl.getProgramParameter(this._program, gl.ACTIVE_UNIFORMS); //个数\r\n\r\n        for (i = 0; i < nUniformNum; i++) {\r\n            var uniform: any = this.customCompile ? result.uniforms[i] : gl.getActiveUniform(this._program, i);//得到uniform对象，包括名字等信息 {name,type,size}\r\n            location = gl.getUniformLocation(this._program, uniform.name); //用名字来得到location\r\n            one = { vartype: \"uniform\", glfun: null, ivartype: 1, location: location, name: uniform.name, type: uniform.type, isArray: false, isSame: false, preValue: null, indexOfParams: 0 };\r\n            if (one.name.indexOf('[0]') > 0) {\r\n                one.name = one.name.substr(0, one.name.length - 3);\r\n                one.isArray = true;\r\n                one.location = gl.getUniformLocation(this._program, one.name);\r\n            }\r\n            this._params.push(one);\r\n        }\r\n\r\n        for (i = 0, n = this._params.length; i < n; i++) {\r\n            one = this._params[i];\r\n            one.indexOfParams = i;\r\n            one.index = 1;\r\n            one.value = [one.location, null];\r\n            one.codename = one.name;\r\n            one.name = this._nameMap[one.codename] ? this._nameMap[one.codename] : one.codename;\r\n            this._paramsMap[one.name] = one;\r\n            one._this = this;\r\n            one.uploadedValue = [];\r\n\r\n            switch (one.type) {\r\n                case gl.INT:\r\n                    one.fun = one.isArray ? this._uniform1iv : this._uniform1i;\r\n                    break;\r\n                case gl.FLOAT:\r\n                    one.fun = one.isArray ? this._uniform1fv : this._uniform1f;\r\n                    break;\r\n                case gl.FLOAT_VEC2:\r\n                    one.fun = one.isArray ? this._uniform_vec2v : this._uniform_vec2;\r\n                    break;\r\n                case gl.FLOAT_VEC3:\r\n                    one.fun = one.isArray ? this._uniform_vec3v : this._uniform_vec3;\r\n                    break;\r\n                case gl.FLOAT_VEC4:\r\n                    one.fun = one.isArray ? this._uniform_vec4v : this._uniform_vec4;\r\n                    break;\r\n                case gl.SAMPLER_2D:\r\n                    one.fun = this._uniform_sampler2D;\r\n                    break;\r\n                case gl.SAMPLER_CUBE:\r\n                    one.fun = this._uniform_samplerCube;\r\n                    break;\r\n                case gl.FLOAT_MAT4:\r\n                    one.glfun = gl.uniformMatrix4fv;\r\n                    one.fun = this._uniformMatrix4fv;\r\n                    break;\r\n                case gl.BOOL:\r\n                    one.fun = this._uniform1i;\r\n                    break;\r\n                case gl.FLOAT_MAT2:\r\n                case gl.FLOAT_MAT3:\r\n                    //TODO 这个有人会用的。\r\n                    throw new Error(\"compile shader err!\");\r\n                default:\r\n                    throw new Error(\"compile shader err!\");\r\n            }\r\n        }\r\n    }\r\n\r\n    private static _createShader(gl: WebGLRenderingContext, str: string, type: any): any {\r\n        var shader: any = gl.createShader(type);\r\n        gl.shaderSource(shader, str);\r\n        gl.compileShader(shader);\r\n        if (gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n            return shader;\r\n        } else {\r\n            console.log(gl.getShaderInfoLog(shader));\r\n            return null;\r\n        }\r\n    }\r\n\r\n\t/**\r\n\t * 根据变量名字获得\r\n\t * @param\tname\r\n\t * @return\r\n\t */\r\n    //TODO:coverage\r\n    getUniform(name: string): any {\r\n        return this._paramsMap[name];\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniform1f(one: any, value: any): number {\r\n        var uploadedValue: any[] = one.uploadedValue;\r\n        if (uploadedValue[0] !== value) {\r\n            WebGLContext.mainContext.uniform1f(one.location, uploadedValue[0] = value);\r\n            return 1;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniform1fv(one: any, value: any): number {\r\n        if (value.length < 4) {\r\n            var uploadedValue: any[] = one.uploadedValue;\r\n            if (uploadedValue[0] !== value[0] || uploadedValue[1] !== value[1] || uploadedValue[2] !== value[2] || uploadedValue[3] !== value[3]) {\r\n                WebGLContext.mainContext.uniform1fv(one.location, value);\r\n                uploadedValue[0] = value[0];\r\n                uploadedValue[1] = value[1];\r\n                uploadedValue[2] = value[2];\r\n                uploadedValue[3] = value[3];\r\n                return 1;\r\n            }\r\n            return 0;\r\n        } else {\r\n            WebGLContext.mainContext.uniform1fv(one.location, value);\r\n            return 1;\r\n        }\r\n    }\r\n\r\n    private _uniform_vec2(one: any, value: any): number {\r\n        var uploadedValue: any[] = one.uploadedValue;\r\n        if (uploadedValue[0] !== value[0] || uploadedValue[1] !== value[1]) {\r\n            WebGLContext.mainContext.uniform2f(one.location, uploadedValue[0] = value[0], uploadedValue[1] = value[1]);\r\n            return 1;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniform_vec2v(one: any, value: any): number {\r\n        if (value.length < 2) {\r\n            var uploadedValue: any[] = one.uploadedValue;\r\n            if (uploadedValue[0] !== value[0] || uploadedValue[1] !== value[1] || uploadedValue[2] !== value[2] || uploadedValue[3] !== value[3]) {\r\n                WebGLContext.mainContext.uniform2fv(one.location, value);\r\n                uploadedValue[0] = value[0];\r\n                uploadedValue[1] = value[1];\r\n                uploadedValue[2] = value[2];\r\n                uploadedValue[3] = value[3];\r\n                return 1;\r\n            }\r\n            return 0;\r\n        } else {\r\n            WebGLContext.mainContext.uniform2fv(one.location, value);\r\n            return 1;\r\n        }\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniform_vec3(one: any, value: any): number {\r\n        var uploadedValue: any[] = one.uploadedValue;\r\n        if (uploadedValue[0] !== value[0] || uploadedValue[1] !== value[1] || uploadedValue[2] !== value[2]) {\r\n            WebGLContext.mainContext.uniform3f(one.location, uploadedValue[0] = value[0], uploadedValue[1] = value[1], uploadedValue[2] = value[2]);\r\n            return 1;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniform_vec3v(one: any, value: any): number {\r\n        WebGLContext.mainContext.uniform3fv(one.location, value);\r\n        return 1;\r\n    }\r\n\r\n    private _uniform_vec4(one: any, value: any): number {\r\n        var uploadedValue: any[] = one.uploadedValue;\r\n        if (uploadedValue[0] !== value[0] || uploadedValue[1] !== value[1] || uploadedValue[2] !== value[2] || uploadedValue[3] !== value[3]) {\r\n            WebGLContext.mainContext.uniform4f(one.location, uploadedValue[0] = value[0], uploadedValue[1] = value[1], uploadedValue[2] = value[2], uploadedValue[3] = value[3]);\r\n            return 1;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniform_vec4v(one: any, value: any): number {\r\n        WebGLContext.mainContext.uniform4fv(one.location, value);\r\n        return 1;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniformMatrix2fv(one: any, value: any): number {\r\n        WebGLContext.mainContext.uniformMatrix2fv(one.location, false, value);\r\n        return 1;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniformMatrix3fv(one: any, value: any): number {\r\n        WebGLContext.mainContext.uniformMatrix3fv(one.location, false, value);\r\n        return 1;\r\n    }\r\n\r\n    private _uniformMatrix4fv(one: any, value: any): number {\r\n        WebGLContext.mainContext.uniformMatrix4fv(one.location, false, value);\r\n        return 1;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniform1i(one: any, value: any): number {\r\n        var uploadedValue: any[] = one.uploadedValue;\r\n        if (uploadedValue[0] !== value) {\r\n            WebGLContext.mainContext.uniform1i(one.location, uploadedValue[0] = value);\r\n            return 1;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniform1iv(one: any, value: any): number {\r\n        WebGLContext.mainContext.uniform1iv(one.location, value);\r\n        return 1;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniform_ivec2(one: any, value: any): number {\r\n        var uploadedValue: any[] = one.uploadedValue;\r\n        if (uploadedValue[0] !== value[0] || uploadedValue[1] !== value[1]) {\r\n            WebGLContext.mainContext.uniform2i(one.location, uploadedValue[0] = value[0], uploadedValue[1] = value[1]);\r\n            return 1;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniform_ivec2v(one: any, value: any): number {\r\n        WebGLContext.mainContext.uniform2iv(one.location, value);\r\n        return 1;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniform_vec3i(one: any, value: any): number {\r\n        var uploadedValue: any[] = one.uploadedValue;\r\n        if (uploadedValue[0] !== value[0] || uploadedValue[1] !== value[1] || uploadedValue[2] !== value[2]) {\r\n            WebGLContext.mainContext.uniform3i(one.location, uploadedValue[0] = value[0], uploadedValue[1] = value[1], uploadedValue[2] = value[2]);\r\n            return 1;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    private _uniform_vec3vi(one: any, value: any): number {\r\n        WebGLContext.mainContext.uniform3iv(one.location, value);\r\n        return 1;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniform_vec4i(one: any, value: any): number {\r\n        var uploadedValue: any[] = one.uploadedValue;\r\n        if (uploadedValue[0] !== value[0] || uploadedValue[1] !== value[1] || uploadedValue[2] !== value[2] || uploadedValue[3] !== value[3]) {\r\n            WebGLContext.mainContext.uniform4i(one.location, uploadedValue[0] = value[0], uploadedValue[1] = value[1], uploadedValue[2] = value[2], uploadedValue[3] = value[3]);\r\n            return 1;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniform_vec4vi(one: any, value: any): number {\r\n        WebGLContext.mainContext.uniform4iv(one.location, value);\r\n        return 1;\r\n    }\r\n\r\n    private _uniform_sampler2D(one: any, value: any): number {//TODO:TEXTURTE ARRAY\r\n        var gl: WebGLRenderingContext = WebGLContext.mainContext;\r\n        var uploadedValue: any[] = one.uploadedValue;\r\n        if (uploadedValue[0] == null) {\r\n            uploadedValue[0] = this._curActTexIndex;\r\n            gl.uniform1i(one.location, this._curActTexIndex);\r\n            WebGLContext.activeTexture(gl, gl.TEXTURE0 + this._curActTexIndex);\r\n            WebGLContext.bindTexture(gl, gl.TEXTURE_2D, value);\r\n            this._curActTexIndex++;\r\n            return 1;\r\n        } else {\r\n            WebGLContext.activeTexture(gl, gl.TEXTURE0 + uploadedValue[0]);\r\n            WebGLContext.bindTexture(gl, gl.TEXTURE_2D, value);\r\n            return 0;\r\n        }\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _uniform_samplerCube(one: any, value: any): number {//TODO:TEXTURTECUBE ARRAY\r\n        var gl: WebGLRenderingContext = WebGLContext.mainContext;\r\n        var uploadedValue: any[] = one.uploadedValue;\r\n        if (uploadedValue[0] == null) {\r\n            uploadedValue[0] = this._curActTexIndex;\r\n            gl.uniform1i(one.location, this._curActTexIndex);\r\n            WebGLContext.activeTexture(gl, gl.TEXTURE0 + this._curActTexIndex);\r\n            WebGLContext.bindTexture(gl, gl.TEXTURE_CUBE_MAP, value);\r\n            this._curActTexIndex++;\r\n            return 1;\r\n        } else {\r\n            WebGLContext.activeTexture(gl, gl.TEXTURE0 + uploadedValue[0]);\r\n            WebGLContext.bindTexture(gl, gl.TEXTURE_CUBE_MAP, value);\r\n            return 0;\r\n        }\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _noSetValue(one: any): void {\r\n        console.log(\"no....:\" + one.name);\r\n        //throw new Error(\"upload shader err,must set value:\"+one.name);\r\n    }\r\n\r\n    //TODO:coverage\r\n    uploadOne(name: string, value: any): void {\r\n        //activeResource();\r\n        WebGLContext.useProgram(WebGLContext.mainContext, this._program);\r\n        var one: any = this._paramsMap[name];\r\n        one.fun.call(this, one, value);\r\n    }\r\n\r\n    uploadTexture2D(value: any): void {\r\n        //这个可能执行频率非常高，所以这里能省就省点\r\n        //Stat.shaderCall++;\r\n        //var gl:WebGLContext = WebGLContext.mainContext;\r\n        //WebGLContext.activeTexture(gl,WebGLContext.TEXTURE0);\t2d必须是active0\r\n        var CTX: any = WebGLContext;\r\n\r\n        if (CTX._activeTextures[0] !== value) {\r\n            CTX.bindTexture(WebGLContext.mainContext, LayaGL.instance.TEXTURE_2D, value);\r\n            CTX._activeTextures[0] = value;\r\n        }\r\n    }\r\n\r\n\t/**\r\n\t * 提交shader到GPU\r\n\t * @param\tshaderValue\r\n\t */\r\n    upload(shaderValue: ShaderValue, params: any[] = null): void {\r\n        BaseShader.activeShader = BaseShader.bindShader = this;\r\n        //recreateResource();\r\n        var gl: WebGLRenderingContext = WebGLContext.mainContext;\r\n        WebGLContext.useProgram(gl, this._program);\r\n\r\n        if (this._reCompile) {\r\n            params = this._params;\r\n            this._reCompile = false;\r\n        } else {\r\n            params = params || this._params;\r\n        }\r\n\r\n\r\n        var one: any, value: any, n: number = params.length, shaderCall: number = 0;\r\n\r\n        for (var i: number = 0; i < n; i++) {\r\n            one = params[i];\r\n            if ((value = shaderValue[one.name]) !== null)\r\n\r\n                shaderCall += one.fun.call(this, one, value);\r\n\t\t\t/*\r\n\t\t\tone.glfun?\r\n\t\t\t\tone.glfun.call(gl, one.location, false, value):\r\n\t\t\t\tone.fun.call(this, one, value);*/\r\n        }\r\n\r\n        Stat.shaderCall += shaderCall;\r\n    }\r\n\r\n\t/**\r\n\t * 按数组的定义提交\r\n\t * @param\tshaderValue 数组格式[name,value,...]\r\n\t */\r\n    //TODO:coverage\r\n    uploadArray(shaderValue: any[], length: number, _bufferUsage: any): void {\r\n        BaseShader.activeShader = this;\r\n        BaseShader.bindShader = this;\r\n        //activeResource();\r\n        WebGLContext.useProgram(WebGLContext.mainContext, this._program);\r\n        var params: any = this._params, value: any;\r\n        var one: any, shaderCall: number = 0;\r\n        for (var i: number = length - 2; i >= 0; i -= 2) {\r\n            one = this._paramsMap[shaderValue[i]];\r\n            if (!one)\r\n                continue;\r\n\r\n            value = shaderValue[i + 1];\r\n            if (value != null) {\r\n                _bufferUsage && _bufferUsage[one.name] && _bufferUsage[one.name].bind();\r\n                shaderCall += one.fun.call(this, one, value);\r\n            }\r\n        }\r\n        Stat.shaderCall += shaderCall;\r\n    }\r\n\r\n\t/**\r\n\t * 得到编译后的变量及相关预定义\r\n\t * @return\r\n\t */\r\n    //TODO:coverage\r\n    getParams(): any[] {\r\n        return this._params;\r\n    }\r\n\r\n\t/**\r\n\t * 设置shader里面的attribute绑定到哪个location，必须与mesh2d的对应起来，\r\n\t * 这个必须在编译之前设置。\r\n\t * @param attribDesc 属性描述，格式是 [attributeName, location, attributeName, location ... ]\r\n\t */\r\n    //TODO:coverage\r\n    setAttributesLocation(attribDesc: any[]): void {\r\n        this._attribInfo = attribDesc;\r\n    }\r\n}\r\n\r\n","import { Shader } from \"../Shader\"\r\nimport { ShaderValue } from \"../ShaderValue\"\r\n\r\nexport class Shader2X extends Shader {\r\n    _params2dQuick2: any[]|null = null;\r\n    _shaderValueWidth: number = 0;\r\n    _shaderValueHeight: number = 0;\r\n\r\n    constructor(vs: string, ps: string, saveName: any = null, nameMap: any = null, bindAttrib: any[]|null = null) {\r\n        super(vs, ps, saveName, nameMap, bindAttrib);\r\n    }\r\n\r\n    //TODO:coverage\r\n    /**\r\n     * @override\r\n     */\r\n    protected _disposeResource(): void {\r\n        super._disposeResource();\r\n        this._params2dQuick2 = null;\r\n    }\r\n\r\n    //TODO:coverage\r\n    upload2dQuick2(shaderValue: ShaderValue): void {\r\n        this.upload(shaderValue, this._params2dQuick2 || this._make2dQuick2());\r\n    }\r\n\r\n    //去掉size的所有的uniform\r\n    _make2dQuick2(): any[] {\r\n        if (!this._params2dQuick2) {\r\n            this._params2dQuick2 = [];\r\n\r\n            var params: any[] = this._params, one: any;\r\n            for (var i: number = 0, n: number = params.length; i < n; i++) {\r\n                one = params[i];\r\n                if (one.name !== \"size\") this._params2dQuick2.push(one);\r\n            }\r\n        }\r\n        return this._params2dQuick2;\r\n    }\r\n\r\n    static create(vs: string, ps: string, saveName: any = null, nameMap: any = null, bindAttrib: any[]|null = null): Shader {\r\n        return new Shader2X(vs, ps, saveName, nameMap, bindAttrib);\r\n    }\r\n}\r\n\r\n\r\n","\timport { Texture } from \"../../../../resource/Texture\"\r\n\timport { Shader } from \"../../Shader\"\r\n\timport { ShaderValue } from \"../../ShaderValue\"\r\n\timport { Shader2D } from \"../Shader2D\"\r\n\timport { Shader2X } from \"../Shader2X\"\r\n\timport { ShaderDefines2D } from \"../ShaderDefines2D\"\r\n\timport { RenderState2D } from \"../../../utils/RenderState2D\"\r\nimport { ILaya } from \"../../../../../ILaya\";\r\n\r\n\texport class Value2D{\r\n\t\t\r\n\r\n\t\tprotected static _cache:any[]=[];\r\n\t\tprotected static _typeClass:any = [];\r\n\t\t\r\n\t\t static TEMPMAT4_ARRAY:any[]= [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n\r\n\t\tpublic static _initone(type:number, classT:any):void\r\n\t\t{\r\n\t\t\tValue2D._typeClass[type] = classT;\r\n\t\t\tValue2D._cache[type] = [];\r\n\t\t\tValue2D._cache[type]._length = 0;\r\n\t\t}\r\n\t\t\r\n\t\t static __init__():void{\r\n\t\t}\r\n\t\t\r\n\t\t defines:ShaderDefines2D = new ShaderDefines2D();\r\n\t\t\r\n\t\t size:any[] = [0, 0];\r\n\t\t\r\n\t\t alpha:number = 1.0;\t//这个目前只给setIBVB用。其他的都放到attribute的color中了\r\n\t\t mmat:any[];\t\t//worldmatrix，是4x4的，因为为了shader使用方便。 TODO 换成float32Array\r\n\t\t u_MvpMatrix:any[]; \r\n\t\t texture:any;\r\n\t\t\r\n\t\t ALPHA:number = 1.0;\t//这个？\r\n\t\t\r\n\t\t shader:Shader;\r\n\t\t mainID:number;\r\n\t\t subID:number=0;\r\n\t\t filters:any[];\r\n\t\t\r\n\t\t textureHost:Texture;\r\n\t\t//public var fillStyle:DrawStyle;\t\t\t//TODO 这个有什么用？\r\n\t\t color:any[];\r\n\t\t//public var strokeStyle:DrawStyle;\r\n\t\t colorAdd:any[];\r\n\t\t u_mmat2:any[];\r\n\t\t ref:number = 1;\r\n\t\tprotected _attribLocation:any[];\t//[name,location,name,location...] 由继承类赋值。这个最终会传给对应的shader\r\n\t\t\r\n\t\tprivate _inClassCache:any;\r\n\t\tprivate _cacheID:number = 0;\r\n\t\t clipMatDir:any[] = [ILaya.Context._MAXSIZE, 0, 0, ILaya.Context._MAXSIZE];\r\n\t\t clipMatPos:any[] = [0, 0];\r\n\t\t clipOff:any[] = [0,0];\t\t\t// 裁剪是否需要加上偏移，cacheas normal用\r\n\t\t//public var clipDir:Array = [Context._MAXSIZE, 0, 0, Context._MAXSIZE];\t\t//裁剪信息\r\n\t\t//public var clipRect:Array = [0, 0];\t\t\t\t\t\t//裁剪位置\r\n\t\t\r\n\t\tconstructor(mainID:number,subID:number){\r\n\t\t\tthis.mainID = mainID;\r\n\t\t\tthis.subID = subID;\r\n\t\t\t\r\n\t\t\tthis.textureHost = null;\r\n\t\t\tthis.texture = null;\r\n\t\t\t//this.fillStyle = null;\r\n\t\t\tthis.color = null;\r\n\t\t\t//this.strokeStyle = null;\r\n\t\t\tthis.colorAdd = null;\r\n\t\t\tthis.u_mmat2 = null;\r\n\t\t\t\r\n\t\t\tthis._cacheID = mainID|subID;\r\n\t\t\tthis._inClassCache = Value2D._cache[this._cacheID];\r\n\t\t\tif (mainID>0 && !this._inClassCache)\r\n\t\t\t{\r\n\t\t\t\tthis._inClassCache = Value2D._cache[this._cacheID] = [];\r\n\t\t\t\tthis._inClassCache._length = 0;\r\n\t\t\t}\r\n\t\t\tthis.clear();\r\n\t\t\t\r\n\t\t}\t\t\r\n\t\t\r\n\t\t setValue(value:Shader2D):void{}\r\n\t\t\t//throw new Error(\"todo in subclass\");\r\n\t\t\r\n\t\t//不知道什么意思，这个名字太难懂，反正只有submitIBVB中用到。直接把代码拷贝到哪里\r\n\t\t//public function refresh():ShaderValue\r\n\t\t\r\n\t\tprivate _ShaderWithCompile():Shader2X\r\n\t\t{\r\n\t\t\tvar ret:Shader2X =  (<Shader2X>Shader.withCompile2D(0, this.mainID, this.defines.toNameDic(), this.mainID | this.defines._value, Shader2X.create, this._attribLocation) );\r\n\t\t\t//ret.setAttributesLocation(_attribLocation); 由于上面函数的流程的修改，导致这里已经晚了\r\n\t\t\treturn ret;\r\n\t\t}\r\n\t\t\r\n\t\t upload():void{\r\n\t\t\tvar renderstate2d:any= RenderState2D;\r\n\t\t\t\r\n\t\t\t// 如果有矩阵的话，就设置 WORLDMAT 宏\r\n\t\t\tRenderState2D.worldMatrix4 === RenderState2D.TEMPMAT4_ARRAY ||  this.defines.addInt(ShaderDefines2D.WORLDMAT);\r\n\t\t\tthis.mmat = renderstate2d.worldMatrix4;\r\n\t\t\t\r\n\t\t\tif (RenderState2D.matWVP) {\r\n\t\t\t\tthis.defines.addInt(ShaderDefines2D.MVP3D);\r\n\t\t\t\tthis.u_MvpMatrix = RenderState2D.matWVP.elements;\r\n\t\t\t}\r\n\r\n\t\t\tvar sd:Shader2X = Shader.sharders[this.mainID | this.defines._value] || this._ShaderWithCompile();\r\n\t\t\t\t\r\n\t\t\tif (sd._shaderValueWidth !==  renderstate2d.width ||  sd._shaderValueHeight !== renderstate2d.height){\r\n\t\t\t\tthis.size[0] = renderstate2d.width;\r\n\t\t\t\tthis.size[1] = renderstate2d.height;\r\n\t\t\t\tsd._shaderValueWidth  = renderstate2d.width;\r\n\t\t\t\tsd._shaderValueHeight = renderstate2d.height;\r\n\t\t\t\tsd.upload((<ShaderValue>this ), null);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tsd.upload((<ShaderValue>this ), sd._params2dQuick2 || sd._make2dQuick2());\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//TODO:coverage\r\n\t\t setFilters(value:any[]):void\r\n\t\t{\r\n\t\t\tthis.filters = value;\r\n\t\t\tif (!value) \r\n\t\t\t\treturn;\r\n\t\t\t\t\r\n\t\t\tvar n:number = value.length, f:any;\r\n\t\t\tfor (var i:number = 0; i < n; i++)\r\n\t\t\t{\r\n\t\t\t\tf = value[i];\r\n\t\t\t\tif (f)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.defines.add(f.type);//搬到setValue中\r\n\t\t\t\t\tf.action.setValue(this);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t clear():void\r\n\t\t{\r\n\t\t\tthis.defines._value=this.subID;\r\n\t\t\tthis.clipOff[0] = 0;\r\n\t\t}\r\n\t\t\r\n\t\t release():void\r\n\t\t{\r\n\t\t\tif ( (--this.ref)< 1) \r\n\t\t\t{\r\n\t\t\t\tthis._inClassCache && (this._inClassCache[this._inClassCache._length++] = this);\r\n\t\t\t\t//this.fillStyle = null;\r\n\t\t\t\t//this.strokeStyle = null;\r\n\t\t\t\tthis.clear();\r\n\t\t\t\tthis.filters = null;\r\n\t\t\t\tthis.ref = 1;\r\n\t\t\t\tthis.clipOff[0] = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t static create(mainType:number,subType:number):Value2D\r\n\t\t{\r\n\t\t\tvar types:any = Value2D._cache[mainType|subType];\r\n\t\t\tif (types._length)\r\n\t\t\t\treturn types[--types._length];\r\n\t\t\telse\r\n\t\t\t\treturn new Value2D._typeClass[mainType|subType](subType);\r\n\t\t}\r\n\t}\r\n\r\n\r\n","/**\r\n\t * ...\r\n\t * @author xie\r\n\t */\r\nexport class SubmitKey {\r\n    blendShader: number;\r\n    submitType: number;\r\n    other: number;\r\n\r\n    constructor() {\r\n        this.clear();\r\n    }\r\n\r\n    clear(): void {\r\n        this.submitType = -1;\r\n        this.blendShader = this.other = 0;\r\n        //alpha = 1;\r\n    }\r\n\r\n    //TODO:coverage\r\n    copyFrom(src: SubmitKey): void {\r\n        this.other = src.other;\r\n        this.blendShader = src.blendShader;\r\n        this.submitType = src.submitType;\r\n        //alpha = src.alpha;\r\n    }\r\n\r\n    copyFrom2(src: SubmitKey, submitType: number, other: number): void {\r\n        //this.blendShader = src.blendShader;\r\n        //this.alpha = src.alpha;\t\t\t\r\n        this.other = other;\r\n        this.submitType = submitType;\r\n    }\r\n\r\n    //�Ƚ�3�����ⲿ�ṩ2��\r\n    //TODO:coverage\r\n    equal3_2(next: SubmitKey, submitType: number, other: number): boolean {\r\n        return this.submitType === submitType && this.other === other && this.blendShader === next.blendShader;// && this.alpha === alpha;\r\n    }\r\n\r\n    //ȫ�Ƚϡ��ⲿ�ṩ2��\r\n    //TODO:coverage\r\n    equal4_2(next: SubmitKey, submitType: number, other: number): boolean {\r\n        return this.submitType === submitType && this.other === other && this.blendShader === next.blendShader;// && alpha === next.alpha;\r\n    }\r\n\r\n    //�Ƚ�3��\r\n    //TODO:coverage\r\n    equal_3(next: SubmitKey): boolean {\r\n        return this.submitType === next.submitType && this.blendShader === next.blendShader;// && alpha === next.alpha;\r\n    }\r\n    //ȫ�Ƚϡ�4��\r\n    //TODO:coverage\r\n    equal(next: SubmitKey): boolean {\r\n        return this.other === next.other && this.submitType === next.submitType && this.blendShader === next.blendShader;// && alpha === next.alpha;\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { ISubmit } from \"./ISubmit\";\r\nimport { SubmitKey } from \"./SubmitKey\";\r\nexport class SubmitCMD implements ISubmit {\r\n    static POOL: any = []; fun: Function;\r\n    /**@internal */\r\n    _this: any;\r\n    args: any[];\r\n    /**@internal */\r\n    _ref: number = 1;\r\n    /**@internal */\r\n    _key: SubmitKey = new SubmitKey();\r\n\r\n    constructor() {\r\n    }\r\n\r\n    renderSubmit(): number {\r\n        this.fun.apply(this._this, this.args);\r\n        return 1;\r\n    }\r\n\r\n    getRenderType(): number {\r\n        return 0;\r\n    }\r\n\r\n    releaseRender(): void {\r\n        if ((--this._ref) < 1) {\r\n            var pool: any = SubmitCMD.POOL;\r\n            pool[pool._length++] = this;\r\n        }\r\n    }\r\n\r\n    static create(args: any[], fun: Function, thisobj: any): SubmitCMD {\r\n        var o: SubmitCMD = SubmitCMD.POOL._length ? SubmitCMD.POOL[--SubmitCMD.POOL._length] : new SubmitCMD();\r\n        o.fun = fun;\r\n        o.args = args;\r\n        o._this = thisobj;\r\n        o._ref = 1;\r\n        o._key.clear();\r\n        return o;\r\n    }\r\n}\r\n{ SubmitCMD.POOL._length = 0 }\r\n\r\n\r\n","import { IFilter } from \"./IFilter\";\r\nimport { Sprite } from \"../display/Sprite\"\r\nimport { Matrix } from \"../maths/Matrix\"\r\nimport { Point } from \"../maths/Point\"\r\nimport { Rectangle } from \"../maths/Rectangle\"\r\nimport { RenderSprite } from \"../renders/RenderSprite\"\r\nimport { Context } from \"../resource/Context\"\r\nimport { RenderTexture2D } from \"../resource/RenderTexture2D\"\r\nimport { Texture2D } from \"../resource/Texture2D\"\r\nimport { WebGLRTMgr } from \"../resource/WebGLRTMgr\"\r\nimport { BlendMode } from \"../webgl/canvas/BlendMode\"\r\nimport { ShaderDefines2D } from \"../webgl/shader/d2/ShaderDefines2D\"\r\nimport { Value2D } from \"../webgl/shader/d2/value/Value2D\"\r\nimport { SubmitCMD } from \"../webgl/submit/SubmitCMD\"\r\nimport { ColorFilter } from \"./ColorFilter\";\r\n\r\n/**\r\n * <code>Filter</code> 是滤镜基类。\r\n */\r\nexport class Filter implements IFilter {\r\n    /**@private 模糊滤镜。*/\r\n    static BLUR: number = 0x10;\r\n    /**@private 颜色滤镜。*/\r\n    static COLOR: number = 0x20;\r\n    /**@private 发光滤镜。*/\r\n    static GLOW: number = 0x08;\r\n    /** @internal*/\r\n    _glRender: any;\r\n\r\n    /**\r\n     * 创建一个 <code>Filter</code> 实例。\r\n     * */\r\n    constructor() { }\r\n\r\n    /**@private 滤镜类型。*/\r\n    get type(): number { return -1 }\r\n\r\n    static _filter = function (sprite: Sprite, context: Context, x: number, y: number): void {\r\n        var webglctx: Context = context;\r\n        var next: any = ((<RenderSprite>this))._next;\r\n        if (next) {\r\n            var filters: any[] = sprite.filters, len: number = filters.length;\r\n            //如果只有一个滤镜，那么还用原来的方式\r\n            if (len == 1 && (filters[0].type == Filter.COLOR)) {\r\n                context.save();\r\n                context.setColorFilter(filters[0]);\r\n                next._fun.call(next, sprite, context, x, y);\r\n                context.restore();\r\n                return;\r\n            }\r\n            //思路：依次遍历滤镜，每次滤镜都画到out的RenderTarget上，然后把out画取src的RenderTarget做原图，去叠加新的滤镜\r\n            var svCP: Value2D = Value2D.create(ShaderDefines2D.TEXTURE2D, 0);\t//拷贝用shaderValue\r\n            var b: Rectangle;\r\n\r\n            var p: Point = Point.TEMP;\r\n            var tMatrix: Matrix = webglctx._curMat;\r\n            var mat: Matrix = Matrix.create();\r\n            tMatrix.copyTo(mat);\r\n            var tPadding: number = 0;\t//给glow用\r\n            var tHalfPadding: number = 0;\r\n            var tIsHaveGlowFilter: boolean = false;\r\n            //这里判断是否存储了out，如果存储了直接用;\r\n            var source: RenderTexture2D = null;\r\n            var out: RenderTexture2D = sprite._cacheStyle.filterCache || null;\r\n            if (!out || sprite.getRepaint() != 0) {\r\n                tIsHaveGlowFilter = sprite._isHaveGlowFilter();\r\n                //glow需要扩展边缘\r\n                if (tIsHaveGlowFilter) {\r\n                    tPadding = 50;\r\n                    tHalfPadding = 25;\r\n                }\r\n                b = new Rectangle();\r\n                b.copyFrom(sprite.getSelfBounds());\r\n                b.x += sprite.x;\r\n                b.y += sprite.y;\r\n                b.x -= sprite.pivotX + 4;//blur \r\n                b.y -= sprite.pivotY + 4;//blur\r\n                var tSX: number = b.x;\r\n                var tSY: number = b.y;\r\n                //重新计算宽和高\r\n                b.width += (tPadding + 8);//增加宽度 blur  由于blur系数为9\r\n                b.height += (tPadding + 8);//增加高度 blur\r\n                p.x = b.x * mat.a + b.y * mat.c;\r\n                p.y = b.y * mat.d + b.x * mat.b;\r\n                b.x = p.x;\r\n                b.y = p.y;\r\n                p.x = b.width * mat.a + b.height * mat.c;\r\n                p.y = b.height * mat.d + b.width * mat.b;\r\n                b.width = p.x;\r\n                b.height = p.y;\r\n                if (b.width <= 0 || b.height <= 0) {\r\n                    return;\r\n                }\r\n                out && WebGLRTMgr.releaseRT(out);// out.recycle();\r\n                source = WebGLRTMgr.getRT(b.width, b.height);\r\n                var outRT: RenderTexture2D = out = WebGLRTMgr.getRT(b.width, b.height);\r\n                sprite._getCacheStyle().filterCache = out;\r\n                //使用RT\r\n                webglctx.pushRT();\r\n                webglctx.useRT(source);\r\n                var tX: number = sprite.x - tSX + tHalfPadding;\r\n                var tY: number = sprite.y - tSY + tHalfPadding;\r\n                //执行节点的渲染\r\n                next._fun.call(next, sprite, context, tX, tY);\r\n                webglctx.useRT(outRT);\r\n                for (var i: number = 0; i < len; i++) {\r\n                    if (i != 0) {\r\n                        //把out往src上画。这只是一个拷贝的过程，下面draw(src) to outRT 才是真正的应用filter\r\n                        //由于是延迟执行，不能直接在这里swap。 TODO 改成延迟swap\r\n                        webglctx.useRT(source);\r\n                        webglctx.drawTarget(outRT, 0, 0, b.width, b.height, Matrix.TEMP.identity(), svCP, null, BlendMode.TOINT.overlay);\r\n                        webglctx.useRT(outRT);\r\n                    }\r\n                    var fil: Filter = filters[i];\r\n                    //把src往out上画\r\n                    switch (fil.type) {\r\n                        case Filter.BLUR:\r\n                            fil._glRender && fil._glRender.render(source, context, b.width, b.height, fil);\r\n                            //BlurFilterGLRender.render(source, context, b.width, b.height, fil as BlurFilter);\r\n                            break;\r\n                        case Filter.GLOW:\r\n                            //GlowFilterGLRender.render(source, context, b.width, b.height, fil as GlowFilter);\r\n                            fil._glRender && fil._glRender.render(source, context, b.width, b.height, fil);\r\n                            break;\r\n                        case Filter.COLOR:\r\n                            webglctx.setColorFilter((<ColorFilter>fil));\r\n                            webglctx.drawTarget(source, 0, 0, b.width, b.height, Matrix.EMPTY.identity(), Value2D.create(ShaderDefines2D.TEXTURE2D, 0));\r\n                            webglctx.setColorFilter(null);\r\n                            break;\r\n                    }\r\n                }\r\n                webglctx.popRT();\r\n            } else {\r\n                tIsHaveGlowFilter = sprite._cacheStyle.hasGlowFilter || false;\r\n                if (tIsHaveGlowFilter) {\r\n                    tPadding = 50;\r\n                    tHalfPadding = 25;\r\n                }\r\n                b = sprite.getBounds();\r\n                if (b.width <= 0 || b.height <= 0) {\r\n                    return;\r\n                }\r\n                b.width += tPadding;\r\n                b.height += tPadding;\r\n                p.x = b.x * mat.a + b.y * mat.c;\r\n                p.y = b.y * mat.d + b.x * mat.b;\r\n                b.x = p.x;\r\n                b.y = p.y;\r\n                p.x = b.width * mat.a + b.height * mat.c;\r\n                p.y = b.height * mat.d + b.width * mat.b;\r\n                b.width = p.x;\r\n                b.height = p.y;\r\n                //scope.addValue(\"out\", out);\r\n            }\r\n            x = x - tHalfPadding - sprite.x;\r\n            y = y - tHalfPadding - sprite.y;\r\n            p.setTo(x, y);\r\n            mat.transformPoint(p);\r\n            x = p.x + b.x;\r\n            y = p.y + b.y;\r\n            //把最后的out纹理画出来\r\n            webglctx._drawRenderTexture(out, x, y, b.width, b.height, Matrix.TEMP.identity(), 1.0, RenderTexture2D.defuv);\r\n\r\n            //把对象放回池子中\r\n            //var submit:SubmitCMD = SubmitCMD.create([scope], Filter._recycleScope, this);\r\n            if (source) {\r\n                var submit: SubmitCMD = SubmitCMD.create([source], function (s: Texture2D): void {\r\n                    s.destroy();\r\n                }, this);\r\n                source = null;\r\n                context.addRenderObject(submit);\r\n            }\r\n            mat.destroy();\r\n        }\r\n    }\r\n}\r\n\r\n","import { Sprite } from \"../display/Sprite\"\r\nimport { Stage } from \"../display/Stage\"\r\nimport { Matrix } from \"../maths/Matrix\"\r\nimport { Point } from \"../maths/Point\"\r\nimport { Rectangle } from \"../maths/Rectangle\"\r\nimport { Texture } from \"../resource/Texture\"\r\nimport { ILaya } from \"../../ILaya\";\r\n\r\n/**\r\n * <code>Utils</code> 是工具类。\r\n */\r\nexport class Utils {\r\n    /**@private */\r\n    static gStage: Stage = null;\r\n    /**@private */\r\n    private static _gid: number = 1;\r\n    /**@private */\r\n    private static _pi: number = 180 / Math.PI;\r\n    /**@private */\r\n    private static _pi2: number = Math.PI / 180;\r\n    /**@private */\r\n    protected static _extReg: RegExp = /\\.(\\w+)\\??/g;\r\n\r\n    /**\r\n     * 角度转弧度。\r\n     * @param\tangle 角度值。\r\n     * @return\t返回弧度值。\r\n     */\r\n    static toRadian(angle: number): number {\r\n        return angle * Utils._pi2;\r\n    }\r\n\r\n    /**\r\n     * 弧度转换为角度。\r\n     * @param\tradian 弧度值。\r\n     * @return\t返回角度值。\r\n     */\r\n    static toAngle(radian: number): number {\r\n        return radian * Utils._pi;\r\n    }\r\n\r\n    /**\r\n     * 将传入的 uint 类型颜色值转换为字符串型颜色值。\r\n     * @param color 颜色值。\r\n     * @return 字符串型颜色值。\r\n     */\r\n    static toHexColor(color: number): string {\r\n        if (color < 0 || isNaN(color)) return null;\r\n        var str: string = color.toString(16);\r\n        while (str.length < 6) str = \"0\" + str;\r\n        return \"#\" + str;\r\n    }\r\n\r\n    /**获取一个全局唯一ID。*/\r\n    static getGID(): number {\r\n        return Utils._gid++;\r\n    }\r\n\r\n    /**\r\n     * 将字符串解析成 XML 对象。\r\n     * @param value 需要解析的字符串。\r\n     * @return js原生的XML对象。\r\n     */\r\n    static parseXMLFromString: Function = function (value: string): XMLDocument {\r\n        var rst: any;\r\n        value = value.replace(/>\\s+</g, '><');\r\n        rst = (new DOMParser()).parseFromString(value, 'text/xml');\r\n        if (rst.firstChild.textContent.indexOf(\"This page contains the following errors\") > -1) {\r\n            throw new Error(rst.firstChild.firstChild.textContent);\r\n        }\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * <p>连接数组。和array的concat相比，此方法不创建新对象</p>\r\n     * <b>注意：</b>若 参数 a 不为空，则会改变参数 source 的值为连接后的数组。\r\n     * @param\tsource 待连接的数组目标对象。\r\n     * @param\tarray 待连接的数组对象。\r\n     * @return 连接后的数组。\r\n     */\r\n    static concatArray(source: any[], array: any[]): any[] {\r\n        if (!array) return source;\r\n        if (!source) return array;\r\n        var i: number, len: number = array.length;\r\n        for (i = 0; i < len; i++) {\r\n            source.push(array[i]);\r\n        }\r\n        return source;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 清空数组对象。\r\n     * @param\tarray 数组。\r\n     * @return\t清空后的 array 对象。\r\n     */\r\n    static clearArray(array: any[]): any[] {\r\n        if (!array) return array;\r\n        array.length = 0;\r\n        return array;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 清空source数组，复制array数组的值。\r\n     * @param\tsource 需要赋值的数组。\r\n     * @param\tarray 新的数组值。\r\n     * @return \t复制后的数据 source 。\r\n     */\r\n    static copyArray(source: any[], array: any[]): any[] {\r\n        source || (source = []);\r\n        if (!array) return source;\r\n        source.length = array.length;\r\n        var i: number, len: number = array.length;\r\n        for (i = 0; i < len; i++) {\r\n            source[i] = array[i];\r\n        }\r\n        return source;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 根据传入的显示对象 <code>Sprite</code> 和此显示对象上的 两个点，返回此对象上的两个点在舞台坐标系上组成的最小的矩形区域对象。\r\n     * @param\tsprite 显示对象 <code>Sprite</code>。\r\n     * @param\tx0\t点一的 X 轴坐标点。\r\n     * @param\ty0\t点一的 Y 轴坐标点。\r\n     * @param\tx1\t点二的 X 轴坐标点。\r\n     * @param\ty1\t点二的 Y 轴坐标点。\r\n     * @return 两个点在舞台坐标系组成的矩形对象 <code>Rectangle</code>。\r\n     */\r\n    static getGlobalRecByPoints(sprite: Sprite, x0: number, y0: number, x1: number, y1: number): Rectangle {\r\n        var newLTPoint: Point;\r\n        newLTPoint = Point.create().setTo(x0, y0);\r\n        newLTPoint = sprite.localToGlobal(newLTPoint);\r\n        var newRBPoint: Point;\r\n        newRBPoint = Point.create().setTo(x1, y1);\r\n        newRBPoint = sprite.localToGlobal(newRBPoint);\r\n        var rst: Rectangle = Rectangle._getWrapRec([newLTPoint.x, newLTPoint.y, newRBPoint.x, newRBPoint.y]);\r\n        newLTPoint.recover();\r\n        newRBPoint.recover();\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     * 计算传入的显示对象 <code>Sprite</code> 的全局坐标系的坐标和缩放值，返回 <code>Rectangle</code> 对象存放计算出的坐标X值、Y值、ScaleX值、ScaleY值。\r\n     * @param\tsprite <code>Sprite</code> 对象。\r\n     * @return  矩形对象 <code>Rectangle</code>\r\n     */\r\n    static getGlobalPosAndScale(sprite: Sprite): Rectangle {\r\n        return Utils.getGlobalRecByPoints(sprite, 0, 0, 1, 1);\r\n    }\r\n\r\n    /**\r\n     * 给传入的函数绑定作用域，返回绑定后的函数。\r\n     * @param\tfun 函数对象。\r\n     * @param\tscope 函数作用域。\r\n     * @return 绑定后的函数。\r\n     */\r\n    static bind(fun: Function, scope: any): Function {\r\n        var rst: Function = fun;\r\n        rst = fun.bind(scope);;\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 对传入的数组列表，根据子项的属性 Z 值进行重新排序。返回是否已重新排序的 Boolean 值。\r\n     * @param\tarray 子对象数组。\r\n     * @return\tBoolean 值，表示是否已重新排序。\r\n     */\r\n    static updateOrder(array: any[]): boolean {\r\n        if (!array || array.length < 2) return false;\r\n        var i: number = 1, j: number, len: number = array.length, key: number, c: Sprite;\r\n        while (i < len) {\r\n            j = i;\r\n            c = array[j];\r\n            key = array[j]._zOrder;\r\n            while (--j > -1) {\r\n                if (array[j]._zOrder > key) array[j + 1] = array[j];\r\n                else break;\r\n            }\r\n            array[j + 1] = c;\r\n            i++;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 批量移动点坐标。\r\n     * @param points 坐标列表。\r\n     * @param x x轴偏移量。\r\n     * @param y y轴偏移量。\r\n     */\r\n    static transPointList(points: any[], x: number, y: number): void {\r\n        var i: number, len: number = points.length;\r\n        for (i = 0; i < len; i += 2) {\r\n            points[i] += x;\r\n            points[i + 1] += y;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 解析一个字符串，并返回一个整数。和JS原生的parseInt不同：如果str为空或者非数字，原生返回NaN，这里返回0。\r\n     * @param\tstr\t\t要被解析的字符串。\r\n     * @param\tradix\t表示要解析的数字的基数。默认值为0，表示10进制，其他值介于 2 ~ 36 之间。如果它以 “0x” 或 “0X” 开头，将以 16 为基数。如果该参数不在上述范围内，则此方法返回 0。\r\n     * @return\t返回解析后的数字。\r\n     */\r\n    static parseInt(str: string, radix: number = 0): number {\r\n        var result: any = parseInt(str, radix);\r\n        if (isNaN(result)) return 0;\r\n        return result;\r\n    }\r\n\r\n    /**@private */\r\n    static getFileExtension(path: string): string {\r\n        Utils._extReg.lastIndex = path.lastIndexOf(\".\");\r\n        var result: any[] = Utils._extReg.exec(path);\r\n        if (result && result.length > 1) {\r\n            return result[1].toLowerCase();\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * @private \r\n     * 为兼容平台后缀名不能用的特殊兼容TODO：\r\n     */\r\n    static getFilecompatibleExtension(path: string):string{\r\n        var result:string[] = path.split(\".\");\r\n        var resultlen:number = result.length;\r\n        if(result.length>2)\r\n        return result[resultlen-2]+\".\"+result[resultlen-1];\r\n        else\r\n        return null;\r\n\r\n    }\r\n\r\n    /**\r\n     * 获取指定区域内相对于窗口左上角的transform。\r\n     * @param\tcoordinateSpace\t坐标空间，不能是Stage引用\r\n     * @param\tx\t\t\t\t相对于coordinateSpace的x坐标\r\n     * @param\ty\t\t\t\t相对于coordinateSpace的y坐标\r\n     * @return\r\n     */\r\n    static getTransformRelativeToWindow(coordinateSpace: Sprite, x: number, y: number): any {\r\n        var stage: Stage = Utils.gStage;\r\n\r\n        // coordinateSpace的全局缩放、坐标\r\n        var globalTransform: Rectangle = Utils.getGlobalPosAndScale(coordinateSpace);\r\n        // canvas的transform矩阵\r\n        var canvasMatrix: Matrix = stage._canvasTransform.clone();\r\n        // 在矩阵变化前前记录的canvas的坐标\r\n        var canvasLeft: number = canvasMatrix.tx;\r\n        var canvasTop: number = canvasMatrix.ty;\r\n\r\n        // 把矩阵转回0度，得到正确的画布缩放比\r\n        canvasMatrix.rotate(-Math.PI / 180 * stage.canvasDegree);\r\n        // 组合画布缩放和舞台适配缩放\r\n        canvasMatrix.scale(stage.clientScaleX, stage.clientScaleY);\r\n        // 画布是否处于正常角度的垂直角度，-90或90度\r\n        var perpendicular: boolean = (stage.canvasDegree % 180 != 0);\r\n        var tx: number, ty: number;\r\n\r\n        if (perpendicular) {\r\n            // 在舞台上的坐标\r\n            tx = y + globalTransform.y;\r\n            ty = x + globalTransform.x;\r\n\r\n            // 在画布上的坐标\r\n            tx *= canvasMatrix.d;\r\n            ty *= canvasMatrix.a;\r\n\r\n            // 设置了screenMode = horizontal\r\n            if (stage.canvasDegree == 90) {\r\n                // 在浏览器窗口上的坐标\r\n                // 此时画布的left是视觉上的right，画布的left是视觉上的top\r\n                tx = canvasLeft - tx;\r\n                ty += canvasTop;\r\n            }\r\n            // screenMode = vertical并且设备在横屏状态，画布旋转-90度\r\n            else {\r\n                // 在浏览器窗口上的坐标\r\n                // 此时画布的left是视觉上的left，画布的top是视觉上的bottom\r\n                tx += canvasLeft;\r\n                ty = canvasTop - ty;\r\n            }\r\n        }\r\n        // 没有canvas旋转\r\n        else {\r\n            // 在舞台上的坐标\r\n            tx = x + globalTransform.x;\r\n            ty = y + globalTransform.y;\r\n\r\n            // 在画布上的坐标\r\n            tx *= canvasMatrix.a;\r\n            ty *= canvasMatrix.d;\r\n\r\n            // 在浏览器窗口上的坐标\r\n            tx += canvasLeft;\r\n            ty += canvasTop;\r\n        }\r\n\r\n        // Safari兼容\r\n        ty += stage['_safariOffsetY'];\r\n\r\n        // 组合画布缩放和舞台适配缩放以及显示对象缩放，得到DOM原因的缩放因子\r\n        var domScaleX: number, domScaleY: number;\r\n        if (perpendicular) {\r\n            domScaleX = canvasMatrix.d * globalTransform.height;\r\n            domScaleY = canvasMatrix.a * globalTransform.width;\r\n        } else {\r\n            domScaleX = canvasMatrix.a * globalTransform.width;\r\n            domScaleY = canvasMatrix.d * globalTransform.height;\r\n        }\r\n\r\n        return { x: tx, y: ty, scaleX: domScaleX, scaleY: domScaleY };\r\n    }\r\n\r\n    /**\r\n     * 使DOM元素使用舞台内的某块区域内。\r\n     * @param\tdom\t\t\t\tDOM元素引用\r\n     * @param\tcoordinateSpace\t坐标空间，不能是Stage引用\r\n     * @param\tx\t\t\t\t相对于coordinateSpace的x坐标\r\n     * @param\ty\t\t\t\t相对于coordinateSpace的y坐标\r\n     * @param\twidth\t\t\t宽度\r\n     * @param\theight\t\t\t高度\r\n     */\r\n    static fitDOMElementInArea(dom: any, coordinateSpace: Sprite, x: number, y: number, width: number, height: number): void {\r\n        if (!dom._fitLayaAirInitialized) {\r\n            dom._fitLayaAirInitialized = true;\r\n            dom.style.transformOrigin = dom.style.webKittransformOrigin = \"left top\";\r\n            dom.style.position = \"absolute\"\r\n        }\r\n\r\n        var transform: any = Utils.getTransformRelativeToWindow(coordinateSpace, x, y);\r\n\r\n        // 设置dom样式\r\n        dom.style.transform = dom.style.webkitTransform = \"scale(\" + transform.scaleX + \",\" + transform.scaleY + \") rotate(\" + (Utils.gStage.canvasDegree) + \"deg)\";\r\n        dom.style.width = width + 'px';\r\n        dom.style.height = height + 'px';\r\n        dom.style.left = transform.x + 'px';\r\n        dom.style.top = transform.y + 'px';\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 是否是可用的Texture数组\r\n     * @param\ttextureList\r\n     * @return\r\n     */\r\n    static isOkTextureList(textureList: any[]): boolean {\r\n        if (!textureList) return false;\r\n        var i: number, len: number = textureList.length;\r\n        var tTexture: Texture;\r\n        for (i = 0; i < len; i++) {\r\n            tTexture = textureList[i];\r\n            if (!tTexture || !tTexture._getSource()) return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 是否是可用的绘图指令数组\r\n     * @param\tcmds\r\n     * @return\r\n     */\r\n    static isOKCmdList(cmds: any[]): boolean {\r\n        //todo 改成适应新版cmd版本\r\n        if (!cmds) return false;\r\n        var i: number, len: number = cmds.length;\r\n        //var context:RenderContext = Render._context;\r\n        var cmd: any;\r\n        var tex: Texture;\r\n        for (i = 0; i < len; i++) {\r\n            cmd = cmds[i];\r\n            //switch(cmd.callee)\r\n            //{\r\n            //case context._drawTexture: \r\n            //case context._fillTexture: \r\n            //case context._drawTextureWithTransform: \r\n            //tex = cmd[0];\r\n            //if (!tex || !tex.source) return false;\r\n            //\r\n            //}\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * 获得URL参数值\r\n     * @param\tname 参数名称\r\n     * @return\t参数值\r\n     */\r\n    static getQueryString(name: string): string {\r\n        if (ILaya.Browser.onMiniGame) return null;\r\n        if (!window.location || !window.location.search)\r\n            return null;\r\n        var reg: RegExp = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\");\r\n        var r: any = window.location.search.substr(1).match(reg);\r\n        if (r != null) return unescape(r[2]);\r\n        return null;\r\n    }\r\n}\r\n\r\n","import { Utils } from \"./Utils\"\r\n\r\n/**\r\n * @private\r\n * <code>ColorUtils</code> 是一个颜色值处理类。\r\n */\r\nexport class ColorUtils {\r\n    /*[FILEINDEX:10000]*/\r\n\r\n    /**@private */\r\n    static _SAVE: any = {};\r\n    /**@private */\r\n    static _SAVE_SIZE: number = 0;\r\n    /**@private */\r\n    private static _COLOR_MAP: any = { \"purple\": \"#800080\", \"orange\": \"#ffa500\", \"white\": '#FFFFFF', \"red\": '#FF0000', \"green\": '#00FF00', \"blue\": '#0000FF', \"black\": '#000000', \"yellow\": '#FFFF00', 'gray': '#808080' };\r\n    /**@private */\r\n    private static _DEFAULT: any = ColorUtils._initDefault();\r\n    /**@private */\r\n    private static _COLODID: number = 1;\r\n\r\n    /**rgba 取值范围0-1*/\r\n    //TODO:delete？\r\n    arrColor: any[] = [];\r\n    /** 字符串型颜色值。*/\r\n    strColor: string;\r\n    /** uint 型颜色值。*/\r\n    numColor: number;\r\n    /**@internal TODO:*/\r\n    _drawStyle: any;\r\n\r\n    /**\r\n     * 根据指定的属性值，创建一个 <code>Color</code> 类的实例。\r\n     * @param\tvalue 颜色值，可以是字符串：\"#ff0000\"或者16进制颜色 0xff0000。\r\n     */\r\n    constructor(value: any) {\r\n        if (value == null || value=='none') {\r\n            this.strColor = \"#00000000\";\r\n            this.numColor = 0;\r\n            this.arrColor = [0, 0, 0, 0];\r\n            return;\r\n        }\r\n        var i: number, len: number;\r\n        var color: number;\r\n        if (typeof (value) == 'string') {\r\n            if (((<string>value)).indexOf(\"rgba(\") >= 0 || ((<string>value)).indexOf(\"rgb(\") >= 0) {\r\n                var tStr: string = <string>value;\r\n                var beginI: number, endI: number;\r\n                beginI = tStr.indexOf(\"(\");\r\n                endI = tStr.indexOf(\")\");\r\n                tStr = tStr.substring(beginI + 1, endI);\r\n                this.arrColor = tStr.split(\",\");\r\n                len = this.arrColor.length;\r\n                for (i = 0; i < len; i++) {\r\n                    this.arrColor[i] = parseFloat(this.arrColor[i]);\r\n                    if (i < 3) {\r\n                        this.arrColor[i] = Math.round(this.arrColor[i]);\r\n                    }\r\n                }\r\n                if (this.arrColor.length == 4) {\r\n                    color = ((this.arrColor[0] * 256 + this.arrColor[1]) * 256 + this.arrColor[2]) * 256 + Math.round(this.arrColor[3] * 255);\r\n                } else {\r\n                    color = ((this.arrColor[0] * 256 + this.arrColor[1]) * 256 + this.arrColor[2]);\r\n                }\r\n\r\n                this.strColor = <string>value;\r\n            } else {\r\n                this.strColor = value;\r\n                value.charAt(0) === '#' && (value = value.substr(1));\r\n                len = value.length;\r\n                if (len === 3 || len === 4) {\r\n                    var temp: string = \"\";\r\n                    for (i = 0; i < len; i++) {\r\n                        temp += (value[i] + value[i]);\r\n                    }\r\n                    value = temp;\r\n                }\r\n                color = parseInt(value, 16);\r\n            }\r\n\r\n        } else {\r\n            color = value;\r\n            this.strColor = Utils.toHexColor(color);\r\n        }\r\n\r\n        if (this.strColor.indexOf(\"rgba\") >= 0 || this.strColor.length === 9) {\r\n            //color:0xrrggbbaa numColor此时为负数\r\n            this.arrColor = [((0xFF000000 & color) >>> 24) / 255, ((0xFF0000 & color) >> 16) / 255, ((0xFF00 & color) >> 8) / 255, (0xFF & color) / 255];\r\n            this.numColor = (0xff000000 & color) >>> 24 | (color & 0xff0000) >> 8 | (color & 0x00ff00) << 8 | ((color & 0xff) << 24);//to 0xffbbggrr\r\n        } else {\r\n            this.arrColor = [((0xFF0000 & color) >> 16) / 255, ((0xFF00 & color) >> 8) / 255, (0xFF & color) / 255, 1];\r\n            this.numColor = 0xff000000 | (color & 0xff0000) >> 16 | (color & 0x00ff00) | (color & 0xff) << 16;//to 0xffbbggrr\r\n        }\r\n        ((<any>this.arrColor)).__id = ++ColorUtils._COLODID;\r\n    }\r\n\r\n    /**@private */\r\n    static _initDefault(): any {\r\n        ColorUtils._DEFAULT = {};\r\n        for (var i in ColorUtils._COLOR_MAP) ColorUtils._SAVE[i] = ColorUtils._DEFAULT[i] = new ColorUtils(ColorUtils._COLOR_MAP[i]);\r\n        return ColorUtils._DEFAULT;\r\n    }\r\n\r\n    /**@private 缓存太大，则清理缓存*/\r\n    static _initSaveMap(): void {\r\n        ColorUtils._SAVE_SIZE = 0;\r\n        ColorUtils._SAVE = {};\r\n        for (var i in ColorUtils._DEFAULT) ColorUtils._SAVE[i] = ColorUtils._DEFAULT[i];\r\n    }\r\n\r\n    /**\r\n     * 根据指定的属性值，创建并返回一个 <code>Color</code> 类的实例。\r\n     * @param\tvalue 颜色值，可以是字符串：\"#ff0000\"或者16进制颜色 0xff0000。\r\n     * @return 一个 <code>Color</code> 类的实例。\r\n     */\r\n    static create(value: any): ColorUtils {\r\n        var key: string = value + \"\";\r\n        var color: ColorUtils = ColorUtils._SAVE[key];\r\n        if (color != null) return color;\r\n        if (ColorUtils._SAVE_SIZE < 1000) ColorUtils._initSaveMap();\r\n        return ColorUtils._SAVE[key] = new ColorUtils(value);\r\n    }\r\n}\r\n\r\n","import { Filter } from \"./Filter\";\r\nimport { IFilter } from \"./IFilter\";\r\nimport { ColorUtils } from \"../utils/ColorUtils\"\r\n\r\n/**\r\n * <p><code>ColorFilter</code> 是颜色滤镜。使用 ColorFilter 类可以将 4 x 5 矩阵转换应用于输入图像上的每个像素的 RGBA 颜色和 Alpha 值，以生成具有一组新的 RGBA 颜色和 Alpha 值的结果。该类允许饱和度更改、色相旋转、亮度转 Alpha 以及各种其他效果。您可以将滤镜应用于任何显示对象（即，从 Sprite 类继承的对象）。</p>\r\n * <p>注意：对于 RGBA 值，最高有效字节代表红色通道值，其后的有效字节分别代表绿色、蓝色和 Alpha 通道值。</p>\r\n */\r\nexport class ColorFilter extends Filter implements IFilter {\r\n    /**对比度列表*/\r\n    private static DELTA_INDEX: any[] = [0, 0.01, 0.02, 0.04, 0.05, 0.06, 0.07, 0.08, 0.1, 0.11, 0.12, 0.14, 0.15, 0.16, 0.17, 0.18, 0.20, 0.21, 0.22, 0.24, 0.25, 0.27, 0.28, 0.30, 0.32, 0.34, 0.36, 0.38, 0.40, 0.42, 0.44, 0.46, 0.48, 0.5, 0.53, 0.56, 0.59, 0.62, 0.65, 0.68, 0.71, 0.74, 0.77, 0.80, 0.83, 0.86, 0.89, 0.92, 0.95, 0.98, 1.0, 1.06, 1.12, 1.18, 1.24, 1.30, 1.36, 1.42, 1.48, 1.54, 1.60, 1.66, 1.72, 1.78, 1.84, 1.90, 1.96, 2.0, 2.12, 2.25, 2.37, 2.50, 2.62, 2.75, 2.87, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.3, 4.7, 4.9, 5.0, 5.5, 6.0, 6.5, 6.8, 7.0, 7.3, 7.5, 7.8, 8.0, 8.4, 8.7, 9.0, 9.4, 9.6, 9.8, 10.0];\r\n    /**灰色矩阵*/\r\n    private static GRAY_MATRIX: any[] = [0.3086, 0.6094, 0.082, 0, 0, 0.3086, 0.6094, 0.082, 0, 0, 0.3086, 0.6094, 0.082, 0, 0, 0, 0, 0, 1, 0];\r\n    /**单位矩阵,表示什么效果都没有*/\r\n    private static IDENTITY_MATRIX: any[] = [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];\r\n    /**标准矩阵长度*/\r\n    private static LENGTH: number = 25;\r\n\r\n    /** @internal */\r\n    _mat: Float32Array;\r\n    /** @internal */\r\n    _alpha: Float32Array;\r\n    /**当前使用的矩阵*/\r\n    private _matrix: any[];\r\n\r\n    /**\r\n     * 创建一个 <code>ColorFilter</code> 实例。\r\n     * @param mat\t（可选）由 20 个项目（排列成 4 x 5 矩阵）组成的数组，用于颜色转换。\r\n     */\r\n    constructor(mat: any[] = null) {\r\n        super();\r\n        if (!mat) mat = this._copyMatrix(ColorFilter.IDENTITY_MATRIX);\r\n        this._mat = new Float32Array(16);\r\n        this._alpha = new Float32Array(4);\r\n        this.setByMatrix(mat);\r\n    }\r\n\r\n    /**\r\n     * 设置为灰色滤镜\r\n     */\r\n    gray(): ColorFilter {\r\n        return this.setByMatrix(ColorFilter.GRAY_MATRIX);\r\n    }\r\n\r\n    /**\r\n     * 设置为变色滤镜\r\n     * @param red 红色增量,范围:0~255\r\n     * @param green 绿色增量,范围:0~255\r\n     * @param blue 蓝色增量,范围:0~255\r\n     * @param alpha alpha,范围:0~1\r\n     */\r\n    color(red: number = 0, green: number = 0, blue: number = 0, alpha: number = 1): ColorFilter {\r\n        return this.setByMatrix([1, 0, 0, 0, red, 0, 1, 0, 0, green, 0, 0, 1, 0, blue, 0, 0, 0, 1, alpha]);\r\n    }\r\n\r\n    /**\r\n     * 设置滤镜色\r\n     * @param\tcolor 颜色值\r\n     */\r\n    setColor(color: string): ColorFilter {\r\n        var arr: any[] = ColorUtils.create(color).arrColor;\r\n        var mt: any[] = [0, 0, 0, 0, 256 * arr[0], 0, 0, 0, 0, 256 * arr[1], 0, 0, 0, 0, 256 * arr[2], 0, 0, 0, 1, 0];\r\n        return this.setByMatrix(mt);\r\n    }\r\n\r\n    /**\r\n     * 设置矩阵数据\r\n     * @param matrix 由 20 个项目（排列成 4 x 5 矩阵）组成的数组\r\n     * @return this\r\n     */\r\n    setByMatrix(matrix: any[]): ColorFilter {\r\n        if (this._matrix != matrix) this._copyMatrix(matrix);\r\n        var j: number = 0;\r\n        var z: number = 0;\r\n        for (var i: number = 0; i < 20; i++) {\r\n            if (i % 5 != 4) {\r\n                this._mat[j++] = matrix[i];\r\n            } else {\r\n                this._alpha[z++] = matrix[i];\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @private \r\n     * @override\r\n    */\r\n    get type(): number {\r\n        return Filter.COLOR;\r\n    }\r\n\r\n    /**\r\n     * 调整颜色，包括亮度，对比度，饱和度和色调\r\n     * @param brightness 亮度,范围:-100~100\r\n     * @param contrast 对比度,范围:-100~100\r\n     * @param saturation 饱和度,范围:-100~100\r\n     * @param hue 色调,范围:-180~180\r\n     * @return this\r\n     */\r\n    adjustColor(brightness: number, contrast: number, saturation: number, hue: number): ColorFilter {\r\n        this.adjustHue(hue);\r\n        this.adjustContrast(contrast);\r\n        this.adjustBrightness(brightness);\r\n        this.adjustSaturation(saturation);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 调整亮度\r\n     * @param brightness 亮度,范围:-100~100\r\n     * @return this\r\n     */\r\n    adjustBrightness(brightness: number): ColorFilter {\r\n        brightness = this._clampValue(brightness, 100);\r\n        if (brightness == 0 || isNaN(brightness)) return this;\r\n        return this._multiplyMatrix([1, 0, 0, 0, brightness, 0, 1, 0, 0, brightness, 0, 0, 1, 0, brightness, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\r\n    }\r\n\r\n    /**\r\n     * 调整对比度\r\n     * @param contrast 对比度,范围:-100~100\r\n     * @return this\r\n     */\r\n    adjustContrast(contrast: number): ColorFilter {\r\n        contrast = this._clampValue(contrast, 100);\r\n        if (contrast == 0 || isNaN(contrast)) return this;\r\n        var x: number;\r\n        if (contrast < 0) {\r\n            x = 127 + contrast / 100 * 127\r\n        } else {\r\n            x = contrast % 1;\r\n            if (x == 0) {\r\n                x = ColorFilter.DELTA_INDEX[contrast];\r\n            } else {\r\n                x = ColorFilter.DELTA_INDEX[(contrast << 0)] * (1 - x) + ColorFilter.DELTA_INDEX[(contrast << 0) + 1] * x;\r\n            }\r\n            x = x * 127 + 127;\r\n        }\r\n        var x1: number = x / 127;\r\n        var x2: number = (127 - x) * 0.5;\r\n        return this._multiplyMatrix([x1, 0, 0, 0, x2, 0, x1, 0, 0, x2, 0, 0, x1, 0, x2, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\r\n    }\r\n\r\n    /**\r\n     * 调整饱和度\r\n     * @param saturation 饱和度,范围:-100~100\r\n     * @return this\r\n     */\r\n    adjustSaturation(saturation: number): ColorFilter {\r\n        saturation = this._clampValue(saturation, 100);\r\n        if (saturation == 0 || isNaN(saturation)) return this;\r\n        var x: number = 1 + ((saturation > 0) ? 3 * saturation / 100 : saturation / 100);\r\n        var dx: number = 1 - x;\r\n        var r: number = 0.3086 * dx;\r\n        var g: number = 0.6094 * dx;\r\n        var b: number = 0.0820 * dx;\r\n\r\n        return this._multiplyMatrix([r + x, g, b, 0, 0, r, g + x, b, 0, 0, r, g, b + x, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\r\n    }\r\n\r\n    /**\r\n     * 调整色调\r\n     * @param hue 色调,范围:-180~180\r\n     * @return this\r\n     */\r\n    adjustHue(hue: number): ColorFilter {\r\n        hue = this._clampValue(hue, 180) / 180 * Math.PI;\r\n        if (hue == 0 || isNaN(hue)) return this;\r\n        var cos: number = Math.cos(hue);\r\n        var sin: number = Math.sin(hue);\r\n        var r: number = 0.213;\r\n        var g: number = 0.715;\r\n        var b: number = 0.072;\r\n        return this._multiplyMatrix([r + cos * (1 - r) + sin * (-r), g + cos * (-g) + sin * (-g), b + cos * (-b) + sin * (1 - b), 0, 0, r + cos * (-r) + sin * (0.143), g + cos * (1 - g) + sin * (0.140), b + cos * (-b) + sin * (-0.283), 0, 0, r + cos * (-r) + sin * (-(1 - r)), g + cos * (-g) + sin * (g), b + cos * (1 - b) + sin * (b), 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\r\n    }\r\n\r\n    /**\r\n     * 重置成单位矩阵，去除滤镜效果\r\n     */\r\n    reset(): ColorFilter {\r\n        return this.setByMatrix(this._copyMatrix(ColorFilter.IDENTITY_MATRIX));\r\n    }\r\n\r\n    /**\r\n     * 矩阵乘法\r\n     * @param matrix\r\n     * @return this\r\n     */\r\n    private _multiplyMatrix(matrix: any[]): ColorFilter {\r\n        var col: any[] = [];\r\n        this._matrix = this._fixMatrix(this._matrix);\r\n        for (var i: number = 0; i < 5; i++) {\r\n            for (var j: number = 0; j < 5; j++) {\r\n                col[j] = this._matrix[j + i * 5];\r\n            }\r\n            for (j = 0; j < 5; j++) {\r\n                var val: number = 0;\r\n                for (var k: number = 0; k < 5; k++) {\r\n                    val += matrix[j + k * 5] * col[k];\r\n                }\r\n                this._matrix[j + i * 5] = val;\r\n            }\r\n        }\r\n        return this.setByMatrix(this._matrix);\r\n    }\r\n\r\n    /**\r\n     * 规范值的范围\r\n     * @param val 当前值\r\n     * @param limit 值的范围-limit~limit\r\n     */\r\n    private _clampValue(val: number, limit: number): number {\r\n        return Math.min(limit, Math.max(-limit, val));\r\n    }\r\n\r\n    /**\r\n     * 规范矩阵,将矩阵调整到正确的大小\r\n     * @param matrix 需要调整的矩阵\r\n     */\r\n    private _fixMatrix(matrix: any[] = null): any[] {\r\n        if (matrix == null) return ColorFilter.IDENTITY_MATRIX;\r\n        if (matrix.length < ColorFilter.LENGTH) matrix = matrix.slice(0, matrix.length).concat(ColorFilter.IDENTITY_MATRIX.slice(matrix.length, ColorFilter.LENGTH));\r\n        else if (matrix.length > ColorFilter.LENGTH) matrix = matrix.slice(0, ColorFilter.LENGTH);\r\n        return matrix;\r\n    }\r\n\r\n    /**\r\n     * 复制矩阵\r\n     */\r\n    private _copyMatrix(matrix: any[]): any[] {\r\n        var len: number = ColorFilter.LENGTH;\r\n        if (!this._matrix) this._matrix = [];\r\n        for (var i: number = 0; i < len; i++) {\r\n            this._matrix[i] = matrix[i];\r\n        }\r\n        return this._matrix;\r\n    }\r\n}\r\n\r\n","import { ColorFilter } from \"../../filters/ColorFilter\"\r\nimport { Matrix } from \"../../maths/Matrix\"\r\nimport { Context } from \"../../resource/Context\"\r\nimport { Texture } from \"../../resource/Texture\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 绘制单个贴图\r\n */\r\nexport class DrawTextureCmd {\r\n    static ID: string = \"DrawTexture\";\r\n\r\n    /**\r\n     * 纹理。\r\n     */\r\n    texture: Texture|null;\r\n    /**\r\n     * （可选）X轴偏移量。\r\n     */\r\n    x: number;\r\n    /**\r\n     * （可选）Y轴偏移量。\r\n     */\r\n    y: number;\r\n    /**\r\n     * （可选）宽度。\r\n     */\r\n    width: number;\r\n    /**\r\n     * （可选）高度。\r\n     */\r\n    height: number;\r\n    /**\r\n     * （可选）矩阵信息。\r\n     */\r\n    matrix: Matrix|null;\r\n    /**\r\n     * （可选）透明度。\r\n     */\r\n    alpha: number;\r\n    /**\r\n     * （可选）颜色滤镜。\r\n     */\r\n    color: string;\r\n\r\n    colorFlt: ColorFilter|null = null;\r\n    /**\r\n     * （可选）混合模式。\r\n     */\r\n    blendMode: string;\r\n\r\n    uv: number[]|null = null;\r\n\r\n    /**@private */\r\n    static create(texture: Texture, x: number, y: number, width: number, height: number, matrix: Matrix, alpha: number, color: string, blendMode: string, uv?: number[]): DrawTextureCmd {\r\n        var cmd: DrawTextureCmd = Pool.getItemByClass(\"DrawTextureCmd\", DrawTextureCmd);\r\n        cmd.texture = texture;\r\n        texture._addReference();\r\n        cmd.x = x;\r\n        cmd.y = y;\r\n        cmd.width = width;\r\n        cmd.height = height;\r\n        cmd.matrix = matrix;\r\n        cmd.alpha = alpha;\r\n        cmd.color = color;\r\n        cmd.blendMode = blendMode;\r\n        cmd.uv = uv==undefined?null:uv;\r\n        if (color) {\r\n            cmd.colorFlt = new ColorFilter();\r\n            cmd.colorFlt.setColor(color);\r\n        }\r\n\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this.texture && this.texture._removeReference();\r\n        this.texture = null;\r\n        this.matrix = null;\r\n        Pool.recover(\"DrawTextureCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        this.texture && context.drawTextureWithTransform(this.texture, this.x, this.y, this.width, this.height, this.matrix, gx, gy, this.alpha, this.blendMode, this.colorFlt, this.uv);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return DrawTextureCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Point } from \"../../maths/Point\"\r\nimport { Context } from \"../../resource/Context\"\r\nimport { Texture } from \"../../resource/Texture\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 填充贴图\r\n */\r\nexport class FillTextureCmd {\r\n    static ID: string = \"FillTexture\";\r\n\r\n    /**\r\n     * 纹理。\r\n     */\r\n    texture: Texture;\r\n    /**\r\n     * X轴偏移量。\r\n     */\r\n    x: number;\r\n    /**\r\n     * Y轴偏移量。\r\n     */\r\n    y: number;\r\n    /**\r\n     * （可选）宽度。\r\n     */\r\n    width: number;\r\n    /**\r\n     * （可选）高度。\r\n     */\r\n    height: number;\r\n    /**\r\n     * （可选）填充类型 repeat|repeat-x|repeat-y|no-repeat\r\n     */\r\n    type: string;\r\n    /**\r\n     * （可选）贴图纹理偏移\r\n     */\r\n    offset: Point;\r\n    /**@private */\r\n    other: any;\r\n\r\n    /**@private */\r\n    static create(texture: Texture, x: number, y: number, width: number, height: number, type: string, offset: Point, other: any): FillTextureCmd {\r\n        var cmd: FillTextureCmd = Pool.getItemByClass(\"FillTextureCmd\", FillTextureCmd);\r\n        cmd.texture = texture;\r\n        cmd.x = x;\r\n        cmd.y = y;\r\n        cmd.width = width;\r\n        cmd.height = height;\r\n        cmd.type = type;\r\n        cmd.offset = offset;\r\n        cmd.other = other;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this.texture = null;\r\n        this.offset = null;\r\n        this.other = null;\r\n        Pool.recover(\"FillTextureCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context.fillTexture(this.texture, this.x + gx, this.y + gy, this.width, this.height, this.type, this.offset, this.other);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return FillTextureCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 恢复命令，和save配套使用\r\n */\r\nexport class RestoreCmd {\r\n    static ID: string = \"Restore\";\r\n\r\n\r\n\r\n    /**@private */\r\n    static create(): RestoreCmd {\r\n        var cmd: RestoreCmd = Pool.getItemByClass(\"RestoreCmd\", RestoreCmd);\r\n\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n\r\n        Pool.recover(\"RestoreCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context.restore();\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return RestoreCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 旋转命令\r\n */\r\nexport class RotateCmd {\r\n    static ID: string = \"Rotate\";\r\n\r\n    /**\r\n     * 旋转角度，以弧度计。\r\n     */\r\n    angle: number;\r\n    /**\r\n     * （可选）水平方向轴心点坐标。\r\n     */\r\n    pivotX: number;\r\n    /**\r\n     * （可选）垂直方向轴心点坐标。\r\n     */\r\n    pivotY: number;\r\n\r\n    /**@private */\r\n    static create(angle: number, pivotX: number, pivotY: number): RotateCmd {\r\n        var cmd: RotateCmd = Pool.getItemByClass(\"RotateCmd\", RotateCmd);\r\n        cmd.angle = angle;\r\n        cmd.pivotX = pivotX;\r\n        cmd.pivotY = pivotY;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n\r\n        Pool.recover(\"RotateCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context._rotate(this.angle, this.pivotX + gx, this.pivotY + gy);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return RotateCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n/**\r\n * 缩放命令\r\n */\r\nexport class ScaleCmd {\r\n    static ID: string = \"Scale\";\r\n\r\n    /**\r\n     * 水平方向缩放值。\r\n     */\r\n    scaleX: number;\r\n    /**\r\n     * 垂直方向缩放值。\r\n     */\r\n    scaleY: number;\r\n    /**\r\n     * （可选）水平方向轴心点坐标。\r\n     */\r\n    pivotX: number;\r\n    /**\r\n     * （可选）垂直方向轴心点坐标。\r\n     */\r\n    pivotY: number;\r\n\r\n    /**@private */\r\n    static create(scaleX: number, scaleY: number, pivotX: number, pivotY: number): ScaleCmd {\r\n        var cmd: ScaleCmd = Pool.getItemByClass(\"ScaleCmd\", ScaleCmd);\r\n        cmd.scaleX = scaleX;\r\n        cmd.scaleY = scaleY;\r\n        cmd.pivotX = pivotX;\r\n        cmd.pivotY = pivotY;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n\r\n        Pool.recover(\"ScaleCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context._scale(this.scaleX, this.scaleY, this.pivotX + gx, this.pivotY + gy);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return ScaleCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Matrix } from \"../../maths/Matrix\"\r\nimport { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 矩阵命令\r\n */\r\nexport class TransformCmd {\r\n    static ID: string = \"Transform\";\r\n\r\n    /**\r\n     * 矩阵。\r\n     */\r\n    matrix: Matrix;\r\n    /**\r\n     * （可选）水平方向轴心点坐标。\r\n     */\r\n    pivotX: number;\r\n    /**\r\n     * （可选）垂直方向轴心点坐标。\r\n     */\r\n    pivotY: number;\r\n\r\n    /**@private */\r\n    static create(matrix: Matrix, pivotX: number, pivotY: number): TransformCmd {\r\n        var cmd: TransformCmd = Pool.getItemByClass(\"TransformCmd\", TransformCmd);\r\n        cmd.matrix = matrix;\r\n        cmd.pivotX = pivotX;\r\n        cmd.pivotY = pivotY;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this.matrix = null;\r\n        Pool.recover(\"TransformCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context._transform(this.matrix, this.pivotX + gx, this.pivotY + gy);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return TransformCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n/**\r\n * 位移命令\r\n */\r\nexport class TranslateCmd {\r\n    static ID: string = \"Translate\";\r\n\r\n    /**\r\n     * 添加到水平坐标（x）上的值。\r\n     */\r\n    tx: number;\r\n    /**\r\n     * 添加到垂直坐标（y）上的值。\r\n     */\r\n    ty: number;\r\n\r\n    /**@private */\r\n    static create(tx: number, ty: number): TranslateCmd {\r\n        var cmd: TranslateCmd = Pool.getItemByClass(\"TranslateCmd\", TranslateCmd);\r\n        cmd.tx = tx;\r\n        cmd.ty = ty;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n\r\n        Pool.recover(\"TranslateCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context.translate(this.tx, this.ty);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return TranslateCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Point } from \"./Point\";\r\n/**\r\n\t * @private\r\n\t * 计算贝塞尔曲线的工具类。\r\n\t */\r\nexport class Bezier {\r\n\r\n    /**\r\n     * 工具类单例\r\n     */\r\n    static I: Bezier = new Bezier();\r\n    /** @private */\r\n    private _controlPoints: any[] = [new Point(), new Point(), new Point()];\r\n    /** @private */\r\n    private _calFun: Function = this.getPoint2;\r\n\r\n    /** @private */\r\n    private _switchPoint(x: number, y: number): void {\r\n        var tPoint: Point = this._controlPoints.shift();\r\n        tPoint.setTo(x, y);\r\n        this._controlPoints.push(tPoint);\r\n    }\r\n\r\n    /**\r\n     * 计算二次贝塞尔点。\r\n     */\r\n    getPoint2(t: number, rst: any[]): void {\r\n        //二次贝塞尔曲线公式\r\n        var p1: Point = this._controlPoints[0];\r\n        var p2: Point = this._controlPoints[1];\r\n        var p3: Point = this._controlPoints[2];\r\n        var lineX: number = Math.pow((1 - t), 2) * p1.x + 2 * t * (1 - t) * p2.x + Math.pow(t, 2) * p3.x;\r\n        var lineY: number = Math.pow((1 - t), 2) * p1.y + 2 * t * (1 - t) * p2.y + Math.pow(t, 2) * p3.y;\r\n        rst.push(lineX, lineY);\r\n    }\r\n\r\n    /**\r\n     * 计算三次贝塞尔点\r\n     */\r\n    getPoint3(t: number, rst: any[]): void {\r\n        //三次贝塞尔曲线公式\r\n        var p1: Point = this._controlPoints[0];\r\n        var p2: Point = this._controlPoints[1];\r\n        var p3: Point = this._controlPoints[2];\r\n        var p4: Point = this._controlPoints[3];\r\n        var lineX: number = Math.pow((1 - t), 3) * p1.x + 3 * p2.x * t * (1 - t) * (1 - t) + 3 * p3.x * t * t * (1 - t) + p4.x * Math.pow(t, 3);\r\n        var lineY: number = Math.pow((1 - t), 3) * p1.y + 3 * p2.y * t * (1 - t) * (1 - t) + 3 * p3.y * t * t * (1 - t) + p4.y * Math.pow(t, 3);\r\n        rst.push(lineX, lineY);\r\n    }\r\n\r\n    /**\r\n     * 计算贝塞尔点序列\r\n     */\r\n    insertPoints(count: number, rst: any[]): void {\r\n        var i: number;\r\n        count = count > 0 ? count : 5;\r\n        var dLen: number;\r\n        dLen = 1 / count;\r\n        for (i = 0; i <= 1; i += dLen) {\r\n            this._calFun(i, rst);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 获取贝塞尔曲线上的点。\r\n     * @param pList 控制点[x0,y0,x1,y1...]\r\n     * @param inSertCount 每次曲线的插值数量\r\n     */\r\n    getBezierPoints(pList: any[], inSertCount: number = 5, count: number = 2): any[] {\r\n        var i: number, len: number;\r\n        len = pList.length;\r\n        if (len < (count + 1) * 2) return [];\r\n        var rst: any[] = [];\r\n        switch (count) {\r\n            case 2:\r\n                this._calFun = this.getPoint2;\r\n                break;\r\n            case 3:\r\n                this._calFun = this.getPoint3;\r\n                break;\r\n            default:\r\n                return [];\r\n        }\r\n        while (this._controlPoints.length <= count) {\r\n            this._controlPoints.push(Point.create());\r\n        }\r\n        for (i = 0; i < count * 2; i += 2) {\r\n            this._switchPoint(pList[i], pList[i + 1]);\r\n        }\r\n        for (i = count * 2; i < len; i += 2) {\r\n            this._switchPoint(pList[i], pList[i + 1]);\r\n            if ((i / 2) % count == 0) this.insertPoints(inSertCount, rst);\r\n        }\r\n        return rst;\r\n    }\r\n}\r\n\r\n","import { Point } from \"./Point\";\r\nimport { Utils } from \"../utils/Utils\"\r\n\r\n/**\r\n * @private\r\n * 凸包算法。\r\n */\r\nexport class GrahamScan {\r\n\r\n    private static _mPointList: any[];\r\n    private static _tempPointList: any[] = [];\r\n    private static _temPList: any[] = [];\r\n    private static _temArr: any[] = [];\r\n\r\n    static multiply(p1: Point, p2: Point, p0: Point): number {\r\n        return ((p1.x - p0.x) * (p2.y - p0.y) - (p2.x - p0.x) * (p1.y - p0.y));\r\n    }\r\n\r\n    /**\r\n     * 计算两个点的距离。\r\n     * @param\tp1\r\n     * @param\tp2\r\n     * @return\r\n     */\r\n    static dis(p1: Point, p2: Point): number {\r\n        return (p1.x - p2.x) * (p1.x - p2.x) + (p1.y - p2.y) * (p1.y - p2.y);\r\n    }\r\n\r\n    private static _getPoints(count: number, tempUse: boolean = false, rst: any[]|null = null): any[] {\r\n        if (!GrahamScan._mPointList) GrahamScan._mPointList = [];\r\n        while (GrahamScan._mPointList.length < count) GrahamScan._mPointList.push(new Point());\r\n        if (!rst) rst = [];\r\n        rst.length = 0;\r\n        if (tempUse) {\r\n            //\t\t\t\trst=_mPointList.slice(0,count);\r\n            GrahamScan.getFrom(rst, GrahamScan._mPointList, count);\r\n        } else {\r\n            //\t\t\t\trst=_mPointList.splice(0,count);\r\n            GrahamScan.getFromR(rst, GrahamScan._mPointList, count);\r\n        }\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     * 将数组 src 从索引0位置 依次取 cout 个项添加至 tst 数组的尾部。\r\n     * @param\trst 原始数组，用于添加新的子元素。\r\n     * @param\tsrc 用于取子元素的数组。\r\n     * @param\tcount 需要取得子元素个数。\r\n     * @return 添加完子元素的 rst 对象。\r\n     */\r\n    static getFrom(rst: any[], src: any[], count: number): any[] {\r\n        var i: number;\r\n        for (i = 0; i < count; i++) {\r\n            rst.push(src[i]);\r\n        }\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     * 将数组 src 从末尾索引位置往头部索引位置方向 依次取 cout 个项添加至 tst 数组的尾部。\r\n     * @param\trst 原始数组，用于添加新的子元素。\r\n     * @param\tsrc 用于取子元素的数组。\r\n     * @param\tcount 需要取得子元素个数。\r\n     * @return 添加完子元素的 rst 对象。\r\n     */\r\n    static getFromR(rst: any[], src: any[], count: number): any[] {\r\n        var i: number;\r\n        for (i = 0; i < count; i++) {\r\n            rst.push(src.pop());\r\n        }\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     *  [x,y...]列表 转 Point列表\r\n     * @param pList Point列表\r\n     * @return [x,y...]列表\r\n     */\r\n    static pListToPointList(pList: any[], tempUse: boolean = false): any[] {\r\n        var i: number, len: number = pList.length / 2, rst: any[] = GrahamScan._getPoints(len, tempUse, GrahamScan._tempPointList);\r\n        for (i = 0; i < len; i++) {\r\n            rst[i].setTo(pList[i + i], pList[i + i + 1]);\r\n        }\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     * Point列表转[x,y...]列表\r\n     * @param pointList Point列表\r\n     * @return [x,y...]列表\r\n     */\r\n    static pointListToPlist(pointList: any[]): any[] {\r\n        var i: number, len: number = pointList.length, rst: any[] = GrahamScan._temPList, tPoint: Point;\r\n        rst.length = 0;\r\n        for (i = 0; i < len; i++) {\r\n            tPoint = pointList[i];\r\n            rst.push(tPoint.x, tPoint.y);\r\n        }\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     *  寻找包括所有点的最小多边形顶点集合\r\n     * @param pList 形如[x0,y0,x1,y1...]的点列表\r\n     * @return  最小多边形顶点集合\r\n     */\r\n    static scanPList(pList: any[]): any[] {\r\n        return Utils.copyArray(pList, GrahamScan.pointListToPlist(GrahamScan.scan(GrahamScan.pListToPointList(pList, true))));\r\n    }\r\n\r\n    /**\r\n     * 寻找包括所有点的最小多边形顶点集合\r\n     * @param PointSet Point列表\r\n     * @return 最小多边形顶点集合\r\n     */\r\n    static scan(PointSet: any[]): any[] {\r\n        var i: number, j: number, k: number = 0, top: number = 2, tmp: Point, n: number = PointSet.length, ch: any[];\r\n        var _tmpDic: any = {};\r\n        var key: string;\r\n        ch = GrahamScan._temArr;\r\n        ch.length = 0;\r\n        n = PointSet.length;\r\n        for (i = n - 1; i >= 0; i--) {\r\n            tmp = PointSet[i];\r\n            key = tmp.x + \"_\" + tmp.y;\r\n            if (!(key in _tmpDic)) {\r\n                _tmpDic[key] = true;\r\n                ch.push(tmp);\r\n            }\r\n        }\r\n        n = ch.length;\r\n        Utils.copyArray(PointSet, ch);\r\n        //\t\t\tPointSet=ch;\r\n        //\t\t\tn=PointSet.length;\r\n        //找到最下且偏左的那个点  \r\n        for (i = 1; i < n; i++)\r\n            if ((PointSet[i].y < PointSet[k].y) || ((PointSet[i].y == PointSet[k].y) && (PointSet[i].x < PointSet[k].x)))\r\n                k = i;\r\n        //将这个点指定为PointSet[0]  \r\n        tmp = PointSet[0];\r\n        PointSet[0] = PointSet[k];\r\n        PointSet[k] = tmp;\r\n        //按极角从小到大,距离偏短进行排序  \r\n        for (i = 1; i < n - 1; i++) {\r\n            k = i;\r\n            for (j = i + 1; j < n; j++)\r\n                if ((GrahamScan.multiply(PointSet[j], PointSet[k], PointSet[0]) > 0) || ((GrahamScan.multiply(PointSet[j], PointSet[k], PointSet[0]) == 0) && (GrahamScan.dis(PointSet[0], PointSet[j]) < GrahamScan.dis(PointSet[0], PointSet[k]))))\r\n                    k = j;//k保存极角最小的那个点,或者相同距离原点最近  \r\n            tmp = PointSet[i];\r\n            PointSet[i] = PointSet[k];\r\n            PointSet[k] = tmp;\r\n        }\r\n        //第三个点先入栈  \r\n        ch = GrahamScan._temArr;\r\n        ch.length = 0;\r\n        //trace(\"scan:\",PointSet[0],PointSet[1],PointSet[2]);\r\n        if (PointSet.length < 3) {\r\n            return Utils.copyArray(ch, PointSet);\r\n        }\r\n        ch.push(PointSet[0], PointSet[1], PointSet[2]);\r\n        //ch=[PointSet[0],PointSet[1],PointSet[2]];\r\n        //判断与其余所有点的关系  \r\n        for (i = 3; i < n; i++) {\r\n            //不满足向左转的关系,栈顶元素出栈  \r\n            while (ch.length >= 2 && GrahamScan.multiply(PointSet[i], ch[ch.length - 1], ch[ch.length - 2]) >= 0) ch.pop();\r\n            //当前点与栈内所有点满足向左关系,因此入栈.  \r\n            PointSet[i] && ch.push(PointSet[i]);\r\n        }\r\n        return ch;\r\n    }\r\n\r\n}\r\n\r\n","import { ColorUtils } from \"../../utils/ColorUtils\"\r\n\r\nexport class DrawStyle {\r\n    static DEFAULT: DrawStyle = new DrawStyle(\"#000000\")\r\n\r\n    _color: ColorUtils;\r\n\r\n    static create(value: any): DrawStyle {\r\n        if (value) {\r\n            var color: ColorUtils = (value instanceof ColorUtils) ? ((<ColorUtils>value)) : ColorUtils.create(value);\r\n            return color._drawStyle || (color._drawStyle = new DrawStyle(value));\r\n        }\r\n        return DrawStyle.DEFAULT;\r\n    }\r\n\r\n    constructor(value: any) {\r\n        this.setValue(value);\r\n    }\r\n\r\n    setValue(value: any): void {\r\n        if (value) {\r\n            this._color = (value instanceof ColorUtils) ? ((<ColorUtils>value)) : ColorUtils.create(value);\r\n        }\r\n        else this._color = ColorUtils.create(\"#000000\");\r\n    }\r\n\r\n    reset(): void {\r\n        this._color = ColorUtils.create(\"#000000\");\r\n    }\r\n\r\n    toInt(): number {\r\n        return this._color.numColor;\r\n    }\r\n\r\n    equal(value: any): boolean {\r\n        if (typeof (value) == 'string') return this._color.strColor === (<string>value);\r\n        if (value instanceof ColorUtils) return this._color.numColor === ((<ColorUtils>value)).numColor;\r\n        return false;\r\n    }\r\n\r\n    toColorStr(): string {\r\n        return this._color.strColor;\r\n    }\r\n}\r\n\r\n\r\n","\r\nexport class Path {\r\n\r\n    //public var _rect:Rectangle;\r\n    /**@internal */\r\n    _lastOriX: number = 0;\t//moveto等的原始位置。没有经过内部矩阵变换的\r\n    /**@internal */\r\n    _lastOriY: number = 0;\r\n    paths: any[] = [];\t//所有的路径。{@type renderPath[] }\r\n    private _curPath: renderPath = null;\r\n\r\n\r\n    constructor() {\r\n    }\r\n\r\n    beginPath(convex: boolean): void {\r\n        this.paths.length = 1;\r\n        this._curPath = this.paths[0] = new renderPath();\r\n        this._curPath.convex = convex;\r\n        //_curPath.path = [];\r\n    }\r\n\r\n    closePath(): void {\r\n        this._curPath.loop = true;\r\n    }\r\n\r\n    newPath(): void {\r\n        this._curPath = new renderPath();\r\n        this.paths.push(this._curPath);\r\n    }\r\n\r\n    addPoint(pointX: number, pointY: number): void {\r\n        //tempArray.push(pointX, pointY);\r\n        this._curPath.path.push(pointX, pointY);\r\n    }\r\n\r\n    //直接添加一个完整的path\r\n    push(points: any[], convex: boolean): void {\r\n        if (!this._curPath) {\r\n            this._curPath = new renderPath();\r\n            this.paths.push(this._curPath);\r\n        } else if (this._curPath.path.length > 0) {\r\n            this._curPath = new renderPath();\r\n            this.paths.push(this._curPath);\r\n        }\r\n        var rp: renderPath = this._curPath;\r\n        rp.path = points.slice();//TODO 这个可能多次slice了\r\n        rp.convex = convex;\r\n    }\r\n\r\n    reset(): void {\r\n        this.paths.length = 0;//TODO 复用\r\n    }\r\n}\r\n\r\n\r\n\r\nclass renderPath {\r\n    path: any[] = []; //[x,y,x,y,....]的数组\r\n    loop: boolean = false;\r\n    convex: boolean = false;\r\n}\r\n","import { ISubmit } from \"./ISubmit\";\r\nimport { SubmitKey } from \"./SubmitKey\";\r\nimport { Value2D } from \"../shader/d2/value/Value2D\"\r\nimport { Mesh2D } from \"../utils/Mesh2D\"\r\n\r\nexport class SubmitBase implements ISubmit {\r\n\r\n    static TYPE_2D: number = 10000;\r\n    static TYPE_CANVAS: number = 10003;\r\n    static TYPE_CMDSETRT: number = 10004;\r\n    static TYPE_CUSTOM: number = 10005;\r\n    static TYPE_BLURRT: number = 10006;\r\n    static TYPE_CMDDESTORYPRERT: number = 10007;\r\n    static TYPE_DISABLESTENCIL: number = 10008;\r\n    static TYPE_OTHERIBVB: number = 10009;\r\n    static TYPE_PRIMITIVE: number = 10010;\r\n    static TYPE_RT: number = 10011;\r\n    static TYPE_BLUR_RT: number = 10012;\r\n    static TYPE_TARGET: number = 10013;\r\n    static TYPE_CHANGE_VALUE: number = 10014;\r\n    static TYPE_SHAPE: number = 10015;\r\n    static TYPE_TEXTURE: number = 10016;\r\n    static TYPE_FILLTEXTURE: number = 10017;\r\n\r\n    static KEY_ONCE: number = -1;\r\n    static KEY_FILLRECT: number = 1;\r\n    static KEY_DRAWTEXTURE: number = 2;\r\n    static KEY_VG: number = 3;\r\n    static KEY_TRIANGLES: number = 4;\r\n\r\n    static RENDERBASE: SubmitBase;\r\n    static ID: number = 1;\r\n    static preRender: ISubmit = null;\t//上一个submit，主要用来比较key,以减少uniform的重复提交。\r\n\r\n    clipInfoID: number = -1;\t//用来比较clipinfo\r\n    /**@internal */\r\n    _mesh: Mesh2D = null;\t\t\t//代替 _vb,_ib\r\n    /**@internal */\r\n    _blendFn: Function = null;\r\n    protected _id: number = 0;\r\n    /**@internal */\r\n    _renderType: number = 0;\r\n    /**@internal */\r\n    _parent: ISubmit = null;\r\n    //渲染key，通过key判断是否是同一个\r\n    /**@internal */\r\n    _key: SubmitKey = new SubmitKey();\r\n\r\n    // 从VB中什么地方开始画，画到哪\r\n    /**@internal */\r\n    _startIdx: number = 0;\t\t//indexbuffer 的偏移，单位是byte\r\n    /**@internal */\r\n    _numEle: number = 0;\r\n    /**@internal */\r\n    _ref: number = 1;\t// 其实已经没有用了\r\n\r\n    shaderValue: Value2D = null;\r\n\r\n    static __init__(): void {\r\n        var s: SubmitBase = SubmitBase.RENDERBASE = new SubmitBase(-1);\r\n        s.shaderValue = new Value2D(0, 0);\r\n        s.shaderValue.ALPHA = 1;\r\n        s._ref = 0xFFFFFFFF;\r\n    }\r\n\r\n    constructor(renderType: number = SubmitBase.TYPE_2D) {\r\n        this._renderType = renderType;\r\n        this._id = ++SubmitBase.ID;\r\n    }\r\n\r\n    getID(): number {\r\n        return this._id;\r\n    }\r\n\r\n\r\n    getRenderType(): number {\r\n        return this._renderType;\r\n    }\r\n\r\n    toString(): string {\r\n        return \"ibindex:\" + this._startIdx + \" num:\" + this._numEle + \" key=\" + this._key;\r\n    }\r\n\r\n    renderSubmit(): number { return 1; }\r\n    releaseRender(): void { }\r\n}\r\n\r\n\r\n","import { ISaveData } from \"./ISaveData\";\r\nimport { Context } from \"../../../resource/Context\"\r\nimport { SubmitBase } from \"../../submit/SubmitBase\"\r\n\r\nexport class SaveBase implements ISaveData {\r\n\r\n    /*[FILEINDEX:1]*/\r\n    /*[DISBALEOUTCONST-BEGIN]*/\r\n    static TYPE_ALPHA: number = 0x1;\r\n    static TYPE_FILESTYLE: number = 0x2;\r\n    static TYPE_FONT: number = 0x8;\r\n    static TYPE_LINEWIDTH: number = 0x100;\r\n    static TYPE_STROKESTYLE: number = 0x200;\r\n    static TYPE_MARK: number = 0x400;\r\n    static TYPE_TRANSFORM: number = 0x800;\r\n    static TYPE_TRANSLATE: number = 0x1000;\r\n    static TYPE_ENABLEMERGE: number = 0x2000;\r\n\r\n    static TYPE_TEXTBASELINE: number = 0x4000;\r\n    static TYPE_TEXTALIGN: number = 0x8000;\r\n    static TYPE_GLOBALCOMPOSITEOPERATION: number = 0x10000;\r\n    static TYPE_CLIPRECT: number = 0x20000;\r\n    static TYPE_CLIPRECT_STENCIL: number = 0x40000;\r\n    static TYPE_IBVB: number = 0x80000;\r\n    static TYPE_SHADER: number = 0x100000;\r\n    static TYPE_FILTERS: number = 0x200000;\r\n    static TYPE_FILTERS_TYPE: number = 0x400000;\r\n    static TYPE_COLORFILTER: number = 0x800000;\r\n    /*[DISBALEOUTCONST-END]*/\r\n    private static POOL: any = SaveBase._createArray();\r\n    private static _namemap: any = SaveBase._init();\r\n    /**@internal */\r\n    static _createArray(): any[] {\r\n        var value: any = [];\r\n        value._length = 0;\r\n        return value;\r\n    }\r\n    /**@internal */\r\n    static _init(): any {\r\n        var namemap: any = SaveBase._namemap = {};\r\n\r\n        namemap[SaveBase.TYPE_ALPHA] = \"ALPHA\";\r\n        namemap[SaveBase.TYPE_FILESTYLE] = \"fillStyle\";\r\n        namemap[SaveBase.TYPE_FONT] = \"font\";\r\n        namemap[SaveBase.TYPE_LINEWIDTH] = \"lineWidth\";\r\n        namemap[SaveBase.TYPE_STROKESTYLE] = \"strokeStyle\";\r\n\r\n        namemap[SaveBase.TYPE_ENABLEMERGE] = \"_mergeID\";\r\n\r\n        namemap[SaveBase.TYPE_MARK] = namemap[SaveBase.TYPE_TRANSFORM] = namemap[SaveBase.TYPE_TRANSLATE] = [];\r\n\r\n        namemap[SaveBase.TYPE_TEXTBASELINE] = \"textBaseline\";\r\n        namemap[SaveBase.TYPE_TEXTALIGN] = \"textAlign\";\r\n        namemap[SaveBase.TYPE_GLOBALCOMPOSITEOPERATION] = \"_nBlendType\";\r\n        namemap[SaveBase.TYPE_SHADER] = \"shader\";\r\n        namemap[SaveBase.TYPE_FILTERS] = \"filters\";\r\n        namemap[SaveBase.TYPE_COLORFILTER] = '_colorFiler';\r\n        return namemap;\r\n    }\r\n\r\n    private _valueName: string;\r\n    private _value: any;\r\n    private _dataObj: any;\r\n    private _newSubmit: boolean;\r\n\r\n    constructor() {\r\n    }\r\n\r\n    isSaveMark(): boolean { return false; }\r\n\r\n    restore(context: Context): void {\r\n        this._dataObj[this._valueName] = this._value;\r\n        SaveBase.POOL[SaveBase.POOL._length++] = this;\r\n        this._newSubmit && (context._curSubmit = SubmitBase.RENDERBASE);\r\n    }\r\n\r\n    static save(context: Context, type: number, dataObj: any, newSubmit: boolean): void {\r\n        if ((context._saveMark._saveuse & type) !== type) {\r\n            context._saveMark._saveuse |= type;\r\n            var cache: any = SaveBase.POOL;\r\n            var o: any = cache._length > 0 ? cache[--cache._length] : (new SaveBase());\r\n            o._value = dataObj[o._valueName = SaveBase._namemap[type]];\r\n            o._dataObj = dataObj;\r\n            o._newSubmit = newSubmit;\r\n            var _save: any = context._save;\r\n            _save[_save._length++] = o;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n","import { ISaveData } from \"./ISaveData\";\r\nimport { SaveBase } from \"./SaveBase\";\r\nimport { Matrix } from \"../../../maths/Matrix\"\r\nimport { Rectangle } from \"../../../maths/Rectangle\"\r\nimport { Context } from \"../../../resource/Context\"\r\n\r\nexport class SaveClipRect implements ISaveData {\r\n\r\n\r\n    private static POOL: any = SaveBase._createArray();\r\n\r\n    //public var _clipSaveRect:Rectangle;\r\n    //private var _transedClipInfo:Array = new Array(6);\r\n    private _globalClipMatrix: Matrix = new Matrix();\r\n    private _clipInfoID: number = -1;\r\n    /**@internal */\r\n    _clipRect: Rectangle = new Rectangle();\r\n    incache: boolean = false;\r\n\r\n    isSaveMark(): boolean { return false; }\r\n\r\n    restore(context: Context): void {\r\n        /*\r\n        context._transedClipInfo[0] = _transedClipInfo[0];\r\n        context._transedClipInfo[1] = _transedClipInfo[1];\r\n        context._transedClipInfo[2] = _transedClipInfo[2];\r\n        context._transedClipInfo[3] = _transedClipInfo[3];\r\n        context._transedClipInfo[4] = _transedClipInfo[4];\r\n        context._transedClipInfo[5] = _transedClipInfo[5];\r\n        */\r\n        this._globalClipMatrix.copyTo(context._globalClipMatrix);\r\n        this._clipRect.clone(context._clipRect);\r\n        context._clipInfoID = this._clipInfoID;\r\n        //context._clipTransed = false;\t//ֱ�����¼���\r\n        SaveClipRect.POOL[SaveClipRect.POOL._length++] = this;\r\n        context._clipInCache = this.incache;\r\n        /*\r\n        context._clipRect = _clipSaveRect;\r\n        context._curSubmit = context._submits[context._submits._length++] = SubmitBase.RENDERBASE;\r\n        context._submitKey.submitType=-1;\r\n        */\r\n    }\r\n\r\n    static save(context: Context): void {\r\n        if ((context._saveMark._saveuse & SaveBase.TYPE_CLIPRECT) == SaveBase.TYPE_CLIPRECT) return;\r\n        context._saveMark._saveuse |= SaveBase.TYPE_CLIPRECT;\r\n        var cache: any = SaveClipRect.POOL;\r\n        var o: SaveClipRect = cache._length > 0 ? cache[--cache._length] : (new SaveClipRect());\r\n        //o._clipSaveRect = context._clipRect;\r\n        //context._clipRect = o._clipRect.copyFrom(context._clipRect);\r\n        //o._submitScissor = submitScissor;\r\n        context._globalClipMatrix.copyTo(o._globalClipMatrix);\r\n        /*\r\n        o._transedClipInfo[0] = context._transedClipInfo[0];\r\n        o._transedClipInfo[1] = context._transedClipInfo[1];\r\n        o._transedClipInfo[2] = context._transedClipInfo[2];\r\n        o._transedClipInfo[3] = context._transedClipInfo[3];\r\n        o._transedClipInfo[4] = context._transedClipInfo[4];\r\n        o._transedClipInfo[5] = context._transedClipInfo[5];\r\n        */\r\n        context._clipRect.clone(o._clipRect);\r\n        o._clipInfoID = context._clipInfoID;\r\n        o.incache = context._clipInCache;\r\n        var _save: any = context._save;\r\n        _save[_save._length++] = o;\r\n    }\r\n}\r\n\r\n","import { Context } from \"../../../resource/Context\";\r\nimport { ISaveData } from \"./ISaveData\";\r\nimport { SaveBase } from \"./SaveBase\";\r\n\r\nexport class SaveMark implements ISaveData {\r\n\r\n    private static POOL: any = SaveBase._createArray();\r\n    /**@internal */\r\n    _saveuse: number = 0;\r\n    /**@internal */\r\n    _preSaveMark: SaveMark;\r\n\r\n    constructor() {\r\n    }\r\n\r\n    isSaveMark(): boolean {\r\n        return true;\r\n    }\r\n\r\n    restore(context: Context): void {\r\n        context._saveMark = this._preSaveMark;\r\n        SaveMark.POOL[SaveMark.POOL._length++] = this;\r\n    }\r\n\r\n    static Create(context: Context): SaveMark {\r\n        var no: any = SaveMark.POOL;\r\n        var o: SaveMark = no._length > 0 ? no[--no._length] : (new SaveMark());\r\n        o._saveuse = 0;\r\n        o._preSaveMark = context._saveMark;\r\n        context._saveMark = o;\r\n        return o;\r\n    }\r\n}\r\n\r\n","import { ISaveData } from \"./ISaveData\";\r\nimport { SaveBase } from \"./SaveBase\";\r\nimport { Matrix } from \"../../../maths/Matrix\"\r\nimport { Context } from \"../../../resource/Context\"\r\n\r\nexport class SaveTransform implements ISaveData {\r\n\r\n\r\n    private static POOL: any = SaveBase._createArray();\r\n    /**@internal */\r\n    _savematrix: Matrix;\r\n    /**@internal */\r\n    _matrix: Matrix = new Matrix();\r\n\r\n    constructor() {\r\n    }\r\n\r\n    isSaveMark(): boolean { return false; }\r\n\r\n    restore(context: Context): void {\r\n        context._curMat = this._savematrix;\r\n        SaveTransform.POOL[SaveTransform.POOL._length++] = this;\r\n    }\r\n\r\n    static save(context: Context): void {\r\n        var _saveMark: any = context._saveMark;\r\n        if ((_saveMark._saveuse & SaveBase.TYPE_TRANSFORM) === SaveBase.TYPE_TRANSFORM) return;\r\n        _saveMark._saveuse |= SaveBase.TYPE_TRANSFORM;\r\n        var no: any = SaveTransform.POOL;\r\n        var o: SaveTransform = no._length > 0 ? no[--no._length] : (new SaveTransform());\r\n        o._savematrix = context._curMat;\r\n        context._curMat = context._curMat.copyTo(o._matrix);\r\n        var _save: any = context._save;\r\n        _save[_save._length++] = o;\r\n    }\r\n}\r\n\r\n","import { ISaveData } from \"./ISaveData\";\r\nimport { SaveBase } from \"./SaveBase\";\r\nimport { Matrix } from \"../../../maths/Matrix\"\r\nimport { Context } from \"../../../resource/Context\"\r\n\r\nexport class SaveTranslate implements ISaveData {\r\n\r\n\r\n    private static POOL: any = SaveBase._createArray();\r\n    /**@internal */\r\n    _mat: Matrix = new Matrix();\r\n    isSaveMark(): boolean { return false; }\r\n\r\n    restore(context: Context): void {\r\n        this._mat.copyTo(context._curMat);\r\n        SaveTranslate.POOL[SaveTranslate.POOL._length++] = this;\r\n    }\r\n\r\n    static save(context: Context): void {\r\n        var no: any = SaveTranslate.POOL;\r\n        var o: SaveTranslate = no._length > 0 ? no[--no._length] : (new SaveTranslate());\r\n        context._curMat.copyTo(o._mat);\r\n        var _save: any = context._save;\r\n        _save[_save._length++] = o;\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { LayaGL } from \"../layagl/LayaGL\"\r\nimport { Buffer } from \"./utils/Buffer\"\r\n\r\n/**\r\n * ...\r\n * @author ...\r\n */\r\nexport class BufferStateBase {\r\n    /**@internal [只读]*/\r\n    static _curBindedBufferState: BufferStateBase;\r\n\r\n    /**@private [只读]*/\r\n    private _nativeVertexArrayObject: any;\r\n\r\n    /**@internal [只读]*/\r\n    _bindedIndexBuffer: Buffer;\r\n\r\n    constructor() {\r\n        this._nativeVertexArrayObject = LayaGL.layaGPUInstance.createVertexArray();\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    bind(): void {\r\n        if (BufferStateBase._curBindedBufferState !== this) {\r\n            LayaGL.layaGPUInstance.bindVertexArray(this._nativeVertexArrayObject);\r\n            BufferStateBase._curBindedBufferState = this;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    unBind(): void {\r\n        if (BufferStateBase._curBindedBufferState === this) {\r\n            LayaGL.layaGPUInstance.bindVertexArray(null);\r\n            BufferStateBase._curBindedBufferState = null;\r\n        } else {\r\n            throw \"BufferState: must call bind() function first.\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    destroy(): void {\r\n        LayaGL.layaGPUInstance.deleteVertexArray(this._nativeVertexArrayObject);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    bindForNative(): void {\r\n        (<any>LayaGL.instance).bindVertexArray(this._nativeVertexArrayObject);\r\n        BufferStateBase._curBindedBufferState = this;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    unBindForNative(): void {\r\n        (<any>LayaGL.instance).bindVertexArray(null);\r\n        BufferStateBase._curBindedBufferState = null;\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { BufferStateBase } from \"./BufferStateBase\";\r\n/**\r\n\t * ...\r\n\t * @author ...\r\n\t */\r\nexport class BufferState2D extends BufferStateBase {\r\n\r\n    constructor() {\r\n        super();\r\n\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { LayaGL } from \"../../layagl/LayaGL\"\r\n\r\nexport class Buffer {\r\n\tstatic _bindedVertexBuffer: any;\t//当前gl绑定的VertexBuffer\r\n\tstatic _bindedIndexBuffer: any;\t\t//当前gl绑定的indexBuffer\r\n\r\n\tprotected _glBuffer: any;\r\n\tprotected _buffer: any;//可能为Float32Array、Uint16Array、Uint8Array、ArrayBuffer等。\r\n\r\n\tprotected _bufferType: number;\r\n\tprotected _bufferUsage: number;\r\n\r\n\t_byteLength: number = 0;\r\n\r\n\tget bufferUsage(): number {\r\n\t\treturn this._bufferUsage;\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tthis._glBuffer = LayaGL.instance.createBuffer()\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t * 绕过全局状态判断,例如VAO局部状态设置\r\n\t */\r\n\t_bindForVAO(): void {\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tbind(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tdestroy(): void {\r\n\t\tif (this._glBuffer) {\r\n\t\t\tLayaGL.instance.deleteBuffer(this._glBuffer);\r\n\t\t\tthis._glBuffer = null;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n","/**\r\n\t * \r\n\t * @author laya\r\n\t */\r\nexport class RenderInfo {\r\n    static loopStTm: number = 0;// 当前帧的开始时间\r\n    static loopCount: number = 0;//\r\n}\r\n\r\n\r\n","import { LayaGL } from \"../../layagl/LayaGL\";\r\nimport { RenderInfo } from \"../../renders/RenderInfo\";\r\nimport { BaseShader } from \"../shader/BaseShader\";\r\nimport { WebGLContext } from \"../WebGLContext\";\r\nimport { Buffer } from \"./Buffer\";\r\n\r\nexport class Buffer2D extends Buffer {\r\n\r\n\tstatic FLOAT32: number = 4;\r\n\tstatic SHORT: number = 2;\r\n\r\n\tstatic __int__(gl: WebGLContext): void {\r\n\t}\r\n\r\n\tprotected _maxsize: number = 0;\r\n\r\n\t_upload: boolean = true;\r\n\tprotected _uploadSize: number = 0;\r\n\tprotected _bufferSize: number = 0;\r\n\tprotected _u8Array: Uint8Array = null;\t\t//反正常常要拷贝老的数据，所以保留这个可以提高效率\r\n\r\n\tget bufferLength(): number {\r\n\t\treturn this._buffer.byteLength;\r\n\t}\r\n\r\n\tset byteLength(value: number) {\r\n\t\tthis.setByteLength(value);\r\n\t}\r\n\r\n\tsetByteLength(value: number): void {\r\n\t\tif (this._byteLength !== value) {\r\n\t\t\tvalue <= this._bufferSize || (this._resizeBuffer(value * 2 + 256, true));\r\n\t\t\tthis._byteLength = value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 在当前的基础上需要多大空间，单位是byte\r\n\t * @param\tsz\r\n\t * @return  增加大小之前的写位置。单位是byte\r\n\t */\r\n\tneedSize(sz: number): number {\r\n\t\tvar old: number = this._byteLength;\r\n\t\tif (sz) {\r\n\t\t\tvar needsz: number = this._byteLength + sz;\r\n\t\t\tneedsz <= this._bufferSize || (this._resizeBuffer(needsz << 1, true));\r\n\t\t\tthis._byteLength = needsz;\r\n\t\t}\r\n\t\treturn old;\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tprotected _bufferData(): void {\r\n\t\tthis._maxsize = Math.max(this._maxsize, this._byteLength);\r\n\t\tif (RenderInfo.loopCount % 30 == 0) {//每30帧缩小一下buffer\t。TODO 这个有问题。不知道_maxsize和_byteLength是怎么维护的，这里会导致重新分配64字节\r\n\t\t\tif (this._buffer.byteLength > (this._maxsize + 64)) {\r\n\t\t\t\t//_setGPUMemory(_buffer.byteLength);\r\n\t\t\t\tthis._buffer = this._buffer.slice(0, this._maxsize + 64);\r\n\t\t\t\tthis._bufferSize = this._buffer.byteLength;\r\n\t\t\t\tthis._checkArrayUse();\r\n\t\t\t}\r\n\t\t\tthis._maxsize = this._byteLength;\r\n\t\t}\r\n\t\tif (this._uploadSize < this._buffer.byteLength) {\r\n\t\t\tthis._uploadSize = this._buffer.byteLength;\r\n\r\n\t\t\tLayaGL.instance.bufferData(this._bufferType, this._uploadSize, this._bufferUsage);\r\n\t\t\t//_setGPUMemory(_uploadSize);\r\n\t\t}\r\n\t\tLayaGL.instance.bufferSubData(this._bufferType, 0, new Uint8Array(this._buffer, 0, this._byteLength));\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\tprotected _bufferSubData(offset: number = 0, dataStart: number = 0, dataLength: number = 0): void {\r\n\t\tthis._maxsize = Math.max(this._maxsize, this._byteLength);\r\n\t\tif (RenderInfo.loopCount % 30 == 0) {\r\n\t\t\tif (this._buffer.byteLength > (this._maxsize + 64)) {\r\n\t\t\t\t//_setGPUMemory(_buffer.byteLength);\r\n\t\t\t\tthis._buffer = this._buffer.slice(0, this._maxsize + 64);\r\n\t\t\t\tthis._bufferSize = this._buffer.byteLength;\r\n\t\t\t\tthis._checkArrayUse();\r\n\t\t\t}\r\n\t\t\tthis._maxsize = this._byteLength;\r\n\t\t}\r\n\r\n\t\tif (this._uploadSize < this._buffer.byteLength) {\r\n\t\t\tthis._uploadSize = this._buffer.byteLength;\r\n\t\t\tLayaGL.instance.bufferData(this._bufferType, this._uploadSize, this._bufferUsage);\r\n\t\t\t//_setGPUMemory(_uploadSize);\r\n\t\t}\r\n\r\n\t\tif (dataStart || dataLength) {\r\n\t\t\tvar subBuffer: ArrayBuffer = this._buffer.slice(dataStart, dataLength);\r\n\t\t\tLayaGL.instance.bufferSubData(this._bufferType, offset, subBuffer);\r\n\t\t} else {\r\n\t\t\tLayaGL.instance.bufferSubData(this._bufferType, offset, this._buffer);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * buffer重新分配了，继承类根据需要做相应的处理。\r\n\t */\r\n\tprotected _checkArrayUse(): void {\r\n\t}\r\n\r\n\t/**\r\n\t * 给vao使用的 _bind_upload函数。不要与已经绑定的判断是否相同\r\n\t * @return\r\n\t */\r\n\t_bind_uploadForVAO(): boolean {\r\n\t\tif (!this._upload)\r\n\t\t\treturn false;\r\n\t\tthis._upload = false;\r\n\t\tthis._bindForVAO();\r\n\t\tthis._bufferData();\r\n\t\treturn true;\r\n\t}\r\n\r\n\t_bind_upload(): boolean {\r\n\t\tif (!this._upload)\r\n\t\t\treturn false;\r\n\t\tthis._upload = false;\r\n\t\tthis.bind();\r\n\t\tthis._bufferData();\r\n\t\treturn true;\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\t_bind_subUpload(offset: number = 0, dataStart: number = 0, dataLength: number = 0): boolean {\r\n\t\tif (!this._upload)\r\n\t\t\treturn false;\r\n\r\n\t\tthis._upload = false;\r\n\t\tthis.bind();\r\n\t\tthis._bufferSubData(offset, dataStart, dataLength);\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * 重新分配buffer大小，如果nsz比原来的小则什么都不做。\r\n\t * @param\tnsz\t\tbuffer大小，单位是byte。\r\n\t * @param\tcopy\t是否拷贝原来的buffer的数据。\r\n\t * @return\r\n\t */\r\n\t_resizeBuffer(nsz: number, copy: boolean): Buffer2D //是否修改了长度\r\n\t{\r\n\t\tvar buff: any = this._buffer;\r\n\t\tif (nsz <= buff.byteLength)\r\n\t\t\treturn this;\r\n\t\tvar u8buf: Uint8Array = this._u8Array;\r\n\t\t//_setGPUMemory(nsz);\r\n\t\tif (copy && buff && buff.byteLength > 0) {\r\n\t\t\tvar newbuffer: ArrayBuffer = new ArrayBuffer(nsz);\r\n\t\t\tvar oldU8Arr: Uint8Array = (u8buf && u8buf.buffer == buff) ? u8buf : new Uint8Array(buff);\r\n\t\t\tu8buf = this._u8Array = new Uint8Array(newbuffer);\r\n\t\t\tu8buf.set(oldU8Arr, 0);\r\n\t\t\tbuff = this._buffer = newbuffer;\r\n\t\t} else {\r\n\t\t\tbuff = this._buffer = new ArrayBuffer(nsz);\r\n\t\t\tthis._u8Array = null;\r\n\t\t}\r\n\t\tthis._checkArrayUse();\r\n\t\tthis._upload = true;\r\n\t\tthis._bufferSize = buff.byteLength;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tappend(data: any): void {\r\n\t\tthis._upload = true;\r\n\t\tvar byteLen: number, n: any;\r\n\t\tbyteLen = data.byteLength;\r\n\t\tif (data instanceof Uint8Array) {\r\n\t\t\tthis._resizeBuffer(this._byteLength + byteLen, true);\r\n\t\t\tn = new Uint8Array(this._buffer, this._byteLength);\r\n\t\t} else if (data instanceof Uint16Array) {\r\n\t\t\tthis._resizeBuffer(this._byteLength + byteLen, true);\r\n\t\t\tn = new Uint16Array(this._buffer, this._byteLength);\r\n\t\t} else if (data instanceof Float32Array) {\r\n\t\t\tthis._resizeBuffer(this._byteLength + byteLen, true);\r\n\t\t\tn = new Float32Array(this._buffer, this._byteLength);\r\n\t\t}\r\n\t\tn.set(data, 0);\r\n\t\tthis._byteLength += byteLen;\r\n\t\tthis._checkArrayUse();\r\n\t}\r\n\r\n\t/**\r\n\t * 附加Uint16Array的数据。数据长度是len。byte的话要*2\r\n\t * @param\tdata\r\n\t * @param\tlen\r\n\t */\r\n\tappendU16Array(data: Uint16Array, len: number): void {\r\n\t\tthis._resizeBuffer(this._byteLength + len * 2, true);\r\n\t\t//(new Uint16Array(_buffer, _byteLength, len)).set(data.slice(0, len));\r\n\t\t//下面这种写法比上面的快多了\r\n\t\tvar u: Uint16Array = new Uint16Array(this._buffer, this._byteLength, len);\t//TODO 怎么能不用new\r\n\t\tif (len == 6) {\r\n\t\t\tu[0] = data[0]; u[1] = data[1]; u[2] = data[2];\r\n\t\t\tu[3] = data[3]; u[4] = data[4]; u[5] = data[5];\r\n\t\t} else if (len >= 100) {\r\n\t\t\tu.set(new Uint16Array(data.buffer, 0, len));\r\n\t\t} else {\r\n\t\t\tfor (var i: number = 0; i < len; i++) {\r\n\t\t\t\tu[i] = data[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._byteLength += len * 2;\r\n\t\tthis._checkArrayUse();\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\tappendEx(data: any, type: new (buf, len) => any): void {\r\n\t\tthis._upload = true;\r\n\t\tvar byteLen: number, n: any;\r\n\t\tbyteLen = data.byteLength;\r\n\t\tthis._resizeBuffer(this._byteLength + byteLen, true);\r\n\t\tn = new type(this._buffer, this._byteLength);\r\n\t\tn.set(data, 0);\r\n\t\tthis._byteLength += byteLen;\r\n\t\tthis._checkArrayUse();\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\tappendEx2(data: any, type: new (buff, len) => any, dataLen: number, perDataLen: number = 1): void {\r\n\t\tthis._upload = true;\r\n\t\tvar byteLen: number, n: any;\r\n\t\tbyteLen = dataLen * perDataLen;\r\n\t\tthis._resizeBuffer(this._byteLength + byteLen, true);\r\n\t\tn = new type(this._buffer, this._byteLength);\r\n\t\tvar i: number;\r\n\t\tfor (i = 0; i < dataLen; i++) {\r\n\t\t\tn[i] = data[i];\r\n\t\t}\r\n\t\tthis._byteLength += byteLen;\r\n\t\tthis._checkArrayUse();\r\n\t}\r\n\r\n\r\n\t//TODO:coverage\r\n\tgetBuffer(): ArrayBuffer {\r\n\t\treturn this._buffer;\r\n\t}\r\n\r\n\tsetNeedUpload(): void {\r\n\t\tthis._upload = true;\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\tgetNeedUpload(): boolean {\r\n\t\treturn this._upload;\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\tupload(): boolean {\r\n\t\tvar gl:WebGLRenderingContext=LayaGL.instance;\r\n\t\tvar scuess: boolean = this._bind_upload();\r\n\t\tgl.bindBuffer(this._bufferType, null);\r\n\t\tif (this._bufferType == gl.ARRAY_BUFFER) Buffer._bindedVertexBuffer = null;\r\n\t\tif (this._bufferType == gl.ELEMENT_ARRAY_BUFFER) Buffer._bindedIndexBuffer = null;\r\n\t\tBaseShader.activeShader = null\r\n\t\treturn scuess;\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\tsubUpload(offset: number = 0, dataStart: number = 0, dataLength: number = 0): boolean {\r\n\t\tvar gl:WebGLRenderingContext=LayaGL.instance;\r\n\t\tvar scuess: boolean = this._bind_subUpload();\r\n\t\tgl.bindBuffer(this._bufferType, null);\r\n\t\tif (this._bufferType == gl.ARRAY_BUFFER) Buffer._bindedVertexBuffer = null;\r\n\t\tif (this._bufferType == gl.ELEMENT_ARRAY_BUFFER) Buffer._bindedIndexBuffer = null;\r\n\t\tBaseShader.activeShader = null\r\n\t\treturn scuess;\r\n\t}\r\n\r\n\tprotected _disposeResource(): void {\r\n\t\tthis._upload = true;\r\n\t\tthis._uploadSize = 0;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * 清理数据。保留ArrayBuffer\r\n\t */\r\n\tclear(): void {\r\n\t\tthis._byteLength = 0;\r\n\t\tthis._upload = true;\r\n\t}\r\n}\r\n\r\n\r\n","import { LayaGL } from \"../../layagl/LayaGL\";\r\nimport { Buffer } from \"./Buffer\";\r\nimport { Buffer2D } from \"./Buffer2D\";\r\n\r\nexport class IndexBuffer2D extends Buffer2D {\r\n    static create: Function = function (bufferUsage: number = 0x88e4/* WebGLContext.STATIC_DRAW*/): IndexBuffer2D {\r\n        return new IndexBuffer2D(bufferUsage);\r\n    }\r\n\r\n    protected _uint16Array: Uint16Array;\r\n\r\n    constructor(bufferUsage: number = 0x88e4/* WebGLContext.STATIC_DRAW*/) {\r\n        super();\r\n        this._bufferUsage = bufferUsage;\r\n        this._bufferType = LayaGL.instance.ELEMENT_ARRAY_BUFFER;\r\n        this._buffer = new ArrayBuffer(8);\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    protected _checkArrayUse(): void {\r\n        this._uint16Array && (this._uint16Array = new Uint16Array(this._buffer));\r\n    }\r\n\r\n    getUint16Array(): Uint16Array {\r\n        return this._uint16Array || (this._uint16Array = new Uint16Array(this._buffer));\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    _bindForVAO(): void {\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this._glBuffer);\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    bind(): boolean {\r\n        if (Buffer._bindedIndexBuffer !== this._glBuffer) {\r\n            var gl: WebGLRenderingContext = LayaGL.instance;\r\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this._glBuffer);\r\n            Buffer._bindedIndexBuffer = this._glBuffer;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    destory(): void {\r\n        this._uint16Array = null;\r\n        this._buffer = null;\r\n    }\r\n\r\n    disposeResource(): void {\r\n        this._disposeResource();\r\n    }\r\n}\r\n\r\n","import { Buffer2D } from \"./Buffer2D\";\r\nimport { LayaGL } from \"../../layagl/LayaGL\"\r\nimport { WebGLContext } from \"../WebGLContext\"\r\nimport { Buffer } from \"./Buffer\";\r\n\r\nexport class VertexBuffer2D extends Buffer2D {\r\n    static create: Function = function (vertexStride: number, bufferUsage: number = 0x88e8/* WebGLContext.DYNAMIC_DRAW*/): VertexBuffer2D {\r\n        return new VertexBuffer2D(vertexStride, bufferUsage);\r\n    }\r\n\r\n    _floatArray32: Float32Array;\r\n    _uint32Array: Uint32Array;\r\n\r\n    private _vertexStride: number;\r\n\r\n    get vertexStride(): number {\r\n        return this._vertexStride;\r\n    }\r\n\r\n    constructor(vertexStride: number, bufferUsage: number) {\r\n        super();\r\n        this._vertexStride = vertexStride;\r\n        this._bufferUsage = bufferUsage;\r\n        this._bufferType = LayaGL.instance.ARRAY_BUFFER;\r\n        this._buffer = new ArrayBuffer(8);\r\n        this._floatArray32 = new Float32Array(this._buffer);\r\n        this._uint32Array = new Uint32Array(this._buffer);\r\n    }\r\n\r\n    getFloat32Array(): Float32Array {\r\n        return this._floatArray32;\r\n    }\r\n\r\n    /**\r\n     * 在当前位置插入float数组。\r\n     * @param\tdata\r\n     * @param\tpos\r\n     */\r\n    appendArray(data: any[]): void {\r\n        var oldoff: number = this._byteLength >> 2;\r\n        this.setByteLength(this._byteLength + data.length * 4);\r\n        var vbdata: Float32Array = this.getFloat32Array();\r\n        vbdata.set(data, oldoff);\r\n        this._upload = true;\r\n    }\r\n\t\t/**\r\n\t\t * @override\r\n\t\t */\r\n\t\t/*override*/ protected _checkArrayUse(): void {\r\n        this._floatArray32 && (this._floatArray32 = new Float32Array(this._buffer));\r\n        this._uint32Array && (this._uint32Array = new Uint32Array(this._buffer));\r\n    }\r\n\r\n    //只删除buffer，不disableVertexAttribArray\r\n    deleteBuffer(): void {\r\n        super._disposeResource();\r\n    }\r\n\r\n\t\t/**\r\n\t\t * @inheritDoc\r\n\t\t * @override\r\n\t\t */\r\n\t\t/*override*/  _bindForVAO(): void {\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this._glBuffer);\r\n    }\r\n\r\n\t\t/**\r\n\t\t * @inheritDoc\r\n\t\t * @override\r\n\t\t */\r\n\t\t/*override*/  bind(): boolean {\r\n        if (Buffer._bindedVertexBuffer !== this._glBuffer) {\r\n            var gl: WebGLRenderingContext = LayaGL.instance;\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, this._glBuffer);\r\n            Buffer._bindedVertexBuffer = this._glBuffer;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\t\t/**\r\n\t\t * @override\r\n\t\t */\r\n\t\t/*override*/  destroy(): void {\r\n        super.destroy();\r\n        this._byteLength = 0;\r\n        this._upload = true;\r\n        this._buffer = null;\r\n        this._floatArray32 = null;\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { LayaGL } from \"../../layagl/LayaGL\";\r\nimport { BufferState2D } from \"../BufferState2D\";\r\nimport { Config } from \"./../../../Config\";\r\nimport { IndexBuffer2D } from \"./IndexBuffer2D\";\r\nimport { VertexBuffer2D } from \"./VertexBuffer2D\";\r\n\r\n/**\r\n * Mesh2d只是保存数据。描述attribute用的。本身不具有渲染功能。\r\n */\r\nexport class Mesh2D {\r\n    _stride = 0;\t\t\t//顶点结构大小。每个mesh的顶点结构是固定的。\r\n    vertNum = 0;\t\t\t\t//当前的顶点的个数\r\n    indexNum = 0;\t\t\t//实际index 个数。例如一个三角形是3个。由于ib本身可能超过实际使用的数量，所以需要一个indexNum\r\n    protected _applied = false;\t//是否已经设置给webgl了\r\n    _vb: VertexBuffer2D;\t\t\t//vb和ib都可能需要在外部修改，所以public\r\n    _ib: IndexBuffer2D;\r\n    private _vao: BufferState2D;\t\t\t\t\t\t//webgl VAO对象。需要WebGL扩展。\r\n    private static _gvaoid = 0;\r\n    private _attribInfo: any[];\t\t\t//保存起来的属性定义数组。\r\n    protected _quadNum = 0;\r\n    //public static var meshlist:Array = [];\t//活着的mesh对象列表。\r\n    canReuse = false;\t//用完以后，是删除还是回收。\r\n\r\n    /**\r\n     * \r\n     * @param\tstride\r\n     * @param\tvballoc  vb预分配的大小。主要是用来提高效率。防止不断的resizebfufer\r\n     * @param\tiballoc\r\n     */\r\n    constructor(stride: number, vballoc: number, iballoc: number) {\r\n        this._stride = stride;\r\n        this._vb = new VertexBuffer2D(stride, LayaGL.instance.DYNAMIC_DRAW);\r\n        if (vballoc) {\r\n            this._vb._resizeBuffer(vballoc, false);\r\n        } else {\r\n            Config.webGL2D_MeshAllocMaxMem && this._vb._resizeBuffer(64 * 1024 * stride, false);\r\n        }\r\n        this._ib = new IndexBuffer2D();\r\n        if (iballoc) {\r\n            this._ib._resizeBuffer(iballoc, false);\r\n        }\r\n        //meshlist.push(this);\r\n    }\r\n\r\n    /**\r\n     * 重新创建一个mesh。复用这个对象的vertex结构，ib对象和attribinfo对象\r\n     */\r\n    //TODO:coverage\r\n    cloneWithNewVB(): Mesh2D {\r\n        var mesh: Mesh2D = new Mesh2D(this._stride, 0, 0);\r\n        mesh._ib = this._ib;\r\n        mesh._quadNum = this._quadNum;\r\n        mesh._attribInfo = this._attribInfo;\r\n        return mesh;\r\n    }\r\n\r\n    /**\r\n     * 创建一个mesh，使用当前对象的vertex结构。vb和ib自己提供。\r\n     * @return\r\n     */\r\n    //TODO:coverage\r\n    cloneWithNewVBIB(): Mesh2D {\r\n        var mesh: Mesh2D = new Mesh2D(this._stride, 0, 0);\r\n        mesh._attribInfo = this._attribInfo;\r\n        return mesh;\r\n    }\r\n\r\n    /**\r\n     * 获得一个可以写的vb对象\r\n     */\r\n    //TODO:coverage\r\n    getVBW(): VertexBuffer2D {\r\n        this._vb.setNeedUpload();\r\n        return this._vb;\r\n    }\r\n    /**\r\n     * 获得一个只读vb\r\n     */\r\n    //TODO:coverage\r\n    getVBR(): VertexBuffer2D {\r\n        return this._vb;\r\n    }\r\n\r\n    //TODO:coverage\r\n    getIBR(): IndexBuffer2D {\r\n        return this._ib;\r\n    }\r\n    /**\r\n     * 获得一个可写的ib\r\n     */\r\n    //TODO:coverage\r\n    getIBW(): IndexBuffer2D {\r\n        this._ib.setNeedUpload();\r\n        return this._ib;\r\n    }\r\n\r\n    /**\r\n     * 直接创建一个固定的ib。按照固定四边形的索引。\r\n     * @param\tvar QuadNum\r\n     */\r\n    createQuadIB(QuadNum: number): void {\r\n        this._quadNum = QuadNum;\r\n        this._ib._resizeBuffer(QuadNum * 6 * 2, false);\t//short类型\r\n        this._ib.byteLength = this._ib.bufferLength;\t//这个我也不知道是什么意思\r\n\r\n        var bd: Uint16Array = this._ib.getUint16Array();\r\n        var idx: number = 0;\r\n        var curvert: number = 0;\r\n        for (var i: number = 0; i < QuadNum; i++) {\r\n            bd[idx++] = curvert;\r\n            bd[idx++] = curvert + 2;\r\n            bd[idx++] = curvert + 1;\r\n            bd[idx++] = curvert;\r\n            bd[idx++] = curvert + 3;\r\n            bd[idx++] = curvert + 2;\r\n            curvert += 4;\r\n        }\r\n\r\n        this._ib.setNeedUpload();\r\n    }\r\n\r\n    /**\r\n     * 设置mesh的属性。每3个一组，对应的location分别是0,1,2...\r\n     * 含义是：type,size,offset\r\n     * 不允许多流。因此stride是固定的，offset只是在一个vertex之内。\r\n     * @param\tattribs\r\n     */\r\n    setAttributes(attribs: any[]): void {\r\n        this._attribInfo = attribs;\r\n        if (this._attribInfo.length % 3 != 0) {\r\n            throw 'Mesh2D setAttributes error!';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 初始化VAO的配置，只需要执行一次。以后使用的时候直接bind就行\r\n     * @param\tgl\r\n     */\r\n    private configVAO(gl: WebGLRenderingContext): void {\r\n        if (this._applied)\r\n            return;\r\n        this._applied = true;\r\n        if (!this._vao) {\r\n            //_vao = __JS__('gl.createVertexArray();');\r\n            this._vao = new BufferState2D();\r\n            //_vao.dbgid = _gvaoid++;\r\n        }\r\n        this._vao.bind();\r\n        //gl.bindVertexArray(_vao);\r\n        this._vb._bindForVAO();\r\n\r\n        //_vb._bind(); 这个有相同优化，不适用于vao\r\n        this._ib.setNeedUpload();\t//vao的话，必须要绑定ib。即使是共享的别人的。\r\n        this._ib._bind_uploadForVAO();\r\n        //gl.bindBuffer(WebGLContext.ARRAY_BUFFER,_vb);\r\n        //gl.bindBuffer(WebGLContext.ELEMENT_ARRAY_BUFFER, _ib);\r\n        var attribNum: number = this._attribInfo.length / 3;\r\n        var idx: number = 0;\r\n        for (var i: number = 0; i < attribNum; i++) {\r\n            var _size: number = this._attribInfo[idx + 1];\r\n            var _type: number = this._attribInfo[idx];\r\n            var _off: number = this._attribInfo[idx + 2];\r\n            gl.enableVertexAttribArray(i);\r\n            gl.vertexAttribPointer(i, _size, _type, false, this._stride, _off); //注意 normalize都设置为false了，想必没人要用这个功能把。\r\n            idx += 3;\r\n        }\r\n        this._vao.unBind();\r\n        //gl.bindVertexArray(null);\r\n    }\r\n\r\n    /**\r\n     * 应用这个mesh\r\n     * @param\tgl\r\n     */\r\n    useMesh(gl: WebGLRenderingContext): void {\r\n        //要先bind，在bufferData\r\n        this._applied || this.configVAO(gl);\r\n\r\n        //var attribNum:int = _attribInfo.length / 3;\r\n        //var bindedAttributeBuffer:Array = Buffer._bindedAtributeBuffer;\r\n        //for ( var i:int = 0; i < attribNum; i++) \r\n        //(bindedAttributeBuffer[i]) || (gl.enableVertexAttribArray(i), bindedAttributeBuffer[i] = _vb);\r\n\r\n        //WebGLContext.bindVertexArray(gl, null);\r\n        //gl.disableVertexAttribArray(0);\r\n        this._vao.bind();\r\n        //gl.bindVertexArray(_vao);\r\n\r\n        this._vb.bind();\t//vao必须要再bind vb,否则下面的操作可能是在操作其他的mesh\r\n        this._ib._bind_upload() || this._ib.bind();\r\n        this._vb._bind_upload() || this._vb.bind();\r\n    }\r\n\r\n    //TODO:coverage\r\n    getEleNum(): number {\r\n        return this._ib.getBuffer().byteLength / 2;\r\n    }\r\n\r\n    /**\r\n     * 子类实现。用来把自己放到对应的回收池中，以便复用。\r\n     */\r\n    releaseMesh(): void { }\r\n\r\n    /**\r\n     * 释放资源。\r\n     */\r\n    destroy(): void {\r\n    }\r\n\r\n    /**\r\n     * 清理vb数据\r\n     */\r\n    clearVB(): void {\r\n        this._vb.clear();\r\n    }\r\n}\r\n\r\n","import { IndexBuffer2D } from \"./IndexBuffer2D\";\r\nimport { Mesh2D } from \"./Mesh2D\";\r\nimport { VertexBuffer2D } from \"./VertexBuffer2D\";\r\n/**\r\n * drawImage，fillRect等会用到的简单的mesh。每次添加必然是一个四边形。\r\n */\r\nexport class MeshQuadTexture extends Mesh2D {\r\n\tstatic const_stride: number = 24;// 48;  24是不带clip的\r\n\tprivate static _fixib: IndexBuffer2D;\r\n\tprivate static _maxIB: number = 16 * 1024;\r\n\tprivate static _fixattriInfo: any[];\r\n\tprivate static _POOL: any[] = [];\r\n\t//private static var _num;\r\n\r\n\tstatic __int__(): void {\r\n\t\t//var gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tMeshQuadTexture._fixattriInfo = [5126/*gl.FLOAT*/, 4, 0,\t//pos,uv\r\n\t\t5121/*gl.UNSIGNED_BYTE*/, 4, 16,\t//color alpha\r\n\t\t5121/*gl.UNSIGNED_BYTE*/, 4, 20];\r\n\t}\r\n\r\n\r\n\tconstructor() {\r\n\t\tsuper(MeshQuadTexture.const_stride, 4, 4);\t//x,y,u,v,rgba\r\n\t\tthis.canReuse = true;\r\n\t\tthis.setAttributes(MeshQuadTexture._fixattriInfo);\r\n\t\tif (!MeshQuadTexture._fixib) {\r\n\t\t\tthis.createQuadIB(MeshQuadTexture._maxIB);\t//每个quad 4个顶点。正好达到64k的索引。\r\n\t\t\tMeshQuadTexture._fixib = this._ib;\r\n\t\t} else {\r\n\t\t\tthis._ib = MeshQuadTexture._fixib;\r\n\t\t\tthis._quadNum = MeshQuadTexture._maxIB;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t */\r\n\tstatic getAMesh(mainctx: boolean): MeshQuadTexture {\r\n\t\t//console.log('getmesh');\r\n\t\tvar ret: MeshQuadTexture = null;\r\n\t\tif (MeshQuadTexture._POOL.length) {\r\n\t\t\tret = MeshQuadTexture._POOL.pop();\r\n\t\t} else\r\n\t\t\tret = new MeshQuadTexture();\r\n\t\t// 先分配64k顶点的空间，这样可以避免浪费内存，否则后面增加内存的时候是成倍增加的，当快超过64k的时候，直接变成了128k\r\n\t\tmainctx && ret._vb._resizeBuffer(64 * 1024 * MeshQuadTexture.const_stride, false);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\t\t/**\r\n\t\t * 把本对象放到回收池中，以便getMesh能用。\r\n\t\t * @override\r\n\t\t */\r\n\t\t  releaseMesh(): void {\r\n\t\tthis._vb.setByteLength(0);\r\n\t\tthis.vertNum = 0;\r\n\t\tthis.indexNum = 0;\r\n\t\t//_applied = false;\r\n\t\tMeshQuadTexture._POOL.push(this);\r\n\t}\r\n\t\t/**\r\n\t\t * @override\r\n\t\t */\r\n\t\t  destroy(): void {\r\n\t\t//_ib.destroy(); ib是公用的。\r\n\t\tthis._vb.destroy();\r\n\t\tthis._vb.deleteBuffer();\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t * @param\tpos\r\n\t * @param\tuv\r\n\t * @param\tcolor\r\n\t * @param\tclip   ox,oy,xx,xy,yx,yy\r\n\t * @param \tuseTex 是否使用贴图。false的话是给fillRect用的\r\n\t */\r\n\taddQuad(pos: any[], uv: ArrayLike<number>, color: number, useTex: boolean): void {\r\n\t\tvar vb: VertexBuffer2D = this._vb;\r\n\t\tvar vpos: number = (vb._byteLength >> 2);\t//float数组的下标\r\n\t\t//x,y,u,v,rgba\r\n\t\tvb.setByteLength((vpos + MeshQuadTexture.const_stride) << 2); //是一个四边形的大小，也是这里填充的大小\r\n\t\tvar vbdata: Float32Array = vb._floatArray32 || vb.getFloat32Array();\r\n\t\tvar vbu32Arr: Uint32Array = vb._uint32Array;\r\n\t\tvar cpos: number = vpos;\r\n\t\tvar useTexVal: number = useTex ? 0xff : 0;\r\n\t\tvbdata[cpos++] = pos[0]; vbdata[cpos++] = pos[1]; vbdata[cpos++] = uv[0]; vbdata[cpos++] = uv[1]; vbu32Arr[cpos++] = color; vbu32Arr[cpos++] = useTexVal;\r\n\t\tvbdata[cpos++] = pos[2]; vbdata[cpos++] = pos[3]; vbdata[cpos++] = uv[2]; vbdata[cpos++] = uv[3]; vbu32Arr[cpos++] = color; vbu32Arr[cpos++] = useTexVal;\r\n\t\tvbdata[cpos++] = pos[4]; vbdata[cpos++] = pos[5]; vbdata[cpos++] = uv[4]; vbdata[cpos++] = uv[5]; vbu32Arr[cpos++] = color; vbu32Arr[cpos++] = useTexVal;\r\n\t\tvbdata[cpos++] = pos[6]; vbdata[cpos++] = pos[7]; vbdata[cpos++] = uv[6]; vbdata[cpos++] = uv[7]; vbu32Arr[cpos++] = color; vbu32Arr[cpos++] = useTexVal;\r\n\t\tvb._upload = true;\r\n\t}\r\n}\r\n\r\n","import { LayaGL } from \"../../layagl/LayaGL\";\r\nimport { Matrix } from \"../../maths/Matrix\";\r\nimport { IndexBuffer2D } from \"./IndexBuffer2D\";\r\nimport { Mesh2D } from \"./Mesh2D\";\r\nimport { VertexBuffer2D } from \"./VertexBuffer2D\";\r\n\r\n/**\r\n * 与MeshQuadTexture基本相同。不过index不是固定的\r\n */\r\nexport class MeshTexture extends Mesh2D {\r\n    static const_stride: number = 24;\r\n    private static _fixattriInfo: any[];\r\n    private static _POOL: any[] = [];\r\n\r\n\r\n    static __init__(): void {\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        MeshTexture._fixattriInfo = [5126/*gl.FLOAT*/, 4, 0,\t//pos,uv\r\n            5121/*gl.UNSIGNED_BYTE*/, 4, 16,\t//color alpha\r\n            5121/*gl.UNSIGNED_BYTE*/, 4, 20];\r\n    }\r\n\r\n    constructor() {\r\n        super(MeshTexture.const_stride, 4, 4);\t//x,y,u,v,rgba\r\n        this.canReuse = true;\r\n        this.setAttributes(MeshTexture._fixattriInfo);\r\n    }\r\n\r\n\t/**\r\n\t * \r\n\t */\r\n    static getAMesh(mainctx: boolean): MeshTexture {\r\n        //console.log('getmesh');\r\n        var ret: MeshTexture;\r\n        if (MeshTexture._POOL.length) {\r\n            ret = MeshTexture._POOL.pop();\r\n        }\r\n        else ret = new MeshTexture();\r\n        mainctx && ret._vb._resizeBuffer(64 * 1024 * MeshTexture.const_stride, false);\r\n        return ret;\r\n    }\r\n\r\n    addData(vertices: Float32Array, uvs: Float32Array, idx: Uint16Array, matrix: Matrix, rgba: number): void {\r\n        //vb\r\n        var vb: VertexBuffer2D = this._vb;\r\n        var ib: IndexBuffer2D = this._ib;\r\n        var vertsz: number = vertices.length >> 1;\r\n        var startpos: number = vb.needSize(vertsz * MeshTexture.const_stride);//vb的起点。\t\t\t\r\n        var f32pos: number = startpos >> 2;\r\n        var vbdata: Float32Array = vb._floatArray32 || vb.getFloat32Array();\r\n        var vbu32Arr: Uint32Array = vb._uint32Array;\r\n        var ci: number = 0;\r\n        var m00: number = matrix.a;\r\n        var m01: number = matrix.b;\r\n        var m10: number = matrix.c;\r\n        var m11: number = matrix.d;\r\n        var tx: number = matrix.tx;\r\n        var ty: number = matrix.ty;\r\n        var i: number = 0;\r\n        //var clipinfo:Array = ctx.getTransedClipInfo();\r\n        for (i = 0; i < vertsz; i++) {\r\n            var x: number = vertices[ci], y: number = vertices[ci + 1];\r\n            vbdata[f32pos] = x * m00 + y * m10 + tx;\r\n            vbdata[f32pos + 1] = x * m01 + y * m11 + ty;\r\n            vbdata[f32pos + 2] = uvs[ci];\r\n            vbdata[f32pos + 3] = uvs[ci + 1];\r\n            vbu32Arr[f32pos + 4] = rgba;\r\n            vbu32Arr[f32pos + 5] = 0xff;\r\n            f32pos += 6;\r\n            //裁剪信息。\r\n            //vbdata[f32pos++] = clipinfo[2] ; vbdata[f32pos++] = clipinfo[3]; vbdata[f32pos++] = clipinfo[4]; vbdata[f32pos++] = clipinfo[5];//cliprect的方向\r\n            //vbdata[f32pos++] = clipinfo[0]; vbdata[f32pos++] = clipinfo[1];\t//cliprect的位置\r\n            ci += 2;\r\n        }\r\n        vb.setNeedUpload();\r\n\r\n        var vertN: number = this.vertNum;\r\n        var sz: number = idx.length;\r\n        var stib: number = ib.needSize(idx.byteLength);\r\n        var cidx: Uint16Array = ib.getUint16Array();\r\n        //var cidx:Uint16Array = new Uint16Array(__JS__('ib._buffer'), stib);\r\n        var stibid: number = stib >> 1;\t// indexbuffer的起始位置\r\n        if (vertN > 0) {\r\n            var end: number = stibid + sz;\r\n            var si: number = 0;\r\n            for (i = stibid; i < end; i++ , si++) {\r\n                cidx[i] = idx[si] + vertN;\r\n            }\r\n        } else {\r\n            cidx.set(idx, stibid);\r\n        }\r\n        ib.setNeedUpload();\r\n\r\n        this.vertNum += vertsz;\r\n        this.indexNum += idx.length;\r\n    }\r\n\r\n\t\t/**\r\n\t\t * 把本对象放到回收池中，以便getMesh能用。\r\n\t\t * @override\r\n\t\t */\r\n\t\t /*override*/ releaseMesh(): void {\r\n        this._vb.setByteLength(0);\r\n        this._ib.setByteLength(0);\r\n        this.vertNum = 0;\r\n        this.indexNum = 0;\r\n        //_applied = false;\r\n        MeshTexture._POOL.push(this);\r\n    }\r\n/**\r\n * @override\r\n */\r\n\t\t /*override*/ destroy(): void {\r\n        this._ib.destroy();\r\n        this._vb.destroy();\r\n        this._ib.disposeResource();\r\n        this._vb.deleteBuffer();\r\n    }\r\n}\r\n\r\n","import { LayaGL } from \"../../layagl/LayaGL\";\r\nimport { Context } from \"../../resource/Context\";\r\nimport { Mesh2D } from \"./Mesh2D\";\r\n\r\n/**\r\n * 用来画矢量的mesh。顶点格式固定为 x,y,rgba\r\n */\r\nexport class MeshVG extends Mesh2D {\r\n\tstatic const_stride: number = 12;// 36;\r\n\tprivate static _fixattriInfo: any[];\r\n\tprivate static _POOL: any[] = [];\r\n\r\n\tstatic __init__(): void {\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tMeshVG._fixattriInfo = [5126/*gl.FLOAT*/, 2, 0,\t//x,y\r\n\t\t5121/*gl.UNSIGNED_BYTE*/, 4, 8];\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper(MeshVG.const_stride, 4, 4);\t//x,y,rgba\r\n\t\tthis.canReuse = true;\r\n\t\tthis.setAttributes(MeshVG._fixattriInfo);\r\n\t}\r\n\r\n\tstatic getAMesh(mainctx: boolean): MeshVG {\r\n\t\t//console.log('getmeshvg');\r\n\t\tvar ret: MeshVG;\r\n\t\tif (MeshVG._POOL.length) {\r\n\t\t\tret = MeshVG._POOL.pop();\r\n\t\t} else\r\n\t\t\tret = new MeshVG();\r\n\t\tmainctx && ret._vb._resizeBuffer(64 * 1024 * MeshVG.const_stride, false);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\t/**\r\n\t * 往矢量mesh中添加顶点和index。会把rgba和points在mesh中合并。\r\n\t * @param\tpoints\t顶点数组，只包含x,y。[x,y,x,y...]\r\n\t * @param\trgba\trgba颜色\r\n\t * @param\tib\t\tindex数组。\r\n\t */\r\n\taddVertAndIBToMesh(ctx: Context, points: any[], rgba: number, ib: any[]): void {\r\n\t\tvar startpos: number = this._vb.needSize(points.length / 2 * MeshVG.const_stride);//vb的起点。\r\n\t\tvar f32pos: number = startpos >> 2;\r\n\t\tvar vbdata: Float32Array = this._vb._floatArray32 || this._vb.getFloat32Array();\r\n\t\tvar vbu32Arr: Uint32Array = this._vb._uint32Array;\r\n\t\tvar ci: number = 0;\r\n\t\t//vb\r\n\t\t//var clipinfo:Array = ctx.getTransedClipInfo();\r\n\t\tvar sz: number = points.length / 2;\r\n\t\tfor (var i: number = 0; i < sz; i++) {\r\n\t\t\tvbdata[f32pos++] = points[ci]; vbdata[f32pos++] = points[ci + 1]; ci += 2;\r\n\t\t\tvbu32Arr[f32pos++] = rgba;\r\n\t\t\t/*\r\n\t\t\t//裁剪信息。\r\n\t\t\tvbdata[f32pos++] = clipinfo[2] ; vbdata[f32pos++] = clipinfo[3]; vbdata[f32pos++] = clipinfo[4]; vbdata[f32pos++] = clipinfo[5];//cliprect的方向\r\n\t\t\tvbdata[f32pos++] = clipinfo[0]; vbdata[f32pos++] = clipinfo[1]; //cliprect的位置\r\n\t\t\t*/\r\n\t\t}\r\n\t\tthis._vb.setNeedUpload();\r\n\r\n\t\t//ib\r\n\t\t//TODO 现在这种添加数据的方法效率非常低。而且会引起大量的gc\r\n\t\tthis._ib.append(new Uint16Array(ib));\r\n\t\tthis._ib.setNeedUpload();\r\n\r\n\t\tthis.vertNum += sz;\r\n\t\tthis.indexNum += ib.length;\r\n\t}\r\n\r\n\t\t/**\r\n\t\t * 把本对象放到回收池中，以便getMesh能用。\r\n\t\t * @override\r\n\t\t */\r\n\t\t  releaseMesh(): void {\r\n\t\tthis._vb.setByteLength(0);\r\n\t\tthis._ib.setByteLength(0);\r\n\t\tthis.vertNum = 0;\r\n\t\tthis.indexNum = 0;\r\n\t\t//_applied = false;\r\n\t\tMeshVG._POOL.push(this);\r\n\t}\r\n/**\r\n * @override\r\n */\r\n\t\t  destroy(): void {\r\n\t\tthis._ib.destroy();\r\n\t\tthis._vb.destroy();\r\n\t\tthis._ib.disposeResource();\r\n\t\tthis._vb.deleteBuffer();\r\n\t}\r\n}\r\n\r\n","import { Sprite } from \"../../display/Sprite\"\r\nimport { Matrix } from \"../../maths/Matrix\"\r\nimport { Context } from \"../../resource/Context\"\r\nimport { Submit } from \"../submit/Submit\"\r\nimport { SubmitBase } from \"../submit/SubmitBase\"\r\nimport { Mesh2D } from \"../utils/Mesh2D\"\r\nimport { MeshQuadTexture } from \"../utils/MeshQuadTexture\"\r\nimport { MeshTexture } from \"../utils/MeshTexture\"\r\nimport { MeshVG } from \"../utils/MeshVG\"\r\n/**\r\n * 对象 cacheas normal的时候，本质上只是想把submit缓存起来，以后直接执行\r\n * 为了避免各种各样的麻烦，这里采用复制相应部分的submit的方法。执行环境还是在原来的context中\r\n * 否则包括clip等都非常难以处理\r\n */\r\nexport class WebGLCacheAsNormalCanvas {\r\n    submitStartPos: number = 0;\t// 对应的context的submit的开始的地方\r\n    submitEndPos: number = 0;\r\n    context: Context;\r\n    touches: any[] = [];\t\t//记录的文字信息。cacheas normal的话，文字要能正确touch\r\n    submits: any[] = [];\t\t// 从context中剪切的submit\r\n    sprite: Sprite|null = null;\t// 对应的sprite对象\r\n\r\n    // submit需要关联稳定独立的mesh。所以这里要创建自己的mesh对象\r\n    /**@internal */\r\n    _mesh: MeshQuadTexture;\t\t\t//用Mesh2D代替_vb,_ib. 当前使用的mesh\r\n    private _pathMesh: MeshVG;\t\t\t//矢量专用mesh。\r\n    private _triangleMesh: MeshTexture;\t//drawTriangles专用mesh。由于ib不固定，所以不能与_mesh通用\r\n    meshlist: any[] = [];\t\t\t//本context用到的mesh\r\n\r\n    // 原始context的原始值\r\n    private _oldMesh: MeshQuadTexture|null;\r\n    private _oldPathMesh: MeshVG|null;\r\n    private _oldTriMesh: MeshTexture|null;\r\n    private _oldMeshList: any[];\r\n\r\n    // cache的时候对应的clip\r\n    private cachedClipInfo: Matrix = new Matrix();\t// 用来判断是否需要把cache无效\r\n    //private var oldMatrix:Matrix = null;\t\t\t\t//本地画的时候完全不应用矩阵，所以需要先保存老的，以便恢复\t\t这样会丢失缩放信息，导致文字模糊，所以不用这种方式了\r\n    private oldTx: number = 0;\r\n    private oldTy: number = 0;\r\n    private static matI: Matrix = new Matrix();\r\n\r\n    // 创建这个canvas的时候对应的矩阵的逆矩阵。因为要保留矩阵的缩放信息。所以采用逆矩阵的方法。\r\n    invMat: Matrix = new Matrix();\r\n\r\n    constructor(ctx: Context, sp: Sprite) {\r\n        this.context = ctx;\r\n        this.sprite = sp;\r\n        ctx._globalClipMatrix.copyTo(this.cachedClipInfo);\r\n    }\r\n\r\n    startRec(): void {\r\n\t\tlet context = this.context;\r\n        // 如果有文字优化，这里要先提交一下\r\n        if (context._charSubmitCache && context._charSubmitCache._enable) {\r\n            context._charSubmitCache.enable(false, context);\r\n            context._charSubmitCache.enable(true, context);\r\n        }\r\n        context._incache = true;\r\n        this.touches.length = 0;\r\n        //记录需要touch的文字资源\r\n        ((<any>context)).touches = this.touches;\r\n        context._globalClipMatrix.copyTo(this.cachedClipInfo);\r\n\r\n        this.submits.length = 0;\r\n        this.submitStartPos = context._submits._length;\r\n\r\n        // 先把之前的释放掉\r\n        for (var i: number = 0, sz: number = this.meshlist.length; i < sz; i++) {\r\n            var curm: Mesh2D = this.meshlist[i];\r\n            curm.canReuse ? (curm.releaseMesh()) : (curm.destroy());\r\n        }\r\n        this.meshlist.length = 0;\r\n\r\n        this._mesh = MeshQuadTexture.getAMesh(false);\r\n        this._pathMesh = MeshVG.getAMesh(false);\r\n        this._triangleMesh = MeshTexture.getAMesh(false);\r\n\r\n        this.meshlist.push(this._mesh);\r\n        this.meshlist.push(this._pathMesh);\r\n        this.meshlist.push(this._triangleMesh);\r\n\r\n        // 打断合并\r\n        context._curSubmit = SubmitBase.RENDERBASE;\r\n        // 接管context中的一些值\r\n        this._oldMesh = context._mesh;\r\n        this._oldPathMesh = context._pathMesh;\r\n        this._oldTriMesh = context._triangleMesh;\r\n        this._oldMeshList = context.meshlist;\r\n\r\n        context._mesh = this._mesh;\r\n        context._pathMesh = this._pathMesh;\r\n        context._triangleMesh = this._triangleMesh;\r\n        context.meshlist = this.meshlist;\r\n\r\n        // 要取消位置，因为以后会再传入位置。这里好乱\r\n        this.oldTx = context._curMat.tx;\r\n        this.oldTy = context._curMat.ty;\r\n        context._curMat.tx = 0;\r\n        context._curMat.ty = 0;\r\n\r\n        // 取消缩放等\r\n        context._curMat.copyTo(this.invMat);\r\n        this.invMat.invert();\r\n        //oldMatrix = context._curMat;\r\n        //context._curMat = matI;\r\n    }\r\n\r\n    endRec(): void {\r\n\t\tlet context = this.context;\r\n        // 如果有文字优化，这里要先提交一下\r\n        if (context._charSubmitCache && context._charSubmitCache._enable) {\r\n            context._charSubmitCache.enable(false, context);\r\n            context._charSubmitCache.enable(true, context);\r\n        }\r\n        // copy submit\r\n        var parsubmits: any = context._submits;\r\n        this.submitEndPos = parsubmits._length;\r\n        var num: number = this.submitEndPos - this.submitStartPos;\r\n        for (var i: number = 0; i < num; i++) {\r\n            this.submits.push(parsubmits[this.submitStartPos + i]);\r\n        }\r\n        parsubmits._length -= num;\r\n\r\n        // 恢复原始context的值\r\n        context._mesh = this._oldMesh;\r\n        context._pathMesh = this._oldPathMesh;\r\n        context._triangleMesh = this._oldTriMesh;\r\n        context.meshlist = this._oldMeshList;\r\n\r\n        // 打断合并\r\n        context._curSubmit = SubmitBase.RENDERBASE;\r\n        // 恢复matrix\r\n        //context._curMat = oldMatrix;\r\n        context._curMat.tx = this.oldTx;\r\n        context._curMat.ty = this.oldTy;\r\n        ((<any>context)).touches = null;\r\n        context._incache = false;\r\n    }\r\n\r\n    /**\r\n     * 当前缓存是否还有效。例如clip变了就失效了，因为clip太难自动处理\r\n     * @return\r\n     */\r\n    isCacheValid(): boolean {\r\n        var curclip: Matrix = this.context._globalClipMatrix;\r\n        if (curclip.a != this.cachedClipInfo.a || curclip.b != this.cachedClipInfo.b || curclip.c != this.cachedClipInfo.c\r\n            || curclip.d != this.cachedClipInfo.d || curclip.tx != this.cachedClipInfo.tx || curclip.ty != this.cachedClipInfo.ty)\r\n            return false;\r\n        return true;\r\n    }\r\n\r\n    flushsubmit(): void {\r\n        var curSubmit: SubmitBase = SubmitBase.RENDERBASE;\r\n        this.submits.forEach(function (subm: Submit): void {\r\n            if (subm == SubmitBase.RENDERBASE) return;\r\n            SubmitBase.preRender = curSubmit;\r\n            curSubmit = subm;\r\n            subm.renderSubmit();\r\n        });\r\n    }\r\n\r\n    releaseMem(): void {\r\n\r\n    }\r\n}\r\n\r\n","/*\r\n\ttexture和fillrect使用的。\r\n*/\r\nattribute vec4 posuv;\r\nattribute vec4 attribColor;\r\nattribute vec4 attribFlags;\r\n//attribute vec4 clipDir;\r\n//attribute vec2 clipRect;\r\nuniform vec4 clipMatDir;\r\nuniform vec2 clipMatPos;\t\t// 这个是全局的，不用再应用矩阵了。\r\nvarying vec2 cliped;\r\nuniform vec2 size;\r\nuniform vec2 clipOff;\t\t\t// 使用要把clip偏移。cacheas normal用. 只用了[0]\r\n#ifdef WORLDMAT\r\n\tuniform mat4 mmat;\r\n#endif\r\n#ifdef MVP3D\r\n\tuniform mat4 u_MvpMatrix;\r\n#endif\r\nvarying vec4 v_texcoordAlpha;\r\nvarying vec4 v_color;\r\nvarying float v_useTex;\r\n\r\nvoid main() {\r\n\r\n\tvec4 pos = vec4(posuv.xy,0.,1.);\r\n#ifdef WORLDMAT\r\n\tpos=mmat*pos;\r\n#endif\r\n\tvec4 pos1  =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\r\n#ifdef MVP3D\r\n\tgl_Position=u_MvpMatrix*pos1;\r\n#else\r\n\tgl_Position=pos1;\r\n#endif\r\n\tv_texcoordAlpha.xy = posuv.zw;\r\n\t//v_texcoordAlpha.z = attribColor.a/255.0;\r\n\tv_color = attribColor/255.0;\r\n\tv_color.xyz*=v_color.w;//反正后面也要预乘\r\n\t\r\n\tv_useTex = attribFlags.r/255.0;\r\n\tfloat clipw = length(clipMatDir.xy);\r\n\tfloat cliph = length(clipMatDir.zw);\r\n\t\r\n\tvec2 clpos = clipMatPos.xy;\r\n\t#ifdef WORLDMAT\r\n\t\t// 如果有mmat，需要修改clipMatPos,因为 这是cacheas normal （如果不是就错了）， clipMatPos被去掉了偏移\r\n\t\tif(clipOff[0]>0.0){\r\n\t\t\tclpos.x+=mmat[3].x;\t//tx\t最简单处理\r\n\t\t\tclpos.y+=mmat[3].y;\t//ty\r\n\t\t}\r\n\t#endif\r\n\tvec2 clippos = pos.xy - clpos;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\r\n\tif(clipw>20000. && cliph>20000.)\r\n\t\tcliped = vec2(0.5,0.5);\r\n\telse {\r\n\t\t//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\r\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\r\n\t}\r\n\r\n}","/*\r\n\ttexture和fillrect使用的。\r\n*/\r\n#ifdef GL_FRAGMENT_PRECISION_HIGH\r\nprecision highp float;\r\n#else\r\nprecision mediump float;\r\n#endif\r\n\r\nvarying vec4 v_texcoordAlpha;\r\nvarying vec4 v_color;\r\nvarying float v_useTex;\r\nuniform sampler2D texture;\r\nvarying vec2 cliped;\r\n\r\n#ifdef BLUR_FILTER\r\nuniform vec4 strength_sig2_2sig2_gauss1;\r\nuniform vec2 blurInfo;\r\n\r\n#define PI 3.141593\r\n\r\nfloat getGaussian(float x, float y){\r\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\r\n}\r\n\r\nvec4 blur(){\r\n    const float blurw = 9.0;\r\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\r\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \r\n    vec2 startpos=v_texcoordAlpha.xy-halfsz;\r\n    vec2 ctexcoord = startpos;\r\n    vec2 step = 1.0/blurInfo;  //每个像素      \r\n    \r\n    for(float y = 0.0;y<=blurw; ++y){\r\n        ctexcoord.x=startpos.x;\r\n        for(float x = 0.0;x<=blurw; ++x){\r\n            //TODO 纹理坐标的固定偏移应该在vs中处理\r\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\r\n            ctexcoord.x+=step.x;\r\n        }\r\n        ctexcoord.y+=step.y;\r\n    }\r\n    return vec4Color;\r\n}\r\n#endif\r\n\r\n#ifdef COLOR_FILTER\r\nuniform vec4 colorAlpha;\r\nuniform mat4 colorMat;\r\n#endif\r\n\r\n#ifdef GLOW_FILTER\r\nuniform vec4 u_color;\r\nuniform vec4 u_blurInfo1;\r\nuniform vec4 u_blurInfo2;\r\n#endif\r\n\r\n#ifdef COLOR_ADD\r\nuniform vec4 colorAdd;\r\n#endif\r\n\r\n#ifdef FILLTEXTURE\t\r\nuniform vec4 u_TexRange;//startu,startv,urange, vrange\r\n#endif\r\nvoid main() {\r\n\tif(cliped.x<0.) discard;\r\n\tif(cliped.x>1.) discard;\r\n\tif(cliped.y<0.) discard;\r\n\tif(cliped.y>1.) discard;\r\n\t\r\n#ifdef FILLTEXTURE\t\r\n   vec4 color= texture2D(texture, fract(v_texcoordAlpha.xy)*u_TexRange.zw + u_TexRange.xy);\r\n#else\r\n   vec4 color= texture2D(texture, v_texcoordAlpha.xy);\r\n#endif\r\n\r\n   if(v_useTex<=0.)color = vec4(1.,1.,1.,1.);\r\n   color.a*=v_color.w;\r\n   //color.rgb*=v_color.w;\r\n   color.rgb*=v_color.rgb;\r\n   gl_FragColor=color;\r\n   \r\n   #ifdef COLOR_ADD\r\n\tgl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\r\n\tgl_FragColor.xyz *= colorAdd.a;\r\n   #endif\r\n   \r\n   #ifdef BLUR_FILTER\r\n\tgl_FragColor =   blur();\r\n\tgl_FragColor.w*=v_color.w;   \r\n   #endif\r\n   \r\n   #ifdef COLOR_FILTER\r\n\tmat4 alphaMat =colorMat;\r\n\r\n\talphaMat[0][3] *= gl_FragColor.a;\r\n\talphaMat[1][3] *= gl_FragColor.a;\r\n\talphaMat[2][3] *= gl_FragColor.a;\r\n\r\n\tgl_FragColor = gl_FragColor * alphaMat;\r\n\tgl_FragColor += colorAlpha/255.0*gl_FragColor.a;\r\n   #endif\r\n   \r\n   #ifdef GLOW_FILTER\r\n\tconst float c_IterationTime = 10.0;\r\n\tfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\r\n\tvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\r\n\tvec2 vec2FilterDir = vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\r\n\tvec2 vec2FilterOff = vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\r\n\tfloat maxNum = u_blurInfo1.x * u_blurInfo1.y;\r\n\tvec2 vec2Off = vec2(0.0,0.0);\r\n\tfloat floatOff = c_IterationTime/2.0;\r\n\tfor(float i = 0.0;i<=c_IterationTime; ++i){\r\n\t\tfor(float j = 0.0;j<=c_IterationTime; ++j){\r\n\t\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\r\n\t\t\tvec4Color += texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\r\n\t\t}\r\n\t}\r\n\tgl_FragColor = vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\r\n\tgl_FragColor.rgb *= gl_FragColor.a;   \r\n   #endif\r\n   \r\n}","attribute vec4 position;\r\nattribute vec4 attribColor;\r\n//attribute vec4 clipDir;\r\n//attribute vec2 clipRect;\r\nuniform vec4 clipMatDir;\r\nuniform vec2 clipMatPos;\r\n#ifdef WORLDMAT\r\n\tuniform mat4 mmat;\r\n#endif\r\nuniform mat4 u_mmat2;\r\n//uniform vec2 u_pos;\r\nuniform vec2 size;\r\nvarying vec4 color;\r\n//vec4 dirxy=vec4(0.9,0.1, -0.1,0.9);\r\n//vec4 clip=vec4(100.,30.,300.,600.);\r\nvarying vec2 cliped;\r\nvoid main(){\r\n\t\r\n#ifdef WORLDMAT\r\n\tvec4 pos=mmat*vec4(position.xy,0.,1.);\r\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\r\n#else\r\n\tgl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\r\n#endif\t\r\n\tfloat clipw = length(clipMatDir.xy);\r\n\tfloat cliph = length(clipMatDir.zw);\r\n\tvec2 clippos = position.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\r\n\tif(clipw>20000. && cliph>20000.)\r\n\t\tcliped = vec2(0.5,0.5);\r\n\telse {\r\n\t\t//clipdir是带缩放的方向，由于上面clippos是在缩放后的空间计算的，所以需要把方向先normalize一下\r\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\r\n\t}\r\n  //pos2d.x = dot(clippos,dirx);\r\n  color=attribColor/255.;\r\n}","precision mediump float;\r\n//precision mediump float;\r\nvarying vec4 color;\r\n//uniform float alpha;\r\nvarying vec2 cliped;\r\nvoid main(){\r\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\r\n\t//a.a*=alpha;\r\n    gl_FragColor= color;// vec4(color.r, color.g, color.b, alpha);\r\n\tgl_FragColor.rgb*=color.a;\r\n\tif(cliped.x<0.) discard;\r\n\tif(cliped.x>1.) discard;\r\n\tif(cliped.y<0.) discard;\r\n\tif(cliped.y>1.) discard;\r\n}","attribute vec2 position;\r\nattribute vec2 texcoord;\r\nattribute vec4 color;\r\nuniform vec2 size;\r\nuniform float offsetX;\r\nuniform float offsetY;\r\nuniform mat4 mmat;\r\nuniform mat4 u_mmat2;\r\nvarying vec2 v_texcoord;\r\nvarying vec4 v_color;\r\nvoid main() {\r\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\r\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\r\n  v_color = color;\r\n  v_color.rgb *= v_color.a;\r\n  v_texcoord = texcoord;  \r\n}","precision mediump float;\r\nvarying vec2 v_texcoord;\r\nvarying vec4 v_color;\r\nuniform sampler2D texture;\r\nuniform float alpha;\r\nvoid main() {\r\n\tvec4 t_color = texture2D(texture, v_texcoord);\r\n\tgl_FragColor = t_color.rgba * v_color;\r\n\tgl_FragColor *= alpha;\r\n}","import { ShaderDefines2D } from \"./ShaderDefines2D\";\r\nimport { DrawStyle } from \"../../canvas/DrawStyle\"\r\nimport { Shader } from \"../Shader\"\r\n\r\nimport texture_vs from './files/texture.vs.glsl';\r\nimport texture_ps from './files/texture.ps.glsl';\r\nimport prime_vs from './files/primitive.vs.glsl';\r\nimport prime_ps from './files/primitive.ps.glsl';\r\nimport skin_vs from './skinAnishader/skinShader.vs.glsl';\r\nimport skin_ps from './skinAnishader/skinShader.ps.glsl';\r\n\r\nexport class Shader2D {\r\n    ALPHA: number = 1;\r\n    shader: Shader;\r\n    filters: any[];\r\n    defines = new ShaderDefines2D();\r\n    shaderType: number = 0;\r\n    colorAdd: any[];\r\n    fillStyle = DrawStyle.DEFAULT;\r\n    strokeStyle  = DrawStyle.DEFAULT;\r\n    destroy(): void {\r\n\t\t//@ts-ignore\r\n\t\tthis.defines = null;\r\n\t\t//@ts-ignore\r\n        this.filters = null;\r\n    }\r\n\r\n    static __init__(): void {\r\n        Shader.preCompile2D(0, ShaderDefines2D.TEXTURE2D, texture_vs, texture_ps, null);\r\n        Shader.preCompile2D(0, ShaderDefines2D.PRIMITIVE, prime_vs, prime_ps, null);\r\n        Shader.preCompile2D(0, ShaderDefines2D.SKINMESH, skin_vs, skin_ps, null);\r\n    }\r\n}\r\n\r\n","import { WebGLContext } from \"../../../WebGLContext\"\r\nimport { IndexBuffer2D } from \"../../../utils/IndexBuffer2D\"\r\nimport { VertexBuffer2D } from \"../../../utils/VertexBuffer2D\"\r\nimport { LayaGL } from \"../../../../layagl/LayaGL\";\r\n\r\nexport class SkinMeshBuffer {\r\n\r\n    ib: IndexBuffer2D;\r\n    vb: VertexBuffer2D;\r\n\r\n    static instance: SkinMeshBuffer;\r\n\r\n    //TODO:coverage\r\n    constructor() {\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        this.ib = IndexBuffer2D.create(gl.DYNAMIC_DRAW);\r\n        this.vb = VertexBuffer2D.create(8);\r\n    }\r\n\r\n    //TODO:coverage\r\n    static getInstance(): SkinMeshBuffer {\r\n        return SkinMeshBuffer.instance = SkinMeshBuffer.instance || new SkinMeshBuffer();\r\n    }\r\n\r\n    //TODO:coverage\r\n    addSkinMesh(skinMesh: any): void {\r\n        //skinMesh.getData(vb, ib, vb.byteLength / 32);\r\n        skinMesh.getData2(this.vb, this.ib, this.vb._byteLength / 32);\r\n    }\r\n\r\n\r\n    reset(): void {\r\n        this.vb.clear();\r\n        this.ib.clear();\r\n    }\r\n\r\n}\r\n\r\n\r\n","export class BasePoly {\r\n\r\n    private static tempData: any[] = new Array(256);\r\n\r\n\t/**\r\n\t * 构造线的三角形数据。根据一个位置数组生成vb和ib\r\n\t * @param\tp\r\n\t * @param\tindices\r\n\t * @param\tlineWidth\r\n\t * @param\tindexBase\t\t\t\t顶点开始的值，ib中的索引会加上这个\r\n\t * @param\toutVertex\r\n\t * @return\r\n\t */\r\n    static createLine2(p: any[], indices: any[], lineWidth: number, indexBase: number, outVertex: any[], loop: boolean): any[] {\r\n\r\n        if (p.length < 4) return null;\r\n        var points: any[] = BasePoly.tempData.length > (p.length + 2) ? BasePoly.tempData : new Array(p.length + 2);\t//可能有loop，所以+2\r\n        points[0] = p[0]; points[1] = p[1];\r\n\t\t/*\r\n\t\tvar points:Array = p.concat();\r\n\t\tif (loop) {\r\n\t\t\tpoints.push(points[0], points[1]);\r\n\t\t}\r\n\t\t*/\r\n        var newlen: number = 2;\t//points的下标，也是points的实际长度\r\n        var i: number = 0;\r\n        var length: number = p.length;\r\n        //先过滤一下太相近的点\r\n        for (i = 2; i < length; i += 2) {\r\n            if (Math.abs(p[i] - p[i - 2]) + Math.abs(p[i + 1] - p[i - 1]) > 0.01) {//只是判断是否重合，所以不用sqrt\r\n                points[newlen++] = p[i]; points[newlen++] = p[i + 1];\r\n            }\r\n        }\r\n        //如果终点和起点没有重合，且要求loop的情况的处理\r\n        if (loop && Math.abs(p[0] - points[newlen - 2]) + Math.abs(p[1] - points[newlen - 1]) > 0.01) {\r\n            points[newlen++] = p[0]; points[newlen++] = p[1];\r\n        }\r\n\r\n        var result: any[] = outVertex;\r\n        length = newlen / 2;\t//points可能有多余的点，所以要用inew来表示\r\n        var w: number = lineWidth / 2;\r\n\r\n        var px: number, py: number, p1x: number, p1y: number, p2x: number, p2y: number, p3x: number, p3y: number;\r\n        var perpx: number, perpy: number, perp2x: number, perp2y: number, perp3x: number, perp3y: number;\r\n        var a1: number, b1: number, c1: number, a2: number, b2: number, c2: number;\r\n        var denom: number, pdist: number, dist: number;\r\n\r\n        p1x = points[0];\r\n        p1y = points[1];\r\n        p2x = points[2];\r\n        p2y = points[3];\r\n\r\n        perpx = -(p1y - p2y);\r\n        perpy = p1x - p2x;\r\n        dist = Math.sqrt(perpx * perpx + perpy * perpy);\r\n        perpx = perpx / dist * w;\r\n        perpy = perpy / dist * w;\r\n\r\n        result.push(p1x - perpx, p1y - perpy, p1x + perpx, p1y + perpy);\r\n        for (i = 1; i < length - 1; i++) {\r\n            p1x = points[(i - 1) * 2];\r\n            p1y = points[(i - 1) * 2 + 1];\r\n            p2x = points[(i) * 2];\r\n            p2y = points[(i) * 2 + 1];\r\n            p3x = points[(i + 1) * 2];\r\n            p3y = points[(i + 1) * 2 + 1];\r\n\r\n            perpx = -(p1y - p2y);\r\n            perpy = p1x - p2x;\r\n            dist = Math.sqrt(perpx * perpx + perpy * perpy);\r\n            perpx = perpx / dist * w;\r\n            perpy = perpy / dist * w;\r\n\r\n            perp2x = -(p2y - p3y);\r\n            perp2y = p2x - p3x;\r\n            dist = Math.sqrt(perp2x * perp2x + perp2y * perp2y);\r\n            perp2x = perp2x / dist * w;\r\n            perp2y = perp2y / dist * w;\r\n\r\n            a1 = (-perpy + p1y) - (-perpy + p2y);\r\n            b1 = (-perpx + p2x) - (-perpx + p1x);\r\n            c1 = (-perpx + p1x) * (-perpy + p2y) - (-perpx + p2x) * (-perpy + p1y);\r\n            a2 = (-perp2y + p3y) - (-perp2y + p2y);\r\n            b2 = (-perp2x + p2x) - (-perp2x + p3x);\r\n            c2 = (-perp2x + p3x) * (-perp2y + p2y) - (-perp2x + p2x) * (-perp2y + p3y);\r\n            denom = a1 * b2 - a2 * b1;\r\n            if (Math.abs(denom) < 0.1) {\r\n                denom += 10.1;\r\n                result.push(p2x - perpx, p2y - perpy, p2x + perpx, p2y + perpy);\r\n                continue;\r\n            }\r\n            px = (b1 * c2 - b2 * c1) / denom;\r\n            py = (a2 * c1 - a1 * c2) / denom;\r\n            pdist = (px - p2x) * (px - p2x) + (py - p2y) + (py - p2y);\r\n            result.push(px, py, p2x - (px - p2x), p2y - (py - p2y));\r\n        }\r\n\r\n        p1x = points[newlen - 4];\r\n        p1y = points[newlen - 3];\r\n        p2x = points[newlen - 2];\r\n        p2y = points[newlen - 1];\r\n\r\n        perpx = -(p1y - p2y);\r\n        perpy = p1x - p2x;\r\n        dist = Math.sqrt(perpx * perpx + perpy * perpy);\r\n        perpx = perpx / dist * w;\r\n        perpy = perpy / dist * w;\r\n\r\n        result.push(p2x - perpx, p2y - perpy, p2x + perpx, p2y + perpy);\r\n        for (i = 1; i < length; i++) {\r\n            indices.push(indexBase + (i - 1) * 2, indexBase + (i - 1) * 2 + 1, indexBase + i * 2 + 1, indexBase + i * 2 + 1, indexBase + i * 2, indexBase + (i - 1) * 2);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n\t/**\r\n\t * 相邻的两段线，边界会相交，这些交点可以作为三角形的顶点。有两种可选，一种是采用左左,右右交点，一种是采用 左右，左右交点。当两段线夹角很小的时候，如果采用\r\n\t * 左左，右右会产生很长很长的交点，这时候就要采用左右左右交点，相当于把尖角截断。\r\n\t * 当采用左左右右交点的时候，直接用切线的垂线。采用左右左右的时候，用切线\r\n\t * 切线直接采用两个方向的平均值。不能用3-1的方式，那样垂线和下一段可能都在同一方向（例如都在右方）\r\n\t * 注意把重合的点去掉\r\n\t * @param\tpath\r\n\t * @param\tcolor\r\n\t * @param\twidth\r\n\t * @param\tloop\r\n\t * @param\toutvb\r\n\t * @param\tvbstride  顶点占用几个float,(bytelength/4)\r\n\t * @param\toutib\r\n\t * test:\r\n\t * 横线\r\n\t * [100,100, 400,100]\r\n\t * 竖线\r\n\t * [100,100, 100,400]\r\n\t * 直角\r\n\t * [100,100, 400,100, 400,400]\r\n\t * 重合点\r\n\t * [100,100,100,100,400,100]\r\n\t * 同一直线上的点\r\n\t * [100,100,100,200,100,3000]\r\n\t * 像老式电视的左边不封闭的图形\r\n\t * [98,176,  163,178, 95,66, 175,177, 198,178, 252,56, 209,178,  248,175,  248,266,  209,266, 227,277, 203,280, 188,271,  150,271, 140,283, 122,283, 131,268, 99,268]\r\n\t * \r\n\t */\r\n    //TODO:coverage\r\n    static createLineTriangle(path: any[], color: number, width: number, loop: boolean, outvb: Float32Array, vbstride: number, outib: Uint16Array): void {\r\n\r\n        var points: any[] = path.slice();\r\n        var ptlen: number = points.length;\r\n        var p1x: number = points[0], p1y: number = points[1];\r\n        var p2x: number = points[2], p2y: number = points[2];\r\n        var len: number = 0;\r\n        var rp: number = 0;\r\n        var dx: number = 0, dy: number = 0;\r\n\r\n        //计算每一段的长度，取出有效数据。保存:长度，方向，拐角，切线\r\n        //x,y,len,dx,dy,tx,ty,dot\r\n        //数组中每个都表示当前点开始的长度，方向\r\n        //x,y,dx,dy\r\n\r\n        var pointnum: number = ptlen / 2;\r\n        if (pointnum <= 1) return;\r\n        if (pointnum == 2) {\r\n            //TODO\r\n            return;\r\n        }\r\n\r\n        var tmpData: any[] = new Array(pointnum * 4);//TODO 做到外面\r\n        var realPtNum: number = 0;\t//去掉重复点后的实际点个数。同一直线上的点不做优化\r\n        //var segNum:int = pointnum + (loop?1:0);\r\n        var ci: number = 0;\r\n        for (var i: number = 0; i < pointnum - 1; i++) {\r\n            p1x = points[ci++], p1y = points[ci++];\r\n            p2x = points[ci++], p2y = points[ci++];\r\n            dx = p2x - p1x, dy = p2y - p1y;\r\n            if (dx != 0 && dy != 0) {\r\n                len = Math.sqrt(dx * dx + dy * dy);\r\n                if (len > 1e-3) {\r\n                    rp = realPtNum * 4;\r\n                    tmpData[rp] = p1x;\r\n                    tmpData[rp + 1] = p1y;\r\n                    tmpData[rp + 2] = dx / len;\r\n                    tmpData[rp + 3] = dy / len;\r\n                    realPtNum++;\r\n                }\r\n            }\r\n        }\r\n        if (loop) {//loop的话，需要取第一个点来算\r\n            p1x = points[ptlen - 2], p1y = points[ptlen - 1];\r\n            p2x = points[0], p2y = points[1];\r\n            dx = p2x - p1x, dy = p2y - p1y;\r\n            if (dx != 0 && dy != 0) {//如果长度为零的话，最后这个点就不用加了，上一个点就是指向了第一个点。\r\n                len = Math.sqrt(dx * dx + dy * dy);\r\n                if (len > 1e-3) {\r\n                    rp = realPtNum * 4;\r\n                    tmpData[rp] = p1x;\r\n                    tmpData[rp + 1] = p1y;\r\n                    tmpData[rp + 2] = dx / len;\r\n                    tmpData[rp + 3] = dy / len;\r\n                    realPtNum++;\r\n                }\r\n            }\r\n        } else {//不是loop的话，直接取当前段的朝向，记录在上一个点上\r\n            rp = realPtNum * 4;\r\n            tmpData[rp] = p1x;\r\n            tmpData[rp + 1] = p1y;\r\n            tmpData[rp + 2] = dx / len;\r\n            tmpData[rp + 3] = dy / len;\r\n            realPtNum++;\r\n        }\r\n        ci = 0;\r\n\r\n\t\t/**\r\n\t\t * 根据前后两段的方向，计算垂线的方向，根据这个方向和任意一边的dxdy的垂线的点积为w/2可以得到长度。就可以得到增加的点\r\n\t\t */\r\n        //如果相邻两段朝向的dot值接近-1，则表示反向了，需要改成切\r\n\r\n        for (i = 0; i < pointnum; i++) {\r\n            p1x = points[ci], p1y = points[ci + 1];\r\n            p2x = points[ci + 2], p2y = points[ci + 3];\r\n            //var p3x: number = points[ci + 4], p3y: number = points[ci + 5];\r\n\r\n        }\r\n        if (loop) {\r\n\r\n        }\r\n\r\n    }\r\n}\r\n\r\n","export class EarcutNode {\r\n    i: any;\r\n    x: any;\r\n    y: any;\r\n    prev: any;\r\n    next: any;\r\n    z: any;\r\n    prevZ: any;\r\n    nextZ: any;\r\n    steiner: any;\r\n    constructor(i: any, x: any, y: any) {\r\n        // vertice index in coordinates array\r\n        this.i = i;\r\n\r\n        // vertex coordinates\r\n        this.x = x;\r\n        this.y = y;\r\n\r\n        // previous and next vertice nodes in a polygon ring\r\n        this.prev = null;\r\n        this.next = null;\r\n\r\n        // z-order curve value\r\n        this.z = null;\r\n\r\n        // previous and next nodes in z-order\r\n        this.prevZ = null;\r\n        this.nextZ = null;\r\n\r\n        // indicates whether this is a steiner point\r\n        this.steiner = false;\r\n    }\r\n}\r\n\r\n\r\n\r\n","import { EarcutNode } from \"./EarcutNode\";\r\nexport class Earcut {\r\n    static earcut(data: any, holeIndices: any, dim: any): any {\r\n\r\n        dim = dim || 2;\r\n\r\n        var hasHoles: any = holeIndices && holeIndices.length,\r\n            outerLen: any = hasHoles ? holeIndices[0] * dim : data.length,\r\n            outerNode: any = Earcut.linkedList(data, 0, outerLen, dim, true),\r\n            triangles: any = [];\r\n\r\n        if (!outerNode) return triangles;\r\n\r\n        var minX: any, minY: any, maxX: any, maxY: any, x: any, y: any, invSize: any;\r\n\r\n        if (hasHoles) outerNode = Earcut.eliminateHoles(data, holeIndices, outerNode, dim);\r\n\r\n        // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\r\n        if (data.length > 80 * dim) {\r\n            minX = maxX = data[0];\r\n            minY = maxY = data[1];\r\n\r\n            for (var i: any = dim; i < outerLen; i += dim) {\r\n                x = data[i];\r\n                y = data[i + 1];\r\n                if (x < minX) minX = x;\r\n                if (y < minY) minY = y;\r\n                if (x > maxX) maxX = x;\r\n                if (y > maxY) maxY = y;\r\n            }\r\n\r\n            // minX, minY and invSize are later used to transform coords into integers for z-order calculation\r\n            invSize = Math.max(maxX - minX, maxY - minY);\r\n            invSize = invSize !== 0 ? 1 / invSize : 0;\r\n        }\r\n\r\n        Earcut.earcutLinked(outerNode, triangles, dim, minX, minY, invSize);\r\n\r\n        return triangles;\r\n    }\r\n\r\n    // create a circular doubly linked list from polygon points in the specified winding order\r\n    static linkedList(data: any, start: any, end: any, dim: any, clockwise: any): any {\r\n        var i: any, last: any;\r\n\r\n        if (clockwise === (Earcut.signedArea(data, start, end, dim) > 0)) {\r\n            for (i = start; i < end; i += dim) last = Earcut.insertNode(i, data[i], data[i + 1], last);\r\n        } else {\r\n            for (i = end - dim; i >= start; i -= dim) last = Earcut.insertNode(i, data[i], data[i + 1], last);\r\n        }\r\n\r\n        if (last && Earcut.equals(last, last.next)) {\r\n            Earcut.removeNode(last);\r\n            last = last.next;\r\n        }\r\n\r\n        return last;\r\n    }\r\n\r\n    // eliminate colinear or duplicate points\r\n    static filterPoints(start: any, end: any): any {\r\n        if (!start) return start;\r\n        if (!end) end = start;\r\n\r\n        var p: any = start,\r\n            again: any;\r\n        do {\r\n            again = false;\r\n\r\n            if (!p.steiner && (Earcut.equals(p, p.next) || Earcut.area(p.prev, p, p.next) === 0)) {\r\n                Earcut.removeNode(p);\r\n                p = end = p.prev;\r\n                if (p === p.next) break;\r\n                again = true;\r\n\r\n            } else {\r\n                p = p.next;\r\n            }\r\n        } while (again || p !== end);\r\n\r\n        return end;\r\n    }\r\n\r\n    // main ear slicing loop which triangulates a polygon (given as a linked list)\r\n    static earcutLinked(ear: any, triangles: any, dim: any, minX: any, minY: any, invSize: any, pass: any = null): any {\r\n        if (!ear) return;\r\n\r\n        // interlink polygon nodes in z-order\r\n        if (!pass && invSize) Earcut.indexCurve(ear, minX, minY, invSize);\r\n\r\n        var stop: any = ear,\r\n            prev: any, next: any;\r\n\r\n        // iterate through ears, slicing them one by one\r\n        while (ear.prev !== ear.next) {\r\n            prev = ear.prev;\r\n            next = ear.next;\r\n\r\n            if (invSize ? Earcut.isEarHashed(ear, minX, minY, invSize) : Earcut.isEar(ear)) {\r\n                // cut off the triangle\r\n                triangles.push(prev.i / dim);\r\n                triangles.push(ear.i / dim);\r\n                triangles.push(next.i / dim);\r\n\r\n                Earcut.removeNode(ear);\r\n\r\n                // skipping the next vertice leads to less sliver triangles\r\n                ear = next.next;\r\n                stop = next.next;\r\n\r\n                continue;\r\n            }\r\n\r\n            ear = next;\r\n\r\n            // if we looped through the whole remaining polygon and can't find any more ears\r\n            if (ear === stop) {\r\n                // try filtering points and slicing again\r\n                if (!pass) {\r\n                    Earcut.earcutLinked(Earcut.filterPoints(ear, null), triangles, dim, minX, minY, invSize, 1);\r\n\r\n                    // if this didn't work, try curing all small self-intersections locally\r\n                } else if (pass === 1) {\r\n                    ear = Earcut.cureLocalIntersections(ear, triangles, dim);\r\n                    Earcut.earcutLinked(ear, triangles, dim, minX, minY, invSize, 2);\r\n\r\n                    // as a last resort, try splitting the remaining polygon into two\r\n                } else if (pass === 2) {\r\n                    Earcut.splitEarcut(ear, triangles, dim, minX, minY, invSize);\r\n                }\r\n\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    // check whether a polygon node forms a valid ear with adjacent nodes\r\n    static isEar(ear: any): any {\r\n        var a: any = ear.prev,\r\n            b: any = ear,\r\n            c: any = ear.next;\r\n\r\n        if (Earcut.area(a, b, c) >= 0) return false; // reflex, can't be an ear\r\n\r\n        // now make sure we don't have other points inside the potential ear\r\n        var p: any = ear.next.next;\r\n\r\n        while (p !== ear.prev) {\r\n            if (Earcut.pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\r\n                Earcut.area(p.prev, p, p.next) >= 0) return false;\r\n            p = p.next;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    //TODO:coverage\r\n    static isEarHashed(ear: any, minX: any, minY: any, invSize: any): boolean {\r\n        var a: any = ear.prev,\r\n            b: any = ear,\r\n            c: any = ear.next;\r\n\r\n        if (Earcut.area(a, b, c) >= 0) return false; // reflex, can't be an ear\r\n\r\n        // triangle bbox; min & max are calculated like this for speed\r\n        var minTX: any = a.x < b.x ? (a.x < c.x ? a.x : c.x) : (b.x < c.x ? b.x : c.x),\r\n            minTY: any = a.y < b.y ? (a.y < c.y ? a.y : c.y) : (b.y < c.y ? b.y : c.y),\r\n            maxTX: any = a.x > b.x ? (a.x > c.x ? a.x : c.x) : (b.x > c.x ? b.x : c.x),\r\n            maxTY: any = a.y > b.y ? (a.y > c.y ? a.y : c.y) : (b.y > c.y ? b.y : c.y);\r\n\r\n        // z-order range for the current triangle bbox;\r\n        var minZ: any = Earcut.zOrder(minTX, minTY, minX, minY, invSize),\r\n            maxZ: any = Earcut.zOrder(maxTX, maxTY, minX, minY, invSize);\r\n\r\n        // first look for points inside the triangle in increasing z-order\r\n        var p: any = ear.nextZ;\r\n\r\n        while (p && p.z <= maxZ) {\r\n            if (p !== ear.prev && p !== ear.next &&\r\n                Earcut.pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\r\n                Earcut.area(p.prev, p, p.next) >= 0) return false;\r\n            p = p.nextZ;\r\n        }\r\n\r\n        // then look for points in decreasing z-order\r\n        p = ear.prevZ;\r\n\r\n        while (p && p.z >= minZ) {\r\n            if (p !== ear.prev && p !== ear.next &&\r\n                Earcut.pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\r\n                Earcut.area(p.prev, p, p.next) >= 0) return false;\r\n            p = p.prevZ;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    // go through all polygon nodes and cure small local self-intersections\r\n    //TODO:coverage\r\n    static cureLocalIntersections(start: any, triangles: any, dim: any): any {\r\n        var p: any = start;\r\n        do {\r\n            var a: any = p.prev,\r\n                b: any = p.next.next;\r\n\r\n            if (!Earcut.equals(a, b) && Earcut.intersects(a, p, p.next, b) && Earcut.locallyInside(a, b) && Earcut.locallyInside(b, a)) {\r\n\r\n                triangles.push(a.i / dim);\r\n                triangles.push(p.i / dim);\r\n                triangles.push(b.i / dim);\r\n\r\n                // remove two nodes involved\r\n                Earcut.removeNode(p);\r\n                Earcut.removeNode(p.next);\r\n\r\n                p = start = b;\r\n            }\r\n            p = p.next;\r\n        } while (p !== start);\r\n\r\n        return p;\r\n    }\r\n\r\n    // try splitting polygon into two and triangulate them independently\r\n    //TODO:coverage\r\n    static splitEarcut(start: any, triangles: any, dim: any, minX: any, minY: any, invSize: any): void {\r\n        // look for a valid diagonal that divides the polygon into two\r\n        var a: any = start;\r\n        do {\r\n            var b: any = a.next.next;\r\n            while (b !== a.prev) {\r\n                if (a.i !== b.i && Earcut.isValidDiagonal(a, b)) {\r\n                    // split the polygon in two by the diagonal\r\n                    var c: any = Earcut.splitPolygon(a, b);\r\n\r\n                    // filter colinear points around the cuts\r\n                    a = Earcut.filterPoints(a, a.next);\r\n                    c = Earcut.filterPoints(c, c.next);\r\n\r\n                    // run earcut on each half\r\n                    Earcut.earcutLinked(a, triangles, dim, minX, minY, invSize);\r\n                    Earcut.earcutLinked(c, triangles, dim, minX, minY, invSize);\r\n                    return;\r\n                }\r\n                b = b.next;\r\n            }\r\n            a = a.next;\r\n        } while (a !== start);\r\n    }\r\n\r\n    // link every hole into the outer loop, producing a single-ring polygon without holes\r\n    //TODO:coverage\r\n    static eliminateHoles(data: any, holeIndices: any, outerNode: any, dim: any): any {\r\n        var queue: any = [],\r\n            i: any, len: any, start: any, end: any, list: any;\r\n\r\n        for (i = 0, len = holeIndices.length; i < len; i++) {\r\n            start = holeIndices[i] * dim;\r\n            end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\r\n            list = Earcut.linkedList(data, start, end, dim, false);\r\n            if (list === list.next) list.steiner = true;\r\n            queue.push(Earcut.getLeftmost(list));\r\n        }\r\n\r\n        queue.sort(Earcut.compareX);\r\n\r\n        // process holes from left to right\r\n        for (i = 0; i < queue.length; i++) {\r\n            Earcut.eliminateHole(queue[i], outerNode);\r\n            outerNode = Earcut.filterPoints(outerNode, outerNode.next);\r\n        }\r\n\r\n        return outerNode;\r\n    }\r\n\r\n    //TODO:coverage\r\n    static compareX(a: any, b: any): any {\r\n        return a.x - b.x;\r\n    }\r\n\r\n    // find a bridge between vertices that connects hole with an outer ring and and link it\r\n    //TODO:coverage\r\n    static eliminateHole(hole: any, outerNode: any): void {\r\n        outerNode = Earcut.findHoleBridge(hole, outerNode);\r\n        if (outerNode) {\r\n            var b: any = Earcut.splitPolygon(outerNode, hole);\r\n            Earcut.filterPoints(b, b.next);\r\n        }\r\n    }\r\n\r\n    // David Eberly's algorithm for finding a bridge between hole and outer polygon\r\n    //TODO:coverage\r\n    static findHoleBridge(hole: any, outerNode: any): any {\r\n        var p: any = outerNode,\r\n            hx: any = hole.x,\r\n            hy: any = hole.y,\r\n            qx: any = -Infinity,\r\n            m: any;\r\n\r\n        // find a segment intersected by a ray from the hole's leftmost point to the left;\r\n        // segment's endpoint with lesser x will be potential connection point\r\n        do {\r\n            if (hy <= p.y && hy >= p.next.y && p.next.y !== p.y) {\r\n                var x: any = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\r\n                if (x <= hx && x > qx) {\r\n                    qx = x;\r\n                    if (x === hx) {\r\n                        if (hy === p.y) return p;\r\n                        if (hy === p.next.y) return p.next;\r\n                    }\r\n                    m = p.x < p.next.x ? p : p.next;\r\n                }\r\n            }\r\n            p = p.next;\r\n        } while (p !== outerNode);\r\n\r\n        if (!m) return null;\r\n\r\n        if (hx === qx) return m.prev; // hole touches outer segment; pick lower endpoint\r\n\r\n        // look for points inside the triangle of hole point, segment intersection and endpoint;\r\n        // if there are no points found, we have a valid connection;\r\n        // otherwise choose the point of the minimum angle with the ray as connection point\r\n\r\n        var stop: any = m,\r\n            mx: any = m.x,\r\n            my: any = m.y,\r\n            tanMin: any = Infinity,\r\n            tan: any;\r\n\r\n        p = m.next;\r\n\r\n        while (p !== stop) {\r\n            if (hx >= p.x && p.x >= mx && hx !== p.x &&\r\n                Earcut.pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\r\n\r\n                tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\r\n\r\n                if ((tan < tanMin || (tan === tanMin && p.x > m.x)) && Earcut.locallyInside(p, hole)) {\r\n                    m = p;\r\n                    tanMin = tan;\r\n                }\r\n            }\r\n\r\n            p = p.next;\r\n        }\r\n\r\n        return m;\r\n    }\r\n\r\n    // interlink polygon nodes in z-order\r\n    //TODO:coverage\r\n    static indexCurve(start: any, minX: any, minY: any, invSize: any): void {\r\n        var p: any = start;\r\n        do {\r\n            if (p.z === null) p.z = Earcut.zOrder(p.x, p.y, minX, minY, invSize);\r\n            p.prevZ = p.prev;\r\n            p.nextZ = p.next;\r\n            p = p.next;\r\n        } while (p !== start);\r\n\r\n        p.prevZ.nextZ = null;\r\n        p.prevZ = null;\r\n\r\n        Earcut.sortLinked(p);\r\n    }\r\n\r\n    // Simon Tatham's linked list merge sort algorithm\r\n    // http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\r\n    //TODO:coverage\r\n    static sortLinked(list: any): any {\r\n        var i: any, p: any, q: any, e: any, tail: any, numMerges: any, pSize: any, qSize: any,\r\n            inSize: any = 1;\r\n\r\n        do {\r\n            p = list;\r\n            list = null;\r\n            tail = null;\r\n            numMerges = 0;\r\n\r\n            while (p) {\r\n                numMerges++;\r\n                q = p;\r\n                pSize = 0;\r\n                for (i = 0; i < inSize; i++) {\r\n                    pSize++;\r\n                    q = q.nextZ;\r\n                    if (!q) break;\r\n                }\r\n                qSize = inSize;\r\n\r\n                while (pSize > 0 || (qSize > 0 && q)) {\r\n\r\n                    if (pSize !== 0 && (qSize === 0 || !q || p.z <= q.z)) {\r\n                        e = p;\r\n                        p = p.nextZ;\r\n                        pSize--;\r\n                    } else {\r\n                        e = q;\r\n                        q = q.nextZ;\r\n                        qSize--;\r\n                    }\r\n\r\n                    if (tail) tail.nextZ = e;\r\n                    else list = e;\r\n\r\n                    e.prevZ = tail;\r\n                    tail = e;\r\n                }\r\n\r\n                p = q;\r\n            }\r\n\r\n            tail.nextZ = null;\r\n            inSize *= 2;\r\n\r\n        } while (numMerges > 1);\r\n\r\n        return list;\r\n    }\r\n\r\n    // z-order of a point given coords and inverse of the longer side of data bbox\r\n    //TODO:coverage\r\n    static zOrder(x: any, y: any, minX: any, minY: any, invSize: any): any {\r\n        // coords are transformed into non-negative 15-bit integer range\r\n        x = 32767 * (x - minX) * invSize;\r\n        y = 32767 * (y - minY) * invSize;\r\n\r\n        x = (x | (x << 8)) & 0x00FF00FF;\r\n        x = (x | (x << 4)) & 0x0F0F0F0F;\r\n        x = (x | (x << 2)) & 0x33333333;\r\n        x = (x | (x << 1)) & 0x55555555;\r\n\r\n        y = (y | (y << 8)) & 0x00FF00FF;\r\n        y = (y | (y << 4)) & 0x0F0F0F0F;\r\n        y = (y | (y << 2)) & 0x33333333;\r\n        y = (y | (y << 1)) & 0x55555555;\r\n\r\n        return x | (y << 1);\r\n    }\r\n\r\n    // find the leftmost node of a polygon ring\r\n    //TODO:coverage\r\n    static getLeftmost(start: any): any {\r\n        var p: any = start,\r\n            leftmost: any = start;\r\n        do {\r\n            if (p.x < leftmost.x) leftmost = p;\r\n            p = p.next;\r\n        } while (p !== start);\r\n\r\n        return leftmost;\r\n    }\r\n\r\n    // check if a point lies within a convex triangle\r\n    static pointInTriangle(ax: any, ay: any, bx: any, by: any, cx: any, cy: any, px: any, py: any): boolean {\r\n        return (cx - px) * (ay - py) - (ax - px) * (cy - py) >= 0 &&\r\n            (ax - px) * (by - py) - (bx - px) * (ay - py) >= 0 &&\r\n            (bx - px) * (cy - py) - (cx - px) * (by - py) >= 0;\r\n    }\r\n\r\n    // check if a diagonal between two polygon nodes is valid (lies in polygon interior)\r\n    //TODO:coverage\r\n    static isValidDiagonal(a: any, b: any): boolean {\r\n        return a.next.i !== b.i && a.prev.i !== b.i && !Earcut.intersectsPolygon(a, b) &&\r\n            Earcut.locallyInside(a, b) && Earcut.locallyInside(b, a) && Earcut.middleInside(a, b);\r\n    }\r\n\r\n    // signed area of a triangle\r\n    static area(p: any, q: any, r: any): any {\r\n        return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\r\n    }\r\n\r\n    // check if two points are equal\r\n    static equals(p1: any, p2: any): boolean {\r\n        return p1.x === p2.x && p1.y === p2.y;\r\n    }\r\n\r\n    // check if two segments intersect\r\n    //TODO:coverage\r\n    static intersects(p1: any, q1: any, p2: any, q2: any): boolean {\r\n        if ((Earcut.equals(p1, q1) && Earcut.equals(p2, q2)) ||\r\n            (Earcut.equals(p1, q2) && Earcut.equals(p2, q1))) return true;\r\n        return Earcut.area(p1, q1, p2) > 0 !== Earcut.area(p1, q1, q2) > 0 &&\r\n            Earcut.area(p2, q2, p1) > 0 !== Earcut.area(p2, q2, q1) > 0;\r\n    }\r\n\r\n    // check if a polygon diagonal intersects any polygon segments\r\n    //TODO:coverage\r\n    static intersectsPolygon(a: any, b: any): boolean {\r\n        var p: any = a;\r\n        do {\r\n            if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\r\n                Earcut.intersects(p, p.next, a, b)) return true;\r\n            p = p.next;\r\n        } while (p !== a);\r\n\r\n        return false;\r\n    }\r\n\r\n    // check if a polygon diagonal is locally inside the polygon\r\n    //TODO:coverage\r\n    static locallyInside(a: any, b: any): boolean {\r\n        return Earcut.area(a.prev, a, a.next) < 0 ?\r\n            Earcut.area(a, b, a.next) >= 0 && Earcut.area(a, a.prev, b) >= 0 :\r\n            Earcut.area(a, b, a.prev) < 0 || Earcut.area(a, a.next, b) < 0;\r\n    }\r\n\r\n    // check if the middle point of a polygon diagonal is inside the polygon\r\n    //TODO:coverage\r\n    static middleInside(a: any, b: any): boolean {\r\n        var p: any = a,\r\n            inside: any = false,\r\n            px: any = (a.x + b.x) / 2,\r\n            py: any = (a.y + b.y) / 2;\r\n        do {\r\n            if (((p.y > py) !== (p.next.y > py)) && p.next.y !== p.y &&\r\n                (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\r\n                inside = !inside;\r\n            p = p.next;\r\n        } while (p !== a);\r\n\r\n        return inside;\r\n    }\r\n\r\n    // link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\r\n    // if one belongs to the outer ring and another to a hole, it merges it into a single ring\r\n    //TODO:coverage\r\n    static splitPolygon(a: any, b: any): any {\r\n        var a2: any = new EarcutNode(a.i, a.x, a.y),\r\n            b2: any = new EarcutNode(b.i, b.x, b.y),\r\n            an: any = a.next,\r\n            bp: any = b.prev;\r\n\r\n        a.next = b;\r\n        b.prev = a;\r\n\r\n        a2.next = an;\r\n        an.prev = a2;\r\n\r\n        b2.next = a2;\r\n        a2.prev = b2;\r\n\r\n        bp.next = b2;\r\n        b2.prev = bp;\r\n\r\n        return b2;\r\n    }\r\n\r\n    // create a node and optionally link it with previous one (in a circular doubly linked list)\r\n    static insertNode(i: any, x: any, y: any, last: any): any {\r\n        var p: any = new EarcutNode(i, x, y);\r\n\r\n        if (!last) {\r\n            p.prev = p;\r\n            p.next = p;\r\n\r\n        } else {\r\n            p.next = last.next;\r\n            p.prev = last;\r\n            last.next.prev = p;\r\n            last.next = p;\r\n        }\r\n        return p;\r\n    }\r\n\r\n    static removeNode(p: any): void {\r\n        p.next.prev = p.prev;\r\n        p.prev.next = p.next;\r\n\r\n        if (p.prevZ) p.prevZ.nextZ = p.nextZ;\r\n        if (p.nextZ) p.nextZ.prevZ = p.prevZ;\r\n    }\r\n    // return a percentage difference between the polygon area and its triangulation area;\r\n    // used to verify correctness of triangulation\r\n    /*earcut.deviation = function (data, holeIndices, dim, triangles) {\r\n        var hasHoles = holeIndices && holeIndices.length;\r\n        var outerLen = hasHoles ? holeIndices[0] * dim : data.length;\r\n    \r\n        var polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\r\n        if (hasHoles) {\r\n            for (var i = 0, len = holeIndices.length; i < len; i++) {\r\n                var start = holeIndices[i] * dim;\r\n                var end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\r\n                polygonArea -= Math.abs(signedArea(data, start, end, dim));\r\n            }\r\n        }\r\n    \r\n        var trianglesArea = 0;\r\n        for (i = 0; i < triangles.length; i += 3) {\r\n            var a = triangles[i] * dim;\r\n            var b = triangles[i + 1] * dim;\r\n            var c = triangles[i + 2] * dim;\r\n            trianglesArea += Math.abs(\r\n                (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\r\n                (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\r\n        }\r\n    \r\n        return polygonArea === 0 && trianglesArea === 0 ? 0 :\r\n            Math.abs((trianglesArea - polygonArea) / polygonArea);\r\n    };*/\r\n\r\n    static signedArea(data: any, start: any, end: any, dim: any): any {\r\n        var sum: any = 0;\r\n        for (var i: any = start, j: any = end - dim; i < end; i += dim) {\r\n            sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\r\n            j = i;\r\n        }\r\n        return sum;\r\n    }\r\n\r\n    // turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\r\n    /*earcut.flatten = function (data) {\r\n        var dim = data[0][0].length,\r\n            result = {vertices: [], holes: [], dimensions: dim},\r\n            holeIndex = 0;\r\n    \r\n        for (var i = 0; i < data.length; i++) {\r\n            for (var j = 0; j < data[i].length; j++) {\r\n                for (var d = 0; d < dim; d++) result.vertices.push(data[i][j][d]);\r\n            }\r\n            if (i > 0) {\r\n                holeIndex += data[i - 1].length;\r\n                result.holes.push(holeIndex);\r\n            }\r\n        }\r\n        return result;\r\n    };*/\r\n}\r\n\r\n","export class CONST3D2D {\r\n    static BYTES_PE: number = 4;\r\n    static BYTES_PIDX: number = 2;\r\n\r\n    static defaultMatrix4: any[] = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n\r\n    static defaultMinusYMatrix4: any[] = [1, 0, 0, 0, 0, -1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n\r\n    static uniformMatrix3: any[] = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0];\r\n\r\n    static _TMPARRAY: any[] = [];\r\n\r\n    static _OFFSETX: number = 0;\r\n    static _OFFSETY: number = 0;\r\n\r\n}\r\n\r\n\r\n","import { Context } from \"../../resource/Context\";\r\nimport { Texture } from \"../../resource/Texture\";\r\nimport { Stat } from \"../../utils/Stat\";\r\nimport { BlendMode } from \"../canvas/BlendMode\";\r\nimport { Value2D } from \"../shader/d2/value/Value2D\";\r\nimport { CONST3D2D } from \"../utils/CONST3D2D\";\r\nimport { Mesh2D } from \"../utils/Mesh2D\";\r\nimport { WebGLContext } from \"../WebGLContext\";\r\nimport { SubmitBase } from \"./SubmitBase\";\r\n\r\nexport class Submit extends SubmitBase {\r\n\r\n    protected static _poolSize: number = 0;\r\n    protected static POOL: any[] = [];\r\n\r\n    constructor(renderType: number = SubmitBase.TYPE_2D) {\r\n        super(renderType);\r\n    }\r\n\t\t/**\r\n\t\t * @override\r\n\t\t */\r\n\t\t /*override*/ renderSubmit(): number {\r\n        if (this._numEle === 0 || !this._mesh || this._numEle == 0) return 1;//怎么会有_numEle是0的情况?\r\n\r\n        var _tex: Texture = this.shaderValue.textureHost;\r\n        if (_tex) {\r\n            var source: any = _tex._getSource();\r\n            if (!source)\r\n                return 1;\r\n            this.shaderValue.texture = source;\r\n        }\r\n\r\n        var gl: WebGLRenderingContext = WebGLContext.mainContext;\r\n        this._mesh.useMesh(gl);\r\n        //_ib._bind_upload() || _ib._bind();\r\n        //_vb._bind_upload() || _vb._bind();\r\n\r\n        this.shaderValue.upload();\r\n\r\n        if (BlendMode.activeBlendFunction !== this._blendFn) {\r\n            WebGLContext.setBlend(gl, true);\r\n            this._blendFn(gl);\r\n            BlendMode.activeBlendFunction = this._blendFn;\r\n        }\r\n        gl.drawElements(gl.TRIANGLES, this._numEle, gl.UNSIGNED_SHORT, this._startIdx);\r\n\r\n        Stat.renderBatches++;\r\n        Stat.trianglesFaces += this._numEle / 3;\r\n\r\n        return 1;\r\n    }\r\n\t\t/**\r\n\t\t * @override\r\n\t\t */\r\n\t\t /*override*/ releaseRender(): void {\r\n        if (SubmitBase.RENDERBASE == this)\r\n            return;\r\n\r\n        if ((--this._ref) < 1) {\r\n            Submit.POOL[Submit._poolSize++] = this;\r\n            this.shaderValue.release();\r\n            this.shaderValue = null;\r\n            //_vb = null;\r\n            //_mesh.destroy();\r\n            this._mesh = null;\r\n            this._parent && (this._parent.releaseRender(), this._parent = null);\r\n        }\r\n    }\r\n\r\n\t/*\r\n\t   create方法只传对submit设置的值\r\n\t */\r\n    static create(context: Context, mesh: Mesh2D, sv: Value2D): Submit {\r\n        var o: Submit = Submit._poolSize ? Submit.POOL[--Submit._poolSize] : new Submit();\r\n        o._ref = 1;\r\n        o._mesh = mesh;\r\n        o._key.clear();\r\n        o._startIdx = mesh.indexNum * CONST3D2D.BYTES_PIDX;\r\n        o._numEle = 0;\r\n        var blendType: number = context._nBlendType;\r\n        o._blendFn = context._targets ? BlendMode.targetFns[blendType] : BlendMode.fns[blendType];\r\n        o.shaderValue = sv;\r\n        o.shaderValue.setValue(context._shader2D);\r\n        var filters: any[] = context._shader2D.filters;\r\n        filters && o.shaderValue.setFilters(filters);\r\n        return o;\r\n    }\r\n\r\n\t/**\r\n\t * 创建一个矢量submit\r\n\t * @param\tctx\r\n\t * @param\tmesh\r\n\t * @param\tnumEle\t\t对应drawElement的第二个参数:count\r\n\t * @param\toffset\t\tdrawElement的时候的ib的偏移。\r\n\t * @param\tsv\t\t\tValue2D\r\n\t * @return\r\n\t */\r\n    static createShape(ctx: Context, mesh: Mesh2D, numEle: number, sv: Value2D): Submit {\r\n        var o: Submit = Submit._poolSize ? Submit.POOL[--Submit._poolSize] : (new Submit());\r\n        o._mesh = mesh;\r\n        o._numEle = numEle;\r\n        o._startIdx = mesh.indexNum * 2;\r\n        o._ref = 1;\r\n        o.shaderValue = sv;\r\n        o.shaderValue.setValue(ctx._shader2D);\r\n        var blendType: number = ctx._nBlendType;\r\n        o._key.blendShader = blendType;\r\n        o._blendFn = ctx._targets ? BlendMode.targetFns[blendType] : BlendMode.fns[blendType];\r\n        return o;\r\n    }\r\n}\r\n\r\n\r\n","import { Matrix } from \"../../maths/Matrix\";\r\nimport { Context } from \"../../resource/Context\";\r\nimport { ShaderDefines2D } from \"../shader/d2/ShaderDefines2D\";\r\nimport { Value2D } from \"../shader/d2/value/Value2D\";\r\nimport { CONST3D2D } from \"../utils/CONST3D2D\";\r\nimport { RenderState2D } from \"../utils/RenderState2D\";\r\nimport { SubmitBase } from \"./SubmitBase\";\r\n\r\n/**\r\n * cache as normal 模式下的生成的canvas的渲染。\r\n */\r\n\r\nexport class SubmitCanvas extends SubmitBase {\r\n    /**@internal */\r\n    _matrix: Matrix = new Matrix();\t\t// 用来计算当前的世界矩阵\r\n    canv: Context;\r\n    /**@internal */\r\n    _matrix4: any[] = CONST3D2D.defaultMatrix4.concat();\r\n\r\n\r\n    static create(canvas: any, alpha: number, filters: any[]): SubmitCanvas {\r\n        var o: SubmitCanvas = (!SubmitCanvas.POOL._length) ? (new SubmitCanvas()) : SubmitCanvas.POOL[--SubmitCanvas.POOL._length];\r\n        o.canv = canvas;\r\n        o._ref = 1;\r\n        o._numEle = 0;\r\n        var v: Value2D = o.shaderValue;\r\n        v.alpha = alpha;\r\n        v.defines.setValue(0);\r\n        filters && filters.length && v.setFilters(filters);\r\n        return o;\r\n    }\r\n\r\n    constructor() {\r\n        super(SubmitBase.TYPE_2D);\r\n        this.shaderValue = new Value2D(0, 0);\r\n    }\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n    renderSubmit(): number {\r\n        // 下面主要是为了给canvas设置矩阵。因为canvas保存的是没有偏移的。\r\n        var preAlpha: number = RenderState2D.worldAlpha;\r\n        var preMatrix4: any[] = RenderState2D.worldMatrix4;\r\n        var preMatrix: Matrix = RenderState2D.worldMatrix;\r\n\r\n        var preFilters: any[] = RenderState2D.worldFilters;\r\n        var preWorldShaderDefines: ShaderDefines2D = RenderState2D.worldShaderDefines;\r\n\r\n        var v: Value2D = this.shaderValue;\r\n        var m: Matrix = this._matrix;\r\n        var m4: any[] = this._matrix4;\r\n        var mout: Matrix = Matrix.TEMP;\r\n        Matrix.mul(m, preMatrix, mout);\r\n        m4[0] = mout.a;\r\n        m4[1] = mout.b;\r\n        m4[4] = mout.c;\r\n        m4[5] = mout.d;\r\n        m4[12] = mout.tx;\r\n        m4[13] = mout.ty;\r\n\r\n        RenderState2D.worldMatrix = mout.clone();\r\n        RenderState2D.worldMatrix4 = m4;\r\n        RenderState2D.worldAlpha = RenderState2D.worldAlpha * v.alpha;\r\n        if (v.filters && v.filters.length) {\r\n            RenderState2D.worldFilters = v.filters;\r\n            RenderState2D.worldShaderDefines = v.defines;\r\n        }\r\n        this.canv['flushsubmit']();\r\n        RenderState2D.worldAlpha = preAlpha;\r\n        RenderState2D.worldMatrix4 = preMatrix4;\r\n        RenderState2D.worldMatrix.destroy();\r\n        RenderState2D.worldMatrix = preMatrix;\r\n\r\n        RenderState2D.worldFilters = preFilters;\r\n        RenderState2D.worldShaderDefines = preWorldShaderDefines;\r\n        return 1;\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    releaseRender(): void {\r\n        if ((--this._ref) < 1) {\r\n            var cache: any = SubmitCanvas.POOL;\r\n            //_vb = null;\r\n            this._mesh = null;\r\n            cache[cache._length++] = this;\r\n        }\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    getRenderType(): number {\r\n        return SubmitBase.TYPE_CANVAS;\r\n    }\r\n\r\n    static POOL: any = [];;\r\n}\r\n{ SubmitCanvas.POOL._length = 0 }\r\n","import { ISubmit } from \"./ISubmit\";\r\nimport { SubmitKey } from \"./SubmitKey\";\r\nimport { ColorFilter } from \"../../filters/ColorFilter\"\r\nimport { Context } from \"../../resource/Context\"\r\nimport { RenderTexture2D } from \"../../resource/RenderTexture2D\"\r\nimport { Stat } from \"../../utils/Stat\"\r\nimport { WebGLContext } from \"../WebGLContext\"\r\nimport { BlendMode } from \"../canvas/BlendMode\"\r\nimport { TextureSV } from \"../shader/d2/value/TextureSV\"\r\nimport { Value2D } from \"../shader/d2/value/Value2D\"\r\nimport { CONST3D2D } from \"../utils/CONST3D2D\"\r\nimport { Mesh2D } from \"../utils/Mesh2D\"\r\n\r\n\r\nexport class SubmitTarget implements ISubmit {\r\n    /**@internal */\r\n    _mesh: Mesh2D;\t\t\t//代替 _vb,_ib\r\n    /**@internal */\r\n    _startIdx: number;\r\n    /**@internal */\r\n    _numEle: number;\r\n    shaderValue: Value2D;\r\n    blendType: number = 0;\r\n    /**@internal */\r\n    _ref: number = 1;\r\n    /**@internal */\r\n    _key: SubmitKey = new SubmitKey();\r\n    srcRT: RenderTexture2D;\r\n\r\n    constructor() {\r\n    }\r\n\r\n    static POOL: any = [];\r\n    renderSubmit(): number {\r\n        var gl: WebGLRenderingContext = WebGLContext.mainContext;\r\n        this._mesh.useMesh(gl);\r\n\r\n        var target: RenderTexture2D = this.srcRT;\r\n        if (target) {//??为什么会出现为空的情况\r\n            this.shaderValue.texture = target._getSource();\r\n            this.shaderValue.upload();\r\n            this.blend();\r\n            Stat.renderBatches++;\r\n            Stat.trianglesFaces += this._numEle / 3;\r\n            gl.drawElements(gl.TRIANGLES, this._numEle, gl.UNSIGNED_SHORT, this._startIdx);\r\n        }\r\n        return 1;\r\n    }\r\n\r\n    blend(): void {\r\n        if (BlendMode.activeBlendFunction !== BlendMode.fns[this.blendType]) {\r\n            var gl: WebGLRenderingContext = WebGLContext.mainContext;\r\n            gl.enable(gl.BLEND);\r\n            BlendMode.fns[this.blendType](gl);\r\n            BlendMode.activeBlendFunction = BlendMode.fns[this.blendType];\r\n        }\r\n    }\r\n\r\n    getRenderType(): number {\r\n        return 0;\r\n    }\r\n\r\n    releaseRender(): void {\r\n        if ((--this._ref) < 1) {\r\n            var pool: any = SubmitTarget.POOL;\r\n            pool[pool._length++] = this;\r\n        }\r\n    }\r\n\r\n    static create(context: Context, mesh: Mesh2D, sv: Value2D, rt: RenderTexture2D): SubmitTarget {\r\n        var o: SubmitTarget = SubmitTarget.POOL._length ? SubmitTarget.POOL[--SubmitTarget.POOL._length] : new SubmitTarget();\r\n        o._mesh = mesh;\r\n        o.srcRT = rt;\r\n        o._startIdx = mesh.indexNum * CONST3D2D.BYTES_PIDX;\r\n        o._ref = 1;\r\n        o._key.clear();\r\n        o._numEle = 0;\r\n        o.blendType = context._nBlendType;\r\n        o._key.blendShader = o.blendType;\r\n        o.shaderValue = sv;\r\n        o.shaderValue.setValue(context._shader2D);\r\n        if (context._colorFiler) {\r\n            var ft: ColorFilter = context._colorFiler;\r\n            sv.defines.add(ft.type);\r\n            ((<TextureSV>sv)).colorMat = ft._mat;\r\n            ((<TextureSV>sv)).colorAlpha = ft._alpha;\r\n        }\r\n        return o;\r\n    }\r\n}\r\n{\r\n    SubmitTarget.POOL._length = 0;\r\n}\r\n\r\n\r\n","import { SubmitBase } from \"./SubmitBase\";\r\nimport { SubmitKey } from \"./SubmitKey\";\r\nimport { ColorFilter } from \"../../filters/ColorFilter\"\r\nimport { Context } from \"../../resource/Context\"\r\nimport { Texture } from \"../../resource/Texture\"\r\nimport { Stat } from \"../../utils/Stat\"\r\nimport { WebGLContext } from \"../WebGLContext\"\r\nimport { BlendMode } from \"../canvas/BlendMode\"\r\nimport { BaseShader } from \"../shader/BaseShader\"\r\nimport { Shader } from \"../shader/Shader\"\r\nimport { ShaderDefines2D } from \"../shader/d2/ShaderDefines2D\"\r\nimport { TextureSV } from \"../shader/d2/value/TextureSV\"\r\nimport { Value2D } from \"../shader/d2/value/Value2D\"\r\nimport { CONST3D2D } from \"../utils/CONST3D2D\"\r\nimport { Mesh2D } from \"../utils/Mesh2D\"\r\n\r\nexport class SubmitTexture extends SubmitBase {\r\n    private static _poolSize: number = 0;\r\n    private static POOL: any[] = [];\r\n    constructor(renderType: number = SubmitBase.TYPE_2D) {\r\n        super(renderType);\r\n    }\r\n\t\t/**\r\n\t\t * @override\r\n\t\t */\r\n\t\t /*override*/ releaseRender(): void {\r\n        if ((--this._ref) < 1) {\r\n            SubmitTexture.POOL[SubmitTexture._poolSize++] = this;\r\n            this.shaderValue.release();\r\n            //_vb = null;\r\n            this._mesh = null;\t\t//下次create会重新赋值。既然会重新赋值，那还设置干嘛\r\n            this._parent && (this._parent.releaseRender(), this._parent = null);\r\n        }\r\n    }\r\n\t\t/**\r\n\t\t * @override\r\n\t\t */\r\n\t\t /*override*/ renderSubmit(): number {\r\n        if (this._numEle === 0)\r\n            return 1;\r\n\r\n        var tex: Texture = this.shaderValue.textureHost;\r\n        if (tex) {//现在fillrect也用的这个submit，所以不必要求有texture\r\n            var source: any = tex ? tex._getSource() : null;\r\n            if (!source) return 1;\r\n        }\r\n\r\n        var gl: WebGLRenderingContext = WebGLContext.mainContext;\r\n\r\n        this._mesh.useMesh(gl);\r\n        //如果shader参数都相同，只要提交texture就行了\r\n        var lastSubmit: SubmitTexture = (<SubmitTexture>SubmitBase.preRender);\r\n        var prekey: SubmitKey = ((<SubmitBase>SubmitBase.preRender))._key;\r\n        if (this._key.blendShader === 0 && (this._key.submitType === prekey.submitType && this._key.blendShader === prekey.blendShader) && BaseShader.activeShader &&\r\n            ((<SubmitBase>SubmitBase.preRender)).clipInfoID == this.clipInfoID &&\r\n            lastSubmit.shaderValue.defines._value === this.shaderValue.defines._value && //shader define要相同. \r\n            (this.shaderValue.defines._value & ShaderDefines2D.NOOPTMASK) == 0 //只有基本类型的shader走这个，像blur，glow，filltexture等都不要这样优化\r\n        ) {\r\n            ((<Shader>BaseShader.activeShader)).uploadTexture2D(source);\r\n        }\r\n        else {\r\n            if (BlendMode.activeBlendFunction !== this._blendFn) {\r\n                WebGLContext.setBlend(gl, true);\r\n                this._blendFn(gl);\r\n                BlendMode.activeBlendFunction = this._blendFn;\r\n            }\r\n            this.shaderValue.texture = source;\r\n            this.shaderValue.upload();\r\n        }\r\n\r\n        gl.drawElements(gl.TRIANGLES, this._numEle, gl.UNSIGNED_SHORT, this._startIdx);\r\n\r\n        Stat.renderBatches++;\r\n        Stat.trianglesFaces += this._numEle / 3;\r\n\r\n        return 1;\r\n    }\r\n\r\n    /*\r\n       create方法只传对submit设置的值\r\n     */\r\n    static create(context: Context, mesh: Mesh2D, sv: Value2D): SubmitTexture {\r\n        var o: SubmitTexture = SubmitTexture._poolSize ? SubmitTexture.POOL[--SubmitTexture._poolSize] : new SubmitTexture(SubmitBase.TYPE_TEXTURE);\r\n        o._mesh = mesh;\r\n        o._key.clear();\r\n        o._key.submitType = SubmitBase.KEY_DRAWTEXTURE;\r\n        o._ref = 1;\r\n        o._startIdx = mesh.indexNum * CONST3D2D.BYTES_PIDX;\r\n        o._numEle = 0;\r\n        var blendType: number = context._nBlendType;\r\n        o._key.blendShader = blendType;\r\n        o._blendFn = context._targets ? BlendMode.targetFns[blendType] : BlendMode.fns[blendType];\r\n        o.shaderValue = sv;\r\n        //sv.setValue(context._shader2D);\r\n        if (context._colorFiler) {\r\n            var ft: ColorFilter = context._colorFiler;\r\n            sv.defines.add(ft.type);\r\n            ((<TextureSV>sv)).colorMat = ft._mat;\r\n            ((<TextureSV>sv)).colorAlpha = ft._alpha;\r\n        }\r\n        return o;\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { ColorFilter } from \"../../filters/ColorFilter\"\r\nimport { Matrix } from \"../../maths/Matrix\"\r\nimport { Context } from \"../../resource/Context\"\r\nimport { Texture } from \"../../resource/Texture\"\r\nimport { ShaderDefines2D } from \"../shader/d2/ShaderDefines2D\"\r\nimport { Value2D } from \"../shader/d2/value/Value2D\"\r\nimport { SubmitTexture } from \"../submit/SubmitTexture\"\r\nimport { MeshQuadTexture } from \"../utils/MeshQuadTexture\"\r\nimport { RenderInfo } from \"../../renders/RenderInfo\";\r\n/**\r\n * ...\r\n * @author laoxie\r\n */\r\nexport class CharSubmitCache {\r\n    private static __posPool: any[] = [];\r\n    private static __nPosPool: number = 0;\r\n\r\n    private _data: any[] = [];\r\n    private _ndata: number = 0;\r\n    private _tex: Texture;\r\n    private _imgId: number;\r\n    private _clipid: number = -1;\r\n    private _clipMatrix: Matrix = new Matrix();\r\n    /**@internal */\r\n    _enable: boolean = false;\r\n    /**@internal */\r\n    _colorFiler: ColorFilter;\r\n\r\n    constructor() {\r\n\r\n    }\r\n\r\n    clear(): void {\r\n        this._tex = null;\r\n        this._imgId = -1;\r\n        this._ndata = 0;\r\n        this._enable = false;\r\n        this._colorFiler = null;\r\n    }\r\n\r\n    destroy(): void {\r\n        this.clear();\r\n        this._data.length = 0;\r\n        this._data = null;\r\n    }\r\n\r\n    add(ctx: Context, tex: Texture, imgid: number, pos: any[], uv: ArrayLike<number>, color: number): void {\r\n        if (this._ndata > 0 && (this._tex != tex || this._imgId != imgid ||\r\n            (this._clipid >= 0 && this._clipid != ctx._clipInfoID))) {\r\n            this.submit(ctx);\r\n        }\r\n\r\n        this._clipid = ctx._clipInfoID;\r\n        ctx._globalClipMatrix.copyTo(this._clipMatrix);\r\n        this._tex = tex;\r\n        this._imgId = imgid;\r\n        this._colorFiler = ctx._colorFiler;\r\n\r\n        this._data[this._ndata] = pos;\r\n        this._data[this._ndata + 1] = uv;\r\n        this._data[this._ndata + 2] = color;\r\n        this._ndata += 3;\r\n    }\r\n\r\n    getPos(): any[] {\r\n        if (CharSubmitCache.__nPosPool == 0)\r\n            return new Array(8);\r\n        return CharSubmitCache.__posPool[--CharSubmitCache.__nPosPool];\r\n    }\r\n\r\n    enable(value: boolean, ctx: Context): void {\r\n        if (value === this._enable)\r\n            return;\r\n        this._enable = value;\r\n        this._enable || this.submit(ctx);\r\n    }\r\n\r\n    submit(ctx: Context): void {\r\n        var n: number = this._ndata;\r\n        if (!n)\r\n            return;\r\n\r\n        var _mesh: MeshQuadTexture = ctx._mesh;\r\n\r\n        var colorFiler: ColorFilter = ctx._colorFiler;\r\n        ctx._colorFiler = this._colorFiler;\r\n        var submit: SubmitTexture = SubmitTexture.create(ctx, _mesh, Value2D.create(ShaderDefines2D.TEXTURE2D, 0));\r\n        ctx._submits[ctx._submits._length++] = ctx._curSubmit = submit;\r\n        submit.shaderValue.textureHost = this._tex;\r\n        submit._key.other = this._imgId;\r\n        ctx._colorFiler = colorFiler;\r\n        ctx._copyClipInfo(submit, this._clipMatrix);\r\n        submit.clipInfoID = this._clipid;\r\n\r\n        for (var i: number = 0; i < n; i += 3) {\r\n            _mesh.addQuad(this._data[i], this._data[i + 1], this._data[i + 2], true);\r\n            CharSubmitCache.__posPool[CharSubmitCache.__nPosPool++] = this._data[i];\r\n        }\r\n\r\n        n /= 3;\r\n        submit._numEle += n * 6;\r\n        _mesh.indexNum += n * 6;\r\n        _mesh.vertNum += n * 4;\r\n        ctx._drawCount += n;\r\n        this._ndata = 0;\r\n\r\n        if (RenderInfo.loopCount % 100 == 0)\r\n            this._data.length = 0;\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { Point } from \"../../maths/Point\"\r\n\r\n// 注意长宽都不要超过256，一个是影响效率，一个是超出表达能力\r\nexport class AtlasGrid {\r\n    atlasID: number = 0;\r\n    private _width: number = 0;\r\n    private _height: number = 0;\r\n    private _texCount: number = 0;\r\n    private _rowInfo: Uint8Array = null;\t\t// 当前行的最大长度\r\n    private _cells: Uint8Array = null;\t\t// 每个格子的信息。{type,w,h} 相当于一个距离场. type =0 表示空闲的。不为0的情况下填充的是宽高（有什么用呢）\r\n    _used: number = 0;\t\t\t\t// 使用率\r\n\r\n    // TODO type 是否有用\r\n\r\n    //------------------------------------------------------------------------------\r\n    constructor(width: number = 0, height: number = 0, id: number = 0) {\r\n        this._cells = null;\r\n        this._rowInfo = null;\r\n        this.atlasID = id;\r\n        this._init(width, height);\r\n    }\r\n\r\n    //------------------------------------------------------------------\r\n    addRect(type: number, width: number, height: number, pt: Point): boolean {\r\n        //调用获得应该放在哪 返回值有三个。。bRet是否成功，nX x位置，nY y位置\r\n        if (!this._get(width, height, pt))\r\n            return false;\r\n        //根据获得的x,y填充\r\n        this._fill(pt.x, pt.y, width, height, type);\r\n        this._texCount++;\r\n        //返回是否成功，以及X位置和Y位置\r\n        return true;\r\n    }\r\n\r\n    //------------------------------------------------------------------------------\r\n    private _release(): void {\r\n        this._cells = null;\r\n        this._rowInfo = null;\r\n    }\r\n\r\n    //------------------------------------------------------------------------------\r\n    private _init(width: number, height: number): boolean {\r\n        this._width = width;\r\n        this._height = height;\r\n        this._release();\r\n        if (this._width == 0) return false;\r\n        this._cells = new Uint8Array(this._width * this._height * 3);\r\n        this._rowInfo = new Uint8Array(this._height);\r\n        this._used = 0;\r\n        this._clear();\r\n        return true;\r\n    }\r\n\r\n    //------------------------------------------------------------------\r\n    private _get(width: number, height: number, pt: Point): boolean {\r\n        if (width > this._width || height > this._height) {\r\n            return false;\r\n        }\r\n        //定义返回的x,y的位置\r\n        var rx: number = -1;\r\n        var ry: number = -1;\r\n        //为了效率先保存临时变量\r\n        var nWidth: number = this._width;\r\n        var nHeight: number = this._height;\r\n        //定义一个变量为了指向 m_pCells\r\n        var pCellBox: Uint8Array = this._cells;\r\n\r\n        //遍历查找合适的位置  //TODO 下面的方法应该可以优化\r\n        for (var y: number = 0; y < nHeight; y++) {\r\n            //如果该行的空白数 小于 要放入的宽度返回\r\n            if (this._rowInfo[y] < width) continue;\r\n            for (var x: number = 0; x < nWidth;) {\r\n\r\n                var tm: number = (y * nWidth + x) * 3;\r\n\r\n                if (pCellBox[tm] != 0 || pCellBox[tm + 1] < width || pCellBox[tm + 2] < height) {\r\n                    x += pCellBox[tm + 1];\r\n                    continue;\r\n                }\r\n                rx = x;\r\n                ry = y;\r\n                // 检查当前宽度是否能完全放下，即x方向的每个位置都有足够的高度。\r\n                for (var xx: number = 0; xx < width; xx++) {\r\n                    if (pCellBox[3 * xx + tm + 2] < height) {\r\n                        rx = -1;\r\n                        break;\r\n                    }\r\n                }\r\n                // 不行就x继续前进\r\n                if (rx < 0) {\r\n                    x += pCellBox[tm + 1];\r\n                    continue;\r\n                }\r\n                // 找到了\r\n                pt.x = rx;\r\n                pt.y = ry;\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    //------------------------------------------------------------------\r\n    private _fill(x: number, y: number, w: number, h: number, type: number): void {\r\n        //定义一些临时变量\r\n        var nWidth: number = this._width;\r\n        var nHeghit: number = this._height;\r\n        //代码检查\r\n        this._check((x + w) <= nWidth && (y + h) <= nHeghit);\r\n\r\n        //填充\r\n        for (var yy: number = y; yy < (h + y); ++yy) {\r\n            this._check(this._rowInfo[yy] >= w);\r\n            this._rowInfo[yy] -= w;\r\n            for (var xx: number = 0; xx < w; xx++) {\r\n                var tm: number = (x + yy * nWidth + xx) * 3;\r\n                this._check(this._cells[tm] == 0);\r\n                this._cells[tm] = type;\r\n                this._cells[tm + 1] = w;\r\n                this._cells[tm + 2] = h;\r\n            }\r\n        }\r\n        //调整我左方相邻空白格子的宽度连续信息描述\r\n        if (x > 0) {\r\n            for (yy = 0; yy < h; ++yy) {\r\n                // TODO 下面应该可以优化\r\n                var s: number = 0;\r\n                for (xx = x - 1; xx >= 0; --xx, ++s) {\r\n                    if (this._cells[((y + yy) * nWidth + xx) * 3] != 0) break;\r\n                }\r\n                for (xx = s; xx > 0; --xx) {\r\n                    this._cells[((y + yy) * nWidth + x - xx) * 3 + 1] = xx;\r\n                    this._check(xx > 0);\r\n                }\r\n            }\r\n        }\r\n        //调整我上方相邻空白格子的高度连续信息描述\r\n        if (y > 0) {\r\n            for (xx = x; xx < (x + w); ++xx) {\r\n                // TODO 下面应该可以优化\r\n                s = 0;\r\n                for (yy = y - 1; yy >= 0; --yy, s++) {\r\n                    if (this._cells[(xx + yy * nWidth) * 3] != 0) break;\r\n                }\r\n                for (yy = s; yy > 0; --yy) {\r\n                    this._cells[(xx + (y - yy) * nWidth) * 3 + 2] = yy;\r\n                    this._check(yy > 0);\r\n                }\r\n            }\r\n        }\r\n\r\n        this._used += (w * h) / (this._width * this._height);\r\n    }\r\n\r\n    private _check(ret: boolean): void {\r\n        if (ret == false) {\r\n            console.log(\"xtexMerger 错误啦\");\r\n        }\r\n    }\r\n\r\n    //------------------------------------------------------------------\r\n    private _clear(): void {\r\n        this._texCount = 0;\r\n        for (var y: number = 0; y < this._height; y++) {\r\n            this._rowInfo[y] = this._width;\r\n        }\r\n        for (var i: number = 0; i < this._height; i++) {\r\n            for (var j: number = 0; j < this._width; j++) {\r\n                var tm: number = (i * this._width + j) * 3;\r\n                this._cells[tm] = 0;\r\n                this._cells[tm + 1] = this._width - j;\r\n                this._cells[tm + 2] = this._width - i;\r\n            }\r\n        }\r\n    }\r\n    //------------------------------------------------------------------\r\n}\r\n\r\n\r\n","//import { TextAtlas } from \"./TextAtlas\";\r\nimport { LayaGL } from \"../../layagl/LayaGL\"\r\nimport { RenderInfo } from \"../../renders/RenderInfo\"\r\nimport { Resource } from \"../../resource/Resource\"\r\nimport { WebGLContext } from \"../WebGLContext\"\r\nimport { CharRenderInfo } from \"./CharRenderInfo\"\r\nimport { ILaya } from \"../../../ILaya\";\r\n\r\nexport class TextTexture extends Resource {\r\n    static gTextRender: ITextRender = null;\r\n\r\n    private static pool: any[] = new Array(10);\t\t// 回收用\r\n    private static poolLen: number = 0;\r\n    private static cleanTm: number = 0;\r\n    /**@internal */\r\n    _source: any;\t// webgl 贴图\r\n    /**@internal */\r\n    _texW: number = 0;\r\n    /**@internal */\r\n    _texH: number = 0;\r\n    /**@internal */\r\n    __destroyed: boolean = false;\t//父类有，但是private\r\n    /**@internal */\r\n    _discardTm: number = 0;\t\t\t//释放的时间。超过一定时间会被真正删除\r\n    genID: number = 0; \t\t\t\t// 这个对象会重新利用，为了能让引用他的人知道自己引用的是否有效，加个id\r\n    bitmap: any = { id: 0, _glTexture: null };\t\t\t\t\t\t//samekey的判断用的\r\n    curUsedCovRate: number = 0; \t// 当前使用到的使用率。根据面积算的\r\n    curUsedCovRateAtlas: number = 0; \t// 大图集中的占用率。由于大图集分辨率低，所以会浪费一些空间\r\n    lastTouchTm: number = 0;\r\n    ri: CharRenderInfo = null; \t\t// 如果是独立文字贴图的话带有这个信息\r\n    //public var isIso:Boolean = false;\r\n\r\n    constructor(textureW: number, textureH: number) {\r\n        super();\r\n        this._texW = textureW || TextTexture.gTextRender.atlasWidth;\r\n        this._texH = textureH || TextTexture.gTextRender.atlasWidth;\r\n        this.bitmap.id = this.id;\r\n        this.lock = true;//防止被资源管理清除\r\n    }\r\n\r\n    recreateResource(): void {\r\n        if (this._source)\r\n            return;\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        var glTex: any = this._source = gl.createTexture();\r\n        this.bitmap._glTexture = glTex;\r\n\r\n        WebGLContext.bindTexture(gl, gl.TEXTURE_2D, glTex);\r\n        //gl.bindTexture(WebGLContext.TEXTURE_2D, glTex);\r\n        //var sz:int = _width * _height * 4;\r\n        //分配显存。\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this._texW, this._texH, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\t//不能用点采样，否则旋转的时候，非常难看\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n\r\n        //TODO 预乘alpha\r\n        if (TextTexture.gTextRender.debugUV) {\r\n            this.fillWhite();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param\tdata\r\n     * @param\tx\t\t\t拷贝位置。\r\n     * @param\ty\r\n     * @param  uv  \r\n     * @return uv数组  如果uv不为空就返回传入的uv，否则new一个数组\r\n     */\r\n    addChar(data: ImageData, x: number, y: number, uv: any[] = null): any[] {\r\n        //if (!ILaya.Render.isConchApp &&  !__JS__('(data instanceof ImageData)')) {\r\n        if (TextTexture.gTextRender.isWan1Wan) {\r\n            return this.addCharCanvas(data, x, y, uv);\r\n        }\r\n        !this._source && this.recreateResource();\r\n        var gl = LayaGL.instance;\r\n        WebGLContext.bindTexture(gl, gl.TEXTURE_2D, this._source);\r\n        !ILaya.Render.isConchApp && gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\r\n        var dt: any = data.data;\r\n        if (data.data instanceof Uint8ClampedArray)\r\n            dt = new Uint8Array(dt.buffer);\r\n        gl.texSubImage2D(gl.TEXTURE_2D, 0, x, y, data.width, data.height, gl.RGBA, gl.UNSIGNED_BYTE, dt);\r\n        !ILaya.Render.isConchApp && gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\r\n        var u0: number;\r\n        var v0: number;\r\n        var u1: number;\r\n        var v1: number;\r\n\t\tu0 = x / this._texW;\t\r\n\t\tv0 = y / this._texH;\r\n\t\tu1 = (x + data.width) / this._texW;\t\r\n\t\tv1 = (y + data.height) / this._texH;\r\n        uv = uv || new Array(8);\r\n        uv[0] = u0, uv[1] = v0;\r\n        uv[2] = u1, uv[3] = v0;\r\n        uv[4] = u1, uv[5] = v1;\r\n        uv[6] = u0, uv[7] = v1;\r\n        return uv;\r\n    }\r\n\r\n    /**\r\n     * 玩一玩不支持 getImageData\r\n     * @param\tcanv\r\n     * @param\tx\r\n     * @param\ty\r\n     */\r\n    addCharCanvas(canv: any, x: number, y: number, uv: any[] = null): any[] {\r\n        !this._source && this.recreateResource();\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        WebGLContext.bindTexture(gl, gl.TEXTURE_2D, this._source);\r\n        !ILaya.Render.isConchApp && gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\r\n        gl.texSubImage2D(gl.TEXTURE_2D, 0, x, y, gl.RGBA, gl.UNSIGNED_BYTE, canv);\r\n        !ILaya.Render.isConchApp && gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\r\n        var u0: number;\r\n        var v0: number;\r\n        var u1: number;\r\n        var v1: number;\r\n        if (ILaya.Render.isConchApp) {\r\n            u0 = x / this._texW;\t\t// +1 表示内缩一下，反正文字总是有留白。否则会受到旁边的一个像素的影响\r\n            v0 = y / this._texH;\r\n            u1 = (x + canv.width) / this._texW;\r\n            v1 = (y + canv.height) / this._texH;\r\n        } else {\r\n            u0 = (x + 1) / this._texW;\t\t// +1 表示内缩一下，反正文字总是有留白。否则会受到旁边的一个像素的影响\r\n            v0 = (y + 1) / this._texH;\r\n            u1 = (x + canv.width - 1) / this._texW;\r\n            v1 = (y + canv.height - 1) / this._texH;\r\n        }\r\n        uv = uv || new Array(8);\r\n        uv[0] = u0, uv[1] = v0;\r\n        uv[2] = u1, uv[3] = v0;\r\n        uv[4] = u1, uv[5] = v1;\r\n        uv[6] = u0, uv[7] = v1;\r\n        return uv;\r\n    }\r\n\r\n    /**\r\n     * 填充白色。调试用。\r\n     */\r\n    fillWhite(): void {\r\n        !this._source && this.recreateResource();\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        var dt: Uint8Array = new Uint8Array(this._texW * this._texH * 4);\r\n        ((<any>dt)).fill(0xff);\r\n        gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, this._texW, this._texH, gl.RGBA, gl.UNSIGNED_BYTE, dt);\r\n    }\r\n\r\n    discard(): void {\r\n\t\t// 文字贴图的释放要触发全局cacheas normal无效\r\n\t\tILaya.stage.setGlobalRepaint();\r\n\t\t// 不再使用问题贴图的重用，否则会有内容清理问题\r\n\t\tthis.destroy();\r\n\t\treturn;\r\n\r\n        // 非标准大小不回收。\r\n        if (this._texW != TextTexture.gTextRender.atlasWidth || this._texH != TextTexture.gTextRender.atlasWidth) {\r\n            this.destroy();\r\n            return;\r\n        }\r\n        this.genID++;\r\n        if (TextTexture.poolLen >= TextTexture.pool.length) {\r\n            TextTexture.pool = TextTexture.pool.concat(new Array(10));\r\n        }\r\n\r\n        this._discardTm = RenderInfo.loopStTm;\r\n        TextTexture.pool[TextTexture.poolLen++] = this;\r\n    }\r\n\r\n    static getTextTexture(w: number, h: number): TextTexture {\r\n\t\t// 不再回收\r\n\t\treturn new TextTexture(w, h);\r\n\t\t\r\n        if (w != TextTexture.gTextRender.atlasWidth || w != TextTexture.gTextRender.atlasWidth)\r\n            return new TextTexture(w, h);\r\n        // 否则从回收池中取\r\n        if (TextTexture.poolLen > 0) {\r\n            var ret: TextTexture = TextTexture.pool[--TextTexture.poolLen];\r\n            if (TextTexture.poolLen > 0)\r\n                TextTexture.clean();\t//给个clean的机会。\r\n            return ret;\r\n        }\r\n        return new TextTexture(w, h);\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    destroy(): void {\r\n        //console.log('destroy TextTexture');\r\n        this.__destroyed = true;\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        this._source && gl.deleteTexture(this._source);\r\n        this._source = null;\r\n    }\r\n\r\n    /**\r\n     * 定期清理\r\n     * 为了简单，只有发生 getAPage 或者 discardPage的时候才检测是否需要清理\r\n     */\r\n    static clean(): void {\r\n        var curtm: number = RenderInfo.loopStTm;// Laya.stage.getFrameTm();\r\n        if (TextTexture.cleanTm === 0) TextTexture.cleanTm = curtm;\r\n        if (curtm - TextTexture.cleanTm >= TextTexture.gTextRender.checkCleanTextureDt) {\t//每10秒看看pool中的贴图有没有很老的可以删除的\r\n            for (var i: number = 0; i < TextTexture.poolLen; i++) {\r\n                var p: TextTexture = TextTexture.pool[i];\r\n                if (curtm - p._discardTm >= TextTexture.gTextRender.destroyUnusedTextureDt) {//超过20秒没用的删掉\r\n                    p.destroy();\t\t\t\t\t//真正删除贴图\r\n                    TextTexture.pool[i] = TextTexture.pool[TextTexture.poolLen - 1];\r\n                    TextTexture.poolLen--;\r\n                    i--;\t//这个还要处理，用来抵消i++\r\n                }\r\n            }\r\n            TextTexture.cleanTm = curtm;\r\n        }\r\n    }\r\n\r\n    touchRect(ri: CharRenderInfo, curloop: number): void {\r\n        if (this.lastTouchTm != curloop) {\r\n            this.curUsedCovRate = 0;\r\n            this.curUsedCovRateAtlas = 0;\r\n            this.lastTouchTm = curloop;\r\n        }\r\n        var texw2: number = TextTexture.gTextRender.atlasWidth * TextTexture.gTextRender.atlasWidth;\r\n        var gridw2: number = ILaya.TextAtlas.atlasGridW * ILaya.TextAtlas.atlasGridW;\r\n        this.curUsedCovRate += (ri.bmpWidth * ri.bmpHeight) / texw2;\r\n        this.curUsedCovRateAtlas += (Math.ceil(ri.bmpWidth / ILaya.TextAtlas.atlasGridW) * Math.ceil(ri.bmpHeight / ILaya.TextAtlas.atlasGridW)) / (texw2 / gridw2);\r\n    }\r\n\r\n    // 为了与当前的文字渲染兼容的补丁\r\n    get texture(): any {\r\n        return this;\r\n    }\r\n    /**@internal */\r\n    _getSource(): any {\r\n        return this._source;\r\n    }\r\n\r\n    // for debug\r\n    drawOnScreen(x: number, y: number): void {\r\n\r\n    }\r\n}\r\n\r\ninterface ITextRender {\r\n    atlasWidth: number;\r\n    checkCleanTextureDt: number;\r\n    debugUV: boolean;\r\n    isWan1Wan: boolean;\r\n    destroyUnusedTextureDt: number;\r\n}\r\n","import { AtlasGrid } from \"./AtlasGrid\";\r\nimport { TextTexture } from \"./TextTexture\";\r\nimport { Point } from \"../../maths/Point\"\r\nimport { CharRenderInfo } from \"./CharRenderInfo\"\r\nimport { ILaya } from \"../../../ILaya\";\r\n/**\r\n *  文字贴图的大图集。\r\n */\r\nexport class TextAtlas {\r\n    texWidth: number = 1024;\r\n    texHeight: number = 1024;\r\n    private atlasgrid: AtlasGrid;\r\n    //private protectDist: number = 1;\r\n    texture: TextTexture|null = null;\r\n    charMaps: any = {};\t\t// 保存文字信息的字典\r\n    static atlasGridW: number = 16;\r\n\r\n    constructor() {\r\n        this.texHeight = this.texWidth = ILaya.TextRender.atlasWidth;\r\n        this.texture = TextTexture.getTextTexture(this.texWidth, this.texHeight);\r\n        if (this.texWidth / TextAtlas.atlasGridW > 256) {\r\n            TextAtlas.atlasGridW = Math.ceil(this.texWidth / 256);\r\n        }\r\n        this.atlasgrid = new AtlasGrid(this.texWidth / TextAtlas.atlasGridW, this.texHeight / TextAtlas.atlasGridW, this.texture.id);\r\n    }\r\n\r\n    setProtecteDist(d: number): void {\r\n        //this.protectDist = d;\r\n    }\r\n\r\n    /**\r\n     * 如果返回null，则表示无法加入了\r\n     * 分配的时候优先选择最接近自己高度的节点\r\n     * @param\tw\r\n     * @param\th\r\n     * @return\r\n     */\r\n    getAEmpty(w: number, h: number, pt: Point): boolean {\r\n        var find: boolean = this.atlasgrid.addRect(1, Math.ceil(w / TextAtlas.atlasGridW), Math.ceil(h / TextAtlas.atlasGridW), pt);\r\n        if (find) {\r\n            pt.x *= TextAtlas.atlasGridW;\r\n            pt.y *= TextAtlas.atlasGridW;\r\n        }\r\n        return find;\r\n    }\r\n\r\n    /**\r\n     * 大图集格子单元的占用率，老的也算上了。只是表示这个大图集还能插入多少东西。\r\n     */\r\n    get usedRate(): number {\r\n        return this.atlasgrid._used;\r\n    }\r\n    //data 也可能是canvas\r\n    /*\r\n    public function pushData(data:ImageData, node:TextAtlasNode):void {\r\n        texture.addChar(data, node.x, node.y);\r\n    }\r\n    */\r\n\r\n    destroy(): void {\r\n        for (var k in this.charMaps) {\r\n            var ri: CharRenderInfo = this.charMaps[k];\r\n            ri.deleted = true;\r\n        }\r\n        this.texture.discard();\r\n    }\r\n\r\n    printDebugInfo(): void {\r\n\r\n    }\r\n}\r\n\r\n","import { Sprite } from \"../display/Sprite\"\r\nimport { Stage } from \"../display/Stage\"\r\nimport { Point } from \"../maths/Point\"\r\nimport { ILaya } from \"../../ILaya\";\r\n\r\n/**\r\n * <code>Event</code> 是事件类型的集合。一般当发生事件时，<code>Event</code> 对象将作为参数传递给事件侦听器。\r\n */\r\nexport class Event {\r\n\r\n    /** 一个空的 Event 对象。用于事件派发中转使用。*/\r\n    static EMPTY: Event = new Event();\r\n    /** 定义 mousedown 事件对象的 type 属性值。*/\r\n    static MOUSE_DOWN: string = \"mousedown\";\r\n    /** 定义 mouseup 事件对象的 type 属性值。*/\r\n    static MOUSE_UP: string = \"mouseup\";\r\n    /** 定义 click 事件对象的 type 属性值。*/\r\n    static CLICK: string = \"click\";\r\n    /** 定义 rightmousedown 事件对象的 type 属性值。*/\r\n    static RIGHT_MOUSE_DOWN: string = \"rightmousedown\";\r\n    /** 定义 rightmouseup 事件对象的 type 属性值。*/\r\n    static RIGHT_MOUSE_UP: string = \"rightmouseup\";\r\n    /** 定义 rightclick 事件对象的 type 属性值。*/\r\n    static RIGHT_CLICK: string = \"rightclick\";\r\n    /** 定义 mousemove 事件对象的 type 属性值。*/\r\n    static MOUSE_MOVE: string = \"mousemove\";\r\n    /** 定义 mouseover 事件对象的 type 属性值。*/\r\n    static MOUSE_OVER: string = \"mouseover\";\r\n    /** 定义 mouseout 事件对象的 type 属性值。*/\r\n    static MOUSE_OUT: string = \"mouseout\";\r\n    /** 定义 mousewheel 事件对象的 type 属性值。*/\r\n    static MOUSE_WHEEL: string = \"mousewheel\";\r\n    /** 定义 mouseover 事件对象的 type 属性值。*/\r\n    static ROLL_OVER: string = \"mouseover\";\r\n    /** 定义 mouseout 事件对象的 type 属性值。*/\r\n    static ROLL_OUT: string = \"mouseout\";\r\n    /** 定义 doubleclick 事件对象的 type 属性值。*/\r\n    static DOUBLE_CLICK: string = \"doubleclick\";\r\n    /** 定义 change 事件对象的 type 属性值。*/\r\n    static CHANGE: string = \"change\";\r\n    /** 定义 changed 事件对象的 type 属性值。*/\r\n    static CHANGED: string = \"changed\";\r\n    /** 定义 resize 事件对象的 type 属性值。*/\r\n    static RESIZE: string = \"resize\";\r\n    /** 定义 added 事件对象的 type 属性值。*/\r\n    static ADDED: string = \"added\";\r\n    /** 定义 removed 事件对象的 type 属性值。*/\r\n    static REMOVED: string = \"removed\";\r\n    /** 定义 display 事件对象的 type 属性值。*/\r\n    static DISPLAY: string = \"display\";\r\n    /** 定义 undisplay 事件对象的 type 属性值。*/\r\n    static UNDISPLAY: string = \"undisplay\";\r\n    /** 定义 error 事件对象的 type 属性值。*/\r\n    static ERROR: string = \"error\";\r\n    /** 定义 complete 事件对象的 type 属性值。*/\r\n    static COMPLETE: string = \"complete\";\r\n    /** 定义 loaded 事件对象的 type 属性值。*/\r\n    static LOADED: string = \"loaded\";\r\n    /** 定义 loaded 事件对象的 type 属性值。*/\r\n    static READY: string = \"ready\";\r\n    /** 定义 progress 事件对象的 type 属性值。*/\r\n    static PROGRESS: string = \"progress\";\r\n    /** 定义 input 事件对象的 type 属性值。*/\r\n    static INPUT: string = \"input\";\r\n    /** 定义 render 事件对象的 type 属性值。*/\r\n    static RENDER: string = \"render\";\r\n    /** 定义 open 事件对象的 type 属性值。*/\r\n    static OPEN: string = \"open\";\r\n    /** 定义 message 事件对象的 type 属性值。*/\r\n    static MESSAGE: string = \"message\";\r\n    /** 定义 close 事件对象的 type 属性值。*/\r\n    static CLOSE: string = \"close\";\r\n    /** 定义 keydown 事件对象的 type 属性值。*/\r\n    static KEY_DOWN: string = \"keydown\";\r\n    /** 定义 keypress 事件对象的 type 属性值。*/\r\n    static KEY_PRESS: string = \"keypress\";\r\n    /** 定义 keyup 事件对象的 type 属性值。*/\r\n    static KEY_UP: string = \"keyup\";\r\n    /** 定义 frame 事件对象的 type 属性值。*/\r\n    static FRAME: string = \"enterframe\";\r\n    /** 定义 dragstart 事件对象的 type 属性值。*/\r\n    static DRAG_START: string = \"dragstart\";\r\n    /** 定义 dragmove 事件对象的 type 属性值。*/\r\n    static DRAG_MOVE: string = \"dragmove\";\r\n    /** 定义 dragend 事件对象的 type 属性值。*/\r\n    static DRAG_END: string = \"dragend\";\r\n    /** 定义 enter 事件对象的 type 属性值。*/\r\n    static ENTER: string = \"enter\";\r\n    /** 定义 select 事件对象的 type 属性值。*/\r\n    static SELECT: string = \"select\";\r\n    /** 定义 blur 事件对象的 type 属性值。*/\r\n    static BLUR: string = \"blur\";\r\n    /** 定义 focus 事件对象的 type 属性值。*/\r\n    static FOCUS: string = \"focus\";\r\n    /** 定义 visibilitychange 事件对象的 type 属性值。*/\r\n    static VISIBILITY_CHANGE: string = \"visibilitychange\";\r\n    /** 定义 focuschange 事件对象的 type 属性值。*/\r\n    static FOCUS_CHANGE: string = \"focuschange\";\r\n    /** 定义 played 事件对象的 type 属性值。*/\r\n    static PLAYED: string = \"played\";\r\n    /** 定义 paused 事件对象的 type 属性值。*/\r\n    static PAUSED: string = \"paused\";\r\n    /** 定义 stopped 事件对象的 type 属性值。*/\r\n    static STOPPED: string = \"stopped\";\r\n    /** 定义 start 事件对象的 type 属性值。*/\r\n    static START: string = \"start\";\r\n    /** 定义 end 事件对象的 type 属性值。*/\r\n    static END: string = \"end\";\r\n    /** 定义 componentadded 事件对象的 type 属性值。*/\r\n    static COMPONENT_ADDED: string = \"componentadded\";\r\n    /** 定义 componentremoved 事件对象的 type 属性值。*/\r\n    static COMPONENT_REMOVED: string = \"componentremoved\";\r\n    /** 定义 released 事件对象的 type 属性值。*/\r\n    static RELEASED: string = \"released\";\r\n    /** 定义 link 事件对象的 type 属性值。*/\r\n    static LINK: string = \"link\";\r\n    /** 定义 label 事件对象的 type 属性值。*/\r\n    static LABEL: string = \"label\";\r\n    /**浏览器全屏更改时触发*/\r\n    static FULL_SCREEN_CHANGE: string = \"fullscreenchange\";\r\n    /**显卡设备丢失时触发*/\r\n    static DEVICE_LOST: string = \"devicelost\";\r\n    /**世界矩阵更新时触发。*/\r\n    static TRANSFORM_CHANGED: string = \"transformchanged\";\r\n    /**更换动作时触发。*/\r\n    static ANIMATION_CHANGED: string = \"animationchanged\";\r\n    /**拖尾渲染节点改变时触发。*/\r\n    static TRAIL_FILTER_CHANGE: string = \"trailfilterchange\";\r\n    /**物理碰撞开始*/\r\n    static TRIGGER_ENTER: string = \"triggerenter\";\r\n    /**物理碰撞持续*/\r\n    static TRIGGER_STAY: string = \"triggerstay\";\r\n    /**物理碰撞结束*/\r\n    static TRIGGER_EXIT: string = \"triggerexit\";\r\n\r\n    /** 事件类型。*/\r\n    type: string;\r\n    /** 原生浏览器事件。*/\r\n    nativeEvent: any;\r\n    /** 事件目标触发对象。*/\r\n    target: Sprite;\r\n    /** 事件当前冒泡对象。*/\r\n    currentTarget: Sprite;\r\n    /** @internal */\r\n    _stoped: boolean;\r\n    /** 分配给触摸点的唯一标识号（作为 int）。*/\r\n    touchId: number;\r\n    /**键盘值*/\r\n    keyCode: number;\r\n    /**滚轮滑动增量*/\r\n    delta: number;\r\n\r\n    /**\r\n     * 设置事件数据。\r\n     * @param\ttype 事件类型。\r\n     * @param\tcurrentTarget 事件目标触发对象。\r\n     * @param\ttarget 事件当前冒泡对象。\r\n     * @return 返回当前 Event 对象。\r\n     */\r\n    setTo(type: string, currentTarget: Sprite, target: Sprite): Event {\r\n        this.type = type;\r\n        this.currentTarget = currentTarget;\r\n        this.target = target;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 阻止对事件流中当前节点的后续节点中的所有事件侦听器进行处理。此方法不会影响当前节点 (currentTarget) 中的任何事件侦听器。\r\n     */\r\n    stopPropagation(): void {\r\n        this._stoped = true;\r\n    }\r\n\r\n    /**\r\n     * 触摸点列表。\r\n     */\r\n    get touches(): any[] {\r\n        if (!this.nativeEvent) return null;\r\n        var arr: any[] = this.nativeEvent.touches;\r\n        if (arr) {\r\n            var stage: Stage = ILaya.stage;\r\n            for (var i: number = 0, n: number = arr.length; i < n; i++) {\r\n                var e: any = arr[i];\r\n                var point: Point = Point.TEMP;\r\n                point.setTo(e.clientX, e.clientY);\r\n                stage._canvasTransform.invertTransformPoint(point);\r\n                stage.transform.invertTransformPoint(point);\r\n\r\n                e.stageX = point.x;\r\n                e.stageY = point.y;\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n\r\n    /**\r\n     * 表示 Alt 键是处于活动状态 (true) 还是非活动状态 (false)。\r\n     */\r\n    get altKey(): boolean {\r\n        return this.nativeEvent.altKey;\r\n    }\r\n\r\n    /**\r\n     * 表示 Ctrl 键是处于活动状态 (true) 还是非活动状态 (false)。\r\n     */\r\n    get ctrlKey(): boolean {\r\n        return this.nativeEvent.ctrlKey;\r\n    }\r\n\r\n    /**\r\n     * 表示 Shift 键是处于活动状态 (true) 还是非活动状态 (false)。\r\n     */\r\n    get shiftKey(): boolean {\r\n        return this.nativeEvent.shiftKey;\r\n    }\r\n\r\n    /**\r\n     * 包含按下或释放的键的字符代码值。字符代码值为英文键盘值。\r\n     */\r\n    get charCode(): boolean {\r\n        return this.nativeEvent.charCode;\r\n    }\r\n\r\n    /**\r\n     * 表示键在键盘上的位置。这对于区分在键盘上多次出现的键非常有用。<br>\r\n     * 例如，您可以根据此属性的值来区分左 Shift 键和右 Shift 键：左 Shift 键的值为 KeyLocation.LEFT，右 Shift 键的值为 KeyLocation.RIGHT。另一个示例是区分标准键盘 (KeyLocation.STANDARD) 与数字键盘 (KeyLocation.NUM_PAD) 上按下的数字键。\r\n     */\r\n    get keyLocation(): number {\r\n        return this.nativeEvent.location || this.nativeEvent.keyLocation;\r\n    }\r\n\r\n    /**鼠标在 Stage 上的 X 轴坐标*/\r\n    get stageX(): number {\r\n        return ILaya.stage.mouseX;\r\n    }\r\n\r\n    /**鼠标在 Stage 上的 Y 轴坐标*/\r\n    get stageY(): number {\r\n        return ILaya.stage.mouseY;\r\n    }\r\n}\r\n\r\n","import { Texture2D } from \"./Texture2D\";\r\nimport { Event } from \"../events/Event\"\r\nimport { EventDispatcher } from \"../events/EventDispatcher\"\r\nimport { Rectangle } from \"../maths/Rectangle\"\r\nimport { Handler } from \"../utils/Handler\"\r\nimport { LoaderManager } from \"../net/LoaderManager\";\r\nimport { ILaya } from \"../../ILaya\";\r\n/**\r\n * 资源加载完成后调度。\r\n * @eventType Event.READY\r\n */\r\n/*[Event(name = \"ready\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * <code>Texture</code> 是一个纹理处理类。\r\n */\r\nexport class Texture extends EventDispatcher {\r\n\r\n    /**@private 默认 UV 信息。*/\r\n    static DEF_UV = new Float32Array([0, 0, 1.0, 0, 1.0, 1.0, 0, 1.0]);\r\n    /**@private */\r\n    static NO_UV = new Float32Array([0, 0, 0, 0, 0, 0, 0, 0]);\r\n    /**@private 反转 UV 信息。*/\r\n    static INV_UV = new Float32Array([0, 1, 1.0, 1, 1.0, 0.0, 0, 0.0]);\r\n    /**@private */\r\n    private static _rect1: Rectangle = new Rectangle();\r\n    /**@private */\r\n    private static _rect2: Rectangle = new Rectangle();\r\n\r\n    /**@private uv的范围*/\r\n    uvrect: any[] = [0, 0, 1, 1]; //startu,startv, urange,vrange\r\n    /**@private */\r\n    private _destroyed: boolean = false;\r\n    /**@private */\r\n    private _bitmap: Texture2D | Texture;\r\n    /**@internal */\r\n    public _uv: ArrayLike<number>;\r\n    /**@private */\r\n    private _referenceCount: number = 0;\r\n    /** @internal [NATIVE]*/\r\n    _nativeObj: any;\r\n\r\n    /**@internal 唯一ID*/\r\n    $_GID: number = 0;\r\n    /**沿 X 轴偏移量。*/\r\n    offsetX: number = 0;\r\n    /**沿 Y 轴偏移量。*/\r\n    offsetY: number = 0;\r\n    /** @private */\r\n    private _w: number = 0;\r\n    /** @private */\r\n    private _h: number = 0;\r\n\r\n    /**原始宽度（包括被裁剪的透明区域）。*/\r\n    sourceWidth: number = 0;\r\n    /**原始高度（包括被裁剪的透明区域）。*/\r\n    sourceHeight: number = 0;\r\n    /**图片地址*/\r\n    url: string = null;\r\n    /** @private */\r\n    scaleRate: number = 1;\r\n\r\n    /**\r\n     * 平移 UV。\r\n     * @param offsetX 沿 X 轴偏移量。\r\n     * @param offsetY 沿 Y 轴偏移量。\r\n     * @param uv 需要平移操作的的 UV。\r\n     * @return 平移后的UV。\r\n     */\r\n    static moveUV(offsetX: number, offsetY: number, uv: any[]): any[] {\r\n        for (var i: number = 0; i < 8; i += 2) {\r\n            uv[i] += offsetX;\r\n            uv[i + 1] += offsetY;\r\n        }\r\n        return uv;\r\n    }\r\n\r\n    /**\r\n     *  根据指定资源和坐标、宽高、偏移量等创建 <code>Texture</code> 对象。\r\n     * @param\tsource 绘图资源 Texture2D 或者 Texture对象。\r\n     * @param\tx 起始绝对坐标 x 。\r\n     * @param\ty 起始绝对坐标 y 。\r\n     * @param\twidth 宽绝对值。\r\n     * @param\theight 高绝对值。\r\n     * @param\toffsetX X 轴偏移量（可选）。\t就是[x,y]相对于原始小图片的位置。一般都是正的，表示裁掉了空白边的大小，如果是负的一般表示加了保护边\r\n     * @param\toffsetY Y 轴偏移量（可选）。\r\n     * @param\tsourceWidth 原始宽度，包括被裁剪的透明区域（可选）。\r\n     * @param\tsourceHeight 原始高度，包括被裁剪的透明区域（可选）。\r\n     * @return  <code>Texture</code> 对象。\r\n     */\r\n    static create(source: Texture2D | Texture, x: number, y: number, width: number, height: number, offsetX: number = 0, offsetY: number = 0, sourceWidth: number = 0, sourceHeight: number = 0): Texture {\r\n        return Texture._create(source, x, y, width, height, offsetX, offsetY, sourceWidth, sourceHeight);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 根据指定资源和坐标、宽高、偏移量等创建 <code>Texture</code> 对象。\r\n     * @param\tsource 绘图资源 Texture2D 或者 Texture 对象。\r\n     * @param\tx 起始绝对坐标 x 。\r\n     * @param\ty 起始绝对坐标 y 。\r\n     * @param\twidth 宽绝对值。\r\n     * @param\theight 高绝对值。\r\n     * @param\toffsetX X 轴偏移量（可选）。\r\n     * @param\toffsetY Y 轴偏移量（可选）。\r\n     * @param\tsourceWidth 原始宽度，包括被裁剪的透明区域（可选）。\r\n     * @param\tsourceHeight 原始高度，包括被裁剪的透明区域（可选）。\r\n     * @param\toutTexture 返回的Texture对象。\r\n     * @return  <code>Texture</code> 对象。\r\n     */\r\n    static _create(source: Texture2D | Texture, x: number, y: number, width: number, height: number, offsetX: number = 0, offsetY: number = 0, sourceWidth: number = 0, sourceHeight: number = 0, outTexture: Texture = null): Texture {\r\n        var btex: boolean = source instanceof Texture;\r\n        var uv = btex ? ((<Texture>source)).uv : Texture.DEF_UV;\r\n        var bitmap: Texture2D | Texture = btex ? ((<Texture>source)).bitmap : source as Texture2D;\r\n\r\n        if (bitmap.width && (x + width) > bitmap.width)\r\n            width = bitmap.width - x;\r\n        if (bitmap.height && (y + height) > bitmap.height)\r\n            height = bitmap.height - y;\r\n        var tex: Texture;\r\n        if (outTexture) {\r\n            tex = outTexture;\r\n            tex.setTo(bitmap, null, sourceWidth || width, sourceHeight || height);\r\n        } else {\r\n            tex = new Texture(bitmap, null, sourceWidth || width, sourceHeight || height)\r\n        }\r\n        tex.width = width;\r\n        tex.height = height;\r\n        tex.offsetX = offsetX;\r\n        tex.offsetY = offsetY;\r\n\r\n        var dwidth: number = 1 / bitmap.width;\r\n        var dheight: number = 1 / bitmap.height;\r\n        x *= dwidth;\r\n        y *= dheight;\r\n        width *= dwidth;\r\n        height *= dheight;\r\n\r\n        var u1: number = tex.uv[0], v1: number = tex.uv[1], u2: number = tex.uv[4], v2: number = tex.uv[5];\r\n        var inAltasUVWidth: number = (u2 - u1), inAltasUVHeight: number = (v2 - v1);\r\n        var oriUV: any[] = Texture.moveUV(uv[0], uv[1], [x, y, x + width, y, x + width, y + height, x, y + height]);\r\n        tex.uv = new Float32Array([u1 + oriUV[0] * inAltasUVWidth, v1 + oriUV[1] * inAltasUVHeight,\r\n        u2 - (1 - oriUV[2]) * inAltasUVWidth, v1 + oriUV[3] * inAltasUVHeight,\r\n        u2 - (1 - oriUV[4]) * inAltasUVWidth, v2 - (1 - oriUV[5]) * inAltasUVHeight,\r\n        u1 + oriUV[6] * inAltasUVWidth, v2 - (1 - oriUV[7]) * inAltasUVHeight]);\r\n\r\n        var bitmapScale: number = ((<Texture>(bitmap as any))).scaleRate;\r\n        if (bitmapScale && bitmapScale != 1) {\r\n            tex.sourceWidth /= bitmapScale;\r\n            tex.sourceHeight /= bitmapScale;\r\n            tex.width /= bitmapScale;\r\n            tex.height /= bitmapScale;\r\n            tex.scaleRate = bitmapScale;\r\n        } else {\r\n            tex.scaleRate = 1;\r\n        }\r\n        return tex;\r\n    }\r\n\r\n    /**\r\n     * 截取Texture的一部分区域，生成新的Texture，如果两个区域没有相交，则返回null。\r\n     * @param\ttexture\t目标Texture。\r\n     * @param\tx\t\t相对于目标Texture的x位置。\r\n     * @param\ty\t\t相对于目标Texture的y位置。\r\n     * @param\twidth\t截取的宽度。\r\n     * @param\theight\t截取的高度。\r\n     * @return 返回一个新的Texture。\r\n     */\r\n    static createFromTexture(texture: Texture, x: number, y: number, width: number, height: number): Texture {\r\n        var texScaleRate: number = texture.scaleRate;\r\n        if (texScaleRate != 1) {\r\n            x *= texScaleRate;\r\n            y *= texScaleRate;\r\n            width *= texScaleRate;\r\n            height *= texScaleRate;\r\n        }\r\n        var rect: Rectangle = Rectangle.TEMP.setTo(x - texture.offsetX, y - texture.offsetY, width, height);\r\n        var result = rect.intersection(Texture._rect1.setTo(0, 0, texture.width, texture.height), Texture._rect2);\r\n        if (result)\r\n            var tex: Texture = Texture.create(((<Texture2D>(texture as any))), result.x, result.y, result.width, result.height, result.x - rect.x, result.y - rect.y, width, height);\r\n        else\r\n            return null;\r\n        return tex;\r\n    }\r\n\r\n\r\n    get uv(): ArrayLike<number> {\r\n        return this._uv;\r\n    }\r\n\r\n    set uv(value: ArrayLike<number>) {\r\n        this.uvrect[0] = Math.min(value[0], value[2], value[4], value[6]);\r\n        this.uvrect[1] = Math.min(value[1], value[3], value[5], value[7]);\r\n        this.uvrect[2] = Math.max(value[0], value[2], value[4], value[6]) - this.uvrect[0];\r\n        this.uvrect[3] = Math.max(value[1], value[3], value[5], value[7]) - this.uvrect[1];\r\n        this._uv = value;\r\n    }\r\n\r\n    /** 实际宽度。*/\r\n    get width(): number {\r\n        if (this._w)\r\n            return this._w;\r\n        if (!this.bitmap) return 0;\r\n        return (this.uv && this.uv !== Texture.DEF_UV) ? (this.uv[2] - this.uv[0]) * this.bitmap.width : this.bitmap.width;\r\n    }\r\n\r\n    set width(value: number) {\r\n        this._w = value;\r\n        this.sourceWidth || (this.sourceWidth = value);\r\n    }\r\n\r\n    /** 实际高度。*/\r\n    get height(): number {\r\n        if (this._h)\r\n            return this._h;\r\n        if (!this.bitmap) return 0;\r\n        return (this.uv && this.uv !== Texture.DEF_UV) ? (this.uv[5] - this.uv[1]) * this.bitmap.height : this.bitmap.height;\r\n    }\r\n\r\n    set height(value: number) {\r\n        this._h = value;\r\n        this.sourceHeight || (this.sourceHeight = value);\r\n    }\r\n\r\n    /**\r\n     * 获取位图。\r\n     * @return 位图。\r\n     */\r\n    get bitmap(): Texture2D | Texture {\r\n        return this._bitmap;\r\n    }\r\n\r\n    /**\r\n     * 设置位图。\r\n     * @param 位图。\r\n     */\r\n    set bitmap(value: Texture2D | Texture) {\r\n        this._bitmap && this._bitmap._removeReference(this._referenceCount);\r\n        this._bitmap = value;\r\n        value && (value._addReference(this._referenceCount));\r\n    }\r\n\r\n    /**\r\n     * 获取是否已经销毁。\r\n     * @return 是否已经销毁。\r\n     */\r\n    get destroyed(): boolean {\r\n        return this._destroyed;\r\n    }\r\n\r\n    /**\r\n     * 创建一个 <code>Texture</code> 实例。\r\n     * @param\tbitmap 位图资源。\r\n     * @param\tuv UV 数据信息。\r\n     */\r\n    constructor(bitmap: Texture2D | Texture = null, uv: ArrayLike<number> = null, sourceWidth: number = 0, sourceHeight: number = 0) {\r\n        super();\r\n        this.setTo(bitmap, uv, sourceWidth, sourceHeight);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _addReference(): void {\r\n        this._bitmap && this._bitmap._addReference();\r\n        this._referenceCount++;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _removeReference(): void {\r\n        this._bitmap && this._bitmap._removeReference();\r\n        this._referenceCount--;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _getSource(cb: Function = null): any {\r\n        if (this._destroyed || !this._bitmap)\r\n            return null;\r\n        this.recoverBitmap(cb);\r\n        return this._bitmap.destroyed ? null : this.bitmap._getSource();\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private _onLoaded(complete: Handler, context: any): void {\r\n        if (!context) {\r\n        } else if (context == this) {\r\n\r\n        } else if (context instanceof Texture) {\r\n            var tex: Texture = context;\r\n            Texture._create(context, 0, 0, tex.width, tex.height, 0, 0, tex.sourceWidth, tex.sourceHeight, this);\r\n        } else {\r\n            this.bitmap = context;\r\n            this.sourceWidth = this._w = context.width;\r\n            this.sourceHeight = this._h = context.height;\r\n        }\r\n        complete && complete.run();\r\n        this.event(Event.READY, this);\r\n    }\r\n\r\n    /**\r\n     * 获取是否可以使用。\r\n     */\r\n    getIsReady(): boolean {\r\n        return this._destroyed ? false : (this._bitmap ? true : false);\r\n    }\r\n\r\n    /**\r\n     * 设置此对象的位图资源、UV数据信息。\r\n     * @param\tbitmap 位图资源\r\n     * @param\tuv UV数据信息\r\n     */\r\n    setTo(bitmap: Texture2D | Texture = null, uv: ArrayLike<number> = null, sourceWidth: number = 0, sourceHeight: number = 0): void {\r\n        this.bitmap = bitmap;\r\n        this.sourceWidth = sourceWidth;\r\n        this.sourceHeight = sourceHeight;\r\n\r\n        if (bitmap) {\r\n            this._w = bitmap.width;\r\n            this._h = bitmap.height;\r\n            this.sourceWidth = this.sourceWidth || bitmap.width;\r\n            this.sourceHeight = this.sourceHeight || bitmap.height\r\n        }\r\n        this.uv = uv || Texture.DEF_UV;\r\n    }\r\n\r\n    /**\r\n     * 加载指定地址的图片。\r\n     * @param\turl 图片地址。\r\n     * @param\tcomplete 加载完成回调\r\n     */\r\n    load(url: string, complete: Handler = null): void {\r\n        if (!this._destroyed)\r\n            ILaya.loader.load(url, Handler.create(this, this._onLoaded, [complete]), null, \"htmlimage\", 1, true);\r\n    }\r\n\r\n    getTexturePixels(x: number, y: number, width: number, height: number): Uint8Array {\r\n        var st: number, dst: number, i: number;\r\n        var tex2d: Texture2D | Texture = this.bitmap;\r\n        // 适配图集\r\n        var texw = this._w;\r\n        var texh = this._h;\r\n        var sourceWidth = this.sourceWidth;\r\n        var sourceHeight = this.sourceHeight;\r\n        var tex2dw: number = tex2d.width;\r\n        var tex2dh: number = tex2d.height;\r\n        var offsetX = this.offsetX;\r\n        var offsetY = this.offsetY;\r\n        let draww = width;\r\n        let drawh = height;\r\n        if (x + width > texw + offsetX) draww -= (x + width) - texw - offsetX;\r\n        if (x + width > sourceWidth) width -= (x + width) - sourceWidth;\r\n        if (y + height > texh + offsetY) drawh -= (y + height) - texh - offsetY;\r\n        if (y + height > sourceHeight) height -= (y + height) - sourceHeight;\r\n        if (width <= 0 || height <= 0) return null;\r\n        let marginL = offsetX > x ? offsetX - x : 0; // 考虑图集的情况，只渲染图集中的图片，左侧可能需要补充空白\r\n        let marginT = offsetY > y ? offsetY - y : 0;\r\n        let rePosX = x > offsetX ? x - offsetX : 0; // 考虑图集的情况，只渲染图集中的图片，不渲染 offset，需要重新定位 x 坐标\r\n        let rePosY = y > offsetY ? y - offsetY : 0;\r\n        draww -= marginL; // 考虑图集的情况，只渲染图集中的图片，其大小要减去空白\r\n        drawh -= marginT;\r\n\r\n        var wstride: number = width * 4;\r\n        var pix: Uint8Array = null;\r\n        try {\r\n            pix = <Uint8Array>(tex2d as Texture2D).getPixels();\r\n        } catch (e) {\r\n        }\r\n        if (pix) {\r\n            if (x == 0 && y == 0 && width == tex2dw && height == tex2dh)\r\n                return pix;\r\n            //否则只取一部分\r\n            let uv = (this._uv as Array<number>).slice();\r\n            let atlasPosX = Math.round(uv[0] * tex2dw); // 计算图片在图集中的位置\r\n            let atlasPosY = Math.round(uv[1] * tex2dh);\r\n            var ret: Uint8Array = new Uint8Array(width * height * 4);\r\n            wstride = tex2dw * 4;\r\n            dst = (atlasPosY + rePosY) * wstride;\r\n            st = atlasPosX * 4 + rePosX * 4 + dst;\r\n            for (i = 0; i < drawh; i++) {\r\n                ret.set(pix.slice(st, st + draww * 4), width * 4 * (i + marginT) + marginL * 4);\r\n                st += wstride;\r\n            }\r\n            return ret;\r\n        }\r\n\r\n        // 如果无法直接获取，只能先渲染出来\r\n        var ctx = new ILaya.Context();\r\n        ctx.size(width, height);\r\n        ctx.asBitmap = true;\r\n        var uv: any[] = null;\r\n        if (x != 0 || y != 0 || width != tex2dw || height != tex2dh) {\r\n            uv = (this._uv as Array<number>).slice();\t// 复制一份uv\r\n            var stu: number = uv[0];\r\n            var stv: number = uv[1];\r\n            var uvw: number = uv[2] - stu;\r\n            var uvh: number = uv[7] - stv;\r\n            var uk: number = uvw / texw;\r\n            var vk: number = uvh / texh;\r\n            uv = [stu + rePosX * uk, stv + rePosY * vk,\r\n                stu + (rePosX + draww) * uk, stv + rePosY * vk,\r\n                stu + (rePosX + draww) * uk, stv + (rePosY + drawh) * vk,\r\n                stu + rePosX * uk, stv + (rePosY + drawh) * vk];\r\n        }\r\n        ctx._drawTextureM(this, marginL, marginT, draww, drawh, null, 1.0, uv);\r\n        //ctx.drawTexture(value, -x, -y, x + width, y + height);\r\n        ctx._targets.start();\r\n        ctx.flush();\r\n        ctx._targets.end();\r\n        ctx._targets.restore();\r\n        var dt: Uint8Array = ctx._targets.getData(0, 0, width, height);\r\n        ctx.destroy();\r\n        // 上下颠倒一下\r\n        ret = new Uint8Array(width * height * 4);\r\n        st = 0;\r\n        dst = (height - 1) * wstride;\r\n        for (i = height - 1; i >= 0; i--) {\r\n            ret.set(dt.slice(dst, dst + wstride), st);\r\n            st += wstride;\r\n            dst -= wstride;\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    /**\r\n     * 获取Texture上的某个区域的像素点\r\n     * @param\tx\r\n     * @param\ty\r\n     * @param\twidth\r\n     * @param\theight\r\n     * @return  返回像素点集合\r\n     */\r\n    getPixels(x: number, y: number, width: number, height: number): Uint8Array {\r\n        if ((window as any).conch) {\r\n            return this._nativeObj.getImageData(x, y, width, height);\r\n        } else {\r\n            return this.getTexturePixels(x, y, width, height);\r\n        }// canvas 不支持\r\n    }\r\n\r\n    /**\r\n     * 通过url强制恢复bitmap。\r\n     */\r\n    recoverBitmap(onok: Function = null): void {\r\n        var url: string = this._bitmap.url;\r\n        if (!this._destroyed && (!this._bitmap || this._bitmap.destroyed) && url) {\r\n            let tex:Texture2D = ILaya.loader.getRes(url);\r\n            if(tex){\r\n                this.bitmap = tex;\r\n                onok && onok();\r\n            }else{\r\n                ILaya.loader.load(url, Handler.create(this, function (bit: any): void {\r\n                    this.bitmap = bit;\r\n                    onok && onok();\r\n                }), null, \"htmlimage\", 1, true);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 强制释放Bitmap,无论是否被引用。\r\n     */\r\n    disposeBitmap(): void {\r\n        if (!this._destroyed && this._bitmap) {\r\n            this._bitmap.destroy();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 销毁纹理。\r\n     */\r\n    destroy(force: boolean = false): void {\r\n        if (!this._destroyed) {\r\n            this._destroyed = true;\r\n            var bit = this._bitmap;\r\n            if (bit) {\r\n                bit._removeReference(this._referenceCount);\r\n                if ((bit as any).referenceCount === 0 || force)\r\n                    bit.destroy();\r\n                bit = null;\r\n            }\r\n            if (this.url && this === ILaya.loader.getRes(this.url))\r\n                ILaya.Loader.clearRes(this.url);\r\n        }\r\n    }\r\n}\r\n\r\n","export class FontInfo {\r\n\r\n    static EMPTY: FontInfo = new FontInfo(null);\r\n\r\n    private static _cache: any = {};\r\n    private static _gfontID: number = 0;\r\n    private static _lastFont: string = '';\r\n    private static _lastFontInfo: FontInfo;\r\n\r\n    static Parse(font: string): FontInfo {\r\n        if (font === FontInfo._lastFont) {\r\n            return FontInfo._lastFontInfo;\r\n        }\r\n        var r: FontInfo = FontInfo._cache[font];\r\n        if (!r) {\r\n            r = FontInfo._cache[font] = new FontInfo(font);\r\n        }\r\n        FontInfo._lastFont = font;\r\n        FontInfo._lastFontInfo = r;\r\n        return r;\r\n    }\r\n\r\n    /**@internal */\r\n    _id: number;\r\n    /**@internal */\r\n    _font: string = \"14px Arial\";\r\n    /**@internal */\r\n    _family: string = \"Arial\";\r\n    /**@internal */\r\n    _size: number = 14;\r\n    /**@internal */\r\n    _italic: boolean = false;\r\n    /**@internal */\r\n    _bold: boolean = false;\r\n\r\n    constructor(font: string) {\r\n        this._id = FontInfo._gfontID++;\r\n        this.setFont(font || this._font);\r\n    }\r\n\r\n    setFont(value: string): void {\r\n        this._font = value;\r\n        var _words: any[] = value.split(' ');\r\n        var l: number = _words.length;\r\n        if (l < 2) {\r\n            if (l == 1) {\r\n                if (_words[0].indexOf('px') > 0) {\r\n                    this._size = parseInt(_words[0]);\r\n                }\r\n            }\r\n            return;\r\n        }\r\n        var szpos: number = -1;\r\n        //由于字体可能有空格，例如Microsoft YaHei 所以不能直接取倒数第二个，要先找到px\r\n        for (var i: number = 0; i < l; i++) {\r\n            if (_words[i].indexOf('px') > 0 || _words[i].indexOf('pt') > 0) {\r\n                szpos = i;\r\n                this._size = parseInt(_words[i]);\r\n                if (this._size <= 0) {\r\n                    console.error('font parse error:' + value);\r\n                    this._size = 14;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n        //最后一个是用逗号分开的family\r\n        var fpos: number = szpos + 1;\r\n        var familys: string = _words[fpos];\r\n        fpos++;//下一个\r\n        for (; fpos < l; fpos++) {\r\n            familys += ' ' + _words[fpos];\r\n        }\r\n        this._family = (familys.split(','))[0];\r\n        this._italic = _words.indexOf('italic') >= 0;\r\n        this._bold = _words.indexOf('bold') >= 0;\r\n    }\r\n}\r\n\r\n","/**\r\n\t * @private\r\n\t */\r\nexport class WordText {\r\n    //TODO:\r\n    id: number;\r\n    save: any[] = [];\r\n    toUpperCase: string = null;\r\n    changed: boolean;\r\n    /**@internal */\r\n    _text: string;\r\n    width: number = -1;\t//整个WordText的长度。-1表示没有计算还。\r\n    pageChars: any[] = [];\t//把本对象的字符按照texture分组保存的文字信息。里面又是一个数组。具体含义见使用的地方。\r\n    startID: number = 0;\t//上面的是个数组，但是可能前面都是空的，加个起始位置\r\n    startIDStroke: number = 0;\r\n    lastGCCnt: number = 0;\t//如果文字gc了，需要检查缓存是否有效，这里记录上次检查对应的gc值。\r\n\tsplitRender: boolean = false;\t// 强制拆分渲染\r\n\tscalex=1;\t// 缓存的时候的缩放\r\n\tscaley=1;\r\n\r\n    setText(txt: string): void {\r\n        this.changed = true;\r\n        this._text = txt;\r\n        this.width = -1;\r\n        this.cleanCache();\r\n        //pageChars = [];//需要重新更新\r\n    }\r\n\r\n    //TODO:coverage\r\n    toString(): string {\r\n        return this._text;\r\n    }\r\n\r\n    get length(): number {\r\n        return this._text ? this._text.length : 0;\r\n    }\r\n\r\n    //TODO:coverage\r\n    charCodeAt(i: number): number {\r\n        return this._text ? this._text.charCodeAt(i) : NaN;\r\n    }\r\n\r\n    //TODO:coverage\r\n    charAt(i: number): string {\r\n        return this._text ? this._text.charAt(i) : null;\r\n    }\r\n\r\n    /**\r\n     * 自己主动清理缓存，需要把关联的贴图删掉\r\n     * 不做也可以，textrender会自动清理不用的\r\n     * TODO 重用\r\n     */\r\n    cleanCache(): void {\r\n        // 如果是独占文字贴图的，需要删掉\r\n        this.pageChars.forEach(function (p: any): void { // 可能有多个\r\n            var tex: any = p.tex;\r\n            var words: any[] = p.words;\r\n            if (p.words.length == 1 && tex && tex.ri) {// 如果有ri表示是独立贴图\r\n                tex.destroy();\r\n            }\r\n        });\r\n\r\n        this.pageChars = [];\r\n\t\tthis.startID = 0;\r\n\t\tthis.scalex=1;\r\n\t\tthis.scaley=1;\r\n    }\r\n}\r\n\r\n","import { RenderInfo } from \"../../renders/RenderInfo\"\r\n/**\r\n * TODO如果占用内存较大,这个结构有很多成员可以临时计算\r\n */\r\nexport class CharRenderInfo {\r\n    char: string = '';\t\t\t\t// 调试用\r\n    tex: any;\t\t\t\t\t\t//\r\n    deleted: boolean = false; \t// 已经被删除了\r\n    uv: any[] = new Array(8);// [0, 0, 1, 1];\t\t//uv\r\n    pos: number = 0;\t\t\t\t\t//数组下标\r\n    width: number;\t\t\t\t\t//字体宽度。测量的宽度，用来排版。没有缩放\r\n    height: number; \t\t\t\t//字体高度。没有缩放\r\n    bmpWidth: number;\t\t\t\t//实际图片的宽度。可能与排版用的width不一致。包含缩放和margin\r\n    bmpHeight: number;\r\n    orix: number = 0;\t\t\t\t// 原点位置，通常都是所在区域的左上角\r\n    oriy: number = 0;\r\n    touchTick: number = 0;\t\t//\r\n    isSpace: boolean = false;\t\t//是否是空格，如果是空格，则只有width有效\r\n    touch(): void {\r\n        var curLoop: number = RenderInfo.loopCount;\r\n        if (this.touchTick != curLoop) {// 这个保证每帧只调用一次\r\n            this.tex.touchRect(this, curLoop);\r\n        }\r\n        this.touchTick = curLoop;\r\n    }\r\n}\r\n\r\n","import { CharRenderInfo } from \"./CharRenderInfo\";\r\nexport class ICharRender {\r\n    fontsz = 16;\r\n    getWidth(font: string, str: string): number { return 0; }\r\n\r\n    scale(sx: number, sy: number): void {\r\n    }\r\n\r\n    get canvasWidth(): number {\r\n        return 0;\r\n    }\r\n\r\n    set canvasWidth(w: number) {\r\n\r\n    }\r\n    /**\r\n     *TODO stroke \r\n     * @param\tchar\r\n     * @param\tfont\r\n     * @param\tsize  返回宽高\r\n     * @return\r\n     */\r\n    getCharBmp(char: string, font: string, lineWidth: number, colStr: string, strokeColStr: string, size: CharRenderInfo, margin_left: number, margin_top: number, margin_right: number, margin_bottom: number, rect: any[]|null = null): ImageData|null {\r\n        return null;\r\n    }\r\n}\r\n\r\n","//import { HTMLCanvas } from \"../resource/HTMLCanvas\"\r\nimport { HTMLCanvas } from \"../resource/HTMLCanvas\";\r\nimport { ILaya } from \"../../ILaya\";\r\nimport { Laya } from \"../../Laya\";\r\n\r\n\r\n/**\r\n * <code>Browser</code> 是浏览器代理类。封装浏览器及原生 js 提供的一些功能。\r\n */\r\nexport class Browser {\r\n\r\n    /** 浏览器代理信息。*/\r\n    static userAgent: string;\r\n    /** 表示是否在移动设备，包括IOS和安卓等设备内。*/\r\n    static onMobile: boolean;\r\n    /** 表示是否在 IOS 设备内。*/\r\n    static onIOS: boolean;\r\n    /** 表示是否在 Mac 设备。*/\r\n    static onMac: boolean;\r\n    /** 表示是否在 IPhone 设备内。*/\r\n    static onIPhone: boolean;\r\n    /** 表示是否在 IPad 设备内。*/\r\n    static onIPad: boolean;\r\n    /** 表示是否在 Android 设备内。*/\r\n    static onAndroid: boolean;\r\n    /** 表示是否在 Windows Phone 设备内。*/\r\n    static onWP: boolean;\r\n    /** 表示是否在 QQ 浏览器内。*/\r\n    static onQQBrowser: boolean;\r\n    /** 表示是否在移动端 QQ 或 QQ 浏览器内。*/\r\n    static onMQQBrowser: boolean;\r\n    /** 表示是否在 Safari 内。*/\r\n    static onSafari: boolean;\r\n    /** 表示是否在 IE 浏览器内*/\r\n    static onIE: boolean;\r\n    /** 表示是否在 微信 内*/\r\n    static onWeiXin: boolean;\r\n    /** 表示是否在 PC 端。*/\r\n    static onPC: boolean;\r\n    /** 微信小游戏 **/\r\n    static onMiniGame: boolean;\r\n    /** 百度小游戏 **/\r\n    static onBDMiniGame: boolean;\r\n    /** 小米戏小游戏 **/\r\n    static onKGMiniGame: boolean;\r\n    /** OPPO小游戏 **/\r\n    static onQGMiniGame: boolean;\r\n    /** VIVO小游戏 **/\r\n    static onVVMiniGame: boolean;\r\n    /** 阿里小游戏 **/\r\n    static onAlipayMiniGame: boolean;\r\n    /***手机QQ小游戏 */\r\n    static onQQMiniGame: boolean;\r\n    /*** BILIBILI小游戏 */\r\n    static onBLMiniGame:boolean;\r\n    /** 字节跳动小游戏*/\r\n    static onTTMiniGame:boolean;\r\n    /** 华为快游戏 */\r\n    static onHWMiniGame:boolean;\r\n    /** @private */\r\n    static onFirefox: boolean;//TODO:求补充\r\n    /** @private */\r\n    static onEdge: boolean;//TODO:求补充\r\n    /** @private */\r\n    static onLayaRuntime: boolean;\r\n\r\n\r\n    /** 表示是否支持WebAudio*/\r\n    static supportWebAudio: boolean;\r\n    /** 表示是否支持LocalStorage*/\r\n    static supportLocalStorage: boolean;\r\n\r\n    /** 全局离线画布（非主画布）。主要用来测量字体、获取image数据。*/\r\n    static canvas: HTMLCanvas;\r\n    /** 全局离线画布上绘图的环境（非主画布）。 */\r\n    static context: CanvasRenderingContext2D;\r\n\r\n    /** @private */\r\n    private static _window: any;\r\n    /** @private */\r\n    private static _document: Document;\r\n    /** @private */\r\n    private static _container: any;\r\n    /** @private */\r\n    private static _pixelRatio: number = -1;\r\n\r\n    /** @private */\r\n    static mainCanvas: any = null;\r\n\r\n    /**@private */\r\n    private static hanzi: RegExp = new RegExp(\"^[\\u4E00-\\u9FA5]$\");\r\n    /**@private */\r\n    private static fontMap: any[] = [];\r\n    /**@private */\r\n    static measureText: Function = function (txt: string, font: string): any {\r\n        var isChinese: boolean = Browser.hanzi.test(txt);\r\n        if (isChinese && Browser.fontMap[font]) {\r\n            return Browser.fontMap[font];\r\n        }\r\n\r\n        var ctx: CanvasRenderingContext2D = Browser.context;\r\n        ctx.font = font;\r\n\r\n        var r: any = ctx.measureText(txt);\r\n        if (isChinese) Browser.fontMap[font] = r;\r\n        return r;\r\n    }\r\n\r\n    /**@internal */\r\n    static __init__(): any {\r\n        var Laya: Laya = (window as any).Laya || ILaya.Laya;\r\n        if (Browser._window) return Browser._window;\r\n        var win: any = Browser._window = window;\r\n        var doc: any = Browser._document = win.document;\r\n        var u: string = Browser.userAgent = win.navigator.userAgent;\r\n        var maxTouchPoints: number = win.navigator.maxTouchPoints || 0;\r\n        var platform:string = win.navigator.platform;\r\n\r\n        //阿里小游戏\r\n        if (u.indexOf('AlipayMiniGame') > -1 && \"my\" in Browser.window) {\r\n            //这里需要手动初始化阿里适配库\r\n            (window as any).aliPayMiniGame(Laya, Laya);\r\n            if (!Laya[\"ALIMiniAdapter\"]) {\r\n                console.error(\"请先添加阿里小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-6-0\");\r\n            } else {\r\n                Laya[\"ALIMiniAdapter\"].enable();\r\n            }\r\n        }\r\n\r\n        if (u.indexOf('OPPO') == -1 && u.indexOf(\"MiniGame\") > -1 && \"wx\" in Browser.window) {\r\n            if(\"tt\" in Browser.window){\r\n                //手机头条小游戏\r\n                (window as any).ttMiniGame(Laya, Laya);\r\n                if (!Laya[\"TTMiniAdapter\"]) {\r\n                    //TODO\r\n                    console.error(\"请引入字节跳动小游戏的适配库\");\r\n                } else {\r\n                    Laya[\"TTMiniAdapter\"].enable();\r\n                }\r\n            }else if(\"bl\" in Browser.window){\r\n                 //手机B站小游戏\r\n                 (window as any).biliMiniGame(Laya, Laya);\r\n                 if (!Laya[\"BLMiniAdapter\"]) {\r\n                     console.error(\"请引入bilibili小游戏的适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-7-0\");\r\n                    } else {\r\n                        Laya[\"BLMiniAdapter\"].enable();\r\n                    }\r\n                } \r\n            else if (\"qq\" in Browser.window) {\r\n                //手机QQ小游戏\r\n                (window as any).qqMiniGame(Laya, Laya);\r\n                if (!Laya[\"QQMiniAdapter\"]) {\r\n                    console.error(\"请引入手机QQ小游戏的适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-0-0\");\r\n                } else {\r\n                    Laya[\"QQMiniAdapter\"].enable();\r\n                }\r\n            }\r\n            else {\r\n                //微信小游戏\r\n                (window as any).wxMiniGame(Laya, Laya);\r\n                if (!Laya[\"MiniAdpter\"]) {\r\n                    console.error(\"请先添加小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0\");\r\n                    //TODO 教程要改\r\n                } else {\r\n                    Laya[\"MiniAdpter\"].enable();\r\n                }\r\n            }\r\n        }\r\n        //华为快游戏\r\n        if(\"hbs\" in Browser.window){\r\n            (window as any).hwMiniGame(Laya, Laya);\r\n            if (!Laya[\"HWMiniAdapter\"]) {\r\n                console.error(\"请先添加小游戏适配库!\");\r\n                //TODO 教程要改\r\n            } else {\r\n                Laya[\"HWMiniAdapter\"].enable();\r\n            }\r\n        }\r\n\r\n        //百度小游戏\r\n        if (u.indexOf(\"SwanGame\") > -1) {\r\n            (window as any).bdMiniGame(Laya, Laya);\r\n            if (!Laya[\"BMiniAdapter\"]) {\r\n                console.error(\"请先添加百度小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-1-0\");\r\n                //TODO 教程要改\r\n            } else {\r\n                Laya[\"BMiniAdapter\"].enable();\r\n            }\r\n        }\r\n\r\n        //小米小游戏\r\n        if (u.indexOf('QuickGame') > -1) {\r\n            (window as any).miMiniGame(Laya, Laya);\r\n            if (!Laya[\"KGMiniAdapter\"]) {\r\n                console.error(\"请先添加小米小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-2-0\");\r\n            } else {\r\n                Laya[\"KGMiniAdapter\"].enable();\r\n            }\r\n        }\r\n\r\n        //OPPO小游戏\r\n        if (u.indexOf('OPPO') > -1 && u.indexOf('MiniGame') > -1) {\r\n            (window as any).qgMiniGame(Laya, Laya);\r\n            if (!Laya[\"QGMiniAdapter\"]) {\r\n                console.error(\"请先添加OPPO小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-3-0\");\r\n            } else {\r\n                Laya[\"QGMiniAdapter\"].enable();\r\n            }\r\n        }\r\n\r\n        //VIVO小游戏\r\n        if (u.indexOf('VVGame') > -1) {\r\n            (window as any).vvMiniGame(Laya, Laya);\r\n            if (!Laya[\"VVMiniAdapter\"]) {\r\n                console.error(\"请先添加VIVO小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-4-0\");\r\n            } else {\r\n                Laya[\"VVMiniAdapter\"].enable();\r\n            }\r\n        }\r\n\r\n        //新增trace的支持\r\n        win.trace = console.log;\r\n\r\n        //兼容requestAnimationFrame\r\n        win.requestAnimationFrame = win.requestAnimationFrame || win.webkitRequestAnimationFrame || win.mozRequestAnimationFrame || win.oRequestAnimationFrame || win.msRequestAnimationFrame || function (fun: any): any {\r\n            return win.setTimeout(fun, 1000 / 60);\r\n        }\r\n\r\n        //强制修改body样式\r\n        var bodyStyle: any = doc.body.style;\r\n        bodyStyle.margin = 0;\r\n        bodyStyle.overflow = 'hidden';\r\n        bodyStyle['-webkit-user-select'] = 'none';\r\n        bodyStyle['-webkit-tap-highlight-color'] = 'rgba(200,200,200,0)';\r\n\r\n        //强制修改meta标签，防止开发者写错\r\n        var metas: any[] = doc.getElementsByTagName('meta');\r\n        var i: number = 0, flag: boolean = false, content: any = 'width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no';\r\n        while (i < metas.length) {\r\n            var meta: any = metas[i];\r\n            if (meta.name == 'viewport') {\r\n                meta.content = content;\r\n                flag = true;\r\n                break;\r\n            }\r\n            i++;\r\n        }\r\n        if (!flag) {\r\n            meta = doc.createElement('meta');\r\n            meta.name = 'viewport', meta.content = content;\r\n            doc.getElementsByTagName('head')[0].appendChild(meta);\r\n        }\r\n\r\n        //处理兼容性\t\t\t\r\n        Browser.onMobile = (window as any).isConchApp ? true : u.indexOf(\"Mobile\") > -1;\r\n        Browser.onIOS = !!u.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/);\r\n        Browser.onIPhone = u.indexOf(\"iPhone\") > -1;\r\n        Browser.onMac = u.indexOf(\"Mac OS X\") > -1;\r\n        Browser.onIPad = u.indexOf(\"iPad\") > -1 || ( platform === 'MacIntel' && maxTouchPoints >1 );//\"platform === 'MacIntel' && maxTouchPoints >1\" is a temporary solution，maybe accidentally injure other platform.\r\n        Browser.onAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1;\r\n        Browser.onWP = u.indexOf(\"Windows Phone\") > -1;\r\n        Browser.onQQBrowser = u.indexOf(\"QQBrowser\") > -1;\r\n        Browser.onMQQBrowser = u.indexOf(\"MQQBrowser\") > -1 || (u.indexOf(\"Mobile\") > -1 && u.indexOf(\"QQ\") > -1);\r\n        Browser.onIE = !!win.ActiveXObject || \"ActiveXObject\" in win;\r\n        Browser.onWeiXin = u.indexOf('MicroMessenger') > -1;\r\n        Browser.onSafari = u.indexOf(\"Safari\") > -1;\r\n        Browser.onPC = !Browser.onMobile;\r\n        Browser.onMiniGame = u.indexOf('MiniGame') > -1;\r\n        Browser.onBDMiniGame = u.indexOf('SwanGame') > -1;\r\n        Browser.onLayaRuntime = ! !((<any>Browser.window)).conch;\r\n        if (u.indexOf('OPPO') > -1 && u.indexOf('MiniGame') > -1) {\r\n            Browser.onQGMiniGame = true;//OPPO环境判断\r\n            Browser.onMiniGame = false;\r\n        } else if (\"qq\" in Browser.window && u.indexOf('MiniGame') > -1) {\r\n            Browser.onQQMiniGame = true;//手机QQ环境判断\r\n            Browser.onMiniGame = false;\r\n        }else if(\"bl\" in Browser.window&& u.indexOf('MiniGame') > -1){\r\n            Browser.onBLMiniGame=true;//B站环境判断\r\n            Browser.onMiniGame=false;\r\n        }else if(\"tt\" in Browser.window&& u.indexOf('MiniGame') > -1){\r\n            Browser.onTTMiniGame = true;\r\n            Browser.onMiniGame = false;\r\n        }\r\n        \r\n        Browser.onHWMiniGame = \"hbs\" in Browser.window;\r\n        Browser.onVVMiniGame = u.indexOf('VVGame') > -1;//vivo\r\n        Browser.onKGMiniGame = u.indexOf('QuickGame') > -1;//小米运行环境判断\r\n        if (u.indexOf('AlipayMiniGame') > -1) {\r\n            Browser.onAlipayMiniGame = true;//阿里小游戏环境判断\r\n            Browser.onMiniGame = false;\r\n        }\r\n        return win;\r\n    }\r\n\r\n    /**\r\n     * 创建浏览器原生节点。\r\n     * @param\ttype 节点类型。\r\n     * @return\t创建的节点对象的引用。\r\n     */\r\n    static createElement(type: string): any {\r\n        Browser.__init__();\r\n        return Browser._document.createElement(type);\r\n    }\r\n\r\n    /**\r\n     * 返回 Document 对象中拥有指定 id 的第一个对象的引用。\r\n     * @param\ttype 节点id。\r\n     * @return\t节点对象。\r\n     */\r\n    static getElementById(type: string): any {\r\n        Browser.__init__();\r\n        return Browser._document.getElementById(type);\r\n    }\r\n\r\n    /**\r\n     * 移除指定的浏览器原生节点对象。\r\n     * @param\ttype 节点对象。\r\n     */\r\n    static removeElement(ele: any): void {\r\n        if (ele && ele.parentNode) ele.parentNode.removeChild(ele);\r\n    }\r\n\r\n    /**\r\n     * 获取浏览器当前时间戳，单位为毫秒。\r\n     */\r\n    static now(): number {\r\n        return Date.now();;\r\n    }\r\n\r\n    /**\r\n     * 浏览器窗口可视宽度。\r\n     * 通过分析浏览器信息获得。浏览器多个属性值优先级为：window.innerWidth(包含滚动条宽度) > document.body.clientWidth(不包含滚动条宽度)，如果前者为0或为空，则选择后者。\r\n     */\r\n    static get clientWidth(): number {\r\n        Browser.__init__();\r\n        return Browser._window.innerWidth || Browser._document.body.clientWidth;\r\n    }\r\n\r\n    /**\r\n     * 浏览器窗口可视高度。\r\n     * 通过分析浏览器信息获得。浏览器多个属性值优先级为：window.innerHeight(包含滚动条高度) > document.body.clientHeight(不包含滚动条高度) > document.documentElement.clientHeight(不包含滚动条高度)，如果前者为0或为空，则选择后者。\r\n     */\r\n    static get clientHeight(): number {\r\n        Browser.__init__();\r\n        return Browser._window.innerHeight || Browser._document.body.clientHeight || Browser._document.documentElement.clientHeight;\r\n    }\r\n\r\n    /** 浏览器窗口物理宽度。考虑了设备像素比。*/\r\n    static get width(): number {\r\n        Browser.__init__();\r\n        return ((ILaya.stage && ILaya.stage.canvasRotation) ? Browser.clientHeight : Browser.clientWidth) * Browser.pixelRatio;\r\n    }\r\n\r\n    /** 浏览器窗口物理高度。考虑了设备像素比。*/\r\n    static get height(): number {\r\n        Browser.__init__();\r\n        return ((ILaya.stage && ILaya.stage.canvasRotation) ? Browser.clientWidth : Browser.clientHeight) * Browser.pixelRatio;\r\n    }\r\n\r\n    /** 获得设备像素比。*/\r\n    static get pixelRatio(): number {\r\n        if (Browser._pixelRatio < 0) {\r\n            Browser.__init__();\r\n            if (Browser.userAgent.indexOf(\"Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)\") > -1) Browser._pixelRatio = 2;\r\n            else {\r\n                Browser._pixelRatio = (Browser._window.devicePixelRatio || 1);\r\n                if (Browser._pixelRatio < 1) Browser._pixelRatio = 1;\r\n            }\r\n        }\r\n        return Browser._pixelRatio;\r\n    }\r\n\r\n    /**画布容器，用来盛放画布的容器。方便对画布进行控制*/\r\n    static get container(): any {\r\n        if (!Browser._container) {\r\n            Browser.__init__();\r\n            Browser._container = Browser.createElement(\"div\");\r\n            Browser._container.id = \"layaContainer\";\r\n            Browser._document.body.appendChild(Browser._container);\r\n        }\r\n        return Browser._container;\r\n    }\r\n\r\n    static set container(value: any) {\r\n        Browser._container = value;\r\n    }\r\n\r\n    /**浏览器原生 window 对象的引用。*/\r\n    static get window(): any {\r\n        return Browser._window || Browser.__init__();\r\n    }\r\n\r\n    /**浏览器原生 document 对象的引用。*/\r\n    static get document(): any {\r\n        Browser.__init__();\r\n        return Browser._document;\r\n    }\r\n}\r\n\r\n","import { CharRenderInfo } from \"./CharRenderInfo\"\r\nimport { ICharRender } from \"./ICharRender\"\r\nimport { Browser } from \"../../utils/Browser\";\r\nexport class CharRender_Canvas extends ICharRender {\r\n\tprivate static canvas: any = null;// HTMLCanvasElement;\r\n\tprivate ctx: any = null;\r\n\tprivate lastScaleX = 1.0;\r\n\tprivate lastScaleY = 1.0;\r\n\t//private needResetScale: boolean = false;\r\n\tprivate maxTexW = 0;\r\n\tprivate maxTexH = 0;\r\n\tprivate scaleFontSize = true;\r\n\tprivate showDbgInfo = false;\r\n\tprivate supportImageData = true;\r\n\tconstructor(maxw: number, maxh: number, scalefont: boolean = true, useImageData: boolean = true, showdbg: boolean = false) {\r\n\t\tsuper();\r\n\t\tthis.maxTexW = maxw;\r\n\t\tthis.maxTexH = maxh;\r\n\t\tthis.scaleFontSize = scalefont;\r\n\t\tthis.supportImageData = useImageData;\r\n\t\tthis.showDbgInfo = showdbg;\r\n\t\tif (!CharRender_Canvas.canvas) {\r\n\t\t\tCharRender_Canvas.canvas = Browser.createElement('canvas');\r\n\t\t\tCharRender_Canvas.canvas.width = 1024;\r\n\t\t\tCharRender_Canvas.canvas.height = 512;\r\n\t\t\t//这个canvas是用来获取字体渲染结果的。由于不可见canvas的字体不能小于12，所以要加到body上\r\n\t\t\t//为了避免被发现，设一个在屏幕外的绝对位置。\r\n\t\t\tCharRender_Canvas.canvas.style.left = \"-10000px\";\r\n\t\t\tCharRender_Canvas.canvas.style.position = \"absolute\";\r\n\t\t\tdocument.body.appendChild(CharRender_Canvas.canvas);;\r\n\t\t\tthis.ctx = CharRender_Canvas.canvas.getContext('2d');\r\n\t\t}\r\n\t}\r\n    /**\r\n     * @override\r\n     */\r\n\tget canvasWidth(): number {\r\n\t\treturn CharRender_Canvas.canvas.width;\r\n\t}\r\n\r\n    /**\r\n     * @override\r\n     */\r\n\tset canvasWidth(w: number) {\r\n\t\tif (CharRender_Canvas.canvas.width == w)\r\n\t\t\treturn;\r\n\t\tCharRender_Canvas.canvas.width = w;\r\n\t\tif (w > 2048) {\r\n\t\t\tconsole.warn(\"画文字设置的宽度太大，超过2048了\");\r\n\t\t}\r\n\t\t// 重新恢复一下缩放\r\n\t\tthis.ctx.setTransform(1, 0, 0, 1, 0, 0);\t// 强制清理缩放\t\t\t\r\n\t\tthis.ctx.scale(this.lastScaleX, this.lastScaleY);\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t * @param font \r\n\t * @param str \r\n\t * @override\r\n\t */\r\n\tgetWidth(font: string, str: string): number {\r\n\t\tif (!this.ctx) return 0;\r\n\t\t//由于大家公用一个canvas，所以需要在选中的时候做一些配置。\r\n\t\tif (this.ctx._lastFont != font) {\r\n\t\t\tthis.ctx.font = font;\r\n\t\t\tthis.ctx._lastFont = font;\r\n\t\t\t//console.log('use font ' + font);\r\n\t\t}\r\n\t\treturn this.ctx.measureText(str).width;\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t * @param sx \r\n\t * @param sy \r\n\t * @override\r\n\t */\r\n\tscale(sx: number, sy: number): void {\r\n\t\tif (!this.supportImageData) {// supportImageData==false表示用 getCharCanvas，这个自己管理缩放\r\n\t\t\tthis.lastScaleX = sx;\r\n\t\t\tthis.lastScaleY = sy;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this.lastScaleX != sx || this.lastScaleY != sy) {\r\n\t\t\tthis.ctx.setTransform(sx, 0, 0, sy, 0, 0);\t// 强制清理缩放\t\t\t\r\n\t\t\tthis.lastScaleX = sx;\r\n\t\t\tthis.lastScaleY = sy;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t *TODO stroke \r\n\t * @param\tchar\r\n\t * @param\tfont\r\n\t * @param\tcri  修改里面的width。\r\n\t * @return\r\n\t * @override\r\n\t */\r\n\tgetCharBmp(char: string, font: string, lineWidth: number, colStr: string, strokeColStr: string, cri: CharRenderInfo,\r\n\t\tmargin_left: number, margin_top: number, margin_right: number, margin_bottom: number, rect: any[] | null = null): ImageData|null {\r\n\t\tif (!this.supportImageData)\r\n\t\t\treturn this.getCharCanvas(char, font, lineWidth, colStr, strokeColStr, cri, margin_left, margin_top, margin_right, margin_bottom);\r\n\t\tvar ctx: any = this.ctx;\r\n\r\n\t\tvar sz = this.fontsz;\r\n\t\t//ctx.save();\r\n\t\t//由于大家公用一个canvas，所以需要在选中的时候做一些配置。\r\n\t\t//跟_lastFont比较容易出错，所以比较ctx.font\r\n\t\tif (ctx.font != font) {// ctx._lastFont != font) {\t问题：ctx.font=xx 然后ctx==xx可能返回false，例如可能会给自己加\"\",当字体有空格的时候\r\n\t\t\tctx.font = font;\r\n\t\t\tctx._lastFont = font;\r\n\t\t\t//console.log('use font ' + font);\r\n\t\t}\r\n\r\n\t\tcri.width = ctx.measureText(char).width;//排版用的width是没有缩放的。后面会用矩阵缩放\r\n\t\tvar w: number = cri.width * this.lastScaleX;//w h 只是clear用的。所以要缩放\r\n\t\tvar h: number = cri.height * this.lastScaleY;\r\n\t\tw += (margin_left + margin_right) * this.lastScaleX;\r\n\t\th += (margin_top + margin_bottom) * this.lastScaleY;\r\n\t\tw = Math.ceil(w);\r\n\t\th = Math.ceil(h);\r\n\t\tw = Math.min(w, CharRender_Canvas.canvas.width);\r\n\t\th = Math.min(h, CharRender_Canvas.canvas.height);\r\n\r\n\t\tvar clearW: number = w + lineWidth * 2 + 1;\r\n\t\tvar clearH: number = h + lineWidth * 2 + 1;\r\n\t\tif (rect) {// measureText可能会小于请求的区域。 rect[2]可能为-1\r\n\t\t\tclearW = Math.max(clearW, rect[0] + rect[2] + 1);\r\n\t\t\tclearH = Math.max(clearH, rect[1] + rect[3] + 1);\r\n\t\t}\r\n\t\tctx.clearRect(0, 0, clearW/this.lastScaleX+1, clearH/this.lastScaleY+1);\r\n\t\tctx.save();\r\n\t\t//ctx.textAlign = \"end\";\r\n\t\tctx.textBaseline = \"middle\";\r\n\t\t//ctx.translate(CborderSize, CborderSize);\r\n\t\t//ctx.scale(xs, ys);\r\n\t\tif (lineWidth > 0) {\r\n\t\t\tctx.strokeStyle = strokeColStr;\r\n\t\t\tctx.lineWidth = lineWidth;\r\n\t\t\tctx.strokeText(char, margin_left, margin_top + sz / 2);\r\n\t\t}\r\n\t\tif (colStr) {\r\n\t\t\tctx.fillStyle = colStr;\r\n\t\t\tctx.fillText(char, margin_left, margin_top + sz / 2);\r\n\t\t}\r\n\r\n\t\tif (this.showDbgInfo) {\r\n\t\t\tctx.strokeStyle = '#ff0000';\r\n\t\t\tctx.strokeRect(1, 1, w - 2, h - 2);\r\n\t\t\tctx.strokeStyle = '#00ff00';\r\n\t\t\tctx.strokeRect(margin_left, margin_top, cri.width, cri.height);//原始大小，没有缩放的\r\n\t\t}\r\n\t\t//ctx.restore();\r\n\t\tif (rect) {\r\n\t\t\tif (rect[2] == -1) rect[2] = Math.ceil((cri.width + lineWidth * 2) * this.lastScaleX); // 这个没有考虑左右margin\r\n\t\t\tif(rect[2]<=0) rect[2]=1;\t// 有的字体在处理不存在文字的时候，测量宽度为0，会导致getImageData出错\r\n\t\t}\r\n\t\tvar imgdt: ImageData = rect ? (ctx.getImageData(rect[0], rect[1], rect[2], rect[3]+1)) : (ctx.getImageData(0, 0, w, h+1));\r\n\t\tctx.restore();\r\n\t\tcri.bmpWidth = imgdt.width;\r\n\t\tcri.bmpHeight = imgdt.height;\r\n\t\treturn imgdt;\r\n\t}\r\n\r\n\tgetCharCanvas(char: string, font: string, lineWidth: number, colStr: string, strokeColStr: string, cri: CharRenderInfo, margin_left: number, margin_top: number, margin_right: number, margin_bottom: number): ImageData {\r\n\t\tvar ctx: any = this.ctx;\r\n\r\n\t\t//ctx.save();\r\n\t\t//由于大家公用一个canvas，所以需要在选中的时候做一些配置。\r\n\t\t//跟_lastFont比较容易出错，所以比较ctx.font\r\n\t\tif (ctx.font != font) {// ctx._lastFont != font) {\t问题：ctx.font=xx 然后ctx==xx可能返回false，例如可能会给自己加\"\",当字体有空格的时候\r\n\t\t\tctx.font = font;\r\n\t\t\tctx._lastFont = font;\r\n\t\t\t//console.log('use font ' + font);\r\n\t\t}\r\n\r\n\t\tcri.width = ctx.measureText(char).width;//排版用的width是没有缩放的。后面会用矩阵缩放\r\n\t\tvar w: number = cri.width * this.lastScaleX;//w h 只是clear用的。所以要缩放\r\n\t\tvar h: number = cri.height * this.lastScaleY;\r\n\t\tw += (margin_left + margin_right) * this.lastScaleX;\r\n\t\th += ((margin_top + margin_bottom) * this.lastScaleY + 1);\t// 这个+1只是为了让测试能通过。确实应该加点高度，否则会被裁掉一部分，但是加多少还没找到方法。\r\n\t\tw = Math.min(w, this.maxTexW);\r\n\t\th = Math.min(h, this.maxTexH);\r\n\r\n\t\t//if (canvas.width != (w + 1) || canvas.height != (h + 1)) {\r\n\t\tCharRender_Canvas.canvas.width = Math.min(w + 1, this.maxTexW);\r\n\t\tCharRender_Canvas.canvas.height = Math.min(h + 1, this.maxTexH);\r\n\t\tctx.font = font;\r\n\t\t//}\r\n\t\tctx.clearRect(0, 0, w + 1 + lineWidth, h + 1 + lineWidth);\r\n\t\tctx.setTransform(1, 0, 0, 1, 0, 0);\t// 强制清理缩放\r\n\t\tctx.save();\r\n\t\tif (this.scaleFontSize) {\r\n\t\t\t//这里的缩放会导致与上面的缩放同时起作用。所以上面保护\r\n\t\t\tctx.scale(this.lastScaleX, this.lastScaleY);\r\n\t\t}\r\n\t\tctx.translate(margin_left, margin_top);\r\n\t\tctx.textAlign = \"left\";\r\n\r\n\t\tvar sz = this.fontsz;\r\n\t\tctx.textBaseline = \"middle\";\r\n\t\t//ctx.translate(CborderSize, CborderSize);\r\n\t\t//ctx.scale(xs, ys);\r\n\t\tif (lineWidth > 0) {\r\n\t\t\tctx.strokeStyle = strokeColStr;\r\n\t\t\tctx.fillStyle = colStr;\r\n\t\t\tctx.lineWidth = lineWidth;\r\n\t\t\t//ctx.strokeText(char, margin_left, margin_top);\r\n\t\t\tif (ctx.fillAndStrokeText) {\r\n\t\t\t\tctx.fillAndStrokeText(char, 0, sz / 2);\r\n\t\t\t} else {\r\n\t\t\t\tctx.strokeText(char, 0, sz / 2);\r\n\t\t\t\tctx.fillText(char, 0, sz / 2);\r\n\t\t\t}\r\n\t\t} else if (colStr) {\r\n\t\t\tctx.fillStyle = colStr;\r\n\t\t\tctx.fillText(char, 0, sz / 2);\r\n\t\t}\r\n\t\tif (this.showDbgInfo) {\r\n\t\t\tctx.strokeStyle = '#ff0000';\r\n\t\t\tctx.strokeRect(0, 0, w, h);\r\n\t\t\tctx.strokeStyle = '#00ff00';\r\n\t\t\tctx.strokeRect(0, 0, cri.width, cri.height);//原始大小，没有缩放的\r\n\t\t}\r\n\t\tctx.restore();\r\n\t\tcri.bmpWidth = CharRender_Canvas.canvas.width;\r\n\t\tcri.bmpHeight = CharRender_Canvas.canvas.height;\r\n\t\treturn CharRender_Canvas.canvas;\r\n\t}\r\n}\r\n\r\n","import { CharRenderInfo } from \"./CharRenderInfo\";\r\nimport { ICharRender } from \"./ICharRender\"\r\nimport { ColorUtils } from \"../../utils/ColorUtils\"\r\nexport class CharRender_Native extends ICharRender {\r\n\tprivate lastFont: string = '';\r\n\tprivate lastScaleX: number = 1.0;\r\n\tprivate lastScaleY: number = 1.0;\r\n\r\n\t//TODO:coverage\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t * @param font \r\n\t * @param str \r\n\t * @override\r\n\t */\r\n\t getWidth(font: string, str: string): number {\r\n\t\tif (!(window as any).conchTextCanvas) return 0;\r\n\t\t//TODO 先取消判断，保证字体信息一致\r\n\t\t//if (lastFont != font) { \r\n\t\t(window as any).conchTextCanvas.font = font;\r\n\t\tthis.lastFont = font;\r\n\t\t//console.log('use font ' + font);\r\n\t\t//}\t\t\t\t\t\r\n\t\t//getTextBitmapData\r\n\t\treturn (window as any).conchTextCanvas.measureText(str).width;\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t * @param sx \r\n\t * @param sy \r\n\t * @override\r\n\t */\r\n\tscale(sx: number, sy: number): void {\r\n\t\tthis.lastScaleX = sx;\r\n\t\tthis.lastScaleY = sy;\r\n\t}\r\n\t/**\r\n\t *TODO stroke \r\n\t * @param\tchar\r\n\t * @param\tfont\r\n\t * @param\tsize  返回宽高\r\n\t * @return\r\n\t * @override\r\n\t */\r\n\tgetCharBmp(char: string, font: string, lineWidth: number, colStr: string, strokeColStr: string, size: CharRenderInfo,\r\n\t\tmargin_left: number, margin_top: number, margin_right: number, margin_bottom: number, rect: any[] | null = null): ImageData|null {\r\n\r\n\t\tif (!(window as any).conchTextCanvas) return null;\r\n\t\t//window.conchTextCanvas.getTextBitmapData();\r\n\r\n\t\t//TODO 先取消判断，保证字体信息一致\r\n\t\t//if(lastFont!=font){\r\n\t\t(window as any).conchTextCanvas.font = font;\r\n\t\tthis.lastFont = font;\r\n\t\t//}\t\t\t\t\t\t\r\n\t\tvar w: number = size.width = (window as any).conchTextCanvas.measureText(char).width;\r\n\t\tvar h: number = size.height;\r\n\t\tw += (margin_left + margin_right);\r\n\t\th += (margin_top + margin_bottom);\r\n\r\n\t\t(window as any).conchTextCanvas.scale && (window as any).conchTextCanvas.scale(this.lastScaleX, this.lastScaleY);\r\n\r\n\t\tvar c1: ColorUtils = ColorUtils.create(strokeColStr);\r\n\t\tvar nStrokeColor: number = c1.numColor;\r\n\t\tvar c2: ColorUtils = ColorUtils.create(colStr);\r\n\t\tvar nTextColor: number = c2.numColor;\r\n\t\tvar textInfo: any = (window as any).conchTextCanvas.getTextBitmapData(char, nTextColor, lineWidth > 2 ? 2 : lineWidth, nStrokeColor);\r\n\t\t//window.Laya.LayaGL.instance.texSubImage2D(1,2,0,0,textInfo.width,textInfo.height,0,0,textInfo.bitmapData);\r\n\t\t//var ret = new ImageData();\r\n\t\tsize.bmpWidth = textInfo.width;\r\n\t\tsize.bmpHeight = textInfo.height;\r\n\t\treturn textInfo;\r\n        /*\r\n        ctx.clearRect(0,0, w, h);\r\n        //ctx.textAlign = \"end\";\r\n        ctx.textBaseline = \"top\";\r\n        if (lineWidth > 0) { \r\n            ctx.strokeStyle = colStr;\r\n            ctx.lineWidth = lineWidth;\r\n            ctx.strokeText(char, margin_left, margin_top);\r\n        } else {\r\n            ctx.fillStyle = colStr;\r\n            ctx.fillText(char, margin_left, margin_top);\r\n        }\r\n        if ( CharBook.debug) {\r\n            ctx.strokeStyle = '#ff0000';\r\n            ctx.strokeRect(0, 0, w, h);\r\n            ctx.strokeStyle = '#00ff00';\r\n            ctx.strokeRect(margin_left, margin_top, size.width, size.height);\r\n        }\r\n        //ctx.restore();\r\n        return ctx.getImageData( 0,0, w, h );\r\n        */\r\n\t}\r\n}\r\n\r\n","import { TextAtlas } from \"./TextAtlas\";\r\nimport { TextTexture } from \"./TextTexture\";\r\nimport { Sprite } from \"../../display/Sprite\"\r\nimport { Matrix } from \"../../maths/Matrix\"\r\nimport { Point } from \"../../maths/Point\"\r\nimport { RenderInfo } from \"../../renders/RenderInfo\"\r\nimport { Context } from \"../../resource/Context\"\r\nimport { Texture } from \"../../resource/Texture\"\r\nimport { FontInfo } from \"../../utils/FontInfo\"\r\nimport { HTMLChar } from \"../../utils/HTMLChar\"\r\nimport { WordText } from \"../../utils/WordText\"\r\nimport { CharRenderInfo } from \"./CharRenderInfo\"\r\nimport { CharRender_Canvas } from \"./CharRender_Canvas\"\r\nimport { CharRender_Native } from \"./CharRender_Native\"\r\nimport { ICharRender } from \"./ICharRender\"\r\nimport { ILaya } from \"../../../ILaya\";\r\n\r\nexport class TextRender {\r\n    //config\r\n    static useOldCharBook: boolean = false;\r\n    static atlasWidth: number = 1024;\r\n    static noAtlas: boolean = false;\t\t\t\t// 一串文字用独立贴图\r\n    static forceSplitRender: boolean = false;\t    // 强制把一句话拆开渲染\r\n    static forceWholeRender: boolean = false; \t// 强制整句话渲染\r\n    static scaleFontWithCtx: boolean = true;\t\t// 如果有缩放，则修改字体，以保证清晰度\r\n    static standardFontSize: number = 32;\t\t\t// 测量的时候使用的字体大小\r\n    static destroyAtlasDt: number = 10;\t\t\t\t\t// 回收图集贴图的时间\r\n    static checkCleanTextureDt: number = 2000;\t\t// 检查是否要真正删除纹理的时间。单位是ms\r\n    static destroyUnusedTextureDt: number = 3000; \t// 长时间不用的纹理删除的时间。单位是ms\r\n    static cleanMem: number = 100 * 1024 * 1024;\t\t// 多大内存触发清理图集。这时候占用率低的图集会被清理\r\n    static isWan1Wan: boolean = false;\r\n    static showLog: boolean = false;\r\n    static debugUV: boolean = false;\t\t\t\t// 文字纹理需要保护边。当像素没有对齐的时候，可能会采样到旁边的贴图。true则填充texture为白色，模拟干扰\r\n    //config\r\n\r\n    /**\r\n     * fontSizeInfo\r\n     * 记录每种字体的像素的大小。标准是32px的字体。由4个byte组成，分别表示[xdist,ydist,w,h]。 \r\n     * xdist,ydist 是像素起点到排版原点的距离，都是正的，表示实际数据往左和上偏多少，如果实际往右和下偏，则算作0，毕竟这个只是一个大概\r\n     * 例如 [Arial]=0x00002020, 表示宽高都是32\r\n     */\r\n    private fontSizeInfo: any = {};\r\n    static atlasWidth2: number;\r\n    private charRender: ICharRender;\r\n    private static tmpRI: CharRenderInfo = new CharRenderInfo();\r\n    private static pixelBBX: any[] = [0, 0, 0, 0];\r\n    private mapFont: any = {};\t\t// 把font名称映射到数字\r\n    private fontID: number = 0;\r\n\r\n    private mapColor: any[] = [];\t\t// 把color映射到数字\r\n    private colorID: number = 0;\r\n    private fontScaleX: number = 1.0;\t\t\t\t\t\t//临时缩放。\r\n    private fontScaleY: number = 1.0;\r\n\r\n    //private var charMaps:Object = {};\t// 所有的都放到一起\r\n\r\n    private _curStrPos: number = 0;\t\t//解开一个字符串的时候用的。表示当前解到什么位置了\r\n    static textRenderInst: TextRender;\t//debug\r\n\r\n    textAtlases: TextAtlas[] = [];\t\t// 所有的大图集\r\n    private isoTextures: TextTexture[] = [];\t// 所有的独立贴图\r\n\r\n    private bmpData32: Uint32Array;\r\n    private static imgdtRect: any[] = [0, 0, 0, 0];\r\n\r\n    // 当前字体的测量信息。\r\n    private lastFont: FontInfo|null = null;\r\n    private fontSizeW: number = 0;\r\n    private fontSizeH: number = 0;\r\n    private fontSizeOffX: number = 0;\r\n    private fontSizeOffY: number = 0;\r\n\r\n    private renderPerChar: boolean = true;\t// 是否是单个字符渲染。这个是结果，上面的是配置\r\n    private tmpAtlasPos: Point = new Point();\r\n    private textureMem: number = 0; \t\t\t// 当前贴图所占用的内存\r\n    private fontStr: string;\t\t\t\t\t// 因为要去掉italic，所以自己保存一份\r\n    static simClean: boolean = false;\t\t\t\t// 测试用。强制清理占用低的图集\r\n\r\n    constructor() {\r\n        ILaya.TextAtlas = TextAtlas;\r\n\r\n        var bugIOS: boolean = false;//是否是有bug的ios版本\r\n        //在微信下有时候不显示文字，所以采用canvas模式，现在测试微信好像都好了，所以去掉了。\r\n        var miniadp: any = ILaya.Laya['MiniAdpter']; //头条也继承了这个bug\r\n        if (miniadp && miniadp.systemInfo && miniadp.systemInfo.system) {\r\n\t\t\tbugIOS = miniadp.systemInfo.system.toLowerCase() === 'ios 10.1.1';\r\n\t\t\t//12.3\r\n        }\r\n        if ((ILaya.Browser.onMiniGame||ILaya.Browser.onTTMiniGame||ILaya.Browser.onBLMiniGame||ILaya.Browser.onAlipayMiniGame) /*&& !Browser.onAndroid*/ && !bugIOS) TextRender.isWan1Wan = true; //android 微信下 字边缘发黑，所以不用getImageData了\r\n        //TextRender.isWan1Wan = true;\r\n        this.charRender = ILaya.Render.isConchApp ? (new CharRender_Native()) : (new CharRender_Canvas(2048, 2048, TextRender.scaleFontWithCtx, !TextRender.isWan1Wan, false));\r\n        TextRender.textRenderInst = this;\r\n        ILaya.Laya['textRender'] = this;\r\n        TextRender.atlasWidth2 = TextRender.atlasWidth * TextRender.atlasWidth;\r\n        //TEST\r\n        //forceSplitRender = true;\r\n        //noAtlas = true;\r\n        //forceWholeRender = true;\r\n        //TEST\r\n    }\r\n\r\n    /**\r\n     * 设置当前字体，获得字体的大小信息。\r\n     * @param\tfont\r\n     */\r\n    setFont(font: FontInfo): void {\r\n        if (this.lastFont == font) return;\r\n        this.lastFont = font;\r\n        var fontsz: number = this.getFontSizeInfo(font._family);\r\n        var offx: number = fontsz >> 24\r\n        var offy: number = (fontsz >> 16) & 0xff;\r\n        var fw: number = (fontsz >> 8) & 0xff;\r\n        var fh: number = fontsz & 0xff;\r\n        var k: number = font._size / TextRender.standardFontSize;\r\n        this.fontSizeOffX = Math.ceil(offx * k);\r\n        this.fontSizeOffY = Math.ceil(offy * k);\r\n        this.fontSizeW = Math.ceil(fw * k);\r\n        this.fontSizeH = Math.ceil(fh * k);\r\n        if (font._font.indexOf('italic') >= 0) {// 先判断一下效率会高一些\r\n            this.fontStr = font._font.replace('italic', '');\r\n        } else {\r\n            this.fontStr = font._font;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 从string中取出一个完整的char，例如emoji的话要多个\r\n     * 会修改 _curStrPos\r\n     * TODO 由于各种文字中的组合写法，这个需要能扩展，以便支持泰文等\r\n     * @param\tstr\r\n     * @param\tstart\t开始位置\r\n     */\r\n    getNextChar(str: string): string |null{\r\n        var len: number = str.length;\r\n        var start: number = this._curStrPos;\r\n        if (start >= len)\r\n            return null;\r\n\r\n        //var link: boolean = false;\t//如果是连接的话要再加一个完整字符\r\n        var i: number = start;\r\n        var state: number = 0; //0 初始化 1  正常 2 连续中\r\n        for (; i < len; i++) {\r\n            var c: number = str.charCodeAt(i);\r\n            if ((c >>> 11) == 0x1b) { //可能是0b110110xx或者0b110111xx。 这都表示2个u16组成一个emoji\r\n                if (state == 1) break;//新的字符了，要截断\r\n                state = 1;\t// 其他状态都转成正常读取字符状态，只是一次读两个\r\n                i++;\t//跨过一个。\r\n            }\r\n            else if (c === 0xfe0e || c === 0xfe0f) {\t//样式控制字符\r\n                // 继续。不改变状态\r\n            }\r\n            else if (c == 0x200d) {\t\t//zero width joiner\r\n                state = 2; \t// 继续\r\n            } else {\r\n                if (state == 0) state = 1;\r\n                else if (state == 1) break;\r\n                else if (state == 2) {\r\n                    // 继续\r\n                }\r\n            }\r\n        }\r\n        this._curStrPos = i;\r\n        return str.substring(start, i);\r\n\t}\r\n\t\r\n    filltext(ctx: Context, data: string | WordText, x: number, y: number, fontStr: string, color: string, strokeColor: string, lineWidth: number, textAlign: string, underLine: number = 0): void {\r\n        if (data.length <= 0)\r\n            return;\r\n        //以后保存到wordtext中\r\n        var font: FontInfo = FontInfo.Parse(fontStr);\r\n\r\n        var nTextAlign: number = 0;\r\n        switch (textAlign) {\r\n            case 'center':\r\n                nTextAlign = ILaya.Context.ENUM_TEXTALIGN_CENTER;\r\n                break;\r\n            case 'right':\r\n                nTextAlign = ILaya.Context.ENUM_TEXTALIGN_RIGHT;\r\n                break;\r\n        }\r\n        this._fast_filltext(ctx, (<WordText>data), null, x, y, font, color, strokeColor, lineWidth, nTextAlign, underLine);\r\n    }\r\n\r\n    fillWords(ctx: Context, data: HTMLChar[], x: number, y: number, fontStr: string | FontInfo, color: string, strokeColor: string, lineWidth: number): void {\r\n        if (!data) return;\r\n        if (data.length <= 0) return;\r\n        var font: FontInfo = typeof (fontStr) === 'string' ? FontInfo.Parse(fontStr) : fontStr;\r\n        this._fast_filltext(ctx, null, data, x, y, font, color, strokeColor, lineWidth, 0, 0);\r\n    }\r\n\r\n    _fast_filltext(ctx: Context, data: string | WordText|null, htmlchars: HTMLChar[]|null, x: number, y: number, font: FontInfo, color: string, strokeColor: string, lineWidth: number, textAlign: number, underLine: number = 0): void {\r\n        if (data && data.length < 1) return;\r\n        if (htmlchars && htmlchars.length < 1) return;\r\n        if (lineWidth < 0) lineWidth = 0;\r\n        this.setFont(font);\r\n        this.fontScaleX = this.fontScaleY = 1.0;\r\n        if (TextRender.scaleFontWithCtx) {\r\n            var sx: number = 1;\r\n            var sy: number = 1;\r\n    \r\n            if (!ILaya.Render.isConchApp || ((window as any).conchTextCanvas.scale)) {\r\n                sx = ctx.getMatScaleX();\r\n                sy = ctx.getMatScaleY();\r\n            }\r\n            \r\n            if (sx < 1e-4 || sy < 1e-1)\r\n                return;\r\n            if(sx>1) this.fontScaleX = sx;\r\n            if(sy>1) this.fontScaleY = sy;\r\n        }\r\n\r\n        font._italic && (ctx._italicDeg = 13);\r\n        //准备bmp\r\n        //拷贝到texture上,得到一个gltexture和uv\r\n        var wt = (<WordText>data);\r\n        var isWT = !htmlchars && (data instanceof WordText);\r\n        var str = (<string>data);\r\n        var isHtmlChar= !!htmlchars;\r\n        /**\r\n         * sameTexData \r\n         * WordText 中保存了一个数组，这个数组是根据贴图排序的，目的是为了能相同的贴图合并。\r\n         * 类型是 {ri:CharRenderInfo,stx:int,sty:int,...}[文字个数][贴图分组]\r\n         */\r\n        var sameTexData: any[] = isWT ? wt.pageChars : [];\r\n\r\n        //总宽度，下面的对齐需要\r\n        var strWidth: number = 0;\r\n        if (isWT) {\r\n            str = wt._text;\r\n            strWidth = wt.width;\r\n            if (strWidth < 0) {\r\n                strWidth = wt.width = this.charRender.getWidth(this.fontStr, str);\t// 字符串长度是原始的。\r\n            }\r\n        } else {\r\n            strWidth = str ? this.charRender.getWidth(this.fontStr, str) : 0;\r\n        }\r\n\r\n        //水平对齐方式\r\n        switch (textAlign) {\r\n            case ILaya.Context.ENUM_TEXTALIGN_CENTER:\r\n                x -= strWidth / 2;\r\n                break;\r\n            case ILaya.Context.ENUM_TEXTALIGN_RIGHT:\r\n                x -= strWidth;\r\n                break;\r\n        }\r\n\r\n        //检查保存的数据是否有的已经被释放了\r\n        if (wt && sameTexData) {\t// TODO 能利用lastGCCnt么\r\n            //wt.lastGCCnt = _curPage.gcCnt;\r\n            if (this.hasFreedText(sameTexData)) {\r\n                sameTexData = wt.pageChars = [];\r\n\t\t\t}\r\n\t\t\t// if(isWT && (this.fontScaleX!=wt.scalex || this.fontScaleY!=wt.scaley)) {\r\n\t\t\t// \t// 文字缩放要清理缓存\r\n\t\t\t// \tsameTexData = wt.pageChars = [];\r\n\t\t\t// }\r\n        }\r\n        var ri: CharRenderInfo = null;\r\n        //var oneTex: boolean = isWT || TextRender.forceWholeRender;\t// 如果能缓存的话，就用一张贴图\r\n        var splitTex: boolean = this.renderPerChar = (!isWT) || TextRender.forceSplitRender || isHtmlChar || (isWT && wt.splitRender); \t// 拆分字符串渲染，这个优先级高\r\n        if (!sameTexData || sameTexData.length < 1) {\r\n\t\t\tif (isWT) {\r\n                wt.scalex = this.fontScaleX;\r\n                wt.scaley = this.fontScaleY;\r\n            }\r\n            // 重新构建缓存的贴图信息\r\n            // TODO 还是要ctx.scale么\r\n            if (splitTex) {\r\n                // 如果要拆分字符渲染\r\n                var stx: number = 0;\r\n                var sty: number = 0;\r\n\r\n                this._curStrPos = 0;\r\n                var curstr: string|null;\r\n                while (true) {\r\n                    if (htmlchars) {\r\n                        var chc = htmlchars[this._curStrPos++];\r\n                        if (chc) {\r\n                            curstr = chc.char;\r\n                            stx = chc.x;\r\n                            sty = chc.y;\r\n                        } else {\r\n                            curstr = null;\r\n                        }\r\n                    } else {\r\n                        curstr = this.getNextChar(str);\r\n                    }\r\n                    if (!curstr)\r\n                        break;\r\n                    ri = this.getCharRenderInfo(curstr, font, color, strokeColor, lineWidth, false);\r\n                    if (!ri) {\r\n                        // 没有分配到。。。\r\n                        break;\r\n                    }\r\n                    if (ri.isSpace) {\t// 空格什么都不做\r\n                    } else {\r\n                        //分组保存\r\n                        var add = sameTexData[ri.tex.id];\r\n                        if (!add) {\r\n                            var o1 = { texgen: ((<TextTexture>ri.tex)).genID, tex: ri.tex, words: [] };\t// 根据genid来减少是否释放的判断量\r\n                            sameTexData[ri.tex.id] = o1;\r\n                            add = o1.words;\r\n                        } else {\r\n                            add = add.words;\r\n                        }\r\n                        //不能直接修改ri.bmpWidth, 否则会累积缩放，所以把缩放保存到独立的变量中\r\n                        add.push({ ri: ri, x: stx, y: sty, w: ri.bmpWidth / this.fontScaleX, h: ri.bmpHeight / this.fontScaleY });\r\n                        stx += ri.width;\t// TODO 缩放\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                // 如果要整句话渲染\r\n\t\t\t\tvar margin = ILaya.Render.isConchApp ? 0 : (font._size / 3 | 0);  // margin保持与charrender_canvas的一致\r\n\t\t\t\tvar isotex: boolean = TextRender.noAtlas || (strWidth+margin+margin) * this.fontScaleX > TextRender.atlasWidth;\t// 独立贴图还是大图集。需要考虑margin\r\n                ri = this.getCharRenderInfo(str, font, color, strokeColor, lineWidth, isotex);\r\n                // 整句渲染，则只有一个贴图\r\n                sameTexData[0] = { texgen: ((<TextTexture>ri.tex)).genID, tex: ri.tex, words: [{ ri: ri, x: 0, y: 0, w: ri.bmpWidth / this.fontScaleX, h: ri.bmpHeight / this.fontScaleY }] };\r\n            }\r\n\r\n            //TODO getbmp 考虑margin 字体与标准字体的关系\r\n        }\r\n\r\n        this._drawResortedWords(ctx, x, y, sameTexData);\r\n        ctx._italicDeg = 0;\r\n    }\r\n\r\n    /**\r\n     * 画出重新按照贴图顺序分组的文字。\r\n     * @param\tsamePagesData\r\n     * @param  startx 保存的数据是相对位置，所以需要加上这个偏移。用相对位置更灵活一些。\r\n     * @param y {int} 因为这个只能画在一行上所以没有必要保存y。所以这里再把y传进来\r\n     */\r\n    protected _drawResortedWords(ctx: Context, startx: number, starty: number, samePagesData: any[]): void {\r\n        var isLastRender = ctx._charSubmitCache?ctx._charSubmitCache._enable:false;\r\n        var mat = ctx._curMat;\r\n        var slen = samePagesData.length;\r\n        //for (var id = 0; id < slen; id++) {\r\n\t\tfor(var id in samePagesData) {// TODO samePagesData可能是个不连续的数组，比如只有一个samePagesData[29999] = dt;\r\n\t\t\t\t\t\t\t\t\t\t// TODO 想个更好的方法\r\n            var dt = samePagesData[id];\r\n            if (!dt) continue;\r\n            var pri: any[] = dt.words;\r\n            var pisz: number = pri.length; if (pisz <= 0) continue;\r\n            var tex: TextTexture = ((<TextTexture>samePagesData[id].tex));\r\n            for (var j: number = 0; j < pisz; j++) {\r\n                var riSaved: any = pri[j];\r\n                var ri: CharRenderInfo = riSaved.ri;\r\n                if (ri.isSpace) continue;\r\n                ri.touch();\r\n                ctx.drawTexAlign = true;\r\n                //ctx._drawTextureM(ri.tex.texture as Texture, startx +riSaved.x -ri.orix / fontScaleX , starty + riSaved.y -ri.oriy / fontScaleY , riSaved.w, riSaved.h, null, 1.0, ri.uv);\r\n                if (ILaya.Render.isConchApp) {\r\n                    ctx._drawTextureM((<Texture>tex.texture), startx + riSaved.x - ri.orix, starty + riSaved.y - ri.oriy, riSaved.w, riSaved.h, null, 1.0, ri.uv);\r\n                } else {\r\n                    let t = tex as TextTexture;\r\n                    ctx._inner_drawTexture(t.texture, t.id,\r\n                        startx + riSaved.x - ri.orix, starty + riSaved.y - ri.oriy, riSaved.w, riSaved.h,\r\n                        mat, ri.uv, 1.0, isLastRender);\r\n                }\r\n\r\n                if (((<any>ctx)).touches) {\r\n                    ((<any>ctx)).touches.push(ri);\r\n                }\r\n            }\r\n        }\r\n        //不要影响别人\r\n        //ctx._curSubmit._key.other = -1;\r\n    }\r\n\r\n    /**\r\n     * 检查 txts数组中有没有被释放的资源\r\n     * @param\ttxts {{ri:CharRenderInfo,...}[][]}\r\n     * @param\tstartid\r\n     * @return\r\n     */\r\n    hasFreedText(txts: any[]): boolean {\r\n        var sz: number = txts.length;\r\n        for (var i: number = 0; i < sz; i++) {\r\n            var pri: any = txts[i];\r\n            if (!pri) continue;\r\n            var tex: TextTexture = ((<TextTexture>pri.tex));\r\n            if (tex.__destroyed || tex.genID != pri.texgen) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    getCharRenderInfo(str: string, font: FontInfo, color: string, strokeColor: string, lineWidth: number, isoTexture: boolean = false): CharRenderInfo {\r\n        var fid: any = this.mapFont[font._family];\r\n        if (fid == undefined) {\r\n            this.mapFont[font._family] = fid = this.fontID++;\r\n        }\r\n        /*\r\n        var cid:int = mapColor[color];\r\n        if (cid == undefined) {\r\n            mapColor[color] = cid = colorID++;\r\n        }\r\n        var scid:int = mapColor[strokeColor];\r\n        */\r\n        var key: string = str + '_' + fid + '_' + font._size + '_' + color;\r\n        if (lineWidth > 0)\r\n            key += '_' + strokeColor + lineWidth;\r\n        if (font._bold)\r\n            key += 'P';\r\n        if (this.fontScaleX != 1 || this.fontScaleY != 1) {\r\n            key += (this.fontScaleX * 20 | 0) + '_' + (this.fontScaleY * 20 | 0);\t// 这个精度可以控制占用资源的大小，精度越高越能细分缩放。\r\n        }\r\n\r\n        var i: number = 0;\r\n        // 遍历所有的大图集看是否存在\r\n        var sz: number = this.textAtlases.length;\r\n        var ri: CharRenderInfo;\r\n        var atlas: TextAtlas;\r\n        if (!isoTexture) {\r\n            for (i = 0; i < sz; i++) {\r\n                atlas = this.textAtlases[i];\r\n                ri = atlas.charMaps[key]\r\n                if (ri) {\r\n                    ri.touch();\r\n                    return ri;\r\n                }\r\n            }\r\n        }\r\n        // 没有找到，要创建一个\r\n        ri = new CharRenderInfo();\r\n        this.charRender.scale(this.fontScaleX, this.fontScaleY);\r\n        ri.char = str;\r\n        ri.height = font._size;\r\n        var margin: number = ILaya.Render.isConchApp ? 0 : (font._size / 3 | 0);\t// 凑的。 注意这里不能乘以缩放，因为ctx会自动处理\r\n        // 如果不存在，就要插入已有的，或者创建新的\r\n        var imgdt: ImageData|null=null;\r\n        // 先大约测量文字宽度 \r\n\r\n        if (!lineWidth) {\r\n            lineWidth = 0;\r\n        }\r\n        var w1: number = Math.ceil((this.charRender.getWidth(this.fontStr, str) + 2 * lineWidth) * this.fontScaleX);\r\n        if (w1 > this.charRender.canvasWidth) {\r\n            this.charRender.canvasWidth = Math.min(2048, w1 + margin * 2);\r\n        }\r\n        if (isoTexture) {\r\n            // 独立贴图\r\n            this.charRender.fontsz = font._size;\r\n            imgdt = this.charRender.getCharBmp(str, this.fontStr, lineWidth, color, strokeColor, ri, margin, margin, margin, margin, null);\r\n\t\t\t// 这里可以直接\r\n\t\t\tif(imgdt){\r\n\t\t\t\tvar tex: TextTexture = TextTexture.getTextTexture(imgdt.width, imgdt.height);\r\n\t\t\t\ttex.addChar(imgdt, 0, 0, ri.uv);\r\n\t\t\t\tri.tex = tex;\r\n\t\t\t\tri.orix = margin; // 这里是原始的，不需要乘scale,因为scale的会创建一个scale之前的rect\r\n\t\t\t\tri.oriy = margin;\r\n\t\t\t\ttex.ri = ri;\r\n\t\t\t\tthis.isoTextures.push(tex);\r\n\t\t\t}\r\n        } else {\r\n            // 大图集\r\n            var len: number = str.length;\r\n            if (len > 1) {\r\n                // emoji或者组合的\r\n            }\r\n            var lineExt: number = lineWidth * 1;\t// 这里，包括下面的*2 都尽量用整数。否则在取整以后可能有有偏移。\r\n            var fw: number = Math.ceil((this.fontSizeW + lineExt * 2) * this.fontScaleX); \t//本来只要 lineWidth就行，但是这样安全一些\r\n            var fh: number = Math.ceil((this.fontSizeH + lineExt * 2) * this.fontScaleY);\r\n            TextRender.imgdtRect[0] = ((margin - this.fontSizeOffX - lineExt) * this.fontScaleX) | 0;\t// 本来要 lineWidth/2 但是这样一些尖角会有问题，所以大一点\r\n            TextRender.imgdtRect[1] = ((margin - this.fontSizeOffY - lineExt) * this.fontScaleY) | 0;\r\n            if (this.renderPerChar || len == 1) {\r\n                // 单个字符的处理\r\n                TextRender.imgdtRect[2] = Math.max(w1, fw);\r\n                TextRender.imgdtRect[3] = Math.max(w1, fh);\t// 高度也要取大的。 例如emoji\r\n            } else {\r\n                // 多个字符的处理\r\n                TextRender.imgdtRect[2] = -1;\t// -1 表示宽度要测量\r\n                TextRender.imgdtRect[3] = fh; \t// TODO 如果被裁剪了，可以考虑把这个加大一点点\r\n            }\r\n            this.charRender.fontsz = font._size;\r\n            imgdt = this.charRender.getCharBmp(str, this.fontStr, lineWidth, color, strokeColor, ri,\r\n\t\t\t\tmargin, margin, margin, margin, TextRender.imgdtRect);\r\n\t\t\tif(imgdt){\r\n\t\t\t\tatlas = this.addBmpData(imgdt, ri);\r\n\t\t\t\tif (TextRender.isWan1Wan) {\r\n\t\t\t\t\t// 这时候 imgdtRect 是不好使的，要自己设置\r\n\t\t\t\t\tri.orix = margin;\t// 不要乘缩放。要不后面也要除。\r\n\t\t\t\t\tri.oriy = margin;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 取下来的imagedata的原点在哪\r\n\t\t\t\t\tri.orix = (this.fontSizeOffX + lineExt);\t// 由于是相对于imagedata的，上面会根据包边调整左上角，所以原点也要相应反向调整\r\n\t\t\t\t\tri.oriy = (this.fontSizeOffY + lineExt);\r\n\t\t\t\t}\r\n\t\t\t\tatlas.charMaps[key] = ri;\r\n\t\t\t}\r\n        }\r\n        return ri;\r\n    }\r\n\r\n    /**\r\n     * 添加数据到大图集\r\n     * @param\tw\r\n     * @param\th\r\n     * @return\r\n     */\r\n    addBmpData(data: ImageData, ri: CharRenderInfo): TextAtlas {\r\n        var w = data.width;\r\n        var h = data.height;\r\n        var sz = this.textAtlases.length;\r\n        var atlas: TextAtlas;\r\n        var find = false;\r\n        for (var i = 0; i < sz; i++) {\r\n            atlas = this.textAtlases[i];\r\n            find = atlas.getAEmpty(w, h, this.tmpAtlasPos);\r\n            if (find) {\r\n                break;\r\n            }\r\n        }\r\n        if (!find) {\r\n            // 创建一个新的\r\n            atlas = new TextAtlas()\r\n            this.textAtlases.push(atlas);\r\n            find = atlas.getAEmpty(w, h, this.tmpAtlasPos);\r\n            if (!find) {\r\n                throw 'err1'; //TODO\r\n            }\r\n            // 清理旧的\r\n            this.cleanAtlases();\r\n        }\r\n        if (find) {\r\n            atlas.texture.addChar(data, this.tmpAtlasPos.x, this.tmpAtlasPos.y, ri.uv);\r\n            ri.tex = atlas.texture;\r\n        }\r\n        return atlas;\r\n    }\r\n\r\n    /**\r\n     * 清理利用率低的大图集\r\n     */\r\n    GC(): void {\r\n        var i: number = 0;\r\n        var sz: number = this.textAtlases.length;\r\n        var dt: number = 0;\r\n        var destroyDt: number = TextRender.destroyAtlasDt;\r\n        var totalUsedRate: number = 0;\t// 总使用率\r\n        var totalUsedRateAtlas: number = 0;\r\n        var curloop: number = RenderInfo.loopCount;\r\n\r\n        //var minUsedRateID:int = -1;\r\n        //var minUsedRate:Number = 1;\r\n        var maxWasteRateID: number = -1;\r\n        var maxWasteRate: number = 0;\r\n        var tex: TextTexture = null;\r\n        var curatlas: TextAtlas = null;\r\n        // 图集的清理\r\n        for (; i < sz; i++) {\r\n            curatlas = this.textAtlases[i];\r\n            tex = curatlas.texture;\r\n            if (tex) {\r\n                totalUsedRate += tex.curUsedCovRate;\r\n                totalUsedRateAtlas += tex.curUsedCovRateAtlas;\r\n                // 浪费掉的图集\r\n                // (已经占用的图集和当前使用的图集的差。图集不可局部重用，所以有占用的和使用的的区别)\r\n                var waste: number = curatlas.usedRate - tex.curUsedCovRateAtlas;\r\n                // 记录哪个图集浪费的最多\r\n                if (maxWasteRate < waste) {\r\n                    maxWasteRate = waste;\r\n                    maxWasteRateID = i;\r\n                }\r\n                /*\r\n                if (minUsedRate > tex.curUsedCovRate) {\r\n                    minUsedRate = tex.curUsedCovRate;\r\n                    minUsedRateID = i;\r\n                }\r\n                */\r\n            }\r\n            // 如果当前贴图的touch时间超出了指定的间隔（单位是帧，例如），则设置回收\r\n            // 可能同时会有多个图集被回收\r\n            dt = curloop - curatlas.texture.lastTouchTm;\r\n            if (dt > destroyDt) {\r\n                TextRender.showLog && console.log('TextRender GC delete atlas ' + tex ? curatlas.texture.id : 'unk');\r\n                curatlas.destroy();\r\n                this.textAtlases[i] = this.textAtlases[sz - 1];\t// 把最后的拿过来冲掉\r\n                sz--;\r\n                i--;\r\n                maxWasteRateID = -1;\r\n            }\r\n        }\r\n        // 缩减图集数组的长度\r\n        this.textAtlases.length = sz;\r\n\r\n        // 独立贴图的清理 TODO 如果多的话，要不要分开处理\r\n        sz = this.isoTextures.length;\r\n        for (i = 0; i < sz; i++) {\r\n            tex = this.isoTextures[i];\r\n            dt = curloop - tex.lastTouchTm;\r\n            if (dt > TextRender.destroyUnusedTextureDt) {\r\n                tex.ri.deleted = true;\r\n                tex.ri.tex = null;\r\n                // 直接删除，不回收\r\n                tex.destroy();\r\n                this.isoTextures[i] = this.isoTextures[sz - 1];\r\n                sz--;\r\n                i--;\r\n            }\r\n        }\r\n        this.isoTextures.length = sz;\r\n\r\n        // 如果超出内存需要清理不常用\r\n        var needGC: boolean = this.textAtlases.length > 1 && this.textAtlases.length - totalUsedRateAtlas >= 2;\t// 总量浪费了超过2张\r\n        if (TextRender.atlasWidth * TextRender.atlasWidth * 4 * this.textAtlases.length > TextRender.cleanMem || needGC || TextRender.simClean) {\r\n            TextRender.simClean = false;\r\n            TextRender.showLog && console.log('清理使用率低的贴图。总使用率:', totalUsedRateAtlas, ':', this.textAtlases.length, '最差贴图:' + maxWasteRateID);\r\n            if (maxWasteRateID >= 0) {\r\n                curatlas = this.textAtlases[maxWasteRateID];\r\n                curatlas.destroy();\r\n                this.textAtlases[maxWasteRateID] = this.textAtlases[this.textAtlases.length - 1];\r\n                this.textAtlases.length = this.textAtlases.length - 1;\r\n            }\r\n        }\r\n\r\n        TextTexture.clean();\r\n    }\r\n\r\n    /**\r\n     * 尝试清理大图集\r\n     */\r\n    cleanAtlases(): void {\r\n        // TODO 根据覆盖率决定是否清理\r\n    }\r\n\r\n    getCharBmp(c: string): any {\r\n\r\n    }\r\n\r\n    /**\r\n     * 检查当前线是否存在数据\r\n     * @param\tdata\r\n     * @param\tl\r\n     * @param\tsx\r\n     * @param\tex\r\n     * @return\r\n     */\r\n    private checkBmpLine(data: ImageData, l: number, sx: number, ex: number): boolean {\r\n        if (this.bmpData32.buffer != data.data.buffer) {\r\n            this.bmpData32 = new Uint32Array(data.data.buffer);\r\n        }\r\n        var stpos: number = data.width * l + sx;\r\n        for (var x: number = sx; x < ex; x++) {\r\n            if (this.bmpData32[stpos++] != 0) return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 根据bmp数据和当前的包围盒，更新包围盒\r\n     * 由于选择的文字是连续的，所以可以用二分法\r\n     * @param\tdata\r\n     * @param\tcurbbx \t[l,t,r,b]\r\n     * @param   onlyH 不检查左右\r\n     */\r\n    private updateBbx(data: ImageData, curbbx: any[], onlyH: boolean = false): void {\r\n        var w: number = data.width;\r\n        var h: number = data.height;\r\n        var x: number = 0;\r\n        // top\r\n        var sy: number = curbbx[1];\t//从t到0 sy表示有数据的行\r\n        var ey: number = 0;\r\n        var y: number = sy;\r\n        if (this.checkBmpLine(data, sy, 0, w)) {\r\n            // 如果当前行有数据，就要往上找\r\n            while (true) {\r\n                y = (sy + ey) / 2 | 0;\t// 必须是int\r\n                if (y + 1 >= sy) {// \r\n                    // 找到了。严格来说还不知道这个是否有像素，不过这里要求不严格，可以认为有\r\n                    curbbx[1] = y;\r\n                    break;\r\n                }\r\n                if (this.checkBmpLine(data, y, 0, w)) {\r\n                    //中间线有数据，搜索上半部分\r\n                    sy = y;\r\n                } else {\r\n                    //中间线没有有数据，搜索下半部分\r\n                    ey = y;\r\n                }\r\n            }\r\n        }\r\n        // 下半部分\r\n        if (curbbx[3] > h) curbbx[3] = h;\r\n        else {\r\n            y = sy = curbbx[3];\r\n            ey = h;\r\n            if (this.checkBmpLine(data, sy, 0, w)) {\r\n                while (true) {\r\n                    y = (sy + ey) / 2 | 0;\r\n                    if (y - 1 <= sy) {\r\n                        curbbx[3] = y;\r\n                        break;\r\n                    }\r\n                    if (this.checkBmpLine(data, y, 0, w)) {\r\n                        sy = y;\r\n                    } else {\r\n                        ey = y;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (onlyH)\r\n            return;\r\n\r\n        // 左半部分\r\n        var minx: number = curbbx[0];\r\n        var stpos: number = w * curbbx[1]; //w*cy+0\r\n        for (y = curbbx[1]; y < curbbx[3]; y++) {\r\n            for (x = 0; x < minx; x++) {\r\n                if (this.bmpData32[stpos + x] != 0) {\r\n                    minx = x;\r\n                    break;\r\n                }\r\n            }\r\n            stpos += w;\r\n        }\r\n        curbbx[0] = minx;\r\n        // 右半部分\r\n        var maxx: number = curbbx[2];\r\n        stpos = w * curbbx[1]; //w*cy\r\n        for (y = curbbx[1]; y < curbbx[3]; y++) {\r\n            for (x = maxx; x < w; x++) {\r\n                if (this.bmpData32[stpos + x] != 0) {\r\n                    maxx = x;\r\n                    break;\r\n                }\r\n            }\r\n            stpos += w;\r\n        }\r\n        curbbx[2] = maxx;\r\n    }\r\n\r\n    getFontSizeInfo(font: string): number {\r\n        var finfo: any = this.fontSizeInfo[font];\r\n        if (finfo != undefined)\r\n            return finfo;\r\n\r\n        var fontstr: string = 'bold ' + TextRender.standardFontSize + 'px ' + font;\r\n        if (TextRender.isWan1Wan) {\r\n            // 这时候无法获得imagedata，只能采取保险测量\r\n            this.fontSizeW = this.charRender.getWidth(fontstr, '有') * 1.5;\r\n            this.fontSizeH = TextRender.standardFontSize * 1.5;\r\n            var szinfo: number = this.fontSizeW << 8 | this.fontSizeH;\r\n            this.fontSizeInfo[font] = szinfo;\r\n            return szinfo;\r\n        }\r\n        // bbx初始大小\r\n        TextRender.pixelBBX[0] = TextRender.standardFontSize / 2;// 16;\r\n        TextRender.pixelBBX[1] = TextRender.standardFontSize / 2;// 16;\r\n        TextRender.pixelBBX[2] = TextRender.standardFontSize;// 32;\r\n        TextRender.pixelBBX[3] = TextRender.standardFontSize;// 32;\r\n\r\n        var orix: number = 16;\t\t// 左边留白，也就是x原点的位置\r\n        var oriy: number = 16;\r\n        var marginr: number = 16;\r\n        var marginb: number = 16;\r\n        this.charRender.scale(1, 1);\r\n        TextRender.tmpRI.height = TextRender.standardFontSize;\r\n        this.charRender.fontsz = TextRender.standardFontSize;\r\n        var bmpdt: ImageData = this.charRender.getCharBmp('g', fontstr, 0, 'red', null, TextRender.tmpRI, orix, oriy, marginr, marginb);\r\n        // native 返回的是 textBitmap。 data直接是ArrayBuffer \r\n        if (ILaya.Render.isConchApp) {\r\n            //bmpdt.data.buffer = bmpdt.data;\r\n            (bmpdt as any).data = new Uint8ClampedArray(bmpdt.data);\r\n        }\r\n        this.bmpData32 = new Uint32Array(bmpdt.data.buffer);\r\n        //测量宽度是 tmpRI.width\r\n        this.updateBbx(bmpdt, TextRender.pixelBBX, false);\r\n        bmpdt = this.charRender.getCharBmp('有', fontstr, 0, 'red', null, TextRender.tmpRI, oriy, oriy, marginr, marginb);// '有'比'国'大\r\n        if (ILaya.Render.isConchApp) {\r\n            //bmpdt.data.buffer = bmpdt.data;\r\n            (bmpdt as any).data = new Uint8ClampedArray(bmpdt.data);\r\n        }\r\n        this.bmpData32 = new Uint32Array(bmpdt.data.buffer);\r\n        // 国字的宽度就用系统测量的，不再用像素检测\r\n        if (TextRender.pixelBBX[2] < orix + TextRender.tmpRI.width)\r\n            TextRender.pixelBBX[2] = orix + TextRender.tmpRI.width;\r\n        this.updateBbx(bmpdt, TextRender.pixelBBX, false);//TODO 改成 true\r\n        // 原点在 16,16\r\n        if (ILaya.Render.isConchApp) {\r\n            //runtime 的接口好像有问题，不认orix，oriy\r\n            orix = 0;\r\n            oriy = 0;\r\n        }\r\n        var xoff: number = Math.max(orix - TextRender.pixelBBX[0], 0);\r\n        var yoff: number = Math.max(oriy - TextRender.pixelBBX[1], 0);\r\n        var bbxw: number = TextRender.pixelBBX[2] - TextRender.pixelBBX[0];\r\n        var bbxh: number = TextRender.pixelBBX[3] - TextRender.pixelBBX[1];\r\n        var sizeinfo: number = xoff << 24 | yoff << 16 | bbxw << 8 | bbxh;\r\n        this.fontSizeInfo[font] = sizeinfo;\r\n        return sizeinfo;\r\n    }\r\n\r\n    printDbgInfo(): void {\r\n        console.log('图集个数:' + this.textAtlases.length + ',每个图集大小:' + TextRender.atlasWidth + 'x' + TextRender.atlasWidth, ' 用canvas:', TextRender.isWan1Wan);\r\n        console.log('图集占用空间:' + (TextRender.atlasWidth * TextRender.atlasWidth * 4 / 1024 / 1024 * this.textAtlases.length) + 'M');\r\n        console.log('缓存用到的字体:');\r\n        for (var f in this.mapFont) {\r\n            var fontsz: number = this.getFontSizeInfo(f);\r\n            var offx: number = fontsz >> 24\r\n            var offy: number = (fontsz >> 16) & 0xff;\r\n            var fw: number = (fontsz >> 8) & 0xff;\r\n            var fh: number = fontsz & 0xff;\r\n            console.log('    ' + f, ' off:', offx, offy, ' size:', fw, fh);\r\n        }\r\n        var num: number = 0;\r\n        console.log('缓存数据:');\r\n        var totalUsedRate: number = 0;\t// 总使用率\r\n        var totalUsedRateAtlas: number = 0;\r\n        this.textAtlases.forEach(function (a: TextAtlas): void {\r\n            var id: number = a.texture.id;\r\n            var dt: number = RenderInfo.loopCount - a.texture.lastTouchTm\r\n            var dtstr: string = dt > 0 ? ('' + dt + '帧以前') : '当前帧';\r\n            totalUsedRate += a.texture.curUsedCovRate;\r\n            totalUsedRateAtlas += a.texture.curUsedCovRateAtlas;\r\n            console.log('--图集(id:' + id + ',当前使用率:' + (a.texture.curUsedCovRate * 1000 | 0) + '‰', '当前图集使用率:', (a.texture.curUsedCovRateAtlas * 100 | 0) + '%', '图集使用率:', (a.usedRate * 100 | 0), '%, 使用于:' + dtstr + ')--:');\r\n            for (var k in a.charMaps) {\r\n                var ri: CharRenderInfo = a.charMaps[k];\r\n                console.log('     off:', ri.orix, ri.oriy, ' bmp宽高:', ri.bmpWidth, ri.bmpHeight, '无效:', ri.deleted, 'touchdt:', (RenderInfo.loopCount - ri.touchTick), '位置:', ri.uv[0] * TextRender.atlasWidth | 0, ri.uv[1] * TextRender.atlasWidth | 0,\r\n                    '字符:', ri.char, 'key:', k);\r\n                num++;\r\n            }\r\n        });\r\n        console.log('独立贴图文字(' + this.isoTextures.length + '个):');\r\n        this.isoTextures.forEach(function (tex: TextTexture): void {\r\n            console.log('    size:', tex._texW, tex._texH, 'touch间隔:', (RenderInfo.loopCount - tex.lastTouchTm), 'char:', tex.ri.char);\r\n        });\r\n        console.log('总缓存:', num, '总使用率:', totalUsedRate, '总当前图集使用率:', totalUsedRateAtlas);\r\n\r\n    }\r\n\r\n    // 在屏幕上显示某个大图集\r\n    showAtlas(n: number, bgcolor: string, x: number, y: number, w: number, h: number): Sprite {\r\n        if (!this.textAtlases[n]) {\r\n            console.log('没有这个图集');\r\n            return null;\r\n        }\r\n        var sp: Sprite = new ILaya.Sprite();\r\n        var texttex: TextTexture = this.textAtlases[n].texture;\r\n        var texture: any = {\r\n            width: TextRender.atlasWidth,\r\n            height: TextRender.atlasWidth,\r\n            sourceWidth: TextRender.atlasWidth,\r\n            sourceHeight: TextRender.atlasWidth,\r\n            offsetX: 0,\r\n            offsetY: 0,\r\n            getIsReady: function (): boolean { return true; },\r\n            _addReference: function (): void { },\r\n            _removeReference: function (): void { },\r\n            _getSource: function (): any { return texttex._getSource(); },\r\n            bitmap: { id: texttex.id },\r\n            _uv: Texture.DEF_UV\r\n        };\r\n        ((<any>sp)).size = function (w: number, h: number): Sprite {\r\n            this.width = w;\r\n            this.height = h;\r\n            sp.graphics.clear();\r\n            sp.graphics.drawRect(0, 0, sp.width, sp.height, bgcolor);\r\n            sp.graphics.drawTexture((<Texture>texture), 0, 0, sp.width, sp.height);\r\n            return (<Sprite>this);\r\n        }\r\n        sp.graphics.drawRect(0, 0, w, h, bgcolor);\r\n        sp.graphics.drawTexture((<Texture>texture), 0, 0, w, h);\r\n        sp.pos(x, y);\r\n        ILaya.stage.addChild(sp);\r\n        return sp;\r\n    }\r\n\r\n    /////// native ///////\r\n    filltext_native(ctx: Context, data: string | WordText, htmlchars: HTMLChar[], x: number, y: number, fontStr: string, color: string, strokeColor: string, lineWidth: number, textAlign: string, underLine: number = 0): void {\r\n        if (data && data.length <= 0) return;\r\n        if (htmlchars && htmlchars.length < 1) return;\r\n\r\n        var font: FontInfo = FontInfo.Parse(fontStr);\r\n\r\n        var nTextAlign: number = 0;\r\n        switch (textAlign) {\r\n            case 'center':\r\n                nTextAlign = ILaya.Context.ENUM_TEXTALIGN_CENTER;\r\n                break;\r\n            case 'right':\r\n                nTextAlign = ILaya.Context.ENUM_TEXTALIGN_RIGHT;\r\n                break;\r\n        }\r\n        return this._fast_filltext(ctx, (<WordText>data), htmlchars, x, y, font, color, strokeColor, lineWidth, nTextAlign, underLine);\r\n    }\r\n}\r\n\r\nTextTexture.gTextRender = TextRender;","import { ILaya } from \"../../ILaya\";\r\nimport { Sprite } from \"../display/Sprite\";\r\nimport { ColorFilter } from \"../filters/ColorFilter\";\r\nimport { LayaGL } from \"../layagl/LayaGL\";\r\nimport { Bezier } from \"../maths/Bezier\";\r\nimport { Matrix } from \"../maths/Matrix\";\r\nimport { Point } from \"../maths/Point\";\r\nimport { Rectangle } from \"../maths/Rectangle\";\r\nimport { FontInfo } from \"../utils/FontInfo\";\r\nimport { HTMLChar } from \"../utils/HTMLChar\";\r\nimport { Stat } from \"../utils/Stat\";\r\nimport { WordText } from \"../utils/WordText\";\r\nimport { BlendMode } from \"../webgl/canvas/BlendMode\";\r\nimport { DrawStyle } from \"../webgl/canvas/DrawStyle\";\r\nimport { Path } from \"../webgl/canvas/Path\";\r\nimport { ISaveData } from \"../webgl/canvas/save/ISaveData\";\r\nimport { SaveBase } from \"../webgl/canvas/save/SaveBase\";\r\nimport { SaveClipRect } from \"../webgl/canvas/save/SaveClipRect\";\r\nimport { SaveMark } from \"../webgl/canvas/save/SaveMark\";\r\nimport { SaveTransform } from \"../webgl/canvas/save/SaveTransform\";\r\nimport { SaveTranslate } from \"../webgl/canvas/save/SaveTranslate\";\r\nimport { WebGLCacheAsNormalCanvas } from \"../webgl/canvas/WebGLCacheAsNormalCanvas\";\r\nimport { BaseShader } from \"../webgl/shader/BaseShader\";\r\nimport { Shader2D } from \"../webgl/shader/d2/Shader2D\";\r\nimport { ShaderDefines2D } from \"../webgl/shader/d2/ShaderDefines2D\";\r\nimport { SkinMeshBuffer } from \"../webgl/shader/d2/skinAnishader/SkinMeshBuffer\";\r\nimport { Value2D } from \"../webgl/shader/d2/value/Value2D\";\r\nimport { Shader } from \"../webgl/shader/Shader\";\r\nimport { BasePoly } from \"../webgl/shapes/BasePoly\";\r\nimport { Earcut } from \"../webgl/shapes/Earcut\";\r\nimport { ISubmit } from \"../webgl/submit/ISubmit\";\r\nimport { Submit } from \"../webgl/submit/Submit\";\r\nimport { SubmitBase } from \"../webgl/submit/SubmitBase\";\r\nimport { SubmitCanvas } from \"../webgl/submit/SubmitCanvas\";\r\nimport { SubmitCMD } from \"../webgl/submit/SubmitCMD\";\r\nimport { SubmitKey } from \"../webgl/submit/SubmitKey\";\r\nimport { SubmitTarget } from \"../webgl/submit/SubmitTarget\";\r\nimport { SubmitTexture } from \"../webgl/submit/SubmitTexture\";\r\nimport { CharRenderInfo } from \"../webgl/text/CharRenderInfo\";\r\nimport { CharSubmitCache } from \"../webgl/text/CharSubmitCache\";\r\nimport { TextRender } from \"../webgl/text/TextRender\";\r\nimport { IndexBuffer2D } from \"../webgl/utils/IndexBuffer2D\";\r\nimport { Mesh2D } from \"../webgl/utils/Mesh2D\";\r\nimport { MeshQuadTexture } from \"../webgl/utils/MeshQuadTexture\";\r\nimport { MeshTexture } from \"../webgl/utils/MeshTexture\";\r\nimport { MeshVG } from \"../webgl/utils/MeshVG\";\r\nimport { RenderState2D } from \"../webgl/utils/RenderState2D\";\r\nimport { VertexBuffer2D } from \"../webgl/utils/VertexBuffer2D\";\r\nimport { WebGLContext } from \"../webgl/WebGLContext\";\r\nimport { Bitmap } from \"./Bitmap\";\r\nimport { HTMLCanvas } from \"./HTMLCanvas\";\r\nimport { RenderTexture2D } from \"./RenderTexture2D\";\r\nimport { RenderTextureFormat } from \"./RenderTextureFormat\";\r\nimport { Texture } from \"./Texture\";\r\nimport { Texture2D } from \"./Texture2D\";\r\n\r\n/**\r\n * @private\r\n * Context扩展类\r\n */\r\nexport class Context {\r\n\r\n\t/**@internal */\r\n\t_canvas: HTMLCanvas;\r\n\tstatic ENUM_TEXTALIGN_DEFAULT: number = 0;\r\n\tstatic ENUM_TEXTALIGN_CENTER: number = 1;\r\n\tstatic ENUM_TEXTALIGN_RIGHT: number = 2;\r\n\r\n\r\n\tstatic _SUBMITVBSIZE: number = 32000;\r\n\r\n\tstatic _MAXSIZE: number = 99999999;\r\n\tprivate static _MAXVERTNUM: number = 65535;\r\n\r\n\tstatic MAXCLIPRECT: Rectangle = null;\r\n\r\n\tstatic _COUNT: number = 0;\r\n\r\n\t/**@internal */\r\n\t_tmpMatrix: Matrix = new Matrix();\t\t// chrome下静态的访问比从this访问要慢\r\n\r\n\tprivate static SEGNUM: number = 32;\r\n\r\n\tprivate static _contextcount: number = 0;\r\n\r\n\tprivate _drawTexToDrawTri_Vert: Float32Array = new Float32Array(8);\t\t// 从速度考虑，不做成static了\r\n\tprivate _drawTexToDrawTri_Index: Uint16Array = new Uint16Array([0, 1, 2, 0, 2, 3]);\r\n\tprivate _tempUV: Float32Array = new Float32Array(8);\r\n\tprivate _drawTriUseAbsMatrix: boolean = false;\t//drawTriange函数的矩阵是全局的，不用再乘以当前矩阵了。这是一个补丁。\r\n\r\n\tstatic __init__(): void {\r\n\t\tContext.MAXCLIPRECT = new Rectangle(0, 0, Context._MAXSIZE, Context._MAXSIZE);\r\n\t\tContextParams.DEFAULT = new ContextParams();\r\n\t\tWebGLCacheAsNormalCanvas;\r\n\t}\r\n\r\n\t/**@private */\r\n\tdrawImage(...args): void {\r\n\t}\r\n\r\n\t/**@private */\r\n\tgetImageData(...args): any {\r\n\t}\r\n\r\n\t/**@private */\r\n\tmeasureText(text: string): any {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**@private */\r\n\tsetTransform(...args): void {\r\n\t}\r\n\r\n\r\n\t/**@private */\r\n\t$transform(a: number, b: number, c: number, d: number, tx: number, ty: number): void {\r\n\t}\r\n\r\n\r\n\t/**@private */\r\n\tget lineJoin(): string {\r\n\t\treturn '';\r\n\t}\r\n\r\n\t/**@private */\r\n\tset lineJoin(value: string) {\r\n\t}\r\n\r\n\t/**@private */\r\n\tget lineCap(): string {\r\n\t\treturn '';\r\n\t}\r\n\r\n\t/**@private */\r\n\tset lineCap(value: string) {\r\n\t}\r\n\r\n\t/**@private */\r\n\tget miterLimit(): string {\r\n\t\treturn '';\r\n\t}\r\n\r\n\t/**@private */\r\n\tset miterLimit(value: string) {\r\n\t}\r\n\r\n\t/**@private */\r\n\tclearRect(x: number, y: number, width: number, height: number): void {\r\n\t}\r\n\r\n\t/**@internal */\r\n\t//TODO:coverage\r\n\t_drawRect(x: number, y: number, width: number, height: number, style: any): void {\r\n\t\tStat.renderBatches++;\r\n\t\tstyle && (this.fillStyle = style);\r\n\t\tthis.fillRect(x, y, width, height, null);\r\n\t}\r\n\r\n\t///**@private */\r\n\t//public function transformByMatrix(value:Matrix):void {\r\n\t//this.transform(value.a, value.b, value.c, value.d, value.tx, value.ty);\r\n\t//}\r\n\r\n\t/**@private */\r\n\t//TODO:coverage\r\n\t//public function setTransformByMatrix(value:Matrix):void {\r\n\t//\tthis.setTransform(value.a, value.b, value.c, value.d, value.tx, value.ty);\r\n\t//}\r\n\r\n\t/**@private */\r\n\t//TODO:coverage\r\n\tdrawTexture2(x: number, y: number, pivotX: number, pivotY: number, m: Matrix, args2: any[]): void {\r\n\t}\r\n\r\n\t//=============新增==================\r\n\ttransformByMatrix(matrix: Matrix, tx: number, ty: number): void {\r\n\t\tthis.transform(matrix.a, matrix.b, matrix.c, matrix.d, matrix.tx + tx, matrix.ty + ty);\r\n\t}\r\n\r\n\tsaveTransform(matrix: Matrix): void {\r\n\t\tthis.save();\r\n\t}\r\n\r\n\trestoreTransform(matrix: Matrix): void {\r\n\t\tthis.restore();\r\n\t}\r\n\r\n\tdrawRect(x: number, y: number, width: number, height: number, fillColor: any, lineColor: any, lineWidth: number): void {\r\n\t\tvar ctx: any = this;\r\n\r\n\t\t//填充矩形\r\n\t\tif (fillColor != null) {\r\n\t\t\tctx.fillStyle = fillColor;\r\n\t\t\tctx.fillRect(x, y, width, height);\r\n\t\t}\r\n\r\n\t\t//绘制矩形边框\r\n\t\tif (lineColor != null) {\r\n\t\t\tctx.strokeStyle = lineColor;\r\n\t\t\tctx.lineWidth = lineWidth;\r\n\t\t\tctx.strokeRect(x, y, width, height);\r\n\t\t}\r\n\t}\r\n\r\n\talpha(value: number): void {\r\n\t\tthis.globalAlpha *= value;\r\n\t}\r\n\r\n\t/**@internal */\r\n\t//TODO:coverage\r\n\t_transform(mat: Matrix, pivotX: number, pivotY: number): void {\r\n\t\tthis.translate(pivotX, pivotY);\r\n\t\tthis.transform(mat.a, mat.b, mat.c, mat.d, mat.tx, mat.ty);\r\n\t\tthis.translate(-pivotX, -pivotY);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_rotate(angle: number, pivotX: number, pivotY: number): void {\r\n\t\tthis.translate(pivotX, pivotY);\r\n\t\tthis.rotate(angle);\r\n\t\tthis.translate(-pivotX, -pivotY);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_scale(scaleX: number, scaleY: number, pivotX: number, pivotY: number): void {\r\n\t\tthis.translate(pivotX, pivotY);\r\n\t\tthis.scale(scaleX, scaleY);\r\n\t\tthis.translate(-pivotX, -pivotY);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_drawLine(x: number, y: number, fromX: number, fromY: number, toX: number, toY: number, lineColor: string, lineWidth: number, vid: number): void {\r\n\t\tthis.beginPath();\r\n\t\tthis.strokeStyle = lineColor;\r\n\t\tthis.lineWidth = lineWidth;\r\n\t\tthis.moveTo(x + fromX, y + fromY);\r\n\t\tthis.lineTo(x + toX, y + toY);\r\n\t\tthis.stroke();\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_drawLines(x: number, y: number, points: any[], lineColor: any, lineWidth: number, vid: number): void {\r\n\t\tthis.beginPath();\r\n\t\t//x += args[0], y += args[1];\r\n\t\tthis.strokeStyle = lineColor;\r\n\t\tthis.lineWidth = lineWidth;\r\n\t\t//var points:Array = args[2];\r\n\t\tthis.addPath(points.slice(), false, false, x, y);\r\n\t\tthis.stroke();\r\n\t}\r\n\r\n\tdrawCurves(x: number, y: number, points: any[], lineColor: any, lineWidth: number): void {\r\n\t\tthis.beginPath();\r\n\t\tthis.strokeStyle = lineColor;\r\n\t\tthis.lineWidth = lineWidth;\r\n\t\t//var points:Array = args[2];\r\n\t\t//x += args[0], y += args[1];\r\n\t\tthis.moveTo(x + points[0], y + points[1]);\r\n\t\tvar i: number = 2, n: number = points.length;\r\n\t\twhile (i < n) {\r\n\t\t\tthis.quadraticCurveTo(x + points[i++], y + points[i++], x + points[i++], y + points[i++]);\r\n\t\t}\r\n\t\tthis.stroke();\r\n\t}\r\n\r\n\tprivate _fillAndStroke(fillColor: string, strokeColor: string, lineWidth: number, isConvexPolygon: boolean = false): void {\r\n\t\t//绘制填充区域\r\n\t\tif (fillColor != null) {\r\n\t\t\tthis.fillStyle = fillColor;\r\n\t\t\tthis.fill();\r\n\t\t}\r\n\r\n\t\t//绘制边框\r\n\t\tif (strokeColor != null && lineWidth > 0) {\r\n\t\t\tthis.strokeStyle = strokeColor;\r\n\t\t\tthis.lineWidth = lineWidth;\r\n\t\t\tthis.stroke();\r\n\t\t}\r\n\t}\r\n\t/**Math.PI*2的结果缓存 */\r\n\tstatic PI2: number = 2 * Math.PI;\r\n\t/**@internal */\r\n\t_drawCircle(x: number, y: number, radius: number, fillColor: any, lineColor: any, lineWidth: number, vid: number): void {\r\n\t\tStat.renderBatches++;\r\n\t\tthis.beginPath(true);\r\n\t\tthis.arc(x, y, radius, 0, Context.PI2);\r\n\t\tthis.closePath();\r\n\t\t//绘制\r\n\t\tthis._fillAndStroke(fillColor, lineColor, lineWidth);\r\n\t}\r\n\r\n\t//矢量方法\t\r\n\t/**@internal */\r\n\t_drawPie(x: number, y: number, radius: number, startAngle: number, endAngle: number, fillColor: any, lineColor: any, lineWidth: number, vid: number): void {\r\n\t\t//移动中心点\r\n\t\t//ctx.translate(x + args[0], y + args[1]);\r\n\t\t//形成路径\r\n\t\tthis.beginPath();\r\n\t\tthis.moveTo(x, y);\r\n\t\tthis.arc(x, y, radius, startAngle, endAngle);\r\n\t\tthis.closePath();\r\n\t\t//绘制\r\n\t\tthis._fillAndStroke(fillColor, lineColor, lineWidth);\r\n\t\t//恢复中心点\r\n\t\t//ctx.translate(-x - args[0], -y - args[1]);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_drawPoly(x: number, y: number, points: any[], fillColor: any, lineColor: any, lineWidth: number, isConvexPolygon: boolean, vid: number): void {\r\n\t\t//var points:Array = args[2];\r\n\t\tthis.beginPath();\r\n\t\t//poly一定是close的\r\n\t\tthis.addPath(points.slice(), true, isConvexPolygon, x, y);\r\n\t\tthis.closePath();\r\n\t\tthis._fillAndStroke(fillColor, lineColor, lineWidth, isConvexPolygon);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_drawPath(x: number, y: number, paths: any[], brush: any, pen: any): void {\r\n\t\t//形成路径\r\n\t\tthis.beginPath();\r\n\t\t//x += args[0], y += args[1];\r\n\r\n\t\t//var paths:Array = args[2];\r\n\t\tfor (var i: number = 0, n: number = paths.length; i < n; i++) {\r\n\r\n\t\t\tvar path: any[] = paths[i];\r\n\t\t\tswitch (path[0]) {\r\n\t\t\t\tcase \"moveTo\":\r\n\t\t\t\t\tthis.moveTo(x + path[1], y + path[2]);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"lineTo\":\r\n\t\t\t\t\tthis.lineTo(x + path[1], y + path[2]);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"arcTo\":\r\n\t\t\t\t\tthis.arcTo(x + path[1], y + path[2], x + path[3], y + path[4], path[5]);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"closePath\":\r\n\t\t\t\t\tthis.closePath();\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//var brush:Object = args[3];\r\n\t\tif (brush != null) {\r\n\t\t\tthis.fillStyle = brush.fillStyle;\r\n\t\t\tthis.fill();\r\n\t\t}\r\n\r\n\t\t//var pen:Object = args[4];\r\n\t\tif (pen != null) {\r\n\t\t\tthis.strokeStyle = pen.strokeStyle;\r\n\t\t\tthis.lineWidth = pen.lineWidth || 1;\r\n\t\t\tthis.lineJoin = pen.lineJoin;\r\n\t\t\tthis.lineCap = pen.lineCap;\r\n\t\t\tthis.miterLimit = pen.miterLimit;\r\n\t\t\tthis.stroke();\r\n\t\t}\r\n\t}\r\n\r\n\tstatic set2DRenderConfig(): void {\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tWebGLContext.setBlend(gl, true);//还原2D设置\r\n\t\tWebGLContext.setBlendEquation(gl, gl.FUNC_ADD);\r\n\t\tBlendMode.activeBlendFunction=null;\t\t// 防止submit不设置blend\r\n\t\tWebGLContext.setBlendFunc(gl, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n\t\tWebGLContext.setDepthTest(gl, false);\r\n\t\tWebGLContext.setCullFace(gl, false);\r\n\t\tWebGLContext.setDepthMask(gl, true);\r\n\t\tWebGLContext.setFrontFace(gl, gl.CCW);\r\n\t\tgl.viewport(0, 0, RenderState2D.width, RenderState2D.height);//还原2D视口\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_id: number = ++Context._COUNT;\r\n\r\n\tprivate _other: ContextParams|null = null;\r\n\tprivate _renderNextSubmitIndex: number = 0;\r\n\r\n\tprivate _path: Path|null = null;\r\n\t/**@internal */\r\n\t_drawCount: number = 1;\r\n\tprivate _width: number = Context._MAXSIZE;\r\n\tprivate _height: number = Context._MAXSIZE;\r\n\tprivate _renderCount: number = 0;\r\n\t/**@internal */\r\n\t_submits: any = null;\r\n\t/**@internal */\r\n\t_curSubmit: any = null;\r\n\t/**@internal */\r\n\t_submitKey: SubmitKey = new SubmitKey();\t//当前将要使用的设置。用来跟上一次的_curSubmit比较\r\n\r\n\t/**@internal */\r\n\t_mesh: MeshQuadTexture|null = null;\t\t\t//用Mesh2D代替_vb,_ib. 当前使用的mesh\r\n\t/**@internal */\r\n\t_pathMesh: MeshVG|null = null;\t\t\t//矢量专用mesh。\r\n\t/**@internal */\r\n\t_triangleMesh: MeshTexture|null = null;\t//drawTriangles专用mesh。由于ib不固定，所以不能与_mesh通用\r\n\r\n\tmeshlist: any[] = [];\t//本context用到的mesh\r\n\r\n\t//public var _vbs:Array = [];\t//双buffer管理。TODO 临时删掉，需要mesh中加上\r\n\tprivate _transedPoints: any[] = new Array(8);\t//临时的数组，用来计算4个顶点的转换后的位置。\r\n\tprivate _temp4Points: any[] = new Array(8);\t\t//临时数组。用来保存4个顶点的位置。\r\n\r\n\t/**@internal */\r\n\t_clipRect: Rectangle = Context.MAXCLIPRECT;\r\n\t//public var _transedClipInfo:Array = [0, 0, Context._MAXSIZE, 0, 0, Context._MAXSIZE];\t//应用矩阵后的clip。ox,oy, xx,xy,yx,yy \txx,xy等是缩放*宽高\r\n\t/**@internal */\r\n\t_globalClipMatrix: Matrix = new Matrix(Context._MAXSIZE, 0, 0, Context._MAXSIZE, 0, 0);\t//用矩阵描述的clip信息。最终的点投影到这个矩阵上，在0~1之间就可见。\r\n\t/**@internal */\r\n\t_clipInCache: boolean = false; \t// 当前记录的clipinfo是在cacheas normal后赋值的，因为cacheas normal会去掉当前矩阵的tx，ty，所以需要记录一下，以便在是shader中恢复\r\n\t/**@internal */\r\n\t_clipInfoID: number = 0;\t\t\t\t\t//用来区分是不是clipinfo已经改变了\r\n\tprivate _clipID_Gen: number = 0;\t\t\t//生成clipid的，原来是  _clipInfoID=++_clipInfoID 这样会有问题，导致兄弟clip的id都相同\r\n\t/**@internal */\r\n\t_curMat: Matrix;\r\n\r\n\t//计算矩阵缩放的缓存\r\n\t/**@internal */\r\n\t_lastMatScaleX: number = 1.0;\r\n\t/**@internal */\r\n\t_lastMatScaleY: number = 1.0;\r\n\tprivate _lastMat_a: number = 1.0;\r\n\tprivate _lastMat_b: number = 0.0;\r\n\tprivate _lastMat_c: number = 0.0;\r\n\tprivate _lastMat_d: number = 1.0;\r\n\t/**@internal */\r\n\t_nBlendType: number = 0;\r\n\t/**@internal */\r\n\t_save: any = null;\r\n\t/**@internal */\r\n\t_targets: RenderTexture2D|null = null;\r\n\t/**@internal */\r\n\t_charSubmitCache: CharSubmitCache|null = null;\r\n\t/**@internal */\r\n\t_saveMark: SaveMark|null = null;\r\n\t/**@internal */\r\n\t_shader2D: Shader2D = new Shader2D();\t//\r\n\r\n\t/**\r\n\t * 所cacheAs精灵\r\n\t * 对于cacheas bitmap的情况，如果图片还没准备好，需要有机会重画，所以要保存sprite。例如在图片\r\n\t * 加载完成后，调用repaint\r\n\t */\r\n\tsprite: Sprite|null = null;\r\n\r\n\t/**@internal */\r\n\tpublic static _textRender: TextRender|null = null;// new TextRender();\r\n\t/**@internal */\r\n\t_italicDeg: number = 0;//文字的倾斜角度\r\n\t/**@internal */\r\n\t_lastTex: Texture|null = null; //上次使用的texture。主要是给fillrect用，假装自己也是一个drawtexture\r\n\r\n\tprivate _fillColor: number = 0;\r\n\tprivate _flushCnt: number = 0;\r\n\r\n\tprivate defTexture: Texture|null = null;\t//给fillrect用\r\n\t/**@internal */\r\n\t_colorFiler: ColorFilter|null = null;\r\n\r\n\tdrawTexAlign: boolean = false;\t\t// 按照像素对齐\r\n\t/**@internal */\r\n\t_incache: boolean = false;\t\t\t// 正处在cacheas normal过程中\r\n\r\n\tisMain: boolean = false;\t\t\t\t// 是否是主context\r\n\r\n\tconstructor() {\r\n\t\tContext._contextcount++;\r\n\t\tContext._textRender = Context._textRender || new TextRender();\r\n\t\t//_ib = IndexBuffer2D.QuadrangleIB;\r\n\t\tif (!this.defTexture) {\r\n\t\t\tvar defTex2d: Texture2D = new Texture2D(2, 2);\r\n\t\t\tdefTex2d.setPixels(new Uint8Array(16));\r\n\t\t\tdefTex2d.lock = true;\r\n\t\t\tthis.defTexture = new Texture(defTex2d);\r\n\t\t}\r\n\t\tthis._lastTex = this.defTexture;\r\n\t\tthis.clear();\r\n\t}\r\n\r\n\tclearBG(r: number, g: number, b: number, a: number): void {\r\n\t\tvar gl: WebGLRenderingContext = WebGLContext.mainContext;\r\n\t\tgl.clearColor(r, g, b, a);\r\n\t\tgl.clear(gl.COLOR_BUFFER_BIT);\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\t/**@internal */\r\n\t_getSubmits(): any[] {\r\n\t\treturn this._submits;\r\n\t}\r\n\r\n\t/**\r\n\t * 释放占用内存\r\n\t * @param\tkeepRT  是否保留rendertarget\r\n\t */\r\n\tprivate _releaseMem(keepRT: boolean = false): void {\r\n\t\tif (!this._submits)\r\n\t\t\treturn;\r\n\r\n\t\tthis._curMat && this._curMat.destroy();\r\n\t\t//@ts-ignore\r\n\t\tthis._curMat = null;\r\n\t\tthis._shader2D.destroy();\r\n\t\tthis._shader2D = null;\r\n\t\tthis._charSubmitCache.clear();\r\n\r\n\t\tfor (var i: number = 0, n: number = this._submits._length; i < n; i++) {\r\n\t\t\tthis._submits[i].releaseRender();\r\n\t\t}\r\n\t\tthis._submits.length = 0;\r\n\t\tthis._submits._length = 0;\r\n\t\tthis._submits = null;\r\n\t\tthis._curSubmit = null;\r\n\r\n\t\tthis._path = null;\r\n\t\t//_other && (_other.font = null);\r\n\t\tthis._save = null;\r\n\r\n\t\tvar sz: number;\r\n\t\tfor (i = 0, sz = this.meshlist.length; i < sz; i++) {\r\n\t\t\tvar curm: Mesh2D = this.meshlist[i];\r\n\t\t\tcurm.destroy();\r\n\t\t}\r\n\t\tthis.meshlist.length = 0;\r\n\r\n\t\tthis.sprite = null;\r\n\t\tif (!keepRT) {\r\n\t\t\tthis._targets && (this._targets.destroy());\r\n\t\t\tthis._targets = null;\r\n\t\t}\r\n\t\t//TODO mesh 暂时releaseMem了\r\n\t}\r\n\r\n\t/**\r\n\t * 释放所有资源\r\n\t * @param\tkeepRT  是否保留rendertarget\r\n\t */\r\n\tdestroy(keepRT: boolean = false): void {\r\n\t\t--Context._contextcount;\r\n\t\tthis.sprite = null;\r\n\t\tthis._releaseMem(keepRT);\r\n\t\tthis._charSubmitCache.destroy();\r\n\t\t//_ib && (_ib != IndexBuffer2D.QuadrangleIB) && _ib.releaseResource();\r\n\t\tthis._mesh.destroy();\r\n\t\tif (!keepRT) {\r\n\t\t\tthis._targets && this._targets.destroy();//用回收么？可能没什么重复利用的价值\r\n\t\t\tthis._targets = null;\r\n\t\t}\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tif (!this._submits) {//第一次\r\n\t\t\tthis._other = ContextParams.DEFAULT;\r\n\t\t\tthis._curMat = Matrix.create();\r\n\t\t\tthis._charSubmitCache = new CharSubmitCache();\r\n\t\t\t//_vb = _vbs[0] = VertexBuffer2D.create( -1);\r\n\t\t\tthis._mesh = MeshQuadTexture.getAMesh(this.isMain);\r\n\t\t\tthis.meshlist.push(this._mesh);\r\n\t\t\tthis._pathMesh = MeshVG.getAMesh(this.isMain);\r\n\t\t\tthis.meshlist.push(this._pathMesh);\r\n\t\t\tthis._triangleMesh = MeshTexture.getAMesh(this.isMain);\r\n\t\t\tthis.meshlist.push(this._triangleMesh);\r\n\t\t\t//if(Config.smartCache) _vbs[1] = VertexBuffer2D.create( -1);\r\n\t\t\tthis._submits = [];\r\n\t\t\tthis._save = [SaveMark.Create(this)];\r\n\t\t\tthis._save.length = 10;\r\n\t\t\tthis._shader2D = new Shader2D();\r\n\t\t}\r\n\r\n\t\tthis._submitKey.clear();\r\n\r\n\t\t//_vb = _vbs[_renderCount%2];\r\n\t\t//_vb.clear();\r\n\t\tthis._mesh.clearVB();\r\n\r\n\t\t//_targets && (_targets.repaint = true);\r\n\r\n\t\tthis._drawCount = 1;\r\n\r\n\t\tthis._other = ContextParams.DEFAULT;\r\n\t\tthis._other.lineWidth = this._shader2D.ALPHA = 1.0;\r\n\r\n\t\tthis._nBlendType = 0;\r\n\r\n\t\tthis._clipRect = Context.MAXCLIPRECT;\r\n\r\n\t\tthis._curSubmit = SubmitBase.RENDERBASE;\r\n\t\tSubmitBase.RENDERBASE._ref = 0xFFFFFF;\r\n\t\tSubmitBase.RENDERBASE._numEle = 0;\r\n\r\n\t\tthis._shader2D.fillStyle = this._shader2D.strokeStyle = DrawStyle.DEFAULT;\r\n\r\n\t\tfor (var i: number = 0, n: number = this._submits._length; i < n; i++)\r\n\t\t\tthis._submits[i].releaseRender();\r\n\r\n\t\tthis._submits._length = 0;\r\n\r\n\t\tthis._curMat.identity();\r\n\t\tthis._other.clear();\r\n\r\n\t\tthis._saveMark = this._save[0];\r\n\t\tthis._save._length = 1;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 设置ctx的size，这个不允许直接设置，必须是canvas调过来的。所以这个函数里也不用考虑canvas相关的东西\r\n\t * @param\tw\r\n\t * @param\th\r\n\t */\r\n\tsize(w: number, h: number): void {\r\n\t\tif (this._width != w || this._height != h) {\r\n\t\t\tthis._width = w;\r\n\t\t\tthis._height = h;\r\n\t\t\t//TODO 问题：如果是rendertarget 计算内存会有问题，即canvas算一次，rt又算一次,所以这里要修改\r\n\t\t\t//这种情况下canvas应该不占内存\r\n\t\t\tif (this._targets) {\r\n\t\t\t\tthis._targets.destroy();\r\n\t\t\t\tthis._targets = new RenderTexture2D(w, h, RenderTextureFormat.R8G8B8A8, -1);\r\n\t\t\t}\r\n\t\t\t//如果是主画布，要记录窗口大小\r\n\t\t\t//如果不是 TODO\r\n\t\t\tif (this.isMain) {\r\n\t\t\t\tWebGLContext.mainContext.viewport(0, 0, w, h);\r\n\t\t\t\tRenderState2D.width = w;\r\n\t\t\t\tRenderState2D.height = h;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (w === 0 && h === 0) this._releaseMem();\r\n\t}\r\n\r\n\t/**\r\n\t * 当前canvas请求保存渲染结果。\r\n\t * 实现：\r\n\t * 如果value==true，就要给_target赋值\r\n\t * @param value {Boolean} \r\n\t */\r\n\tset asBitmap(value: boolean) {\r\n\t\tif (value) {\r\n\t\t\t//缺省的RGB没有a，不合理把。况且没必要自定义一个常量。\r\n\t\t\t//深度格式为-1表示不用深度缓存。\r\n\t\t\tlet rt = this._targets;\r\n\t\t\tif (!this._width || !this._height)\r\n\t\t\t\tthrow Error(\"asBitmap no size!\");\r\n\t\t\tif(!rt || rt.width!=this._width||rt.height!=this._height){\r\n\t\t\t\tif(rt){\r\n\t\t\t\t\trt.destroy();\r\n\t\t\t\t}\r\n\t\t\t\tthis._targets = new RenderTexture2D(this._width, this._height, RenderTextureFormat.R8G8B8A8, -1)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis._targets && this._targets.destroy();\r\n\t\t\tthis._targets = null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 获得当前矩阵的缩放值\r\n\t * 避免每次都计算getScaleX\r\n\t * @return\r\n\t */\r\n\tgetMatScaleX(): number {\r\n\t\tif (this._lastMat_a == this._curMat.a && this._lastMat_b == this._curMat.b)\r\n\t\t\treturn this._lastMatScaleX;\r\n\t\tthis._lastMatScaleX = this._curMat.getScaleX();\r\n\t\tthis._lastMat_a = this._curMat.a;\r\n\t\tthis._lastMat_b = this._curMat.b;\r\n\t\treturn this._lastMatScaleX;\r\n\t}\r\n\r\n\tgetMatScaleY(): number {\r\n\t\tif (this._lastMat_c == this._curMat.c && this._lastMat_d == this._curMat.d)\r\n\t\t\treturn this._lastMatScaleY;\r\n\t\tthis._lastMatScaleY = this._curMat.getScaleY();\r\n\t\tthis._lastMat_c = this._curMat.c;\r\n\t\tthis._lastMat_d = this._curMat.d;\r\n\t\treturn this._lastMatScaleY;\r\n\t}\r\n\r\n\t//TODO\r\n\tsetFillColor(color: number): void {\r\n\t\tthis._fillColor = color;\r\n\t}\r\n\tgetFillColor(): number {\r\n\t\treturn this._fillColor;\r\n\t}\r\n\r\n\tset fillStyle(value: any) {\r\n\t\tif (!this._shader2D.fillStyle.equal(value)) {\r\n\t\t\tSaveBase.save(this, SaveBase.TYPE_FILESTYLE, this._shader2D, false);\r\n\t\t\tthis._shader2D.fillStyle = DrawStyle.create(value);\r\n\t\t\tthis._submitKey.other = -this._shader2D.fillStyle.toInt();\r\n\t\t}\r\n\t}\r\n\r\n\tget fillStyle(): any {\r\n\t\treturn this._shader2D.fillStyle;\r\n\t}\r\n\r\n\tset globalAlpha(value: number) {\r\n\t\tvalue = Math.floor(value * 1000) / 1000;\r\n\t\tif (value != this._shader2D.ALPHA) {\r\n\t\t\tSaveBase.save(this, SaveBase.TYPE_ALPHA, this._shader2D, false);\r\n\t\t\tthis._shader2D.ALPHA = value;\r\n\t\t}\r\n\t}\r\n\r\n\tget globalAlpha(): number {\r\n\t\treturn this._shader2D.ALPHA;\r\n\t}\r\n\r\n\tset textAlign(value: string) {\r\n\t\t(this._other.textAlign === value) || (this._other = this._other.make(), SaveBase.save(this, SaveBase.TYPE_TEXTALIGN, this._other, false), this._other.textAlign = value);\r\n\t}\r\n\r\n\tget textAlign(): string {\r\n\t\treturn this._other.textAlign;\r\n\t}\r\n\r\n\tset textBaseline(value: string) {\r\n\t\t(this._other.textBaseline === value) || (this._other = this._other.make(), SaveBase.save(this, SaveBase.TYPE_TEXTBASELINE, this._other, false), this._other.textBaseline = value);\r\n\t}\r\n\r\n\tget textBaseline(): string {\r\n\t\treturn this._other.textBaseline;\r\n\t}\r\n\r\n\tset globalCompositeOperation(value: string) {\r\n\t\tvar n: any = BlendMode.TOINT[value];\r\n\r\n\t\tn == null || (this._nBlendType === n) || (SaveBase.save(this, SaveBase.TYPE_GLOBALCOMPOSITEOPERATION, this, true), this._curSubmit = SubmitBase.RENDERBASE, this._nBlendType = n /*, _shader2D.ALPHA = 1*/);\r\n\t}\r\n\r\n\tget globalCompositeOperation(): string {\r\n\t\treturn BlendMode.NAMES[this._nBlendType];\r\n\t}\r\n\r\n\tset strokeStyle(value: any) {\r\n\t\tthis._shader2D.strokeStyle.equal(value) || (SaveBase.save(this, SaveBase.TYPE_STROKESTYLE, this._shader2D, false), this._shader2D.strokeStyle = DrawStyle.create(value), this._submitKey.other = -this._shader2D.strokeStyle.toInt());\r\n\t}\r\n\r\n\tget strokeStyle(): any {\r\n\t\treturn this._shader2D.strokeStyle;\r\n\t}\r\n\r\n\ttranslate(x: number, y: number): void {\r\n\t\tif (x !== 0 || y !== 0) {\r\n\t\t\tSaveTranslate.save(this);\r\n\t\t\tif (this._curMat._bTransform) {\r\n\t\t\t\tSaveTransform.save(this);\r\n\t\t\t\t//_curMat.transformPointN(Point.TEMP.setTo(x, y));\r\n\t\t\t\t//x = Point.TEMP.x;\r\n\t\t\t\t//y = Point.TEMP.y;\r\n\t\t\t\t//translate的话，相当于在当前坐标系下移动x,y，所以直接修改_curMat,然后x,y就消失了。\r\n\t\t\t\tthis._curMat.tx += (x * this._curMat.a + y * this._curMat.c);\r\n\t\t\t\tthis._curMat.ty += (x * this._curMat.b + y * this._curMat.d);\r\n\t\t\t} else {\r\n\t\t\t\tthis._curMat.tx = x;\r\n\t\t\t\tthis._curMat.ty = y;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tset lineWidth(value: number) {\r\n\t\t(this._other.lineWidth === value) || (this._other = this._other.make(), SaveBase.save(this, SaveBase.TYPE_LINEWIDTH, this._other, false), this._other.lineWidth = value);\r\n\t}\r\n\r\n\tget lineWidth(): number {\r\n\t\treturn this._other.lineWidth;\r\n\t}\r\n\r\n\tsave(): void {\r\n\t\tthis._save[this._save._length++] = SaveMark.Create(this);\r\n\t}\r\n\r\n\trestore(): void {\r\n\t\tvar sz: number = this._save._length;\r\n\t\tvar lastBlend: number = this._nBlendType;\r\n\t\tif (sz < 1)\r\n\t\t\treturn;\r\n\t\tfor (var i: number = sz - 1; i >= 0; i--) {\r\n\t\t\tvar o: ISaveData = this._save[i];\r\n\t\t\to.restore(this);\r\n\t\t\tif (o.isSaveMark()) {\r\n\t\t\t\tthis._save._length = i;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (lastBlend != this._nBlendType) {\r\n\t\t\t//阻止合并\r\n\t\t\tthis._curSubmit = SubmitBase.RENDERBASE;\r\n\t\t}\r\n\t}\r\n\r\n\tset font(str: string) {\r\n\t\t//if (str == _other.font.toString())\r\n\t\t//\treturn;\r\n\t\tthis._other = this._other.make();\r\n\t\tSaveBase.save(this, SaveBase.TYPE_FONT, this._other, false);\r\n\t\t//_other.font === FontInContext.EMPTY ? (_other.font = new FontInContext(str)) : (_other.font.setFont(str));\r\n\t}\r\n\r\n\tfillText(txt: string | WordText, x: number, y: number, fontStr: string, color: string, align: string, lineWidth: number = 0, borderColor: string = \"\"): void {\r\n\t\tContext._textRender.filltext(this, txt, x, y, fontStr, color, borderColor, lineWidth, align);\r\n\t}\r\n\t// 与fillText的区别是没有border信息\r\n\tdrawText(text: string | WordText, x: number, y: number, font: string, color: string, textAlign: string): void {\r\n\t\tContext._textRender.filltext(this, text, x, y, font, color, null, 0, textAlign);\r\n\t}\r\n\tfillWords(words: HTMLChar[], x: number, y: number, fontStr: string, color: string): void {\r\n\t\tContext._textRender.fillWords(this, words, x, y, fontStr, color, null, 0);\r\n\t}\r\n\tstrokeWord(text: string | WordText, x: number, y: number, font: string, color: string, lineWidth: number, textAlign: string): void {\r\n\t\tContext._textRender.filltext(this, text, x, y, font, null, color, lineWidth, textAlign);\r\n\t}\r\n\tfillBorderText(txt: string | WordText, x: number, y: number, font: string, color: string, borderColor: string, lineWidth: number, textAlign: string): void {\r\n\t\tContext._textRender.filltext(this, txt, x, y, font, color, borderColor, lineWidth, textAlign);\r\n\t}\r\n\tfillBorderWords(words: HTMLChar[], x: number, y: number, font: string, color: string, borderColor: string, lineWidth: number): void {\r\n\t\tContext._textRender.fillWords(this, words, x, y, font, color, borderColor, lineWidth);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_fast_filltext(data: string | WordText, x: number, y: number, fontObj: any, color: string, strokeColor: string, lineWidth: number, textAlign: number, underLine: number = 0): void {\r\n\t\tContext._textRender._fast_filltext(this, data, null, x, y, (<FontInfo>fontObj), color, strokeColor, lineWidth, textAlign, underLine);\r\n\t}\r\n\r\n\tprivate _fillRect(x: number, y: number, width: number, height: number, rgba: number): void {\r\n\t\tvar submit: Submit = this._curSubmit;\r\n\t\tvar sameKey: boolean = submit && (submit._key.submitType === SubmitBase.KEY_DRAWTEXTURE && submit._key.blendShader === this._nBlendType);\r\n\t\tif (this._mesh.vertNum + 4 > Context._MAXVERTNUM) {\r\n\t\t\tthis._mesh = MeshQuadTexture.getAMesh(this.isMain);//创建新的mesh  TODO 如果_mesh不是常见格式，这里就不能这么做了。以后把_mesh单独表示成常用模式 \r\n\t\t\tthis.meshlist.push(this._mesh);\r\n\t\t\tsameKey = false;\r\n\t\t}\r\n\r\n\t\t//clipinfo\r\n\t\tsameKey && (sameKey = sameKey && this.isSameClipInfo(submit));\r\n\r\n\t\tthis.transformQuad(x, y, width, height, 0, this._curMat, this._transedPoints);\r\n\t\tif (!this.clipedOff(this._transedPoints)) {\r\n\t\t\tthis._mesh.addQuad(this._transedPoints, Texture.NO_UV, rgba, false);\r\n\t\t\t//if (GlUtils.fillRectImgVb(_mesh._vb, _clipRect, x, y, width, height, Texture.DEF_UV, _curMat, rgba,this)){\r\n\t\t\tif (!sameKey) {\r\n\t\t\t\tsubmit = this._curSubmit = SubmitTexture.create(this, this._mesh, Value2D.create(ShaderDefines2D.TEXTURE2D, 0));\r\n\t\t\t\tthis._submits[this._submits._length++] = submit;\r\n\t\t\t\tthis._copyClipInfo(submit, this._globalClipMatrix);\r\n\t\t\t\tsubmit.shaderValue.textureHost = this._lastTex;\r\n\t\t\t\t//这里有一个问题。例如 clip1, drawTex(tex1), clip2, fillRect, drawTex(tex2)\t会被分成3个submit，\r\n\t\t\t\t//submit._key.copyFrom2(_submitKey, SubmitBase.KEY_DRAWTEXTURE, (_lastTex && _lastTex.bitmap)?_lastTex.bitmap.id: -1);\r\n\t\t\t\tsubmit._key.other = (this._lastTex && this._lastTex.bitmap) ? (this._lastTex.bitmap as Texture2D).id : -1\r\n\t\t\t\tsubmit._renderType = SubmitBase.TYPE_TEXTURE;\r\n\t\t\t}\r\n\t\t\tthis._curSubmit._numEle += 6;\r\n\t\t\tthis._mesh.indexNum += 6;\r\n\t\t\tthis._mesh.vertNum += 4;\r\n\t\t}\r\n\t}\r\n\r\n\tfillRect(x: number, y: number, width: number, height: number, fillStyle: any): void {\r\n\t\tvar drawstyle: DrawStyle = fillStyle ? DrawStyle.create(fillStyle) : this._shader2D.fillStyle;\r\n\t\t//var rgb = drawstyle.toInt() ;\r\n\t\t//由于显卡的格式是 rgba，所以需要处理一下\r\n\t\t//var rgba:uint = ((rgb & 0xff0000) >> 16) | (rgb & 0x00ff00) | ((rgb & 0xff) << 16) | (_shader2D.ALPHA * 255) << 24;\r\n\t\tvar rgba: number = this.mixRGBandAlpha(drawstyle.toInt());\r\n\t\tthis._fillRect(x, y, width, height, rgba);\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\tfillTexture(texture: Texture, x: number, y: number, width: number, height: number, type: string, offset: Point, other: any): void {\r\n\t\t//test\r\n\t\t/*\r\n\t\tvar aa = 95 / 274, bb = 136 / 341, cc = (95 + 41) / 274, dd = (136 + 48) / 341;\r\n\t\ttexture.uv = [aa,bb, cc,bb, cc,dd, aa,dd];\r\n\t\ttexture.width = 41;\r\n\t\ttexture.height = 48;\r\n\t\t*/\r\n\t\t//test\r\n\r\n\t\tif (!texture._getSource()) {\r\n\t\t\tthis.sprite && ILaya.systemTimer.callLater(this, this._repaintSprite);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis._fillTexture(texture, texture.width, texture.height, texture.uvrect, x, y, width, height, type, offset.x, offset.y);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_fillTexture(texture: Texture, texw: number, texh: number, texuvRect: any[], x: number, y: number, width: number, height: number, type: string, offsetx: number, offsety: number): void {\r\n\t\tvar submit: Submit = this._curSubmit;\r\n\t\tvar sameKey: boolean = false;\r\n\t\tif (this._mesh.vertNum + 4 > Context._MAXVERTNUM) {\r\n\t\t\tthis._mesh = MeshQuadTexture.getAMesh(this.isMain);\r\n\t\t\tthis.meshlist.push(this._mesh);\r\n\t\t\tsameKey = false;\r\n\t\t}\r\n\r\n\t\t//filltexture相关逻辑。计算rect大小以及对应的uv\r\n\t\tvar repeatx: boolean = true;\r\n\t\tvar repeaty: boolean = true;\r\n\t\tswitch (type) {\r\n\t\t\tcase \"repeat\": break;\r\n\t\t\tcase \"repeat-x\": repeaty = false; break;\r\n\t\t\tcase \"repeat-y\": repeatx = false; break;\r\n\t\t\tcase \"no-repeat\": repeatx = repeaty = false; break;\r\n\t\t\tdefault: break;\r\n\t\t}\r\n\t\t//用 _temp4Points 来存计算出来的顶点的uv。这里的uv用0到1表示纹理的uv区域。这样便于计算，直到shader中才真的转成了实际uv\r\n\t\tvar uv: any[] = this._temp4Points;\r\n\t\tvar stu: number = 0; //uv起点\r\n\t\tvar stv: number = 0;\r\n\t\tvar stx: number = 0, sty: number = 0, edx: number = 0, edy: number = 0;\r\n\t\tif (offsetx < 0) {\r\n\t\t\tstx = x;\r\n\t\t\tstu = (-offsetx % texw) / texw;//有偏移的情况下的u不是从头开始\r\n\t\t} else {\r\n\t\t\tstx = x + offsetx;\r\n\t\t}\r\n\t\tif (offsety < 0) {\r\n\t\t\tsty = y;\r\n\t\t\tstv = (-offsety % texh) / texh;//有偏移的情况下的v不是从头开始\r\n\t\t} else {\r\n\t\t\tsty = y + offsety;\r\n\t\t}\r\n\r\n\t\tedx = x + width;\r\n\t\tedy = y + height;\r\n\t\t(!repeatx) && (edx = Math.min(edx, x + offsetx + texw));//x不重复的话，最多只画一个\r\n\t\t(!repeaty) && (edy = Math.min(edy, y + offsety + texh));//y不重复的话，最多只画一个\r\n\t\tif (edx < x || edy < y)\r\n\t\t\treturn;\r\n\t\tif (stx > edx || sty > edy)\r\n\t\t\treturn;\r\n\r\n\t\t//计算最大uv\r\n\t\tvar edu: number = (edx - x - offsetx) / texw;\r\n\t\tvar edv: number = (edy - y - offsety) / texh;\r\n\r\n\t\tthis.transformQuad(stx, sty, edx - stx, edy - sty, 0, this._curMat, this._transedPoints);\r\n\t\t//四个点对应的uv。必须在transformQuad后面，因为共用了_temp4Points\r\n\t\tuv[0] = stu; uv[1] = stv; uv[2] = edu; uv[3] = stv; uv[4] = edu; uv[5] = edv; uv[6] = stu; uv[7] = edv;\r\n\t\tif (!this.clipedOff(this._transedPoints)) {\r\n\t\t\t//不依赖于wrapmode了，都走filltexture流程，自己修改纹理坐标\r\n\t\t\t//tex2d.wrapModeU = BaseTexture.WARPMODE_REPEAT;\t//这里会有重复判断\r\n\t\t\t//tex2d.wrapModeV = BaseTexture.WARPMODE_REPEAT;\r\n\t\t\t//var rgba:int = mixRGBandAlpha(0xffffffff);\r\n\t\t\t//rgba = _mixRGBandAlpha(rgba, alpha);\t这个函数有问题，不能连续调用，输出作为输入\r\n\t\t\tvar rgba: number = this._mixRGBandAlpha(0xffffffff, this._shader2D.ALPHA);\r\n\r\n\t\t\tthis._mesh.addQuad(this._transedPoints, uv, rgba, true);\r\n\r\n\t\t\tvar sv: Value2D = Value2D.create(ShaderDefines2D.TEXTURE2D, 0);\r\n\t\t\t//这个优化先不要了，因为没太弄明白wrapmode的设置，总是不起作用。\r\n\t\t\t//if(texture.uvrect[2]<1.0||texture.uvrect[3]<1.0)//这表示是大图集中的一部分，只有这时候才用特殊shader\r\n\t\t\tsv.defines.add(ShaderDefines2D.FILLTEXTURE);\r\n\t\t\t((<any>sv)).u_TexRange = texuvRect.concat();\r\n\t\t\tsubmit = this._curSubmit = SubmitTexture.create(this, this._mesh, sv);\r\n\t\t\tthis._submits[this._submits._length++] = submit;\r\n\t\t\tthis._copyClipInfo(submit, this._globalClipMatrix);\r\n\t\t\tsubmit.shaderValue.textureHost = texture;\r\n\t\t\tsubmit._renderType = SubmitBase.TYPE_TEXTURE;\r\n\t\t\tthis._curSubmit._numEle += 6;\r\n\t\t\tthis._mesh.indexNum += 6;\r\n\t\t\tthis._mesh.vertNum += 4;\r\n\t\t}\r\n\t\tthis.breakNextMerge();\t//暂不合并\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * 反正只支持一种filter，就不要叫setFilter了，直接叫setColorFilter\r\n\t * @param\tvalue\r\n\t */\r\n\tsetColorFilter(filter: ColorFilter): void {\r\n\t\tSaveBase.save(this, SaveBase.TYPE_COLORFILTER, this, true);\r\n\t\t//_shader2D.filters = value;\r\n\t\tthis._colorFiler = filter;\r\n\t\tthis._curSubmit = SubmitBase.RENDERBASE;\r\n\t\t//_reCalculateBlendShader();\r\n\t}\r\n\r\n\tdrawTexture(tex: Texture, x: number, y: number, width: number, height: number): void {\r\n\t\tthis._drawTextureM(tex, x, y, width, height, null, 1, null);\r\n\t}\r\n\r\n\tdrawTextures(tex: Texture, pos: any[], tx: number, ty: number): void {\r\n\t\tif (!tex._getSource()) //source内调用tex.active();\r\n\t\t{\r\n\t\t\tthis.sprite && ILaya.systemTimer.callLater(this, this._repaintSprite);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//TODO 还没实现\r\n\t\tvar n: number = pos.length / 2;\r\n\t\tvar ipos: number = 0;\r\n\t\tvar bmpid: number = (tex.bitmap as Texture2D).id;\r\n\t\tfor (var i: number = 0; i < n; i++) {\r\n\t\t\tthis._inner_drawTexture(tex, bmpid, pos[ipos++] + tx, pos[ipos++] + ty, 0, 0, null, null, 1.0, false);\r\n\t\t}\r\n\r\n\t\t/*\r\n\t\tvar pre:Rectangle = _clipRect;\r\n\t\t_clipRect = MAXCLIPRECT;\r\n\t\tif (!_drawTextureM(tex, pos[0], pos[1], tex.width, tex.height,null, 1)) {\r\n\t\t\tthrow \"drawTextures err\";\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t_clipRect = pre;\r\n\t\t\r\n\t\tStat.drawCall++;//= pos.length / 2;\r\n\t\t\r\n\t\tif (pos.length < 4)\r\n\t\t\treturn;\r\n\t\t\r\n\t\tvar finalVB:VertexBuffer2D = _curSubmit._vb || _vb;\r\n\t\tvar sx:Number = _curMat.a, sy:Number = _curMat.d;\r\n\t\tvar vpos:int = finalVB._byteLength >> 2;// + Context._RECTVBSIZE;\r\n\t\tfinalVB.byteLength = finalVB._byteLength + (pos.length / 2 - 1) * Context._RECTVBSIZEBYTE;\r\n\t\tvar vbdata:Float32Array = finalVB.getFloat32Array();\r\n\t\tfor (var i:int = 2, sz:int = pos.length; i < sz; i += 2) {\r\n\t\t\tGlUtils.copyPreImgVb(finalVB,vpos, (pos[i] - pos[i - 2]) * sx, (pos[i + 1] - pos[i - 1]) * sy,vbdata);\r\n\t\t\t_curSubmit._numEle += 6;\r\n\t\t\tvpos += Context._RECTVBSIZE;\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\r\n\t/**\r\n\t * 为drawTexture添加一个新的submit。类型是 SubmitTexture\r\n\t * @param\tvbSize\r\n\t * @param\talpha\r\n\t * @param\twebGLImg\r\n\t * @param\ttex\r\n\t */\r\n\t//TODO:coverage\r\n\tprivate _drawTextureAddSubmit(imgid: number, tex: Texture): void {\r\n\t\t//var alphaBack:Number = shader.ALPHA;\r\n\t\t//shader.ALPHA *= alpha;\r\n\r\n\t\tvar submit: SubmitTexture = null;\r\n\t\tsubmit = SubmitTexture.create(this, this._mesh, Value2D.create(ShaderDefines2D.TEXTURE2D, 0));\r\n\t\tthis._submits[this._submits._length++] = submit;\r\n\t\tsubmit.shaderValue.textureHost = tex;\r\n\t\t//submit._key.copyFrom2(_submitKey, SubmitBase.KEY_DRAWTEXTURE, imgid);\r\n\t\tsubmit._key.other = imgid;\r\n\t\t//submit._key.alpha = shader.ALPHA;\r\n\t\tsubmit._renderType = SubmitBase.TYPE_TEXTURE;\r\n\t\tthis._curSubmit = submit;\r\n\r\n\t\t//shader.ALPHA = alphaBack;\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_drawTextureM(tex: Texture, x: number, y: number, width: number, height: number, m: Matrix, alpha: number, uv: any[]): boolean {\r\n\t\t// 注意sprite要保存，因为后面会被冲掉\r\n\t\tvar cs = this.sprite;\r\n\t\tif (!tex._getSource(function (): void {\r\n\t\t\tif (cs) {\r\n\t\t\t\tcs.repaint();\t// 原来是calllater，callater对于cacheas normal是没有机会执行的\r\n\t\t\t}\r\n\t\t})) { //source内调用tex.active();\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn this._inner_drawTexture(tex, (tex.bitmap as Texture2D).id, x, y, width, height, m, uv, alpha, false);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_drawRenderTexture(tex: RenderTexture2D, x: number, y: number, width: number, height: number, m: Matrix, alpha: number, uv: any[]): boolean {\r\n\t\treturn this._inner_drawTexture((<Texture>(tex as any)), -1, x, y, width, height, m, uv, 1.0, false);\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\tsubmitDebugger(): void {\r\n\t\tthis._submits[this._submits._length++] = SubmitCMD.create([], function (): void { debugger; }, this);\r\n\t}\r\n\r\n\t/*\r\n\tprivate function copyClipInfo(submit:Submit, clipInfo:Array):void {\r\n\t\tvar cd:Array = submit.shaderValue.clipDir;\r\n\t\tcd[0] = clipInfo[2]; cd[1] = clipInfo[3]; cd[2] = clipInfo[4]; cd[3] = clipInfo[5];\r\n\t\tvar cp:Array = submit.shaderValue.clipRect;\r\n\t\tcp[0] = clipInfo[0]; cp[1] = clipInfo[1];\r\n\t\tsubmit.clipInfoID = this._clipInfoID;\r\n\t}\r\n\t*/\r\n\t/**@internal */\r\n\t_copyClipInfo(submit: SubmitBase, clipInfo: Matrix): void {\r\n\t\tvar cm: any[] = submit.shaderValue.clipMatDir;\r\n\t\tcm[0] = clipInfo.a; cm[1] = clipInfo.b; cm[2] = clipInfo.c; cm[3] = clipInfo.d;\r\n\t\tvar cmp: any[] = submit.shaderValue.clipMatPos;\r\n\t\tcmp[0] = clipInfo.tx; cmp[1] = clipInfo.ty;\r\n\t\tsubmit.clipInfoID = this._clipInfoID;\r\n\r\n\t\tif (this._clipInCache) {\r\n\t\t\tsubmit.shaderValue.clipOff[0] = 1;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tprivate isSameClipInfo(submit: SubmitBase): boolean {\r\n\t\treturn (submit.clipInfoID === this._clipInfoID);\r\n\t\t/*\r\n\t\tvar cd:Array = submit.shaderValue.clipDir;\r\n\t\tvar cp:Array = submit.shaderValue.clipRect;\r\n\t\t\r\n\t\tif (clipInfo[0] != cp[0] || clipInfo[1] != cp[1] || clipInfo[2] != cd[0] || clipInfo[3] != cd[1] || clipInfo[4] != cd[2] || clipInfo[5] != cd[3] ) \r\n\t\t\treturn false;\r\n\t\treturn true;\r\n\t\t*/\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t * 这个还是会检查是否合并\r\n\t * @param\ttex\r\n\t * @param\tminVertNum\r\n\t */\r\n\t_useNewTex2DSubmit(tex: Texture, minVertNum: number): void {\r\n\t\t//var sameKey:Boolean = tex.bitmap.id >= 0 && preKey.submitType === SubmitBase.KEY_DRAWTEXTURE && preKey.other === tex.bitmap.id ;\r\n\r\n\t\tif (this._mesh.vertNum + minVertNum > Context._MAXVERTNUM) {\r\n\t\t\tthis._mesh = MeshQuadTexture.getAMesh(this.isMain);//创建新的mesh  TODO 如果_mesh不是常见格式，这里就不能这么做了。以后把_mesh单独表示成常用模式 \r\n\t\t\tthis.meshlist.push(this._mesh);\r\n\t\t\t//sameKey = false;\r\n\t\t}\r\n\r\n\t\tvar submit: SubmitTexture = SubmitTexture.create(this, this._mesh, Value2D.create(ShaderDefines2D.TEXTURE2D, 0));\r\n\t\tthis._submits[this._submits._length++] = this._curSubmit = submit;\r\n\t\tsubmit.shaderValue.textureHost = tex;\r\n\t\tthis._copyClipInfo(submit, this._globalClipMatrix);\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t * 使用上面的设置（texture，submit，alpha，clip），画一个rect\r\n\t */\r\n\t_drawTexRect(x: number, y: number, w: number, h: number, uv: any[]): void {\r\n\t\tthis.transformQuad(x, y, w, h, this._italicDeg, this._curMat, this._transedPoints);\r\n\t\t//这个是给文字用的，为了清晰，必须要按照屏幕像素对齐，并且四舍五入。\r\n\t\tvar ops: any[] = this._transedPoints;\r\n\t\tops[0] = (ops[0] + 0.5) | 0;\r\n\t\tops[1] = (ops[1] + 0.5) | 0;\r\n\t\tops[2] = (ops[2] + 0.5) | 0;\r\n\t\tops[3] = (ops[3] + 0.5) | 0;\r\n\t\tops[4] = (ops[4] + 0.5) | 0;\r\n\t\tops[5] = (ops[5] + 0.5) | 0;\r\n\t\tops[6] = (ops[6] + 0.5) | 0;\r\n\t\tops[7] = (ops[7] + 0.5) | 0;\r\n\r\n\t\tif (!this.clipedOff(this._transedPoints)) {\r\n\t\t\tthis._mesh.addQuad(this._transedPoints, uv, this._fillColor, true);\r\n\t\t\tthis._curSubmit._numEle += 6;\r\n\t\t\tthis._mesh.indexNum += 6;\r\n\t\t\tthis._mesh.vertNum += 4;\r\n\t\t}\r\n\t}\r\n\r\n\tdrawCallOptimize(enable: boolean): boolean {\r\n\t\tthis._charSubmitCache.enable(enable, this);\r\n\t\treturn enable;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t * @param\ttex {Texture | RenderTexture }\r\n\t * @param  imgid 图片id用来比较合并的\r\n\t * @param\tx\r\n\t * @param\ty\r\n\t * @param\twidth\r\n\t * @param\theight\r\n\t * @param\tm\r\n\t * @param\talpha\r\n\t * @param\tuv\r\n\t * @return\r\n\t */\r\n\t_inner_drawTexture(tex: Texture, imgid: number, x: number, y: number, width: number, height: number, m: Matrix, uv: ArrayLike<number>, alpha: number, lastRender: boolean): boolean {\r\n\t\tif (width <= 0 || height <= 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar preKey: SubmitKey = this._curSubmit._key;\r\n\t\tuv = uv || tex._uv\r\n\t\t//为了优化，如果上次是画三角形，并且贴图相同，会认为他们是一组的，把这个也转成三角形，以便合并。\r\n\t\t//因为好多动画是drawTexture和drawTriangle混用的\r\n\t\tif (preKey.submitType === SubmitBase.KEY_TRIANGLES && preKey.other === imgid) {\r\n\t\t\tvar tv: Float32Array = this._drawTexToDrawTri_Vert;\r\n\t\t\ttv[0] = x; tv[1] = y; tv[2] = x + width, tv[3] = y, tv[4] = x + width, tv[5] = y + height, tv[6] = x, tv[7] = y + height;\r\n\t\t\tthis._drawTriUseAbsMatrix = true;\r\n\t\t\tvar tuv: Float32Array = this._tempUV;\r\n\t\t\ttuv[0] = uv[0]; tuv[1] = uv[1]; tuv[2] = uv[2]; tuv[3] = uv[3]; tuv[4] = uv[4]; tuv[5] = uv[5]; tuv[6] = uv[6]; tuv[7] = uv[7];\r\n\t\t\tthis.drawTriangles(tex, 0, 0, tv, tuv, this._drawTexToDrawTri_Index, m, alpha, null, null);//用tuv而不是uv会提高效率\r\n\t\t\tthis._drawTriUseAbsMatrix = false;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tvar mesh: MeshQuadTexture = this._mesh;\r\n\t\tvar submit: SubmitTexture = this._curSubmit;\r\n\t\tvar ops: any[] = lastRender ? this._charSubmitCache.getPos() : this._transedPoints;\r\n\r\n\t\t//凡是这个都是在_mesh上操作，不用考虑samekey\r\n\t\tthis.transformQuad(x, y, width || tex.width, height || tex.height, this._italicDeg, m || this._curMat, ops);\r\n\r\n\t\tif (this.drawTexAlign) {\r\n\t\t\tvar round: Function = Math.round;\r\n\t\t\tops[0] = round(ops[0]);//  (ops[0] + 0.5) | 0;\t// 这么计算负的时候会有问题\r\n\t\t\tops[1] = round(ops[1]);\r\n\t\t\tops[2] = round(ops[2]);\r\n\t\t\tops[3] = round(ops[3]);\r\n\t\t\tops[4] = round(ops[4]);\r\n\t\t\tops[5] = round(ops[5]);\r\n\t\t\tops[6] = round(ops[6]);\r\n\t\t\tops[7] = round(ops[7]);\r\n\t\t\tthis.drawTexAlign = false;\t//一次性的\r\n\t\t}\r\n\r\n\t\tvar rgba: number = this._mixRGBandAlpha(0xffffffff, this._shader2D.ALPHA * alpha);\r\n\r\n\t\t//lastRender = false;\r\n\t\tif (lastRender) {\r\n\t\t\tthis._charSubmitCache.add(this, tex, imgid, ops, uv, rgba);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tthis._drawCount++;\r\n\r\n\t\tvar sameKey: boolean = imgid >= 0 && preKey.submitType === SubmitBase.KEY_DRAWTEXTURE && preKey.other === imgid;\r\n\r\n\t\t//clipinfo\r\n\t\tsameKey && (sameKey = sameKey && this.isSameClipInfo(submit));\r\n\r\n\t\tthis._lastTex = tex;\r\n\r\n\t\tif (mesh.vertNum + 4 > Context._MAXVERTNUM) {\r\n\t\t\tmesh = this._mesh = MeshQuadTexture.getAMesh(this.isMain);//创建新的mesh  TODO 如果_mesh不是常见格式，这里就不能这么做了。以后把_mesh单独表示成常用模式 \r\n\t\t\tthis.meshlist.push(mesh);\r\n\t\t\tsameKey = false;\t//新的mesh不能算samekey了\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tmesh.addQuad(ops, uv, rgba, true);\r\n\t\t\tif (!sameKey) {\r\n\t\t\t\tthis._submits[this._submits._length++] = this._curSubmit = submit = SubmitTexture.create(this, mesh, Value2D.create(ShaderDefines2D.TEXTURE2D, 0));\r\n\t\t\t\tsubmit.shaderValue.textureHost = tex;\r\n\t\t\t\tsubmit._key.other = imgid;\r\n\t\t\t\tthis._copyClipInfo(submit, this._globalClipMatrix);\r\n\t\t\t}\r\n\t\t\tsubmit._numEle += 6;\r\n\t\t\tmesh.indexNum += 6;\r\n\t\t\tmesh.vertNum += 4;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * 转换4个顶点。为了效率这个不做任何检查。需要调用者的配合。\r\n\t * @param\ta\t\t输入。8个元素表示4个点\r\n\t * @param\tout\t\t输出\r\n\t */\r\n\ttransform4Points(a: any[], m: Matrix, out: any[]): void {\r\n\t\t/*\r\n\t\t\tout[0] = 846;\r\n\t\t\tout[1] = 656;\r\n\t\t\tout[2] = 881;\r\n\t\t\tout[3] = 657;\r\n\t\t\tout[4] = 880;\r\n\t\t\tout[5] = 732;\r\n\t\t\tout[6] = 844;\r\n\t\t\tout[7] = 731;\r\n\t\t\treturn ;\r\n\t\t*/\r\n\t\t//var m:Matrix = _curMat;\r\n\t\tvar tx: number = m.tx;\r\n\t\tvar ty: number = m.ty;\r\n\t\tvar ma: number = m.a;\r\n\t\tvar mb: number = m.b;\r\n\t\tvar mc: number = m.c;\r\n\t\tvar md: number = m.d;\r\n\t\tvar a0: number = a[0];\r\n\t\tvar a1: number = a[1];\r\n\t\tvar a2: number = a[2];\r\n\t\tvar a3: number = a[3];\r\n\t\tvar a4: number = a[4];\r\n\t\tvar a5: number = a[5];\r\n\t\tvar a6: number = a[6];\r\n\t\tvar a7: number = a[7];\r\n\t\tif (m._bTransform) {\r\n\t\t\tout[0] = a0 * ma + a1 * mc + tx; out[1] = a0 * mb + a1 * md + ty;\r\n\t\t\tout[2] = a2 * ma + a3 * mc + tx; out[3] = a2 * mb + a3 * md + ty;\r\n\t\t\tout[4] = a4 * ma + a5 * mc + tx; out[5] = a4 * mb + a5 * md + ty;\r\n\t\t\tout[6] = a6 * ma + a7 * mc + tx; out[7] = a6 * mb + a7 * md + ty;\r\n\t\t} else {\r\n\t\t\tout[0] = a0 + tx; out[1] = a1 + ty;\r\n\t\t\tout[2] = a2 + tx; out[3] = a3 + ty;\r\n\t\t\tout[4] = a4 + tx; out[5] = a5 + ty;\r\n\t\t\tout[6] = a6 + tx; out[7] = a7 + ty;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * pt所描述的多边形完全在clip外边，整个被裁掉了\r\n\t * @param\tpt\r\n\t * @return\r\n\t */\r\n\tclipedOff(pt: any[]): boolean {\r\n\t\t//TODO\r\n\t\tif (this._clipRect.width <= 0 || this._clipRect.height <= 0)\r\n\t\t\treturn true;\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * 应用当前矩阵。把转换后的位置放到输出数组中。 \r\n\t * @param\tx\r\n\t * @param\ty\r\n\t * @param\tw\r\n\t * @param\th\r\n\t * @param   italicDeg 倾斜角度，单位是度。0度无，目前是下面不动。以后要做成可调的\r\n\t */\r\n\ttransformQuad(x: number, y: number, w: number, h: number, italicDeg: number, m: Matrix, out: any[]): void {\r\n\t\t/*\r\n\t\tout[0] = 100.1; out[1] = 100.1;\r\n\t\tout[2] = 101.1; out[3] = 100.1;\r\n\t\tout[4] = 101.1; out[5] = 101.1;\r\n\t\tout[6] = 100.1; out[7] = 101.1;\r\n\t\treturn;\r\n\t\t*/\r\n\t\tvar xoff: number = 0;\r\n\t\tif (italicDeg != 0) {\r\n\t\t\txoff = Math.tan(italicDeg * Math.PI / 180) * h;\r\n\t\t}\r\n\t\tvar maxx: number = x + w; var maxy: number = y + h;\r\n\r\n\t\tvar tx: number = m.tx;\r\n\t\tvar ty: number = m.ty;\r\n\t\tvar ma: number = m.a;\r\n\t\tvar mb: number = m.b;\r\n\t\tvar mc: number = m.c;\r\n\t\tvar md: number = m.d;\r\n\t\tvar a0: number = x + xoff;\r\n\t\tvar a1: number = y;\r\n\t\tvar a2: number = maxx + xoff;\r\n\t\tvar a3: number = y;\r\n\t\tvar a4: number = maxx;\r\n\t\tvar a5: number = maxy;\r\n\t\tvar a6: number = x;\r\n\t\tvar a7: number = maxy;\r\n\t\tif (m._bTransform) {\r\n\t\t\tout[0] = a0 * ma + a1 * mc + tx; out[1] = a0 * mb + a1 * md + ty;\r\n\t\t\tout[2] = a2 * ma + a3 * mc + tx; out[3] = a2 * mb + a3 * md + ty;\r\n\t\t\tout[4] = a4 * ma + a5 * mc + tx; out[5] = a4 * mb + a5 * md + ty;\r\n\t\t\tout[6] = a6 * ma + a7 * mc + tx; out[7] = a6 * mb + a7 * md + ty;\r\n\t\t} else {\r\n\t\t\tout[0] = a0 + tx; out[1] = a1 + ty;\r\n\t\t\tout[2] = a2 + tx; out[3] = a3 + ty;\r\n\t\t\tout[4] = a4 + tx; out[5] = a5 + ty;\r\n\t\t\tout[6] = a6 + tx; out[7] = a7 + ty;\r\n\t\t}\r\n\t}\r\n\r\n\tpushRT(): void {\r\n\t\tthis.addRenderObject(SubmitCMD.create(null, RenderTexture2D.pushRT, this));\r\n\t}\r\n\tpopRT(): void {\r\n\t\tthis.addRenderObject(SubmitCMD.create(null, RenderTexture2D.popRT, this));\r\n\t\tthis.breakNextMerge();\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\tuseRT(rt: RenderTexture2D): void {\r\n\t\t//这里并没有做cliprect的保存恢复。因为认为调用这个函数的话，就是完全不走context流程了，完全自己控制。\r\n\t\tfunction _use(rt: RenderTexture2D): void {\r\n\t\t\tif (!rt) {\r\n\t\t\t\tthrow 'error useRT'\r\n\t\t\t} else {\r\n\t\t\t\trt.start();\r\n\t\t\t\trt.clear(0, 0, 0, 0);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.addRenderObject(SubmitCMD.create([rt], _use, this));\r\n\t\tthis.breakNextMerge();\r\n\t}\r\n\r\n\t/**\r\n\t * 异步执行rt的restore函数\r\n\t * @param\trt\r\n\t */\r\n\t//TODO:coverage\r\n\tRTRestore(rt: RenderTexture2D): void {\r\n\t\tfunction _restore(rt: RenderTexture2D): void {\r\n\t\t\trt.restore();\r\n\t\t}\r\n\t\tthis.addRenderObject(SubmitCMD.create([rt], _restore, this));\r\n\t\tthis.breakNextMerge();\r\n\t}\r\n\r\n\t/**\r\n\t * 强制拒绝submit合并\r\n\t * 例如切换rt的时候\r\n\t */\r\n\tbreakNextMerge(): void {\r\n\t\tthis._curSubmit = SubmitBase.RENDERBASE;\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\tprivate _repaintSprite(): void {\r\n\t\tthis.sprite && this.sprite.repaint();\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t * @param\ttex\r\n\t * @param\tx\t\t\t\r\n\t * @param\ty\r\n\t * @param\twidth\r\n\t * @param\theight\r\n\t * @param\ttransform\t图片本身希望的矩阵\r\n\t * @param\ttx\t\t\t节点的位置\r\n\t * @param\tty\r\n\t * @param\talpha\r\n\t */\r\n\tdrawTextureWithTransform(tex: Texture, x: number, y: number, width: number, height: number, transform: Matrix, tx: number, ty: number, alpha: number, blendMode: string, colorfilter: ColorFilter = null, uv?: number[]): void {\r\n\t\tvar oldcomp: string ;\r\n\t\tvar curMat: Matrix = this._curMat;\r\n\t\tif (blendMode) {\r\n\t\t\toldcomp = this.globalCompositeOperation;\r\n\t\t\tthis.globalCompositeOperation = blendMode;\r\n\t\t}\r\n\t\tvar oldColorFilter: ColorFilter = this._colorFiler;\r\n\t\tif (colorfilter) {\r\n\t\t\tthis.setColorFilter(colorfilter);\r\n\t\t}\r\n\r\n\t\tif (!transform) {\r\n\t\t\tthis._drawTextureM(tex, x + tx, y + ty, width, height, curMat, alpha, uv);\r\n\t\t\tif (blendMode) {\r\n\t\t\t\tthis.globalCompositeOperation = oldcomp;\r\n\t\t\t}\r\n\t\t\tif (colorfilter) {\r\n\t\t\t\tthis.setColorFilter(oldColorFilter);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar tmpMat: Matrix = this._tmpMatrix;\r\n\t\t//克隆transform,因为要应用tx，ty，这里不能修改原始的transform\r\n\t\ttmpMat.a = transform.a; tmpMat.b = transform.b; tmpMat.c = transform.c; tmpMat.d = transform.d; tmpMat.tx = transform.tx + tx; tmpMat.ty = transform.ty + ty;\r\n\t\ttmpMat._bTransform = transform._bTransform;\r\n\r\n\t\tif (transform && curMat._bTransform) {\r\n\t\t\t// 如果当前矩阵不是只有平移，则只能用mul的方式\r\n\t\t\tMatrix.mul(tmpMat, curMat, tmpMat);\r\n\t\t\ttransform = tmpMat;\r\n\t\t\ttransform._bTransform = true;\r\n\t\t} else {\r\n\t\t\t//如果curmat没有旋转。\r\n\t\t\ttmpMat.tx += curMat.tx;\r\n\t\t\ttmpMat.ty += curMat.ty;\r\n\t\t\ttransform = tmpMat;\r\n\t\t}\r\n\t\tthis._drawTextureM(tex, x, y, width, height, transform, alpha, uv);\r\n\t\tif (blendMode) {\r\n\t\t\tthis.globalCompositeOperation = oldcomp;\r\n\t\t}\r\n\t\tif (colorfilter) {\r\n\t\t\tthis.setColorFilter(oldColorFilter);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * * 把ctx中的submits提交。结果渲染到target上\r\n\t * @param\tctx\r\n\t * @param\ttarget\r\n\t */\r\n\tprivate _flushToTarget(context: Context, target: RenderTexture2D): void {\r\n\t\t//if (target._destroy) return;\r\n\t\t//var preworldClipRect:Rectangle = RenderState2D.worldClipRect;\r\n\t\t//裁剪不用考虑，现在是在context内部自己维护，不会乱窜\r\n\t\tRenderState2D.worldScissorTest = false;\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tgl.disable(gl.SCISSOR_TEST);\r\n\r\n\t\tvar preAlpha: number = RenderState2D.worldAlpha;\r\n\t\tvar preMatrix4: any[] = RenderState2D.worldMatrix4;\r\n\t\tvar preMatrix: Matrix = RenderState2D.worldMatrix;\r\n\r\n\t\tvar preShaderDefines: ShaderDefines2D = RenderState2D.worldShaderDefines;\r\n\r\n\t\tRenderState2D.worldMatrix = Matrix.EMPTY;\r\n\r\n\t\tRenderState2D.restoreTempArray();\r\n\t\tRenderState2D.worldMatrix4 = RenderState2D.TEMPMAT4_ARRAY;\r\n\t\tRenderState2D.worldAlpha = 1;\r\n\t\t//RenderState2D.worldFilters = null;\r\n\t\t//RenderState2D.worldShaderDefines = null;\r\n\t\tBaseShader.activeShader = null;\r\n\r\n\t\ttarget.start();\r\n\t\t// 如果没有命令就不要clear。这么改是因为嵌套cacheas出问题了\r\n\t\t// 如果一个sprite cacheas normal ，他的子节点有cacheas bitmap的（包括mask等）就会不断的执行 _flushToTarget和drawCamvase,从而把target上的内容清掉\r\n\t\t// 由于cacheas normal 导致 RenderSprite没有机会执行 _cacheStyle.canvas 存在的分支。在\r\n\t\tif (context._submits._length > 0)\r\n\t\t\ttarget.clear(0, 0, 0, 0);\r\n\r\n\t\tcontext._curSubmit = SubmitBase.RENDERBASE;\r\n\t\tcontext.flush();\r\n\t\tcontext.clear();\r\n\t\ttarget.restore();\r\n\t\tcontext._curSubmit = SubmitBase.RENDERBASE;\r\n\t\t//context._canvas\r\n\t\tBaseShader.activeShader = null;\r\n\t\tRenderState2D.worldAlpha = preAlpha;\r\n\t\tRenderState2D.worldMatrix4 = preMatrix4;\r\n\t\tRenderState2D.worldMatrix = preMatrix;\r\n\t\t//RenderState2D.worldFilters = preFilters;\r\n\t\t//RenderState2D.worldShaderDefines = preShaderDefines;\r\n\t}\r\n\r\n\tdrawCanvas(canvas: HTMLCanvas, x: number, y: number, width: number, height: number): void {\r\n\t\tif (!canvas) return;\r\n\t\tvar src: Context = canvas.context as Context;\r\n\t\tvar submit: ISubmit;\r\n\t\tif (src._targets) {\r\n\t\t\t//生成渲染结果到src._targets上\r\n\t\t\t/*\r\n\t\t\tthis._submits[this._submits._length++] = SubmitCanvas.create(src, 0, null);\r\n\t\t\t_curSubmit = SubmitBase.RENDERBASE;\r\n\t\t\t//画出src._targets\r\n\t\t\t//drawTexture(src._targets.target.getTexture(), x, y, width, height, 0, 0);\r\n\t\t\t*/\r\n\t\t\t//应用并清空canvas中的指令。如果内容需要重画，RenderSprite会给他重新加入submit\r\n\t\t\tif (src._submits._length > 0) {\r\n\t\t\t\tsubmit = SubmitCMD.create([src, src._targets], this._flushToTarget, this);\r\n\t\t\t\tthis._submits[this._submits._length++] = submit;\r\n\t\t\t}\r\n\t\t\t//在这之前就已经渲染出结果了。\r\n\t\t\tthis._drawRenderTexture(src._targets, x, y, width, height, null, 1.0, RenderTexture2D.flipyuv);\r\n\t\t\tthis._curSubmit = SubmitBase.RENDERBASE;\r\n\t\t\t/*\r\n\t\t\tthis._submits[this._submits._length++] = SubmitCanvas.create(src, 0, null);\r\n\t\t\t//src._targets.flush(src);\r\n\t\t\t_curSubmit = SubmitBase.RENDERBASE;\r\n\t\t\t//src._targets.drawTo(this, x, y, width, height);\r\n\t\t\t//drawTexture(src._targets.target.getTexture(), x, y, width, height, 0, 0);\r\n\t\t\t_drawRenderTexture(src._targets, x, y, width, height,null,1.0, RenderTexture.flipyuv);\r\n\t\t\t*/\r\n\t\t} else {\r\n\t\t\tvar canv: WebGLCacheAsNormalCanvas = (<WebGLCacheAsNormalCanvas>(canvas as any));\r\n\t\t\tif (canv.touches) {\r\n\t\t\t\t((<any[]>canv.touches)).forEach(function (v: CharRenderInfo): void { v.touch(); });\r\n\t\t\t}\r\n\r\n\t\t\tsubmit = SubmitCanvas.create(canvas, this._shader2D.ALPHA, this._shader2D.filters);\r\n\t\t\tthis._submits[this._submits._length++] = submit;\r\n\t\t\t((<SubmitCanvas>submit))._key.clear();\r\n\t\t\t//var sx:Number = width / canvas.width;\r\n\t\t\t//var sy:Number = height / canvas.height;\r\n\t\t\tvar mat: Matrix = ((<SubmitCanvas>submit))._matrix;\r\n\t\t\tthis._curMat.copyTo(mat);\r\n\t\t\t//sx != 1 && sy != 1 && mat.scale(sx, sy);\r\n\t\t\t// 先加上位置，最后再乘逆\r\n\t\t\tvar tx: number = mat.tx, ty: number = mat.ty;\r\n\t\t\tmat.tx = mat.ty = 0;\r\n\t\t\tmat.transformPoint(Point.TEMP.setTo(x, y));\t// 用当前矩阵变换 (x,y)\r\n\t\t\tmat.translate(Point.TEMP.x + tx, Point.TEMP.y + ty);\t// 加上原来的 (tx,ty)\r\n\r\n\t\t\tMatrix.mul(canv.invMat, mat, mat);\r\n\r\n\t\t\tthis._curSubmit = SubmitBase.RENDERBASE;\r\n\t\t}\r\n\t}\r\n\r\n\tdrawTarget(rt: RenderTexture2D, x: number, y: number, width: number, height: number, m: Matrix, shaderValue: Value2D, uv: ArrayLike<number> = null, blend: number = -1): boolean {\r\n\t\tthis._drawCount++;\r\n\t\tvar rgba: number = 0xffffffff;\r\n\t\tif (this._mesh.vertNum + 4 > Context._MAXVERTNUM) {\r\n\t\t\tthis._mesh = MeshQuadTexture.getAMesh(this.isMain);//创建新的mesh  TODO 如果_mesh不是常见格式，这里就不能这么做了。以后把_mesh单独表示成常用模式 \r\n\t\t\tthis.meshlist.push(this._mesh);\r\n\t\t}\r\n\r\n\t\t//凡是这个都是在_mesh上操作，不用考虑samekey\r\n\t\tthis.transformQuad(x, y, width, height, 0, m || this._curMat, this._transedPoints);\r\n\t\tif (!this.clipedOff(this._transedPoints)) {\r\n\t\t\tthis._mesh.addQuad(this._transedPoints, uv || Texture.DEF_UV, 0xffffffff, true);\r\n\t\t\t//if (GlUtils.fillRectImgVb( _mesh._vb, _clipRect, x, y, width , height , uv || Texture.DEF_UV, m || _curMat, rgba, this)) {\r\n\t\t\tvar submit: SubmitTarget = this._curSubmit = SubmitTarget.create(this, this._mesh, shaderValue, rt);\r\n\t\t\tsubmit.blendType = (blend == -1) ? this._nBlendType : blend;\r\n\t\t\tthis._copyClipInfo((<SubmitBase>(submit as any)), this._globalClipMatrix);\r\n\t\t\tsubmit._numEle = 6;\r\n\t\t\tthis._mesh.indexNum += 6;\r\n\t\t\tthis._mesh.vertNum += 4;\r\n\t\t\tthis._submits[this._submits._length++] = submit;\r\n\t\t\t//暂时drawTarget不合并\r\n\t\t\tthis._curSubmit = SubmitBase.RENDERBASE\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t//暂时drawTarget不合并\r\n\t\tthis._curSubmit = SubmitBase.RENDERBASE\r\n\t\treturn false;\r\n\t}\r\n\r\n\tdrawTriangles(tex: Texture, x: number, y: number, vertices: Float32Array, uvs: Float32Array, indices: Uint16Array, matrix: Matrix, alpha: number, color: ColorFilter, blendMode: string, colorNum: number = 0xffffffff): void {\r\n\t\tif (!tex._getSource()) { //source内调用tex.active();\r\n\t\t\tif (this.sprite) {\r\n\t\t\t\tILaya.systemTimer.callLater(this, this._repaintSprite);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar oldcomp: string = null;\r\n\t\tif (blendMode) {\r\n\t\t\toldcomp = this.globalCompositeOperation;\r\n\t\t\tthis.globalCompositeOperation = blendMode;\r\n\t\t}\r\n\t\tthis._drawCount++;\r\n\r\n\t\t// 为了提高效率，把一些变量放到这里\r\n\t\tvar tmpMat: Matrix = this._tmpMatrix;\r\n\t\tvar triMesh: MeshTexture = this._triangleMesh;\r\n\r\n\t\tvar oldColorFilter: ColorFilter = null;\r\n\t\tvar needRestorFilter: boolean = false;\r\n\t\tif (color) {\r\n\t\t\toldColorFilter = this._colorFiler;\r\n\t\t\t//这个不用save，直接修改就行\r\n\t\t\tthis._colorFiler = color;\r\n\t\t\tthis._curSubmit = SubmitBase.RENDERBASE;\r\n\t\t\tneedRestorFilter = oldColorFilter != color;\r\n\t\t}\r\n\t\tvar webGLImg: Bitmap = (<Bitmap>tex.bitmap);\r\n\t\tvar preKey: SubmitKey = this._curSubmit._key;\r\n\t\tvar sameKey: boolean = preKey.submitType === SubmitBase.KEY_TRIANGLES && preKey.other === webGLImg.id && preKey.blendShader == this._nBlendType;\r\n\r\n\t\t//var rgba:int = mixRGBandAlpha(0xffffffff);\r\n\t\t//rgba = _mixRGBandAlpha(rgba, alpha);\t这个函数有问题，不能连续调用，输出作为输入\r\n\t\tif (triMesh.vertNum + vertices.length / 2 > Context._MAXVERTNUM) {\r\n\t\t\ttriMesh = this._triangleMesh = MeshTexture.getAMesh(this.isMain);//创建新的mesh  TODO 如果_mesh不是常见格式，这里就不能这么做了。以后把_mesh单独表示成常用模式 \r\n\t\t\tthis.meshlist.push(triMesh);\r\n\t\t\tsameKey = false;\t//新的mesh不能算samekey了\r\n\t\t}\r\n\t\tif (!sameKey) {\r\n\t\t\t//添加一个新的submit\r\n\t\t\tvar submit: SubmitTexture = this._curSubmit = SubmitTexture.create(this, triMesh, Value2D.create(ShaderDefines2D.TEXTURE2D, 0));\r\n\t\t\tsubmit.shaderValue.textureHost = tex;\r\n\t\t\tsubmit._renderType = SubmitBase.TYPE_TEXTURE;\r\n\t\t\tsubmit._key.submitType = SubmitBase.KEY_TRIANGLES;\r\n\t\t\tsubmit._key.other = webGLImg.id;\r\n\t\t\tthis._copyClipInfo(submit, this._globalClipMatrix);\r\n\t\t\tthis._submits[this._submits._length++] = submit;\r\n\t\t}\r\n\r\n\t\tvar rgba: number = this._mixRGBandAlpha(colorNum, this._shader2D.ALPHA * alpha);\r\n\t\tif (!this._drawTriUseAbsMatrix) {\r\n\t\t\tif (!matrix) {\r\n\t\t\t\ttmpMat.a = 1; tmpMat.b = 0; tmpMat.c = 0; tmpMat.d = 1; tmpMat.tx = x; tmpMat.ty = y;\r\n\t\t\t} else {\r\n\t\t\t\ttmpMat.a = matrix.a; tmpMat.b = matrix.b; tmpMat.c = matrix.c; tmpMat.d = matrix.d; tmpMat.tx = matrix.tx + x; tmpMat.ty = matrix.ty + y;\r\n\t\t\t}\r\n\t\t\tMatrix.mul(tmpMat, this._curMat, tmpMat);\r\n\t\t\ttriMesh.addData(vertices, uvs, indices, tmpMat || this._curMat, rgba);\r\n\t\t} else {\r\n\t\t\t// 这种情况是drawtexture转成的drawTriangle，直接使用matrix就行，传入的xy都是0\r\n\t\t\ttriMesh.addData(vertices, uvs, indices, matrix, rgba);\r\n\t\t}\r\n\t\tthis._curSubmit._numEle += indices.length;\r\n\r\n\t\tif (needRestorFilter) {\r\n\t\t\tthis._colorFiler = oldColorFilter;\r\n\t\t\tthis._curSubmit = SubmitBase.RENDERBASE;\r\n\t\t}\r\n\t\tif (blendMode) {\r\n\t\t\tthis.globalCompositeOperation = oldcomp;\r\n\t\t}\r\n\t\t//return true;\r\n\t}\r\n\r\n\ttransform(a: number, b: number, c: number, d: number, tx: number, ty: number): void {\r\n\t\tSaveTransform.save(this);\r\n\t\tMatrix.mul(Matrix.TEMP.setTo(a, b, c, d, tx, ty), this._curMat, this._curMat);\t//TODO 这里会有效率问题。一堆的set\r\n\t\tthis._curMat._checkTransform();\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\t/**@internal */\r\n\t_transformByMatrix(matrix: Matrix, tx: number, ty: number): void {\r\n\t\tmatrix.setTranslate(tx, ty);\r\n\t\tMatrix.mul(matrix, this._curMat, this._curMat);\r\n\t\tmatrix.setTranslate(0, 0);\r\n\t\tthis._curMat._bTransform = true;\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\tsetTransformByMatrix(value: Matrix): void {\r\n\t\tvalue.copyTo(this._curMat);\r\n\t}\r\n\r\n\trotate(angle: number): void {\r\n\t\tSaveTransform.save(this);\r\n\t\tthis._curMat.rotateEx(angle);\r\n\t}\r\n\r\n\tscale(scaleX: number, scaleY: number): void {\r\n\t\tSaveTransform.save(this);\r\n\t\tthis._curMat.scaleEx(scaleX, scaleY);\r\n\t}\r\n\r\n\tclipRect(x: number, y: number, width: number, height: number): void {\r\n\t\tSaveClipRect.save(this);\r\n\t\tif (this._clipRect == Context.MAXCLIPRECT) {\r\n\t\t\tthis._clipRect = new Rectangle(x, y, width, height);\r\n\t\t} else {\r\n\t\t\tthis._clipRect.width = width;\r\n\t\t\tthis._clipRect.height = height;\r\n\r\n\t\t\t//把xy转换到当前矩阵空间。宽高不用转换，这样在shader中计算的时候就不用把方向normalize了\r\n\t\t\tthis._clipRect.x = x;\r\n\t\t\tthis._clipRect.y = y;\r\n\t\t}\r\n\t\tthis._clipID_Gen++;\r\n\t\tthis._clipID_Gen %= 10000;\r\n\t\tthis._clipInfoID = this._clipID_Gen;\r\n\t\tvar cm: Matrix = this._globalClipMatrix;\r\n\t\t//TEMP 处理clip交集问题，这里有点问题，无法处理旋转，翻转 是临时瞎写的\r\n\t\tvar minx: number = cm.tx;\r\n\t\tvar miny: number = cm.ty;\r\n\t\tvar maxx: number = minx + cm.a;\r\n\t\tvar maxy: number = miny + cm.d;\r\n\t\t//TEMP end\r\n\r\n\t\tif (this._clipRect.width >= Context._MAXSIZE) {\r\n\t\t\tcm.a = cm.d = Context._MAXSIZE;\r\n\t\t\tcm.b = cm.c = cm.tx = cm.ty = 0;\r\n\t\t} else {\r\n\t\t\t//其实就是矩阵相乘\r\n\t\t\tif (this._curMat._bTransform) {\r\n\t\t\t\tcm.tx = this._clipRect.x * this._curMat.a + this._clipRect.y * this._curMat.c + this._curMat.tx;\r\n\t\t\t\tcm.ty = this._clipRect.x * this._curMat.b + this._clipRect.y * this._curMat.d + this._curMat.ty;\r\n\t\t\t\tcm.a = this._clipRect.width * this._curMat.a;\r\n\t\t\t\tcm.b = this._clipRect.width * this._curMat.b;\r\n\t\t\t\tcm.c = this._clipRect.height * this._curMat.c;\r\n\t\t\t\tcm.d = this._clipRect.height * this._curMat.d;\r\n\t\t\t} else {\r\n\t\t\t\tcm.tx = this._clipRect.x + this._curMat.tx;\r\n\t\t\t\tcm.ty = this._clipRect.y + this._curMat.ty;\r\n\t\t\t\tcm.a = this._clipRect.width;\r\n\t\t\t\tcm.b = cm.c = 0;\r\n\t\t\t\tcm.d = this._clipRect.height;\r\n\t\t\t}\r\n\t\t\tif (this._incache) {\r\n\t\t\t\tthis._clipInCache = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//TEMP 处理clip交集问题，这里有点问题，无法处理旋转,翻转\r\n\t\tif (cm.a > 0 && cm.d > 0) {\r\n\t\t\tvar cmaxx: number = cm.tx + cm.a;\r\n\t\t\tvar cmaxy: number = cm.ty + cm.d;\r\n\t\t\tif (cmaxx <= minx || cmaxy <= miny || cm.tx >= maxx || cm.ty >= maxy) {\r\n\t\t\t\t//超出范围了\r\n\t\t\t\tcm.a = -0.1; cm.d = -0.1;\r\n\t\t\t} else {\r\n\t\t\t\tif (cm.tx < minx) {\r\n\t\t\t\t\tcm.a -= (minx - cm.tx);\r\n\t\t\t\t\tcm.tx = minx;\r\n\t\t\t\t}\r\n\t\t\t\tif (cmaxx > maxx) {\r\n\t\t\t\t\tcm.a -= (cmaxx - maxx);\r\n\t\t\t\t}\r\n\t\t\t\tif (cm.ty < miny) {\r\n\t\t\t\t\tcm.d -= (miny - cm.ty);\r\n\t\t\t\t\tcm.ty = miny;\r\n\t\t\t\t}\r\n\t\t\t\tif (cmaxy > maxy) {\r\n\t\t\t\t\tcm.d -= (cmaxy - maxy);\r\n\t\t\t\t}\r\n\t\t\t\tif (cm.a <= 0) cm.a = -0.1;\r\n\t\t\t\tif (cm.d <= 0) cm.d = -0.1;\r\n\t\t\t}\r\n\t\t}\r\n\t\t//TEMP end\r\n\t}\r\n\r\n\t/**\r\n\t * 从setIBVB改为drawMesh\r\n\t * type 参数不知道是干什么的，先删掉。offset好像跟attribute有关，删掉\r\n\t * @param\tx\r\n\t * @param\ty\r\n\t * @param\tib\r\n\t * @param\tvb\r\n\t * @param\tnumElement\r\n\t * @param\tmat\r\n\t * @param\tshader\r\n\t * @param\tshaderValues\r\n\t * @param\tstartIndex\r\n\t * @param\toffset\r\n\t */\r\n\t//TODO:coverage\r\n\tdrawMesh(x: number, y: number, ib: IndexBuffer2D, vb: VertexBuffer2D, numElement: number, mat: Matrix, shader: Shader, shaderValues: Value2D, startIndex: number = 0): void {\r\n\t\t;\r\n\t}\r\n\r\n\taddRenderObject(o: ISubmit): void {\r\n\t\tthis._submits[this._submits._length++] = o;\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t * @param\tstart\r\n\t * @param\tend\r\n\t */\r\n\tsubmitElement(start: number, end: number): number {\r\n\t\t//_ib._bind_upload() || _ib._bind();\r\n\t\t//_vb._bind_upload() || _vb._bind();\r\n\t\tvar mainCtx: boolean = this.isMain;\r\n\t\tvar renderList: any[] = this._submits;\r\n\t\tvar ret: number = ((<any>renderList))._length;\r\n\t\tend < 0 && (end = ((<any>renderList))._length);\r\n\t\tvar submit: Submit = SubmitBase.RENDERBASE;\r\n\t\twhile (start < end) {\r\n\t\t\tthis._renderNextSubmitIndex = start + 1;\r\n\t\t\tif (renderList[start] === SubmitBase.RENDERBASE) {\r\n\t\t\t\tstart++;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tSubmitBase.preRender = submit;\r\n\t\t\tsubmit = renderList[start];\r\n\t\t\t//只有submitscissor才会返回多个\r\n\t\t\tstart += submit.renderSubmit();\r\n\t\t\t//本来做了个优化，如果是主画布，用完立即releaseRender. 但是实际没有什么效果，且由于submit需要用来对比，即使用完也不能修改，所以这个优化又去掉了\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tflush(): number {\r\n\t\tthis._clipID_Gen = 0;\r\n\t\tvar ret: number = this.submitElement(0, this._submits._length);\r\n\t\tthis._path && this._path.reset();\r\n\t\tSkinMeshBuffer.instance && SkinMeshBuffer.getInstance().reset();\r\n\r\n\t\t//Stat.mesh2DNum += meshlist.length;\r\n\t\tthis._curSubmit = SubmitBase.RENDERBASE;\r\n\r\n\t\tfor (var i: number = 0, sz: number = this.meshlist.length; i < sz; i++) {\r\n\t\t\tvar curm: Mesh2D = this.meshlist[i];\r\n\t\t\tcurm.canReuse ? (curm.releaseMesh()) : (curm.destroy());\r\n\t\t}\r\n\t\tthis.meshlist.length = 0;\r\n\r\n\t\tthis._mesh = MeshQuadTexture.getAMesh(this.isMain);\t//TODO 不要这样。\r\n\t\tthis._pathMesh = MeshVG.getAMesh(this.isMain);\r\n\t\tthis._triangleMesh = MeshTexture.getAMesh(this.isMain);\r\n\t\tthis.meshlist.push(this._mesh, this._pathMesh, this._triangleMesh);\r\n\r\n\t\tthis._flushCnt++;\r\n\t\t//charbook gc\r\n\t\tif (this._flushCnt % 60 == 0 && this.isMain) {\r\n\t\t\tif (TextRender.textRenderInst) {\r\n\t\t\t\tTextRender.textRenderInst.GC();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\t/*******************************************start矢量绘制***************************************************/\r\n\r\n\tbeginPath(convex: boolean = false): void {\r\n\t\tvar tPath: Path = this._getPath();\r\n\t\ttPath.beginPath(convex);\r\n\t}\r\n\r\n\tclosePath(): void {\r\n\t\t//_path.closePath = true;\r\n\t\tthis._path.closePath();\r\n\t}\r\n\r\n\t/**\r\n\t * 添加一个path。\r\n\t * @param\tpoints [x,y,x,y....]\t这个会被保存下来，所以调用者需要注意复制。\r\n\t * @param\tclose\t是否闭合\r\n\t * @param   convex 是否是凸多边形。convex的优先级是这个最大。fill的时候的次之。其实fill的时候不应该指定convex，因为可以多个path\r\n\t * @param\tdx  需要添加的平移。这个需要在应用矩阵之前应用。\r\n\t * @param\tdy\r\n\t */\r\n\taddPath(points: any[], close: boolean, convex: boolean, dx: number, dy: number): void {\r\n\t\tvar ci: number = 0;\r\n\t\tfor (var i: number = 0, sz: number = points.length / 2; i < sz; i++) {\r\n\t\t\tvar x1: number = points[ci] + dx, y1: number = points[ci + 1] + dy;\r\n\t\t\tpoints[ci] = x1;\r\n\t\t\tpoints[ci + 1] = y1;\r\n\t\t\tci += 2;\r\n\t\t}\r\n\t\tthis._getPath().push(points, convex);\r\n\t}\r\n\r\n\tfill(): void {\r\n\t\tvar m: Matrix = this._curMat;\r\n\t\tvar tPath: Path = this._getPath();\r\n\t\tvar submit: Submit = this._curSubmit;\r\n\t\tvar sameKey: boolean = (submit._key.submitType === SubmitBase.KEY_VG && submit._key.blendShader === this._nBlendType);\r\n\t\tsameKey && (sameKey = sameKey && this.isSameClipInfo(submit));\r\n\t\tif (!sameKey) {\r\n\t\t\tthis._curSubmit = this.addVGSubmit(this._pathMesh);\r\n\t\t}\r\n\t\tvar rgba: number = this.mixRGBandAlpha(this.fillStyle.toInt());\r\n\t\tvar curEleNum: number = 0;\r\n\t\tvar idx: any[];\r\n\t\t//如果有多个path的话，要一起填充mesh，使用相同的颜色和alpha\r\n\t\tfor (var i: number = 0, sz: number = tPath.paths.length; i < sz; i++) {\r\n\t\t\tvar p: any = tPath.paths[i];\r\n\t\t\tvar vertNum: number = p.path.length / 2;\r\n\t\t\tif (vertNum < 3 || (vertNum == 3 && !p.convex))\r\n\t\t\t\tcontinue;\r\n\t\t\tvar cpath: any[] = p.path.concat();\r\n\t\t\t// 应用矩阵转换顶点\r\n\t\t\tvar pi: number = 0;\r\n\t\t\tvar xp: number, yp: number;\r\n\t\t\tvar _x: number, _y: number;\r\n\t\t\tif (m._bTransform) {\r\n\t\t\t\tfor (pi = 0; pi < vertNum; pi++) {\r\n\t\t\t\t\txp = pi << 1;\r\n\t\t\t\t\typ = xp + 1;\r\n\t\t\t\t\t_x = cpath[xp];\r\n\t\t\t\t\t_y = cpath[yp];\r\n\r\n\t\t\t\t\tcpath[xp] = m.a * _x + m.c * _y + m.tx;\r\n\t\t\t\t\tcpath[yp] = m.b * _x + m.d * _y + m.ty;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor (pi = 0; pi < vertNum; pi++) {\r\n\t\t\t\t\txp = pi << 1;\r\n\t\t\t\t\typ = xp + 1;\r\n\t\t\t\t\t_x = cpath[xp];\r\n\t\t\t\t\t_y = cpath[yp];\r\n\t\t\t\t\tcpath[xp] = _x + m.tx;\r\n\t\t\t\t\tcpath[yp] = _y + m.ty;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this._pathMesh.vertNum + vertNum > Context._MAXVERTNUM) {\r\n\t\t\t\t//;\r\n\t\t\t\t//顶点数超了，要先提交一次\r\n\t\t\t\tthis._curSubmit._numEle += curEleNum;\r\n\t\t\t\tcurEleNum = 0;\r\n\t\t\t\t//然后用新的mesh，和新的submit。\r\n\t\t\t\tthis._pathMesh = MeshVG.getAMesh(this.isMain);\r\n\t\t\t\tthis._curSubmit = this.addVGSubmit(this._pathMesh);\r\n\t\t\t}\r\n\r\n\t\t\tvar curvert: number = this._pathMesh.vertNum;\r\n\t\t\t//生成 ib\r\n\t\t\tif (p.convex) { //convex的ib比较容易\r\n\t\t\t\tvar faceNum: number = vertNum - 2;\r\n\t\t\t\tidx = new Array(faceNum * 3);\r\n\t\t\t\tvar idxpos: number = 0;\r\n\t\t\t\tfor (var fi: number = 0; fi < faceNum; fi++) {\r\n\t\t\t\t\tidx[idxpos++] = curvert;\r\n\t\t\t\t\tidx[idxpos++] = fi + 1 + curvert;\r\n\t\t\t\t\tidx[idxpos++] = fi + 2 + curvert;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tidx = Earcut.earcut(cpath, null, 2);\t//返回索引\r\n\t\t\t\tif (curvert > 0) {\r\n\t\t\t\t\t//修改ib\r\n\t\t\t\t\tfor (var ii: number = 0; ii < idx.length; ii++) {\r\n\t\t\t\t\t\tidx[ii] += curvert;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//填充mesh\r\n\t\t\tthis._pathMesh.addVertAndIBToMesh(this, cpath, rgba, idx);\r\n\t\t\tcurEleNum += idx.length;\r\n\t\t}\r\n\t\tthis._curSubmit._numEle += curEleNum;\r\n\t}\r\n\r\n\tprivate addVGSubmit(mesh: Mesh2D): Submit {\r\n\t\t//elenum设为0，后面再加\r\n\t\tvar submit: Submit = Submit.createShape(this, mesh, 0, Value2D.create(ShaderDefines2D.PRIMITIVE, 0));\r\n\t\t//submit._key.clear();\r\n\t\t//submit._key.blendShader = _submitKey.blendShader;\t//TODO 这个在哪里赋值的啊\r\n\t\tsubmit._key.submitType = SubmitBase.KEY_VG;\r\n\t\tthis._submits[this._submits._length++] = submit;\r\n\t\tthis._copyClipInfo(submit, this._globalClipMatrix);\r\n\t\treturn submit;\r\n\t}\r\n\r\n\tstroke(): void {\r\n\t\tif (this.lineWidth > 0) {\r\n\t\t\tvar rgba: number = this.mixRGBandAlpha(this.strokeStyle._color.numColor);\r\n\t\t\tvar tPath: Path = this._getPath();\r\n\t\t\tvar submit: Submit = this._curSubmit;\r\n\t\t\tvar sameKey: boolean = (submit._key.submitType === SubmitBase.KEY_VG && submit._key.blendShader === this._nBlendType);\r\n\t\t\tsameKey && (sameKey = sameKey && this.isSameClipInfo(submit));\r\n\r\n\t\t\tif (!sameKey) {\r\n\t\t\t\tthis._curSubmit = this.addVGSubmit(this._pathMesh);\r\n\t\t\t}\r\n\t\t\tvar curEleNum: number = 0;\r\n\t\t\t//如果有多个path的话，要一起填充mesh，使用相同的颜色和alpha\r\n\t\t\tfor (var i: number = 0, sz: number = tPath.paths.length; i < sz; i++) {\r\n\t\t\t\tvar p: any = tPath.paths[i];\r\n\t\t\t\tif (p.path.length <= 0)\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tvar idx: any[] = [];\r\n\t\t\t\tvar vertex: any[] = [];//x,y\r\n\t\t\t\t//p.path.loop;\r\n\t\t\t\t//填充vbib\r\n\t\t\t\tvar maxVertexNum: number = p.path.length * 2;\t//最大可能产生的顶点数。这个需要考虑考虑\r\n\t\t\t\tif (maxVertexNum < 2)\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tif (this._pathMesh.vertNum + maxVertexNum > Context._MAXVERTNUM) {\r\n\t\t\t\t\t//;\r\n\t\t\t\t\t//顶点数超了，要先提交一次\r\n\t\t\t\t\tthis._curSubmit._numEle += curEleNum;\r\n\t\t\t\t\tcurEleNum = 0;\r\n\t\t\t\t\t//然后用新的mesh，和新的submit。\r\n\t\t\t\t\tthis._pathMesh = MeshVG.getAMesh(this.isMain);\r\n\t\t\t\t\tthis.meshlist.push(this._pathMesh);\r\n\t\t\t\t\tthis._curSubmit = this.addVGSubmit(this._pathMesh);\r\n\t\t\t\t}\r\n\t\t\t\t//这个需要放在创建新的mesh的后面，因为需要mesh.vertNum,否则如果先调用这个，再创建mesh，那么ib就不对了\r\n\t\t\t\tBasePoly.createLine2(p.path, idx, this.lineWidth, this._pathMesh.vertNum, vertex, p.loop);\t//_pathMesh.vertNum 是要加到生成的ib上的\r\n\t\t\t\t// 变换所有的点\r\n\t\t\t\tvar ptnum: number = vertex.length / 2;\r\n\t\t\t\tvar m: Matrix = this._curMat;\r\n\t\t\t\tvar pi: number = 0;\r\n\t\t\t\tvar xp: number, yp: number;\r\n\t\t\t\tvar _x: number, _y: number;\r\n\t\t\t\tif (m._bTransform) {\r\n\t\t\t\t\tfor (pi = 0; pi < ptnum; pi++) {\r\n\t\t\t\t\t\txp = pi << 1;\r\n\t\t\t\t\t\typ = xp + 1;\r\n\t\t\t\t\t\t_x = vertex[xp];\r\n\t\t\t\t\t\t_y = vertex[yp];\r\n\r\n\t\t\t\t\t\tvertex[xp] = m.a * _x + m.c * _y + m.tx;\r\n\t\t\t\t\t\tvertex[yp] = m.b * _x + m.d * _y + m.ty;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (pi = 0; pi < ptnum; pi++) {\r\n\t\t\t\t\t\txp = pi << 1;\r\n\t\t\t\t\t\typ = xp + 1;\r\n\t\t\t\t\t\t_x = vertex[xp];\r\n\t\t\t\t\t\t_y = vertex[yp];\r\n\t\t\t\t\t\tvertex[xp] = _x + m.tx;\r\n\t\t\t\t\t\tvertex[yp] = _y + m.ty;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//this.drawPoly(0, 0, p.path, fillStyle._color.numColor, 0, 0, p.convex);\r\n\t\t\t\t//填充mesh\r\n\t\t\t\tthis._pathMesh.addVertAndIBToMesh(this, vertex, rgba, idx);\r\n\t\t\t\tcurEleNum += idx.length;\r\n\t\t\t}\r\n\t\t\tthis._curSubmit._numEle += curEleNum;\r\n\t\t}\r\n\t}\r\n\r\n\tmoveTo(x: number, y: number): void {\r\n\t\tvar tPath: Path = this._getPath();\r\n\t\ttPath.newPath();\r\n\t\ttPath._lastOriX = x;\r\n\t\ttPath._lastOriY = y;\r\n\t\ttPath.addPoint(x, y);\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t * @param\tx\r\n\t * @param\ty\r\n\t * @param\tb 是否应用矩阵\r\n\t */\r\n\tlineTo(x: number, y: number): void {\r\n\t\tvar tPath: Path = this._getPath();\r\n\t\tif (Math.abs(x - tPath._lastOriX) < 1e-3 && Math.abs(y - tPath._lastOriY) < 1e-3)//不判断的话，下面的画线算法受不了\r\n\t\t\treturn;\r\n\t\ttPath._lastOriX = x;\r\n\t\ttPath._lastOriY = y;\r\n\t\ttPath.addPoint(x, y);\r\n\t}\r\n\t/*\r\n\tpublic function drawCurves(x:Number, y:Number,points:Array, lineColor:*, lineWidth:Number = 1):void {\r\n\t\t//setPathId(-1);\r\n\t\tbeginPath();\r\n\t\tstrokeStyle = lineColor;\r\n\t\tthis.lineWidth = lineWidth;\r\n\t\tvar points:Array = points;\r\n\t\t//movePath(x, y); TODO 这个被去掉了\r\n\t\tmoveTo(points[0], points[1]);\r\n\t\tvar i:int = 2, n:int = points.length;\r\n\t\twhile (i < n) {\r\n\t\t\tquadraticCurveTo(points[i++], points[i++], points[i++], points[i++]);\r\n\t\t}\r\n\t\tstroke();\r\n\t}\r\n\t*/\r\n\r\n\tarcTo(x1: number, y1: number, x2: number, y2: number, r: number): void {\r\n\t\t/*\r\n\t\tif (mId != -1) {\r\n\t\t\tif (mHaveKey) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\t\tvar i: number = 0;\r\n\t\tvar x: number = 0, y: number = 0;\r\n\t\tvar dx: number = this._path._lastOriX - x1;\r\n\t\tvar dy: number = this._path._lastOriY - y1;\r\n\t\tvar len1: number = Math.sqrt(dx * dx + dy * dy);\r\n\t\tif (len1 <= 0.000001) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar ndx: number = dx / len1;\r\n\t\tvar ndy: number = dy / len1;\r\n\t\tvar dx2: number = x2 - x1;\r\n\t\tvar dy2: number = y2 - y1;\r\n\t\tvar len22: number = dx2 * dx2 + dy2 * dy2;\r\n\t\tvar len2: number = Math.sqrt(len22);\r\n\t\tif (len2 <= 0.000001) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar ndx2: number = dx2 / len2;\r\n\t\tvar ndy2: number = dy2 / len2;\r\n\t\tvar odx: number = ndx + ndx2;\r\n\t\tvar ody: number = ndy + ndy2;\r\n\t\tvar olen: number = Math.sqrt(odx * odx + ody * ody);\r\n\t\tif (olen <= 0.000001) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar nOdx: number = odx / olen;\r\n\t\tvar nOdy: number = ody / olen;\r\n\r\n\t\tvar alpha: number = Math.acos(nOdx * ndx + nOdy * ndy);\r\n\t\tvar halfAng: number = Math.PI / 2 - alpha;\r\n\r\n\t\tlen1 = r / Math.tan(halfAng);\r\n\t\tvar ptx1: number = len1 * ndx + x1;\r\n\t\tvar pty1: number = len1 * ndy + y1;\r\n\r\n\t\tvar orilen: number = Math.sqrt(len1 * len1 + r * r);\r\n\t\t//圆心\r\n\t\tvar orix: number = x1 + nOdx * orilen;\r\n\t\tvar oriy: number = y1 + nOdy * orilen;\r\n\r\n\t\tvar ptx2: number = len1 * ndx2 + x1;\r\n\t\tvar pty2: number = len1 * ndy2 + y1;\r\n\r\n\t\tvar dir: number = ndx * ndy2 - ndy * ndx2;\r\n\r\n\t\tvar fChgAng: number = 0;\r\n\t\tvar sinx: number = 0.0;\r\n\t\tvar cosx: number = 0.0;\r\n\t\tif (dir >= 0) {\r\n\t\t\tfChgAng = halfAng * 2;\r\n\t\t\tvar fda: number = fChgAng / Context.SEGNUM;\r\n\t\t\tsinx = Math.sin(fda);\r\n\t\t\tcosx = Math.cos(fda);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfChgAng = -halfAng * 2;\r\n\t\t\tfda = fChgAng / Context.SEGNUM;\r\n\t\t\tsinx = Math.sin(fda);\r\n\t\t\tcosx = Math.cos(fda);\r\n\t\t}\r\n\r\n\t\t//x = _curMat.a * ptx1 + _curMat.c * pty1 /*+ _curMat.tx*/;\r\n\t\t//y = _curMat.b * ptx1 + _curMat.d * pty1 /*+ _curMat.ty*/;\r\n\t\tvar lastx: number = this._path._lastOriX, lasty: number = this._path._lastOriY;\t//没有矩阵转换的上一个点\r\n\t\tvar _x1: number = ptx1, _y1: number = pty1;\r\n\t\tif (Math.abs(_x1 - this._path._lastOriX) > 0.1 || Math.abs(_y1 - this._path._lastOriY) > 0.1) {\r\n\t\t\tx = _x1;// _curMat.a * _x1 + _curMat.c * _y1 + _curMat.tx;\r\n\t\t\ty = _y1;//_curMat.b * _x1 + _curMat.d * _y1 + _curMat.ty;\r\n\t\t\tlastx = _x1;\r\n\t\t\tlasty = _y1;\r\n\t\t\tthis._path._lastOriX = x;\r\n\t\t\tthis._path._lastOriY = y;\r\n\t\t\tthis._path.addPoint(x, y);\r\n\t\t}\r\n\t\tvar cvx: number = ptx1 - orix;\r\n\t\tvar cvy: number = pty1 - oriy;\r\n\t\tvar tx: number = 0.0;\r\n\t\tvar ty: number = 0.0;\r\n\t\tfor (i = 0; i < Context.SEGNUM; i++) {\r\n\t\t\tvar cx: number = cvx * cosx + cvy * sinx;\r\n\t\t\tvar cy: number = -cvx * sinx + cvy * cosx;\r\n\t\t\tx = cx + orix;\r\n\t\t\ty = cy + oriy;\r\n\r\n\t\t\t//x1 = _curMat.a * x + _curMat.c * y /*+ _curMat.tx*/;\r\n\t\t\t//y1 = _curMat.b * x + _curMat.d * y /*+ _curMat.ty*/;\r\n\t\t\t//x = x1;\r\n\t\t\t//y = y1;\r\n\t\t\tif (Math.abs(lastx - x) > 0.1 || Math.abs(lasty - y) > 0.1) {\r\n\t\t\t\t//var _tx1:Number = x, _ty1:Number = y;\r\n\t\t\t\t//x = _curMat.a * _tx1 + _curMat.c * _ty1 + _curMat.tx;\r\n\t\t\t\t//y = _curMat.b * _tx1 + _curMat.d * _ty1 + _curMat.ty;\r\n\t\t\t\tthis._path._lastOriX = x;\r\n\t\t\t\tthis._path._lastOriY = y;\r\n\t\t\t\tthis._path.addPoint(x, y);\r\n\t\t\t\tlastx = x;\r\n\t\t\t\tlasty = y;\r\n\t\t\t}\r\n\t\t\tcvx = cx;\r\n\t\t\tcvy = cy;\r\n\t\t}\r\n\t}\r\n\r\n\tarc(cx: number, cy: number, r: number, startAngle: number, endAngle: number, counterclockwise: boolean = false, b: boolean = true): void {\r\n\t\t/* TODO 缓存还没想好\r\n\t\tif (mId != -1) {\r\n\t\t\tvar tShape:IShape = VectorGraphManager.getInstance().shapeDic[this.mId];\r\n\t\t\tif (tShape) {\r\n\t\t\t\tif (mHaveKey && !tShape.needUpdate(_curMat))\r\n\t\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcx = 0;\r\n\t\t\tcy = 0;\r\n\t\t}\r\n\t\t*/\r\n\t\tvar a: number = 0, da: number = 0, hda: number = 0, kappa: number = 0;\r\n\t\tvar dx: number = 0, dy: number = 0, x: number = 0, y: number = 0, tanx: number = 0, tany: number = 0;\r\n\t\tvar px: number = 0, py: number = 0, ptanx: number = 0, ptany: number = 0;\r\n\t\tvar i: number, ndivs: number, nvals: number;\r\n\r\n\t\t// Clamp angles\r\n\t\tda = endAngle - startAngle;\r\n\t\tif (!counterclockwise) {\r\n\t\t\tif (Math.abs(da) >= Math.PI * 2) {\r\n\t\t\t\tda = Math.PI * 2;\r\n\t\t\t} else {\r\n\t\t\t\twhile (da < 0.0) {\r\n\t\t\t\t\tda += Math.PI * 2;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (Math.abs(da) >= Math.PI * 2) {\r\n\t\t\t\tda = -Math.PI * 2;\r\n\t\t\t} else {\r\n\t\t\t\twhile (da > 0.0) {\r\n\t\t\t\t\tda -= Math.PI * 2;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sx: number = this.getMatScaleX();\r\n\t\tvar sy: number = this.getMatScaleY();\r\n\t\tvar sr: number = r * (sx > sy ? sx : sy);\r\n\t\tvar cl: number = 2 * Math.PI * sr;\r\n\t\tndivs = (Math.max(cl / 10, 10)) | 0;\r\n\r\n\t\thda = (da / ndivs) / 2.0;\r\n\t\tkappa = Math.abs(4 / 3 * (1 - Math.cos(hda)) / Math.sin(hda));\r\n\t\tif (counterclockwise)\r\n\t\t\tkappa = -kappa;\r\n\r\n\t\tnvals = 0;\r\n\t\tvar tPath: Path = this._getPath();\r\n\t\tvar _x1: number, _y1: number;\r\n\t\tfor (i = 0; i <= ndivs; i++) {\r\n\t\t\ta = startAngle + da * (i / ndivs);\r\n\t\t\tdx = Math.cos(a);\r\n\t\t\tdy = Math.sin(a);\r\n\t\t\tx = cx + dx * r;\r\n\t\t\ty = cy + dy * r;\r\n\t\t\tif (x != this._path._lastOriX || y != this._path._lastOriY) {\r\n\t\t\t\t//var _tx1:Number = x, _ty1:Number = y;\r\n\t\t\t\t//x = _curMat.a * _tx1 + _curMat.c * _ty1 + _curMat.tx;\r\n\t\t\t\t//y = _curMat.b * _tx1 + _curMat.d * _ty1 + _curMat.ty;\r\n\t\t\t\ttPath.addPoint(x, y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tdx = Math.cos(endAngle);\r\n\t\tdy = Math.sin(endAngle);\r\n\t\tx = cx + dx * r;\r\n\t\ty = cy + dy * r;\r\n\t\tif (x != this._path._lastOriX || y != this._path._lastOriY) {\r\n\t\t\t//var _x2:Number = x, _y2:Number = y;\r\n\t\t\t//x = _curMat.a * _x2 + _curMat.c * _y2 + _curMat.tx;\r\n\t\t\t//y = _curMat.b * _x2 + _curMat.d * _y2 + _curMat.ty;\r\n\t\t\ttPath.addPoint(x, y);\r\n\t\t}\r\n\t}\r\n\r\n\tquadraticCurveTo(cpx: number, cpy: number, x: number, y: number): void {\r\n\t\tvar tBezier: Bezier = Bezier.I;\r\n\t\tvar tResultArray: any[] = [];\r\n\t\t//var _x1:Number = x, _y1:Number = y;\r\n\t\t//x = _curMat.a * _x1 + _curMat.c * _y1 ;// + _curMat.tx;\r\n\t\t//y = _curMat.b * _x1 + _curMat.d * _y1;// + _curMat.ty;\r\n\t\t//_x1 = cpx, _y1 = cpy;\r\n\t\t//cpx = _curMat.a * _x1 + _curMat.c * _y1;// + _curMat.tx;\r\n\t\t//cpy = _curMat.b * _x1 + _curMat.d * _y1;// + _curMat.ty;\r\n\t\tvar tArray: any[] = tBezier.getBezierPoints([this._path._lastOriX, this._path._lastOriY, cpx, cpy, x, y], 30, 2);\r\n\t\tfor (var i: number = 0, n: number = tArray.length / 2; i < n; i++) {\r\n\t\t\tthis.lineTo(tArray[i * 2], tArray[i * 2 + 1]);\r\n\t\t}\r\n\t\tthis.lineTo(x, y);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * 把颜色跟当前设置的alpha混合\r\n\t * @return\r\n\t */\r\n\tmixRGBandAlpha(color: number): number {\r\n\t\treturn this._mixRGBandAlpha(color, this._shader2D.ALPHA);\r\n\t}\r\n\t/**@internal */\r\n\t_mixRGBandAlpha(color: number, alpha: number): number {\r\n\t\tif (alpha >= 1) {\r\n\t\t\treturn color;\r\n\t\t}\r\n\t\tvar a: number = ((color & 0xff000000) >>> 24);\r\n\t\t//TODO 这里容易出问题，例如颜色的alpha部分虽然为0，但是他的意义就是0，不能假设是没有设置alpha。例如级联多个alpha就会生成这种结果\r\n\t\tif (a != 0) {\r\n\t\t\ta *= alpha;\r\n\t\t} else {\r\n\t\t\ta = alpha * 255;\r\n\t\t}\r\n\t\treturn (color & 0x00ffffff) | (a << 24);\r\n\t}\r\n\r\n\tstrokeRect(x: number, y: number, width: number, height: number, parameterLineWidth: number): void {\r\n\t\tvar tW: number = parameterLineWidth * 0.5;\r\n\t\t//line(x - tW, y, x + width + tW, y, parameterLineWidth, _curMat);\r\n\t\t//line(x + width, y, x + width, y + height, parameterLineWidth, _curMat);\r\n\t\t//line(x, y, x, y + height, parameterLineWidth, _curMat);\r\n\t\t//line(x - tW, y + height, x + width + tW, y + height, parameterLineWidth, _curMat);\r\n\t\t/**\r\n\t\t * p1-------------------------------p2\r\n\t\t * |  x,y                      x+w,y|\r\n\t\t * |     p4--------------------p3   |\r\n\t\t * |     |                     |    |\r\n\t\t * |     p6--------------------p7   |\r\n\t\t * |  x,y+h                  x+w,y+h|\r\n\t\t * p5-------------------------------p8\r\n\t\t * \r\n\t\t * 不用了\r\n\t\t * 这个其实用4个fillrect拼起来更好，能与fillrect合并。虽然多了几个点。\r\n\t\t */\r\n\t\t//TODO 这里能不能与下面的stroke合并一下\r\n\t\tif (this.lineWidth > 0) {\r\n\t\t\tvar rgba: number = this.mixRGBandAlpha(this.strokeStyle._color.numColor);\r\n\t\t\tvar hw: number = this.lineWidth / 2;\r\n\t\t\tthis._fillRect(x - hw, y - hw, width + this.lineWidth, this.lineWidth, rgba);\t\t\t\t//上\r\n\t\t\tthis._fillRect(x - hw, y - hw + height, width + this.lineWidth, this.lineWidth, rgba);\t\t//下\r\n\t\t\tthis._fillRect(x - hw, y + hw, this.lineWidth, height - this.lineWidth, rgba);\t\t\t\t\t//左\r\n\t\t\tthis._fillRect(x - hw + width, y + hw, this.lineWidth, height - this.lineWidth, rgba);\t\t\t//右\r\n\t\t}\r\n\t}\r\n\r\n\tclip(): void {\r\n\t}\r\n\r\n\t/*******************************************end矢量绘制***************************************************/\r\n\t//TODO:coverage\r\n\tdrawParticle(x: number, y: number, pt: any): void {\r\n\t\tpt.x = x;\r\n\t\tpt.y = y;\r\n\t\tthis._submits[this._submits._length++] = pt;\r\n\t}\r\n\r\n\tprivate _getPath(): Path {\r\n\t\treturn this._path || (this._path = new Path());\r\n\t}\r\n\r\n\t/**获取canvas*/\r\n\t//注意这个是对外接口\r\n\tget canvas(): HTMLCanvas {\r\n\t\treturn this._canvas;\r\n\t}\r\n\t//=============新增==================\t\r\n\t/* 下面的方式是有bug的。canvas是直接save，restore，现在是为了优化，但是有bug，所以先不重载了\r\n\tpublic function saveTransform(matrix:Matrix):void {\r\n\t\tthis._curMat.copyTo(matrix);\r\n\t}\r\n\t\r\n\tpublic function restoreTransform(matrix:Matrix):void {\r\n\t\tmatrix.copyTo(this._curMat);\r\n\t}\r\n\t\r\n\tpublic function transformByMatrix(matrix:Matrix,tx:Number,ty:Number):void {\r\n\t\tvar mat:Matrix = _curMat;\r\n\t\tmatrix.setTranslate(tx, ty);\r\n\t\tMatrix.mul(matrix, mat, mat);\r\n\t\tmatrix.setTranslate(0, 0);\r\n\t\tmat._bTransform = true;\r\n\t}\r\n\t*/\r\n\r\n\t/* 下面的是错误的。位置没有被缩放\r\n\tpublic function transformByMatrix(matrix:Matrix, tx:Number, ty:Number):void {\r\n\t\tSaveTransform.save(this);\t\t\t\r\n\t\tMatrix.mul(matrix, _curMat, _curMat);\t\r\n\t\t_curMat.tx += tx;\r\n\t\t_curMat.ty += ty;\r\n\t\t_curMat._checkTransform();\r\n\t}\r\n\t\t\t\r\n\tpublic function transformByMatrixNoSave(matrix:Matrix, tx:Number, ty:Number):void {\r\n\t\tMatrix.mul(matrix, _curMat, _curMat);\t\r\n\t\t_curMat.tx += tx;\r\n\t\t_curMat.ty += ty;\r\n\t\t_curMat._checkTransform();\r\n\t}\r\n\t*/\r\n\r\n\tprivate static tmpuv1: any[] = [0, 0, 0, 0, 0, 0, 0, 0];\r\n\t/**\r\n\t * 专用函数。通过循环创建来水平填充\r\n\t * @param\ttex\r\n\t * @param\tbmpid\r\n\t * @param\tuv\t\t希望循环的部分的uv\r\n\t * @param\toriw\r\n\t * @param\torih\r\n\t * @param\tx\r\n\t * @param\ty\r\n\t * @param\tw\r\n\t */\r\n\tprivate _fillTexture_h(tex: Texture, imgid: number, uv: ArrayLike<number>, oriw: number, orih: number, x: number, y: number, w: number): void {\r\n\t\tif(oriw<=0) \r\n\t\t\tconsole.error('_fillTexture_h error: oriw must>0');\r\n\r\n\t\tvar stx: number = x;\r\n\t\tvar num: number = Math.floor(w / oriw);\r\n\t\tvar left: number = w % oriw;\r\n\t\tfor (var i: number = 0; i < num; i++) {\r\n\t\t\tthis._inner_drawTexture(tex, imgid, stx, y, oriw, orih, this._curMat, uv, 1, false);\r\n\t\t\tstx += oriw;\r\n\t\t}\r\n\t\t// 最后剩下的\r\n\t\tif (left > 0) {\r\n\t\t\tvar du: number = uv[2] - uv[0];\r\n\t\t\tvar uvr: number = uv[0] + du * (left / oriw);\r\n\t\t\tvar tuv: any[] = Context.tmpuv1;\r\n\t\t\ttuv[0] = uv[0]; tuv[1] = uv[1]; tuv[2] = uvr; tuv[3] = uv[3];\r\n\t\t\ttuv[4] = uvr; tuv[5] = uv[5]; tuv[6] = uv[6]; tuv[7] = uv[7];\r\n\t\t\tthis._inner_drawTexture(tex, imgid, stx, y, left, orih, this._curMat, tuv, 1, false);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 专用函数。通过循环创建来垂直填充\r\n\t * @param\ttex\r\n\t * @param\timgid\r\n\t * @param\tuv\r\n\t * @param\toriw\r\n\t * @param\torih\r\n\t * @param\tx\r\n\t * @param\ty\r\n\t * @param\th\r\n\t */\r\n\tprivate _fillTexture_v(tex: Texture, imgid: number, uv: ArrayLike<number>, oriw: number, orih: number, x: number, y: number, h: number): void {\r\n\t\tif(orih<=0) \r\n\t\t\tconsole.error('_fillTexture_v error: orih must>0');\r\n\t\tvar sty: number = y;\r\n\t\tvar num: number = Math.floor(h / orih);\r\n\t\tvar left: number = h % orih;\r\n\t\tfor (var i: number = 0; i < num; i++) {\r\n\t\t\tthis._inner_drawTexture(tex, imgid, x, sty, oriw, orih, this._curMat, uv, 1, false);\r\n\t\t\tsty += orih;\r\n\t\t}\r\n\t\t// 最后剩下的\r\n\t\tif (left > 0) {\r\n\t\t\tvar dv: number = uv[7] - uv[1];\r\n\t\t\tvar uvb: number = uv[1] + dv * (left / orih);\r\n\t\t\tvar tuv: any[] = Context.tmpuv1;\r\n\t\t\ttuv[0] = uv[0]; tuv[1] = uv[1]; tuv[2] = uv[2]; tuv[3] = uv[3];\r\n\t\t\ttuv[4] = uv[4]; tuv[5] = uvb; tuv[6] = uv[6]; tuv[7] = uvb;\r\n\t\t\tthis._inner_drawTexture(tex, imgid, x, sty, oriw, left, this._curMat, tuv, 1, false);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static tmpUV: any[] = [0, 0, 0, 0, 0, 0, 0, 0];\r\n\tprivate static tmpUVRect: any[] = [0, 0, 0, 0];\r\n\tdrawTextureWithSizeGrid(tex: Texture, tx: number, ty: number, width: number, height: number, sizeGrid: any[], gx: number, gy: number): void {\r\n\t\tif (!tex._getSource())\r\n\t\t\treturn;\r\n\t\ttx += gx;\r\n\t\tty += gy;\r\n\r\n\t\tvar uv = tex.uv, w: number = tex.bitmap.width, h: number = tex.bitmap.height;\r\n\r\n\t\tvar top: number = sizeGrid[0];\r\n\t\tvar left: number = sizeGrid[3];\r\n\t\tvar right: number = sizeGrid[1];\r\n\t\tvar bottom: number = sizeGrid[2];\r\n\t\tvar repeat: boolean = sizeGrid[4];\r\n\t\tvar needClip: boolean = false;\r\n\r\n\t\tif (width == w) {\r\n\t\t\tleft = right = 0;\r\n\t\t}\r\n\t\tif (height == h) {\r\n\t\t\ttop = bottom = 0;\r\n\t\t}\r\n\r\n\t\tvar d_top: number = top / h;\r\n\t\tvar d_left: number = left / w;\r\n\t\tvar d_right: number = right / w;\r\n\t\tvar d_bottom: number = bottom / h;\r\n\r\n\t\t//处理进度条不好看的问题\r\n\t\tif (left + right > width) {\r\n\t\t\tvar clipWidth: number = width;\r\n\t\t\tneedClip = true;\r\n\t\t\twidth = left + right;\r\n\t\t\tthis.save();\r\n\t\t\tthis.clipRect(0 + tx, 0 + ty, clipWidth, height);\r\n\t\t}\r\n\r\n\t\tvar imgid: number = (tex.bitmap as Texture2D).id;\r\n\t\tvar mat: Matrix = this._curMat;\r\n\t\tvar tuv = this._tempUV;\r\n\t\t// 整图的uv\r\n\t\t// 一定是方的，所以uv只要左上右下就行\r\n\t\tvar uvl: number = uv[0];\r\n\t\tvar uvt: number = uv[1];\r\n\t\tvar uvr: number = uv[4];\r\n\t\tvar uvb: number = uv[5];\r\n\r\n\t\t// 小图的uv\r\n\t\tvar uvl_: number = uvl;\r\n\t\tvar uvt_: number = uvt;\r\n\t\tvar uvr_: number = uvr;\r\n\t\tvar uvb_: number = uvb;\r\n\r\n\t\t//绘制四个角\r\n\t\t// 构造uv\r\n\t\tif (left && top) {\r\n\t\t\tuvr_ = uvl + d_left;\r\n\t\t\tuvb_ = uvt + d_top;\r\n\t\t\ttuv[0] = uvl, tuv[1] = uvt, tuv[2] = uvr_, tuv[3] = uvt,\r\n\t\t\t\ttuv[4] = uvr_, tuv[5] = uvb_, tuv[6] = uvl, tuv[7] = uvb_;\r\n\t\t\tthis._inner_drawTexture(tex, imgid, tx, ty, left, top, mat, tuv, 1, false);\r\n\t\t}\r\n\t\tif (right && top) {\r\n\t\t\tuvl_ = uvr - d_right; uvt_ = uvt;\r\n\t\t\tuvr_ = uvr; uvb_ = uvt + d_top;\r\n\t\t\ttuv[0] = uvl_, tuv[1] = uvt_, tuv[2] = uvr_, tuv[3] = uvt_,\r\n\t\t\t\ttuv[4] = uvr_, tuv[5] = uvb_, tuv[6] = uvl_, tuv[7] = uvb_;\r\n\t\t\tthis._inner_drawTexture(tex, imgid, width - right + tx, 0 + ty, right, top, mat, tuv, 1, false);\r\n\t\t}\r\n\t\tif (left && bottom) {\r\n\t\t\tuvl_ = uvl; uvt_ = uvb - d_bottom;\r\n\t\t\tuvr_ = uvl + d_left; uvb_ = uvb;\r\n\t\t\ttuv[0] = uvl_, tuv[1] = uvt_, tuv[2] = uvr_, tuv[3] = uvt_,\r\n\t\t\t\ttuv[4] = uvr_, tuv[5] = uvb_, tuv[6] = uvl_, tuv[7] = uvb_;\r\n\t\t\tthis._inner_drawTexture(tex, imgid, 0 + tx, height - bottom + ty, left, bottom, mat, tuv, 1, false);\r\n\t\t}\r\n\t\tif (right && bottom) {\r\n\t\t\tuvl_ = uvr - d_right; uvt_ = uvb - d_bottom;\r\n\t\t\tuvr_ = uvr; uvb_ = uvb;\r\n\t\t\ttuv[0] = uvl_, tuv[1] = uvt_, tuv[2] = uvr_, tuv[3] = uvt_,\r\n\t\t\t\ttuv[4] = uvr_, tuv[5] = uvb_, tuv[6] = uvl_, tuv[7] = uvb_;\r\n\t\t\tthis._inner_drawTexture(tex, imgid, width - right + tx, height - bottom + ty, right, bottom, mat, tuv, 1, false);\r\n\t\t}\r\n\t\t//绘制上下两个边\r\n\t\tif (top) {\r\n\t\t\tuvl_ = uvl + d_left; uvt_ = uvt;\r\n\t\t\tuvr_ = uvr - d_right; uvb_ = uvt + d_top;\r\n\t\t\ttuv[0] = uvl_, tuv[1] = uvt_, tuv[2] = uvr_, tuv[3] = uvt_,\r\n\t\t\t\ttuv[4] = uvr_, tuv[5] = uvb_, tuv[6] = uvl_, tuv[7] = uvb_;\r\n\t\t\tif (repeat) {\r\n\t\t\t\tthis._fillTexture_h(tex, imgid, tuv, tex.width - left - right, top, left + tx, ty, width - left - right);\r\n\t\t\t} else {\r\n\t\t\t\tthis._inner_drawTexture(tex, imgid, left + tx, ty, width - left - right, top, mat, tuv, 1, false);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tif (bottom) {\r\n\t\t\tuvl_ = uvl + d_left; uvt_ = uvb - d_bottom;\r\n\t\t\tuvr_ = uvr - d_right; uvb_ = uvb;\r\n\t\t\ttuv[0] = uvl_, tuv[1] = uvt_, tuv[2] = uvr_, tuv[3] = uvt_,\r\n\t\t\t\ttuv[4] = uvr_, tuv[5] = uvb_, tuv[6] = uvl_, tuv[7] = uvb_;\r\n\t\t\tif (repeat) {\r\n\t\t\t\tthis._fillTexture_h(tex, imgid, tuv, tex.width - left - right, bottom, left + tx, height - bottom + ty, width - left - right);\r\n\t\t\t} else {\r\n\t\t\t\tthis._inner_drawTexture(tex, imgid, left + tx, height - bottom + ty, width - left - right, bottom, mat, tuv, 1, false);\r\n\t\t\t}\r\n\t\t}\r\n\t\t//绘制左右两边\r\n\t\tif (left) {\r\n\t\t\tuvl_ = uvl; uvt_ = uvt + d_top;\r\n\t\t\tuvr_ = uvl + d_left; uvb_ = uvb - d_bottom;\r\n\t\t\ttuv[0] = uvl_, tuv[1] = uvt_, tuv[2] = uvr_, tuv[3] = uvt_,\r\n\t\t\t\ttuv[4] = uvr_, tuv[5] = uvb_, tuv[6] = uvl_, tuv[7] = uvb_;\r\n\t\t\tif (repeat) {\r\n\t\t\t\tthis._fillTexture_v(tex, imgid, tuv, left, tex.height - top - bottom, tx, top + ty, height - top - bottom);\r\n\t\t\t} else {\r\n\t\t\t\tthis._inner_drawTexture(tex, imgid, tx, top + ty, left, height - top - bottom, mat, tuv, 1, false);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (right) {\r\n\t\t\tuvl_ = uvr - d_right; uvt_ = uvt + d_top;\r\n\t\t\tuvr_ = uvr; uvb_ = uvb - d_bottom;\r\n\t\t\ttuv[0] = uvl_, tuv[1] = uvt_, tuv[2] = uvr_, tuv[3] = uvt_,\r\n\t\t\t\ttuv[4] = uvr_, tuv[5] = uvb_, tuv[6] = uvl_, tuv[7] = uvb_;\r\n\t\t\tif (repeat) {\r\n\t\t\t\tthis._fillTexture_v(tex, imgid, tuv, right, tex.height - top - bottom, width - right + tx, top + ty, height - top - bottom);\r\n\t\t\t} else {\r\n\t\t\t\tthis._inner_drawTexture(tex, imgid, width - right + tx, top + ty, right, height - top - bottom, mat, tuv, 1, false);\r\n\t\t\t}\r\n\t\t}\r\n\t\t//绘制中间\r\n\t\tuvl_ = uvl + d_left; uvt_ = uvt + d_top;\r\n\t\tuvr_ = uvr - d_right; uvb_ = uvb - d_bottom;\r\n\t\ttuv[0] = uvl_, tuv[1] = uvt_, tuv[2] = uvr_, tuv[3] = uvt_,\r\n\t\t\ttuv[4] = uvr_, tuv[5] = uvb_, tuv[6] = uvl_, tuv[7] = uvb_;\r\n\t\tif (repeat) {\r\n\t\t\tvar tuvr: any[] = Context.tmpUVRect;\r\n\t\t\ttuvr[0] = uvl_; tuvr[1] = uvt_;\r\n\t\t\ttuvr[2] = uvr_ - uvl_; tuvr[3] = uvb_ - uvt_;\r\n\t\t\t// 这个如果用重复的可能比较多，所以采用filltexture的方法，注意这样会打断合并\r\n\t\t\tthis._fillTexture(tex, tex.width - left - right, tex.height - top - bottom, tuvr, left + tx, top + ty, width - left - right, height - top - bottom, 'repeat', 0, 0);\r\n\t\t} else {\r\n\t\t\tthis._inner_drawTexture(tex, imgid, left + tx, top + ty, width - left - right, height - top - bottom, mat, tuv, 1, false);\r\n\t\t}\r\n\r\n\t\tif (needClip) this.restore();\r\n\t}\r\n}\r\n\r\n\r\n\r\nclass ContextParams {\r\n\tstatic DEFAULT: ContextParams;\r\n\r\n\tlineWidth: number = 1;\r\n\ttextAlign: string;\r\n\ttextBaseline: string;\r\n\r\n\tclear(): void {\r\n\t\tthis.lineWidth = 1;\r\n\t\tthis.textAlign = this.textBaseline = null;\r\n\t}\r\n\r\n\tmake(): ContextParams {\r\n\t\treturn this === ContextParams.DEFAULT ? new ContextParams() : this;\r\n\t}\r\n}\r\n","import { RenderState2D } from \"./utils/RenderState2D\"\r\nimport { WebGLContext } from \"./WebGLContext\";\r\n\r\n/**\r\n * @private\r\n */\r\nexport class WebGL {\r\n    static _isWebGL2: boolean = false;\r\n    static isNativeRender_enable: boolean = false;\r\n\r\n    //TODO:coverage\r\n    private static _uint8ArraySlice(): Uint8Array {\r\n        var _this: any = this;\r\n        var sz: number = _this.length;\r\n        var dec: Uint8Array = new Uint8Array(_this.length);\r\n        for (var i: number = 0; i < sz; i++) dec[i] = _this[i];\r\n        return dec;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private static _float32ArraySlice(): Float32Array {\r\n        var _this: any = this;\r\n        var sz: number = _this.length;\r\n        var dec: Float32Array = new Float32Array(_this.length);\r\n        for (var i: number = 0; i < sz; i++) dec[i] = _this[i];\r\n        return dec;\r\n    }\r\n\r\n    //TODO:coverage\r\n    private static _uint16ArraySlice(...arg): Uint16Array {\r\n        var _this: any = this;\r\n        var sz: number;\r\n        var dec: Uint16Array;\r\n        var i: number;\r\n        if (arg.length === 0) {\r\n            sz = _this.length;\r\n            dec = new Uint16Array(sz);\r\n            for (i = 0; i < sz; i++)\r\n                dec[i] = _this[i];\r\n\r\n        } else if (arg.length === 2) {\r\n            var start: number = arg[0];\r\n            var end: number = arg[1];\r\n\r\n            if (end > start) {\r\n                sz = end - start;\r\n                dec = new Uint16Array(sz);\r\n                for (i = start; i < end; i++)\r\n                    dec[i - start] = _this[i];\r\n            } else {\r\n                dec = new Uint16Array(0);\r\n            }\r\n        }\r\n        return dec;\r\n    }\r\n\r\n    static _nativeRender_enable(): void {\r\n    }\r\n\r\n    //使用webgl渲染器\r\n    static enable(): boolean {\r\n        return true;\r\n    }\r\n\r\n    static inner_enable(): boolean {\r\n        Float32Array.prototype.slice || (Float32Array.prototype.slice = WebGL._float32ArraySlice);\r\n        Uint16Array.prototype.slice || (Uint16Array.prototype.slice = WebGL._uint16ArraySlice);\r\n        Uint8Array.prototype.slice || (Uint8Array.prototype.slice = WebGL._uint8ArraySlice);\r\n        return true;\r\n    }\r\n\r\n    static onStageResize(width: number, height: number): void {\r\n        if (WebGLContext.mainContext == null) return;\r\n        WebGLContext.mainContext.viewport(0, 0, width, height);\r\n        RenderState2D.width = width;\r\n        RenderState2D.height = height;\r\n    }\r\n}\r\n\r\n\r\n\r\n","\r\nexport class VertexArrayObject {\r\n    constructor() {\r\n    }\r\n}\r\n\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    var glErrorShadow = {};\r\n\r\n    function error(msg) {\r\n        if (window.console && window.console.error) {\r\n            window.console.error(msg);\r\n        }\r\n    }\r\n\r\n    function log(msg) {\r\n        if (window.console && window.console.log) {\r\n            window.console.log(msg);\r\n        }\r\n    }\r\n\r\n    function synthesizeGLError(err, opt_msg) {\r\n        glErrorShadow[err] = true;\r\n        if (opt_msg !== undefined) {\r\n            error(opt_msg)\r\n        }\r\n    }\r\n\r\n    function wrapGLError(gl) {\r\n        var f = gl.getError;\r\n        gl.getError = function () {\r\n            var err;\r\n            do {\r\n                err = f.apply(gl);\r\n                if (err != gl.NO_ERROR) {\r\n                    glErrorShadow[err] = true;\r\n                }\r\n            } while (err != gl.NO_ERROR);\r\n\r\n            for (var err1 in glErrorShadow) {\r\n                if (glErrorShadow[err1]) {\r\n                    delete glErrorShadow[err1];\r\n                    return parseInt(err1);\r\n                }\r\n            }\r\n            return gl.NO_ERROR;\r\n        };\r\n    }\r\n\r\n    var WebGLVertexArrayObjectOES = function WebGLVertexArrayObjectOES(ext) {\r\n        var gl = ext.gl;\r\n\r\n        this.ext = ext;\r\n        this.isAlive = true;\r\n        this.hasBeenBound = false;\r\n\r\n        this.elementArrayBuffer = null;\r\n        this.attribs = new Array(ext.maxVertexAttribs);\r\n        for (var n = 0; n < this.attribs.length; n++) {\r\n            var attrib = new (WebGLVertexArrayObjectOES as any).VertexAttrib(gl);\r\n            this.attribs[n] = attrib;\r\n        }\r\n\r\n        this.maxAttrib = 0;\r\n    };\r\n\r\n    (WebGLVertexArrayObjectOES as any).VertexAttrib = function VertexAttrib(gl) {\r\n        this.enabled = false;\r\n        this.buffer = null;\r\n        this.size = 4;\r\n        this.type = gl.FLOAT;\r\n        this.normalized = false;\r\n        this.stride = 16;\r\n        this.offset = 0;\r\n\r\n        this.cached = \"\";\r\n        this.recache();\r\n    };\r\n    (WebGLVertexArrayObjectOES as any).VertexAttrib.prototype.recache = function recache() {\r\n        this.cached = [this.size, this.type, this.normalized, this.stride, this.offset].join(\":\");\r\n    };\r\n\r\n    var OESVertexArrayObject = function OESVertexArrayObject(gl) {\r\n        var self = this;\r\n        this.gl = gl;\r\n\r\n        wrapGLError(gl);\r\n\r\n        var original = this.original = {\r\n            getParameter: gl.getParameter,\r\n            enableVertexAttribArray: gl.enableVertexAttribArray,\r\n            disableVertexAttribArray: gl.disableVertexAttribArray,\r\n            bindBuffer: gl.bindBuffer,\r\n            getVertexAttrib: gl.getVertexAttrib,\r\n            vertexAttribPointer: gl.vertexAttribPointer\r\n        };\r\n\r\n        gl.getParameter = function getParameter(pname) {\r\n            if (pname == self.VERTEX_ARRAY_BINDING_OES) {\r\n                if (self.currentVertexArrayObject == self.defaultVertexArrayObject) {\r\n                    return null;\r\n                } else {\r\n                    return self.currentVertexArrayObject;\r\n                }\r\n            }\r\n            return original.getParameter.apply(this, arguments);\r\n        };\r\n\r\n        gl.enableVertexAttribArray = function enableVertexAttribArray(index) {\r\n            var vao = self.currentVertexArrayObject;\r\n            vao.maxAttrib = Math.max(vao.maxAttrib, index);\r\n            var attrib = vao.attribs[index];\r\n            attrib.enabled = true;\r\n            return original.enableVertexAttribArray.apply(this, arguments);\r\n        };\r\n        gl.disableVertexAttribArray = function disableVertexAttribArray(index) {\r\n            var vao = self.currentVertexArrayObject;\r\n            vao.maxAttrib = Math.max(vao.maxAttrib, index);\r\n            var attrib = vao.attribs[index];\r\n            attrib.enabled = false;\r\n            return original.disableVertexAttribArray.apply(this, arguments);\r\n        };\r\n\r\n        gl.bindBuffer = function bindBuffer(target, buffer) {\r\n            switch (target) {\r\n                case gl.ARRAY_BUFFER:\r\n                    self.currentArrayBuffer = buffer;\r\n                    break;\r\n                case gl.ELEMENT_ARRAY_BUFFER:\r\n                    self.currentVertexArrayObject.elementArrayBuffer = buffer;\r\n                    break;\r\n            }\r\n            return original.bindBuffer.apply(this, arguments);\r\n        };\r\n\r\n        gl.getVertexAttrib = function getVertexAttrib(index, pname) {\r\n            var vao = self.currentVertexArrayObject;\r\n            var attrib = vao.attribs[index];\r\n            switch (pname) {\r\n                case gl.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:\r\n                    return attrib.buffer;\r\n                case gl.VERTEX_ATTRIB_ARRAY_ENABLED:\r\n                    return attrib.enabled;\r\n                case gl.VERTEX_ATTRIB_ARRAY_SIZE:\r\n                    return attrib.size;\r\n                case gl.VERTEX_ATTRIB_ARRAY_STRIDE:\r\n                    return attrib.stride;\r\n                case gl.VERTEX_ATTRIB_ARRAY_TYPE:\r\n                    return attrib.type;\r\n                case gl.VERTEX_ATTRIB_ARRAY_NORMALIZED:\r\n                    return attrib.normalized;\r\n                default:\r\n                    return original.getVertexAttrib.apply(this, arguments);\r\n            }\r\n        };\r\n\r\n        gl.vertexAttribPointer = function vertexAttribPointer(indx, size, type, normalized, stride, offset) {\r\n            var vao = self.currentVertexArrayObject;\r\n            vao.maxAttrib = Math.max(vao.maxAttrib, indx);\r\n            var attrib = vao.attribs[indx];\r\n            attrib.buffer = self.currentArrayBuffer;\r\n            attrib.size = size;\r\n            attrib.type = type;\r\n            attrib.normalized = normalized;\r\n            attrib.stride = stride;\r\n            attrib.offset = offset;\r\n            attrib.recache();\r\n            return original.vertexAttribPointer.apply(this, arguments);\r\n        };\r\n\r\n        if (gl.instrumentExtension) {\r\n            gl.instrumentExtension(this, \"OES_vertex_array_object\");\r\n        }\r\n\r\n        gl.canvas.addEventListener('webglcontextrestored', function () {\r\n            log(\"OESVertexArrayObject emulation library context restored\");\r\n            self.reset_();\r\n        }, true);\r\n\r\n        this.reset_();\r\n    };\r\n\r\n    OESVertexArrayObject.prototype.VERTEX_ARRAY_BINDING_OES = 0x85B5;\r\n\r\n    OESVertexArrayObject.prototype.reset_ = function reset_() {\r\n        var contextWasLost = this.vertexArrayObjects !== undefined;\r\n        if (contextWasLost) {\r\n            for (var ii = 0; ii < this.vertexArrayObjects.length; ++ii) {\r\n                this.vertexArrayObjects.isAlive = false;\r\n            }\r\n        }\r\n        var gl = this.gl;\r\n        this.maxVertexAttribs = gl.getParameter(gl.MAX_VERTEX_ATTRIBS);\r\n\r\n        this.defaultVertexArrayObject = new WebGLVertexArrayObjectOES(this);\r\n        this.currentVertexArrayObject = null;\r\n        this.currentArrayBuffer = null;\r\n        this.vertexArrayObjects = [this.defaultVertexArrayObject];\r\n\r\n        this.bindVertexArrayOES(null);\r\n    };\r\n\r\n    OESVertexArrayObject.prototype.createVertexArrayOES = function createVertexArrayOES() {\r\n        var arrayObject = new WebGLVertexArrayObjectOES(this);\r\n        this.vertexArrayObjects.push(arrayObject);\r\n        return arrayObject;\r\n    };\r\n\r\n    OESVertexArrayObject.prototype.deleteVertexArrayOES = function deleteVertexArrayOES(arrayObject) {\r\n        arrayObject.isAlive = false;\r\n        this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(arrayObject), 1);\r\n        if (this.currentVertexArrayObject == arrayObject) {\r\n            this.bindVertexArrayOES(null);\r\n        }\r\n    };\r\n\r\n    OESVertexArrayObject.prototype.isVertexArrayOES = function isVertexArrayOES(arrayObject) {\r\n        if (arrayObject && arrayObject instanceof WebGLVertexArrayObjectOES) {\r\n            if ((arrayObject as any).hasBeenBound && (arrayObject as any).ext == this) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    OESVertexArrayObject.prototype.bindVertexArrayOES = function bindVertexArrayOES(arrayObject) {\r\n        var gl = this.gl;\r\n        if (arrayObject && !arrayObject.isAlive) {\r\n            synthesizeGLError(gl.INVALID_OPERATION, \"bindVertexArrayOES: attempt to bind deleted arrayObject\");\r\n            return;\r\n        }\r\n        var original = this.original;\r\n\r\n        var oldVAO = this.currentVertexArrayObject;\r\n        this.currentVertexArrayObject = arrayObject || this.defaultVertexArrayObject;\r\n        this.currentVertexArrayObject.hasBeenBound = true;\r\n        var newVAO = this.currentVertexArrayObject;\r\n\r\n        if (oldVAO == newVAO) {\r\n            return;\r\n        }\r\n\r\n        if (!oldVAO || newVAO.elementArrayBuffer != oldVAO.elementArrayBuffer) {\r\n            original.bindBuffer.call(gl, gl.ELEMENT_ARRAY_BUFFER, newVAO.elementArrayBuffer);\r\n        }\r\n\r\n        var currentBinding = this.currentArrayBuffer;\r\n        var maxAttrib = Math.max(oldVAO ? oldVAO.maxAttrib : 0, newVAO.maxAttrib);\r\n        for (var n = 0; n <= maxAttrib; n++) {\r\n            var attrib = newVAO.attribs[n];\r\n            var oldAttrib = oldVAO ? oldVAO.attribs[n] : null;\r\n\r\n            if (!oldVAO || attrib.enabled != oldAttrib.enabled) {\r\n                if (attrib.enabled) {\r\n                    original.enableVertexAttribArray.call(gl, n);\r\n                } else {\r\n                    original.disableVertexAttribArray.call(gl, n);\r\n                }\r\n            }\r\n\r\n            if (attrib.enabled) {\r\n                var bufferChanged = false;\r\n                if (!oldVAO || attrib.buffer != oldAttrib.buffer) {\r\n                    if (currentBinding != attrib.buffer) {\r\n                        original.bindBuffer.call(gl, gl.ARRAY_BUFFER, attrib.buffer);\r\n                        currentBinding = attrib.buffer;\r\n                    }\r\n                    bufferChanged = true;\r\n                }\r\n\r\n                if (bufferChanged || attrib.cached != oldAttrib.cached) {\r\n                    original.vertexAttribPointer.call(gl, n, attrib.size, attrib.type, attrib.normalized, attrib.stride, attrib.offset);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.currentArrayBuffer != currentBinding) {\r\n            original.bindBuffer.call(gl, gl.ARRAY_BUFFER, this.currentArrayBuffer);\r\n        }\r\n    };\r\n\r\n    (window as any)._setupVertexArrayObject = function (gl) {\r\n        var original_getSupportedExtensions = gl.getSupportedExtensions;\r\n        gl.getSupportedExtensions = function getSupportedExtensions() {\r\n            var list = original_getSupportedExtensions.call(this) || [];\r\n            if (list.indexOf(\"OES_vertex_array_object\") < 0) {\r\n                list.push(\"OES_vertex_array_object\");\r\n            }\r\n            return list;\r\n        };\r\n\r\n        var original_getExtension = gl.getExtension;\r\n\r\n        gl.getExtension = function getExtension(name) {\r\n            var ext = original_getExtension.call(this, name);\r\n            if (ext) {\r\n                return ext;\r\n            }\r\n            if (name !== \"OES_vertex_array_object\") {\r\n                return null;\r\n            }\r\n\r\n            if (!this.__OESVertexArrayObject) {\r\n                console.log(\"Setup OES_vertex_array_object polyfill\");\r\n                this.__OESVertexArrayObject = new OESVertexArrayObject(this);\r\n            }\r\n            return this.__OESVertexArrayObject;\r\n        };\r\n    };\r\n}());\r\n","import { LayaGL } from \"../layagl/LayaGL\";\r\nimport { TextureFormat } from \"../resource/TextureFormat\";\r\nimport { RenderTextureFormat } from \"../resource/RenderTextureFormat\";\r\n\r\n/**\r\n * 系统工具。\r\n */\r\nexport class SystemUtils {\r\n    /** @internal */\r\n    static _maxTextureCount: number;\r\n    /** @internal */\r\n    static _maxTextureSize: number;\r\n    /** @internal */\r\n    static _shaderCapailityLevel: number;\r\n\r\n    /**\r\n     * 图形设备支持的最大纹理数量。\r\n     */\r\n    static get maxTextureCount(): number {\r\n        return this._maxTextureCount;\r\n    }\r\n\r\n    /**\r\n     * 图形设备支持的最大纹理尺寸。\r\n     */\r\n    static get maxTextureSize(): number {\r\n        return this._maxTextureSize;\r\n    }\r\n\r\n    /**\r\n     * 图形设备着色器的大致能力等级,类似于DirectX的shader model概念。\r\n     */\r\n    static get shaderCapailityLevel(): number {\r\n        return this._shaderCapailityLevel;\r\n    }\r\n\r\n    /**\r\n     * 是否支持纹理格式。\r\n     * @param format 纹理格式。 \r\n     * @returns 是否支持。\r\n     */\r\n    static supportTextureFormat(format: number): boolean {\r\n        switch (format) {\r\n            case TextureFormat.R32G32B32A32:\r\n                return (!LayaGL.layaGPUInstance._isWebGL2 && !LayaGL.layaGPUInstance._oesTextureFloat) ? false : true;\r\n            default:\r\n                return true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 是否支持渲染纹理格式。\r\n     * @param format 渲染纹理格式。\r\n     * @returns 是否支持。\r\n     */\r\n    static supportRenderTextureFormat(format: number): boolean {\r\n        switch (format) {\r\n            case RenderTextureFormat.R16G16B16A16:\r\n                return (((!!LayaGL.layaGPUInstance._isWebGL2)&&(!!LayaGL.layaGPUInstance._extColorBufferFloat)) || LayaGL.layaGPUInstance._oesTextureHalfFloat && LayaGL.layaGPUInstance._oesTextureHalfFloatLinear) ? true : false;\r\n            case RenderTextureFormat.Depth:\r\n                return (LayaGL.layaGPUInstance._isWebGL2 || LayaGL.layaGPUInstance._webgl_depth_texture) ? true : false;\r\n            case RenderTextureFormat.ShadowMap:\r\n                return LayaGL.layaGPUInstance._isWebGL2 ? true : false;\r\n            default:\r\n                return true;\r\n        }\r\n    }\r\n}","\r\nimport { Config } from \"../../Config\";\r\nimport { ILaya } from \"../../ILaya\";\r\nimport { VertexArrayObject } from \"../../laya/webgl/VertexArrayObject\";\r\nimport { SystemUtils } from \"./SystemUtils\";\r\n\r\n/**\r\n * @internal\r\n */\r\nexport class LayaGPU {\r\n    /**@internal */\r\n    private static _extentionVendorPrefixes: any[] = [\"\", \"WEBKIT_\", \"MOZ_\"];\r\n\r\n    /**@internal */\r\n    private _gl: any = null;\r\n    /**@internal */\r\n    private _vaoExt: any = null;\r\n    /**@internal */\r\n    private _angleInstancedArrays: any = null;\r\n\r\n    /**@internal */\r\n    _isWebGL2: boolean = false;\r\n    /**@internal */\r\n    _oesTextureHalfFloat: any = null;\r\n    /**@internal */\r\n    _oes_element_index_uint: any = null;\r\n    /**@internal */\r\n    _oesTextureHalfFloatLinear: any = null;\r\n    /**@internal */\r\n    _oesTextureFloat: any = null;\r\n    /**@internal */\r\n    _extShaderTextureLod: any = null;\r\n    /**@internal */\r\n    _extTextureFilterAnisotropic: any = null;\r\n    /**@internal */\r\n    _compressedTextureS3tc: any = null;\r\n    /**@internal */\r\n    _compressedTexturePvrtc: any = null;\r\n    /**@internal */\r\n    _compressedTextureEtc1: any = null;\r\n    /**@internal */\r\n    _webgl_depth_texture: any = null;\r\n    /**@internal webgl1.0开启OES_texture_half_float_linear会默认开启这个扩展*/\r\n    _extColorBufferFloat:any = null;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    constructor(gl: WebGLRenderingContext, isWebGL2: boolean) {\r\n        this._gl = gl;\r\n        this._isWebGL2 = isWebGL2;\r\n        var maxTextureFS: number = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);\r\n        var maxTextureSize: number = gl.getParameter(gl.MAX_TEXTURE_SIZE);\r\n        if (!isWebGL2) {\r\n            if (!ILaya.Render.isConchApp) {\r\n                VertexArrayObject;//强制引用\r\n                if ((window as any)._setupVertexArrayObject) //兼容VAO\r\n                    (window as any)._setupVertexArrayObject(gl);\r\n            }\r\n            this._vaoExt = this._getExtension(\"OES_vertex_array_object\");\r\n            this._angleInstancedArrays = this._getExtension(\"ANGLE_instanced_arrays\");\r\n\r\n            this._oesTextureHalfFloat = this._getExtension(\"OES_texture_half_float\");\r\n            this._oesTextureHalfFloatLinear = this._getExtension(\"OES_texture_half_float_linear\");\r\n            this._oesTextureFloat = this._getExtension(\"OES_texture_float\");\r\n            //this._getExtension(\"OES_texture_float_linear\");\r\n            this._oes_element_index_uint = this._getExtension(\"OES_element_index_uint\");\r\n            this._extShaderTextureLod = this._getExtension(\"EXT_shader_texture_lod\");\r\n            this._webgl_depth_texture = this._getExtension(\"WEBGL_depth_texture\");\r\n\r\n            SystemUtils._shaderCapailityLevel = 30;\r\n        } else {\r\n            this._extColorBufferFloat = this._getExtension(\"EXT_color_buffer_float\");\r\n            //this._getExtension(\"OES_texture_float_linear\");\r\n            SystemUtils._shaderCapailityLevel = 35;\r\n        }\r\n\r\n        //_getExtension(\"EXT_float_blend\");\r\n        this._extTextureFilterAnisotropic = this._getExtension(\"EXT_texture_filter_anisotropic\");\r\n        this._compressedTextureS3tc = this._getExtension(\"WEBGL_compressed_texture_s3tc\");\r\n        this._compressedTexturePvrtc = this._getExtension(\"WEBGL_compressed_texture_pvrtc\");\r\n        this._compressedTextureEtc1 = this._getExtension(\"WEBGL_compressed_texture_etc1\");\r\n\r\n        SystemUtils._maxTextureCount = maxTextureFS;\r\n        SystemUtils._maxTextureSize = maxTextureSize;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    private _getExtension(name: string): any {\r\n        var prefixes: any[] = LayaGPU._extentionVendorPrefixes;\r\n        for (var k in prefixes) {\r\n            var ext: any = this._gl.getExtension(prefixes[k] + name);\r\n            if (ext)\r\n                return ext;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    createVertexArray(): any {\r\n        if (this._isWebGL2)\r\n            return this._gl.createVertexArray();\r\n        else\r\n            return this._vaoExt.createVertexArrayOES();\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    bindVertexArray(vertexArray: any): void {\r\n        if (this._isWebGL2)\r\n            this._gl.bindVertexArray(vertexArray);\r\n        else\r\n            this._vaoExt.bindVertexArrayOES(vertexArray);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    deleteVertexArray(vertexArray: any): void {\r\n        if (this._isWebGL2)\r\n            this._gl.deleteVertexArray(vertexArray);\r\n        else\r\n            this._vaoExt.deleteVertexArrayOES(vertexArray);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    isVertexArray(vertexArray: any): void {\r\n        if (this._isWebGL2)\r\n            this._gl.isVertexArray(vertexArray);\r\n        else\r\n            this._vaoExt.isVertexArrayOES(vertexArray);\r\n    }\r\n\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    drawElementsInstanced(mode: number, count: number, type: number, offset: number, instanceCount: number): void {\r\n        if (this._isWebGL2)\r\n            this._gl.drawElementsInstanced(mode, count, type, offset, instanceCount);\r\n        else\r\n            this._angleInstancedArrays.drawElementsInstancedANGLE(mode, count, type, offset, instanceCount);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    drawArraysInstanced(mode: number, first: number, count: number, instanceCount: number): void {\r\n        if (this._isWebGL2)\r\n            this._gl.drawArraysInstanced(mode, first, count, instanceCount);\r\n        else\r\n            this._angleInstancedArrays.drawArraysInstancedANGLE(mode, first, count, instanceCount);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    vertexAttribDivisor(index: number, divisor: number): void {\r\n        if (this._isWebGL2)\r\n            this._gl.vertexAttribDivisor(index, divisor);\r\n        else\r\n            this._angleInstancedArrays.vertexAttribDivisorANGLE(index, divisor);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    supportInstance(): boolean {\r\n        if ((this._isWebGL2 || this._angleInstancedArrays) && Config.allowGPUInstanceDynamicBatch)\r\n            return true;\r\n        else\r\n            return false;\r\n    }\r\n\r\n    /**\r\n    * @internal\r\n    */\r\n    supportElementIndexUint32(): boolean {\r\n        return this._isWebGL2 || this._oes_element_index_uint ? true : false;\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { ILaya } from \"./../../ILaya\";\r\nimport { Config } from \"./../../Config\";\r\nimport { LayaGL } from \"../layagl/LayaGL\"\r\nimport { Context } from \"../resource/Context\"\r\nimport { HTMLCanvas } from \"../resource/HTMLCanvas\"\r\nimport { WebGL } from \"../webgl/WebGL\"\r\nimport { WebGLContext } from \"../webgl/WebGLContext\"\r\nimport { BlendMode } from \"../webgl/canvas/BlendMode\"\r\nimport { Shader2D } from \"../webgl/shader/d2/Shader2D\"\r\nimport { ShaderDefines2D } from \"../webgl/shader/d2/ShaderDefines2D\"\r\nimport { Value2D } from \"../webgl/shader/d2/value/Value2D\"\r\nimport { Buffer2D } from \"../webgl/utils/Buffer2D\"\r\nimport { SubmitBase } from \"../webgl/submit/SubmitBase\";\r\nimport { LayaGPU } from \"../webgl/LayaGPU\";\r\nimport { Browser } from \"../utils/Browser\";\r\n\r\n/**\r\n * <code>Render</code> 是渲染管理类。它是一个单例，可以使用 Laya.render 访问。\r\n */\r\nexport class Render {\r\n    /** @internal */\r\n    static _context: Context;\r\n    /** @internal 主画布。canvas和webgl渲染都用这个画布*/\r\n    static _mainCanvas: HTMLCanvas;\r\n\r\n    static supportWebGLPlusCulling: boolean = false;\r\n    static supportWebGLPlusAnimation: boolean = false;\r\n    static supportWebGLPlusRendering: boolean = false;\r\n    /**是否是加速器 只读*/\r\n    static isConchApp: boolean = false;\r\n    /** 表示是否是 3D 模式。*/\r\n    static is3DMode: boolean;\r\n\r\n\t/**\r\n\t * 初始化引擎。\r\n\t * @param\twidth 游戏窗口宽度。\r\n\t * @param\theight\t游戏窗口高度。\r\n\t */\r\n    constructor(width: number, height: number, mainCanv: HTMLCanvas) {\r\n        Render._mainCanvas = mainCanv;\r\n        let source: HTMLCanvasElement = Render._mainCanvas.source as HTMLCanvasElement;\r\n        //创建主画布。改到Browser中了，因为为了runtime，主画布必须是第一个\r\n        source.id = \"layaCanvas\";\r\n        source.width = width;\r\n        source.height = height;\r\n        if (Render.isConchApp) {\r\n            document.body.appendChild(source);\r\n        }\r\n\r\n        this.initRender(Render._mainCanvas, width, height);\r\n        window.requestAnimationFrame(loop);\r\n        function loop(stamp: number): void {\r\n            ILaya.stage._loop();\r\n            window.requestAnimationFrame(loop);\r\n        }\r\n        ILaya.stage.on(\"visibilitychange\", this, this._onVisibilitychange);\r\n    }\r\n\r\n    /**@private */\r\n    private _timeId: number = 0;\r\n\r\n    /**@private */\r\n    private _onVisibilitychange(): void {\r\n        if (!ILaya.stage.isVisibility) {\r\n            this._timeId = window.setInterval(this._enterFrame, 1000);\r\n        } else if (this._timeId != 0) {\r\n            window.clearInterval(this._timeId);\r\n        }\r\n    }\r\n\r\n    initRender(canvas: HTMLCanvas, w: number, h: number): boolean {\r\n        function getWebGLContext(canvas: any): WebGLRenderingContext {\r\n            var gl: WebGLRenderingContext;\r\n            var names: any[] = [\"webgl2\", \"webgl\", \"experimental-webgl\", \"webkit-3d\", \"moz-webgl\"];\r\n            if (!Config.useWebGL2 || Browser.onBDMiniGame) {//TODO:反向兼容百度\r\n                names.shift();\r\n            }\r\n            for (var i: number = 0; i < names.length; i++) {\r\n                try {\r\n                    gl = canvas.getContext(names[i], { stencil: Config.isStencil, alpha: Config.isAlpha, antialias: Config.isAntialias, premultipliedAlpha: Config.premultipliedAlpha, preserveDrawingBuffer: Config.preserveDrawingBuffer });//antialias为true,premultipliedAlpha为false,IOS和部分安卓QQ浏览器有黑屏或者白屏底色BUG\r\n                } catch (e) {\r\n                }\r\n                if (gl) {\r\n                    (names[i] === 'webgl2') && (WebGL._isWebGL2 = true);\r\n                    new LayaGL();\r\n                    return gl;\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n        var gl: WebGLRenderingContext = LayaGL.instance = WebGLContext.mainContext = getWebGLContext(Render._mainCanvas.source);\r\n\r\n        if (!gl)\r\n            return false;\r\n\r\n        LayaGL.instance = gl;\r\n        LayaGL.layaGPUInstance = new LayaGPU(gl, WebGL._isWebGL2);\r\n\r\n        canvas.size(w, h);\t//在ctx之后调用。\r\n        Context.__init__();\r\n        SubmitBase.__init__();\r\n\r\n        var ctx: Context = new Context();\r\n        ctx.isMain = true;\r\n        Render._context = ctx;\r\n        canvas._setContext(ctx);\r\n\r\n        //TODO 现在有个问题是 gl.deleteTexture并没有走WebGLContex封装的\r\n        ShaderDefines2D.__init__();\r\n        Value2D.__init__();\r\n        Shader2D.__init__();\r\n        Buffer2D.__int__(gl);\r\n        BlendMode._init_(gl);\r\n        return true;\r\n    }\r\n\r\n    /**@private */\r\n    private _enterFrame(e: any = null): void {\r\n        ILaya.stage._loop();\r\n    }\r\n\r\n    /** 目前使用的渲染器。*/\r\n    static get context(): Context {\r\n        return Render._context;\r\n    }\r\n\r\n    /** 渲染使用的原生画布引用。 */\r\n    static get canvas(): any {\r\n        return Render._mainCanvas.source;\r\n    }\r\n}\r\n{\r\n    Render.isConchApp = ((window as any).conch != null);\r\n    if (Render.isConchApp) {\r\n        Render.supportWebGLPlusCulling = false;\r\n        Render.supportWebGLPlusAnimation = false;\r\n        Render.supportWebGLPlusRendering = false;\r\n    }\r\n    else if ((window as any).qq != null && (window as any).qq.webglPlus != null) {\r\n        Render.supportWebGLPlusCulling = false;\r\n        Render.supportWebGLPlusAnimation = false;\r\n        Render.supportWebGLPlusRendering = false;\r\n    }\r\n}\r\n\r\n\r\n","import { ColorFilter } from \"../../filters/ColorFilter\"\r\nimport { Matrix } from \"../../maths/Matrix\"\r\nimport { Context } from \"../../resource/Context\"\r\nimport { Texture } from \"../../resource/Texture\"\r\nimport { ColorUtils } from \"../../utils/ColorUtils\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 绘制三角形命令\r\n */\r\nexport class DrawTrianglesCmd {\r\n    static ID: string = \"DrawTriangles\";\r\n\r\n    /**\r\n     * 纹理。\r\n     */\r\n    texture: Texture|null;\r\n    /**\r\n     * X轴偏移量。\r\n     */\r\n    x: number;\r\n    /**\r\n     * Y轴偏移量。\r\n     */\r\n    y: number;\r\n    /**\r\n     * 顶点数组。\r\n     */\r\n    vertices: Float32Array;\r\n    /**\r\n     * UV数据。\r\n     */\r\n    uvs: Float32Array;\r\n    /**\r\n     * 顶点索引。\r\n     */\r\n    indices: Uint16Array;\r\n    /**\r\n     * 缩放矩阵。\r\n     */\r\n    matrix: Matrix;\r\n    /**\r\n     * alpha\r\n     */\r\n    alpha: number;\r\n    //public var color:String;\r\n    /**\r\n     * blend模式\r\n     */\r\n    blendMode: string;\r\n    /**\r\n     * 颜色变换\r\n     */\r\n    color: ColorFilter;\r\n\r\n    colorNum: number;\r\n\r\n    /**@private */\r\n    static create(texture: Texture, x: number, y: number, vertices: Float32Array, uvs: Float32Array, indices: Uint16Array, matrix: Matrix, alpha: number, color: string, blendMode: string, colorNum: number): DrawTrianglesCmd {\r\n        var cmd: DrawTrianglesCmd = Pool.getItemByClass(\"DrawTrianglesCmd\", DrawTrianglesCmd);\r\n        cmd.texture = texture;\r\n        cmd.x = x;\r\n        cmd.y = y;\r\n        cmd.vertices = vertices;\r\n        cmd.uvs = uvs;\r\n        cmd.indices = indices;\r\n        cmd.matrix = matrix;\r\n        cmd.alpha = alpha;\r\n        if (color) {\r\n            cmd.color = new ColorFilter();\r\n            var c: any[] = ColorUtils.create(color).arrColor;\r\n            cmd.color.color(c[0] * 255, c[1] * 255, c[2] * 255, c[3] * 255);\t//TODO 这个好像设置的是加色，这样并不合理\r\n        }\r\n        cmd.blendMode = blendMode;\r\n        cmd.colorNum = colorNum;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this.texture = null;\r\n        this.vertices = null;\r\n        this.uvs = null;\r\n        this.indices = null;\r\n        this.matrix = null;\r\n        Pool.recover(\"DrawTrianglesCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context.drawTriangles(this.texture, this.x + gx, this.y + gy, this.vertices, this.uvs, this.indices, this.matrix, this.alpha, this.color, this.blendMode, this.colorNum);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return DrawTrianglesCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Texture } from \"../../resource/Texture\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n/**\r\n * 绘制带九宫格信息的图片\r\n * @internal\r\n */\r\nexport class Draw9GridTexture {\r\n    static ID: string = \"Draw9GridTexture\";\r\n\r\n    /**\r\n     * 纹理。\r\n     */\r\n    texture: Texture;\r\n    /**\r\n     * （可选）X轴偏移量。\r\n     */\r\n    x: number;\r\n    /**\r\n     * （可选）Y轴偏移量。\r\n     */\r\n    y: number;\r\n    /**\r\n     * （可选）宽度。\r\n     */\r\n    width: number;\r\n    /**\r\n     * （可选）高度。\r\n     */\r\n    height: number;\r\n\r\n    sizeGrid: any[];\r\n\r\n\r\n\r\n    /**@private */\r\n    static create(texture: Texture, x: number, y: number, width: number, height: number, sizeGrid: any[]): Draw9GridTexture {\r\n        var cmd: Draw9GridTexture = Pool.getItemByClass(\"Draw9GridTexture\", Draw9GridTexture);\r\n        cmd.texture = texture;\r\n        texture._addReference();\r\n        cmd.x = x;\r\n        cmd.y = y;\r\n        cmd.width = width;\r\n        cmd.height = height;\r\n        cmd.sizeGrid = sizeGrid;\r\n\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this.texture._removeReference();\r\n        Pool.recover(\"Draw9GridTexture\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context.drawTextureWithSizeGrid(this.texture, this.x, this.y, this.width, this.height, this.sizeGrid, gx, gy);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return Draw9GridTexture.ID;\r\n    }\r\n    constructor() {\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 存储命令，和restore配套使用\r\n */\r\nexport class SaveCmd {\r\n    static ID: string = \"Save\";\r\n\r\n\r\n\r\n    /**@private */\r\n    static create(): SaveCmd {\r\n        var cmd: SaveCmd = Pool.getItemByClass(\"SaveCmd\", SaveCmd);\r\n\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n\r\n        Pool.recover(\"SaveCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context.save();\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return SaveCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { AlphaCmd } from \"./cmd/AlphaCmd\"\r\nimport { DrawCircleCmd } from \"./cmd/DrawCircleCmd\"\r\nimport { DrawCurvesCmd } from \"./cmd/DrawCurvesCmd\"\r\nimport { DrawImageCmd } from \"./cmd/DrawImageCmd\"\r\nimport { DrawLineCmd } from \"./cmd/DrawLineCmd\"\r\nimport { DrawLinesCmd } from \"./cmd/DrawLinesCmd\"\r\nimport { DrawPathCmd } from \"./cmd/DrawPathCmd\"\r\nimport { DrawPieCmd } from \"./cmd/DrawPieCmd\"\r\nimport { DrawPolyCmd } from \"./cmd/DrawPolyCmd\"\r\nimport { DrawRectCmd } from \"./cmd/DrawRectCmd\"\r\nimport { DrawTextureCmd } from \"./cmd/DrawTextureCmd\"\r\nimport { FillTextureCmd } from \"./cmd/FillTextureCmd\"\r\nimport { RestoreCmd } from \"./cmd/RestoreCmd\"\r\nimport { RotateCmd } from \"./cmd/RotateCmd\"\r\nimport { ScaleCmd } from \"./cmd/ScaleCmd\"\r\nimport { TransformCmd } from \"./cmd/TransformCmd\"\r\nimport { TranslateCmd } from \"./cmd/TranslateCmd\"\r\nimport { Bezier } from \"../maths/Bezier\"\r\nimport { GrahamScan } from \"../maths/GrahamScan\"\r\nimport { Matrix } from \"../maths/Matrix\"\r\nimport { Point } from \"../maths/Point\"\r\nimport { Rectangle } from \"../maths/Rectangle\"\r\nimport { Render } from \"../renders/Render\"\r\nimport { Context } from \"../resource/Context\"\r\nimport { Texture } from \"../resource/Texture\"\r\nimport { Pool } from \"../utils/Pool\"\r\nimport { Utils } from \"../utils/Utils\"\r\nimport { Graphics } from \"./Graphics\";\r\nimport { DrawTrianglesCmd } from \"./cmd/DrawTrianglesCmd\";\r\nimport { Draw9GridTexture } from \"./cmd/Draw9GridTexture\";\r\nimport { ClassUtils } from \"../utils/ClassUtils\";\r\nimport { SaveCmd } from \"./cmd/SaveCmd\"\r\n\r\n/**\r\n * @private\r\n * Graphic bounds数据类\r\n */\r\nexport class GraphicsBounds {\r\n\r\n    /**@private */\r\n    private static _tempMatrix: Matrix = new Matrix();\r\n    /**@private */\r\n    private static _initMatrix: Matrix = new Matrix();\r\n    /**@private */\r\n    private static _tempPoints: any[] = [];\r\n    /**@private */\r\n    private static _tempMatrixArrays: any[] = [];\r\n    /**@private */\r\n    private static _tempCmds: any[] = [];\r\n    /**@private */\r\n    private _temp: any[];\r\n    /**@private */\r\n    private _bounds: Rectangle;\r\n    /**@private */\r\n    private _rstBoundPoints: any[];\r\n    /**@private */\r\n    private _cacheBoundsType: boolean = false;\r\n    /**@internal */\r\n    _graphics: Graphics;\r\n\r\n    /**\r\n     * 销毁\r\n     */\r\n    destroy(): void {\r\n        this._graphics = null;\r\n        this._cacheBoundsType = false;\r\n        if (this._temp) this._temp.length = 0;\r\n        if (this._rstBoundPoints) this._rstBoundPoints.length = 0;\r\n        if (this._bounds) this._bounds.recover();\r\n        this._bounds = null;\r\n        Pool.recover(\"GraphicsBounds\", this);\r\n    }\r\n\r\n    /**\r\n     * 创建\r\n     */\r\n    static create(): GraphicsBounds {\r\n        return Pool.getItemByClass(\"GraphicsBounds\", GraphicsBounds);\r\n    }\r\n\r\n    /**\r\n     * 重置数据\r\n     */\r\n    reset(): void {\r\n        this._temp && (this._temp.length = 0);\r\n    }\r\n\r\n    /**\r\n     * 获取位置及宽高信息矩阵(比较耗CPU，频繁使用会造成卡顿，尽量少用)。\r\n     * @param realSize\t（可选）使用图片的真实大小，默认为false\r\n     * @return 位置与宽高组成的 一个 Rectangle 对象。\r\n     */\r\n    getBounds(realSize: boolean = false): Rectangle {\r\n        if (!this._bounds || !this._temp || this._temp.length < 1 || realSize != this._cacheBoundsType) {\r\n            this._bounds = Rectangle._getWrapRec(this.getBoundPoints(realSize), this._bounds)\r\n        }\r\n        this._cacheBoundsType = realSize;\r\n        return this._bounds;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * @param realSize\t（可选）使用图片的真实大小，默认为false\r\n     * 获取端点列表。\r\n     */\r\n    getBoundPoints(realSize: boolean = false): any[] {\r\n        if (!this._temp || this._temp.length < 1 || realSize != this._cacheBoundsType)\r\n            this._temp = this._getCmdPoints(realSize);\r\n        this._cacheBoundsType = realSize;\r\n        return this._rstBoundPoints = Utils.copyArray(this._rstBoundPoints, this._temp);\r\n    }\r\n\r\n    private _getCmdPoints(realSize: boolean = false): any[] {\r\n        var context: Context = Render._context;\r\n        var cmds: any[] = this._graphics.cmds;\r\n        var rst: any[];\r\n        rst = this._temp || (this._temp = []);\r\n\r\n        rst.length = 0;\r\n        if (!cmds && this._graphics._one != null) {\r\n            GraphicsBounds._tempCmds.length = 0;\r\n            GraphicsBounds._tempCmds.push(this._graphics._one);\r\n            cmds = GraphicsBounds._tempCmds;\r\n        }\r\n        if (!cmds) return rst;\r\n\r\n        var matrixs: any[] = GraphicsBounds._tempMatrixArrays;\r\n        matrixs.length = 0;\r\n        var tMatrix: Matrix = GraphicsBounds._initMatrix;\r\n        tMatrix.identity();\r\n        var tempMatrix: Matrix = GraphicsBounds._tempMatrix;\r\n        var cmd: any;\r\n        var tex: Texture;\r\n        for (var i: number = 0, n: number = cmds.length; i < n; i++) {\r\n            cmd = cmds[i];\r\n            switch (cmd.cmdID) {\r\n                case AlphaCmd.ID:\r\n                case SaveCmd.ID:\r\n                    matrixs.push(tMatrix);\r\n                    tMatrix = tMatrix.clone();\r\n                    break;\r\n                case RestoreCmd.ID: //restore\r\n                    tMatrix = matrixs.pop();\r\n                    break;\r\n                case ScaleCmd.ID://scale\r\n                    tempMatrix.identity();\r\n                    tempMatrix.translate(-cmd.pivotX, -cmd.pivotY);\r\n                    tempMatrix.scale(cmd.scaleX, cmd.scaleY);\r\n                    tempMatrix.translate(cmd.pivotX, cmd.pivotY);\r\n\r\n                    this._switchMatrix(tMatrix, tempMatrix);\r\n                    break;\r\n                case RotateCmd.ID://case context._rotate: \r\n                    tempMatrix.identity();\r\n                    tempMatrix.translate(-cmd.pivotX, -cmd.pivotY);\r\n                    tempMatrix.rotate(cmd.angle);\r\n                    tempMatrix.translate(cmd.pivotX, cmd.pivotY);\r\n\r\n                    this._switchMatrix(tMatrix, tempMatrix);\r\n                    break;\r\n                case TranslateCmd.ID://translate\r\n                    tempMatrix.identity();\r\n                    tempMatrix.translate(cmd.tx, cmd.ty);\r\n\r\n                    this._switchMatrix(tMatrix, tempMatrix);\r\n                    break;\r\n                case TransformCmd.ID://context._transform:\r\n                    tempMatrix.identity();\r\n                    tempMatrix.translate(-cmd.pivotX, -cmd.pivotY);\r\n                    tempMatrix.concat(cmd.matrix);\r\n                    tempMatrix.translate(cmd.pivotX, cmd.pivotY);\r\n\r\n                    this._switchMatrix(tMatrix, tempMatrix);\r\n                    break;\r\n                case DrawImageCmd.ID://case context._drawTexture: \r\n                case FillTextureCmd.ID://case context._fillTexture\r\n                    GraphicsBounds._addPointArrToRst(rst, Rectangle._getBoundPointS(cmd.x, cmd.y, cmd.width, cmd.height), tMatrix);\r\n                    break;\r\n                case DrawTextureCmd.ID://case context._drawTextureTransform: \r\n                    tMatrix.copyTo(tempMatrix);\r\n                    if (cmd.matrix)\r\n                        tempMatrix.concat(cmd.matrix);\r\n                    GraphicsBounds._addPointArrToRst(rst, Rectangle._getBoundPointS(cmd.x, cmd.y, cmd.width, cmd.height), tempMatrix);\r\n                    break;\r\n                case DrawImageCmd.ID:\r\n                    tex = cmd.texture;\r\n                    if (realSize) {\r\n                        if (cmd.width && cmd.height) {\r\n                            GraphicsBounds._addPointArrToRst(rst, Rectangle._getBoundPointS(cmd.x, cmd.y, cmd.width, cmd.height), tMatrix);\r\n                        } else {\r\n                            GraphicsBounds._addPointArrToRst(rst, Rectangle._getBoundPointS(cmd.x, cmd.y, tex.width, tex.height), tMatrix);\r\n                        }\r\n                    } else {\r\n                        var wRate: number = (cmd.width || tex.sourceWidth) / tex.width;\r\n                        var hRate: number = (cmd.height || tex.sourceHeight) / tex.height;\r\n                        var oWidth: number = wRate * tex.sourceWidth;\r\n                        var oHeight: number = hRate * tex.sourceHeight;\r\n\r\n                        var offX: number = tex.offsetX > 0 ? tex.offsetX : 0;\r\n                        var offY: number = tex.offsetY > 0 ? tex.offsetY : 0;\r\n\r\n                        offX *= wRate;\r\n                        offY *= hRate;\r\n\r\n                        GraphicsBounds._addPointArrToRst(rst, Rectangle._getBoundPointS(cmd.x - offX, cmd.y - offY, oWidth, oHeight), tMatrix);\r\n                    }\r\n\r\n                    break;\r\n                case FillTextureCmd.ID:\r\n                    if (cmd.width && cmd.height) {\r\n                        GraphicsBounds._addPointArrToRst(rst, Rectangle._getBoundPointS(cmd.x, cmd.y, cmd.width, cmd.height), tMatrix);\r\n                    } else {\r\n                        tex = cmd.texture;\r\n                        GraphicsBounds._addPointArrToRst(rst, Rectangle._getBoundPointS(cmd.x, cmd.y, tex.width, tex.height), tMatrix);\r\n                    }\r\n                    break;\r\n                case DrawTextureCmd.ID:\r\n                    var drawMatrix: Matrix;\r\n                    if (cmd.matrix) {\r\n                        tMatrix.copyTo(tempMatrix);\r\n                        tempMatrix.concat(cmd.matrix);\r\n                        drawMatrix = tempMatrix;\r\n                    } else {\r\n                        drawMatrix = tMatrix;\r\n                    }\r\n                    if (realSize) {\r\n                        if (cmd.width && cmd.height) {\r\n                            GraphicsBounds._addPointArrToRst(rst, Rectangle._getBoundPointS(cmd.x, cmd.y, cmd.width, cmd.height), drawMatrix);\r\n                        } else {\r\n                            tex = cmd.texture;\r\n                            GraphicsBounds._addPointArrToRst(rst, Rectangle._getBoundPointS(cmd.x, cmd.y, tex.width, tex.height), drawMatrix);\r\n                        }\r\n                    } else {\r\n                        tex = cmd.texture;\r\n                        wRate = (cmd.width || tex.sourceWidth) / tex.width;\r\n                        hRate = (cmd.height || tex.sourceHeight) / tex.height;\r\n                        oWidth = wRate * tex.sourceWidth;\r\n                        oHeight = hRate * tex.sourceHeight;\r\n\r\n                        offX = tex.offsetX > 0 ? tex.offsetX : 0;\r\n                        offY = tex.offsetY > 0 ? tex.offsetY : 0;\r\n\r\n                        offX *= wRate;\r\n                        offY *= hRate;\r\n\r\n                        GraphicsBounds._addPointArrToRst(rst, Rectangle._getBoundPointS(cmd.x - offX, cmd.y - offY, oWidth, oHeight), drawMatrix);\r\n                    }\r\n\r\n                    break;\r\n                case DrawRectCmd.ID://case context._drawRect:\r\n                    GraphicsBounds._addPointArrToRst(rst, Rectangle._getBoundPointS(cmd.x, cmd.y, cmd.width, cmd.height), tMatrix);\r\n                    break;\r\n                case DrawCircleCmd.ID://case context._drawCircle\r\n                    GraphicsBounds._addPointArrToRst(rst, Rectangle._getBoundPointS(cmd.x - cmd.radius, cmd.y - cmd.radius, cmd.radius + cmd.radius, cmd.radius + cmd.radius), tMatrix);\r\n                    break;\r\n                case DrawLineCmd.ID://drawLine\r\n                    GraphicsBounds._tempPoints.length = 0;\r\n                    var lineWidth: number;\r\n                    lineWidth = cmd.lineWidth * 0.5;\r\n                    if (cmd.fromX == cmd.toX) {\r\n                        GraphicsBounds._tempPoints.push(cmd.fromX + lineWidth, cmd.fromY, cmd.toX + lineWidth, cmd.toY, cmd.fromX - lineWidth, cmd.fromY, cmd.toX - lineWidth, cmd.toY);\r\n                    } else if (cmd.fromY == cmd.toY) {\r\n                        GraphicsBounds._tempPoints.push(cmd.fromX, cmd.fromY + lineWidth, cmd.toX, cmd.toY + lineWidth, cmd.fromX, cmd.fromY - lineWidth, cmd.toX, cmd.toY - lineWidth);\r\n                    } else {\r\n                        GraphicsBounds._tempPoints.push(cmd.fromX, cmd.fromY, cmd.toX, cmd.toY);\r\n                    }\r\n\r\n                    GraphicsBounds._addPointArrToRst(rst, GraphicsBounds._tempPoints, tMatrix);\r\n                    break;\r\n                case DrawCurvesCmd.ID://context._drawCurves:\t\t\t\t\t\r\n                    GraphicsBounds._addPointArrToRst(rst, Bezier.I.getBezierPoints(cmd.points), tMatrix, cmd.x, cmd.y);\r\n                    break;\r\n                case DrawLinesCmd.ID://drawpoly\r\n                case DrawPolyCmd.ID://drawpoly\r\n                    GraphicsBounds._addPointArrToRst(rst, cmd.points, tMatrix, cmd.x, cmd.y);\r\n                    break;\r\n                case DrawPathCmd.ID://drawPath\r\n                    GraphicsBounds._addPointArrToRst(rst, this._getPathPoints(cmd.paths), tMatrix, cmd.x, cmd.y);\r\n                    break;\r\n                case DrawPieCmd.ID://drawPie\r\n                    GraphicsBounds._addPointArrToRst(rst, this._getPiePoints(cmd.x, cmd.y, cmd.radius, cmd.startAngle, cmd.endAngle), tMatrix);\r\n                    break;\r\n                case DrawTrianglesCmd.ID:\r\n                    GraphicsBounds._addPointArrToRst(rst, this._getTriAngBBXPoints((cmd as DrawTrianglesCmd).vertices), tMatrix);\r\n                    break;\r\n                case Draw9GridTexture.ID:\r\n                    GraphicsBounds._addPointArrToRst(rst, this._getDraw9GridBBXPoints(cmd as Draw9GridTexture), tMatrix);\r\n                    break;\r\n            }\r\n        }\r\n        if (rst.length > 200) {\r\n            rst = Utils.copyArray(rst, Rectangle._getWrapRec(rst)._getBoundPoints());\r\n        } else if (rst.length > 8)\r\n            rst = GrahamScan.scanPList(rst);\r\n        return rst;\r\n    }\r\n\r\n    private _switchMatrix(tMatix: Matrix, tempMatrix: Matrix): void {\r\n        tempMatrix.concat(tMatix);\r\n        tempMatrix.copyTo(tMatix);\r\n    }\r\n\r\n    private static _addPointArrToRst(rst: any[], points: any[], matrix: Matrix, dx: number = 0, dy: number = 0): void {\r\n        var i: number, len: number;\r\n        len = points.length;\r\n        for (i = 0; i < len; i += 2) {\r\n            GraphicsBounds._addPointToRst(rst, points[i] + dx, points[i + 1] + dy, matrix);\r\n        }\r\n    }\r\n\r\n    private static _addPointToRst(rst: any[], x: number, y: number, matrix: Matrix): void {\r\n        var _tempPoint: Point = Point.TEMP;\r\n        _tempPoint.setTo(x ? x : 0, y ? y : 0);\r\n        matrix.transformPoint(_tempPoint);\r\n        rst.push(_tempPoint.x, _tempPoint.y);\r\n    }\r\n\r\n    /**\r\n     * 获得drawPie命令可能的产生的点。注意 这里只假设用在包围盒计算上。\r\n     * @param\tx\r\n     * @param\ty\r\n     * @param\tradius\r\n     * @param\tstartAngle\r\n     * @param\tendAngle\r\n     * @return\r\n     */\r\n    private _getPiePoints(x: number, y: number, radius: number, startAngle: number, endAngle: number): any[] {\r\n        var rst: any[] = GraphicsBounds._tempPoints;\r\n        GraphicsBounds._tempPoints.length = 0;\r\n        var k: number = Math.PI / 180;\r\n        var d1: number = endAngle - startAngle;\r\n        if (d1 >= 360 || d1 <= -360) {\r\n            // 如果满了一圈了\r\n            rst.push(x - radius, y - radius);\r\n            rst.push(x + radius, y - radius);\r\n            rst.push(x + radius, y + radius);\r\n            rst.push(x - radius, y + radius);\r\n            return rst;\r\n        }\r\n        // \r\n        rst.push(x, y);\t// 中心\r\n\r\n        var delta: number = d1 % 360;\r\n        if (delta < 0) delta += 360;\r\n\r\n        // 一定增加，且在360以内的end\r\n        var end1: number = startAngle + delta;\r\n\r\n        // 转成弧度\r\n        var st: number = startAngle * k;\r\n        var ed: number = end1 * k;\r\n\r\n        // 起点\r\n        rst.push(x + radius * Math.cos(st), y + radius * Math.sin(st));\r\n        // 终点\r\n        rst.push(x + radius * Math.cos(ed), y + radius * Math.sin(ed));\r\n\r\n        // 圆形的四个边界点\r\n        // 按照90度对齐，看看会经历几个90度\r\n        var s1: number = Math.ceil(startAngle / 90) * 90;\t//开始的。start的下一个90度\r\n        var s2: number = Math.floor(end1 / 90) * 90;\t\t//结束。end的上一个90度\r\n        for (var cs: number = s1; cs <= s2; cs += 90) {\r\n            var csr: number = cs * k;\r\n            rst.push(x + radius * Math.cos(csr), y + radius * Math.sin(csr));\r\n        }\r\n        return rst;\r\n        /*\r\n        var segnum:int = 32;\r\n        var step:Number = delta / segnum;\t\t\r\n        var i:Number;\r\n        var angle:Number = startAngle;\r\n        for (i = 0; i <= segnum; i++) {\r\n            rst.push(x + radius * Math.cos(angle), y + radius * Math.sin(angle));\r\n            angle += step;\r\n        }\t\t\r\n        */\r\n    }\r\n\r\n    private _getTriAngBBXPoints(vert: Float32Array) {\r\n        var vnum = vert.length;\r\n        if (vnum < 2) return [];\r\n        var minx = vert[0];\r\n        var miny = vert[1];\r\n        var maxx = minx;\r\n        var maxy = miny;\r\n        for (var i = 2; i < vnum;) {\r\n            var cx = vert[i++];\r\n            var cy = vert[i++];\r\n            if (minx > cx) minx = cx;\r\n            if (miny > cy) miny = cy;\r\n            if (maxx < cx) maxx = cx;\r\n            if (maxy < cy) maxy = cy;\r\n        }\r\n\r\n        return [minx, miny, maxx, miny, maxx, maxy, minx, maxy];\r\n    }\r\n\r\n    private _getDraw9GridBBXPoints(cmd: Draw9GridTexture) {\r\n        var minx = 0;\r\n        var miny = 0;\r\n        var maxx = cmd.width;\r\n        var maxy = cmd.height;\r\n        return [minx, miny, maxx, miny, maxx, maxy, minx, maxy];\r\n    }\r\n\r\n    private _getPathPoints(paths: any[]): any[] {\r\n        var i: number, len: number;\r\n        var rst: any[] = GraphicsBounds._tempPoints;\r\n        rst.length = 0;\r\n        len = paths.length;\r\n        var tCMD: any[];\r\n        for (i = 0; i < len; i++) {\r\n            tCMD = paths[i];\r\n            if (tCMD.length > 1) {\r\n                rst.push(tCMD[1], tCMD[2]);\r\n                if (tCMD.length > 3) {\r\n                    rst.push(tCMD[3], tCMD[4]);\r\n                }\r\n            }\r\n        }\r\n        return rst;\r\n    }\r\n}","/**\r\n\t * @private\r\n\t */\r\nexport class SpriteConst {\r\n    /** @private */\r\n    static ALPHA: number = 0x01;\r\n    /** @private */\r\n    static TRANSFORM: number = 0x02;\r\n    /** @private */\r\n    static BLEND: number = 0x04;\r\n    /** @private */\r\n    static CANVAS: number = 0x08;\r\n    /** @private */\r\n    static FILTERS: number = 0x10;\r\n    /** @private */\r\n    static MASK: number = 0x20;\r\n    /** @private */\r\n    static CLIP: number = 0x40;\r\n    /** @private */\r\n    static STYLE: number = 0x80;\r\n    /** @private */\r\n    static TEXTURE: number = 0x100;\r\n    /** @private */\r\n    static GRAPHICS: number = 0x200;\r\n    /** @private */\r\n    static LAYAGL3D: number = 0x400;\r\n    /** @private */\r\n    static CUSTOM: number = 0x800;\r\n    /** @private */\r\n    static ONECHILD: number = 0x1000;\r\n    /** @private */\r\n    static CHILDS: number = 0x2000;\r\n\r\n\r\n    /** @private */\r\n    static REPAINT_NONE: number = 0;\r\n    /** @private */\r\n    static REPAINT_NODE: number = 0x01;\r\n    /** @private */\r\n    static REPAINT_CACHE: number = 0x02;\r\n    /** @private */\r\n    static REPAINT_ALL: number = 0x03;\r\n}\r\n\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 裁剪命令\r\n */\r\nexport class ClipRectCmd {\r\n    static ID: string = \"ClipRect\";\r\n\r\n\r\n    /**\r\n     * X 轴偏移量。\r\n     */\r\n    x: number;\r\n    /**\r\n     * Y 轴偏移量。\r\n     */\r\n    y: number;\r\n    /**\r\n     * 宽度。\r\n     */\r\n    width: number;\r\n    /**\r\n     * 高度。\r\n     */\r\n    height: number;\r\n\r\n    /**@private */\r\n    static create(x: number, y: number, width: number, height: number): ClipRectCmd {\r\n        var cmd: ClipRectCmd = Pool.getItemByClass(\"ClipRectCmd\", ClipRectCmd);\r\n        cmd.x = x;\r\n        cmd.y = y;\r\n        cmd.width = width;\r\n        cmd.height = height;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n\r\n        Pool.recover(\"ClipRectCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context.clipRect(this.x + gx, this.y + gy, this.width, this.height);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return ClipRectCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { Texture } from \"../../resource/Texture\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 根据坐标集合绘制多个贴图\r\n */\r\nexport class DrawTexturesCmd {\r\n    static ID: string = \"DrawTextures\";\r\n\r\n    /**\r\n     * 纹理。\r\n     */\r\n    texture: Texture;\r\n    /**\r\n     * 绘制次数和坐标。\r\n     */\r\n    pos: any[];\r\n\r\n    /**@private */\r\n    static create(texture: Texture, pos: any[]): DrawTexturesCmd {\r\n        var cmd: DrawTexturesCmd = Pool.getItemByClass(\"DrawTexturesCmd\", DrawTexturesCmd);\r\n        cmd.texture = texture;\r\n        texture._addReference();\r\n        cmd.pos = pos;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this.texture._removeReference();\r\n        this.texture = null;\r\n        this.pos = null;\r\n        Pool.recover(\"DrawTexturesCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        context.drawTextures(this.texture, this.pos, gx, gy);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return DrawTexturesCmd.ID;\r\n    }\r\n\r\n}\r\n\r\n","import { Context } from \"../../resource/Context\"\r\nimport { ColorUtils } from \"../../utils/ColorUtils\"\r\nimport { FontInfo } from \"../../utils/FontInfo\"\r\nimport { Pool } from \"../../utils/Pool\"\r\nimport { WordText } from \"../../utils/WordText\"\r\nimport { ILaya } from \"../../../ILaya\";\r\nimport { HTMLChar } from \"../../utils/HTMLChar\";\r\n\r\n/**\r\n * 绘制文字\r\n */\r\nexport class FillTextCmd {\r\n    static ID: string = \"FillText\";\r\n    private _text: string | WordText;\r\n    /**@internal */\r\n    _textIsWorldText = false;\r\n    _words: HTMLChar[];\r\n    /**\r\n     * 开始绘制文本的 x 坐标位置（相对于画布）。\r\n     */\r\n    x: number;\r\n    /**\r\n     * 开始绘制文本的 y 坐标位置（相对于画布）。\r\n     */\r\n    y: number;\r\n    private _font: string;\r\n    private _color: string;\r\n    private _borderColor: string;\r\n    private _lineWidth: number;\r\n    private _textAlign: string;\r\n    private _fontColor = 0xffffffff;\r\n    private _strokeColor = 0;\r\n    private static _defFontObj = new FontInfo(null);\r\n    private _fontObj = FillTextCmd._defFontObj;\r\n    private _nTexAlign = 0;\r\n\r\n    /**@private */\r\n    static create(text: string | WordText, words: HTMLChar[], x: number, y: number, font: string, color: string, textAlign: string, lineWidth: number, borderColor: string): FillTextCmd {\r\n        var cmd: FillTextCmd = Pool.getItemByClass(\"FillTextCmd\", FillTextCmd);\r\n        cmd.text = text;\r\n        cmd._textIsWorldText = text instanceof WordText;\r\n        cmd._words = words;\r\n        cmd.x = x;\r\n        cmd.y = y;\r\n        cmd.font = font;\r\n        cmd.color = color;\r\n        cmd.textAlign = textAlign;\r\n        cmd._lineWidth = lineWidth;\r\n        cmd._borderColor = borderColor;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n\r\n        Pool.recover(\"FillTextCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        if (ILaya.stage.isGlobalRepaint()) {\r\n            this._textIsWorldText && ((<WordText>this._text)).cleanCache();\r\n        }\r\n        if (this._words) {\r\n            Context._textRender.fillWords(context, this._words, this.x + gx, this.y + gy, this._fontObj, this._color, this._borderColor, this._lineWidth);\r\n        } else {\r\n            if (this._textIsWorldText) {// 快速通道\r\n                context._fast_filltext(((<WordText>this._text)), this.x + gx, this.y + gy, this._fontObj, this._color, this._borderColor, this._lineWidth, this._nTexAlign, 0);\r\n            } else {\r\n                Context._textRender.filltext(context, this._text, this.x + gx, this.y + gy, this.font, this.color, this._borderColor, this._lineWidth, this._textAlign);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return FillTextCmd.ID;\r\n    }\r\n\r\n    /**\r\n     * 在画布上输出的文本。\r\n     */\r\n    get text(): string | WordText {\r\n        return this._text;\r\n    }\r\n\r\n    set text(value: string | WordText) {\r\n        //TODO 问题。 怎么通知native\r\n        this._text = value;\r\n        this._textIsWorldText = value instanceof WordText;\r\n        this._textIsWorldText && ((<WordText>this._text)).cleanCache();\r\n    }\r\n\r\n    /**\r\n     * 定义字号和字体，比如\"20px Arial\"。\r\n     */\r\n    get font(): string {\r\n        return this._font;\r\n    }\r\n\r\n    set font(value: string) {\r\n        this._font = value;\r\n        this._fontObj = FontInfo.Parse(value);\r\n        this._textIsWorldText && ((<WordText>this._text)).cleanCache();\r\n    }\r\n\r\n    /**\r\n     * 定义文本颜色，比如\"#ff0000\"。\r\n     */\r\n    get color(): string {\r\n        return this._color;\r\n    }\r\n\r\n    set color(value: string) {\r\n        this._color = value;\r\n        this._fontColor = ColorUtils.create(value).numColor;\r\n        this._textIsWorldText && ((<WordText>this._text)).cleanCache();\r\n    }\r\n\r\n    /**\r\n     * 文本对齐方式，可选值：\"left\"，\"center\"，\"right\"。\r\n     */\r\n    get textAlign(): string {\r\n        return this._textAlign;\r\n    }\r\n\r\n    set textAlign(value: string) {\r\n        this._textAlign = value;\r\n        switch (value) {\r\n            case 'center':\r\n                this._nTexAlign = ILaya.Context.ENUM_TEXTALIGN_CENTER;\r\n                break;\r\n            case 'right':\r\n                this._nTexAlign = ILaya.Context.ENUM_TEXTALIGN_RIGHT;\r\n                break;\r\n            default:\r\n                this._nTexAlign = ILaya.Context.ENUM_TEXTALIGN_DEFAULT;\r\n        }\r\n        this._textIsWorldText && ((<WordText>this._text)).cleanCache();\r\n    }\r\n}\r\n\r\n","import { ILaya } from \"./../../ILaya\";\r\n/**\r\n\t * @private\r\n\t * 对象缓存统一管理类\r\n\t */\r\nexport class CacheManger {\r\n    //TODO:\r\n    /**\r\n     * 单次清理检测允许执行的时间，单位ms。\r\n     */\r\n    static loopTimeLimit: number = 2;\r\n    /**\r\n     * @private\r\n     */\r\n    private static _cacheList: any[] = [];\r\n    /**\r\n     * @private\r\n     * 当前检测的索引\r\n     */\r\n    private static _index: number = 0;\r\n\r\n    constructor() {\r\n\r\n    }\r\n\r\n    /**\r\n     * 注册cache管理函数\r\n     * @param disposeFunction 释放函数 fun(force:Boolean)\r\n     * @param getCacheListFunction 获取cache列表函数fun():Array\r\n     *\r\n     */\r\n    static regCacheByFunction(disposeFunction: Function, getCacheListFunction: Function): void {\r\n        CacheManger.unRegCacheByFunction(disposeFunction, getCacheListFunction);\r\n        var cache: any;\r\n        cache = { tryDispose: disposeFunction, getCacheList: getCacheListFunction };\r\n        CacheManger._cacheList.push(cache);\r\n    }\r\n\r\n    /**\r\n     * 移除cache管理函数\r\n     * @param disposeFunction 释放函数 fun(force:Boolean)\r\n     * @param getCacheListFunction 获取cache列表函数fun():Array\r\n     *\r\n     */\r\n    static unRegCacheByFunction(disposeFunction: Function, getCacheListFunction: Function): void {\r\n        var i: number, len: number;\r\n        len = CacheManger._cacheList.length;\r\n        for (i = 0; i < len; i++) {\r\n            if (CacheManger._cacheList[i].tryDispose == disposeFunction && CacheManger._cacheList[i].getCacheList == getCacheListFunction) {\r\n                CacheManger._cacheList.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 强制清理所有管理器\r\n     *\r\n     */\r\n    //TODO:coverage\r\n    static forceDispose(): void {\r\n        var i: number, len: number = CacheManger._cacheList.length;\r\n        for (i = 0; i < len; i++) {\r\n            CacheManger._cacheList[i].tryDispose(true);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 开始检测循环\r\n     * @param waitTime 检测间隔时间\r\n     *\r\n     */\r\n    static beginCheck(waitTime: number = 15000): void {\r\n        ILaya.systemTimer.loop(waitTime, null, CacheManger._checkLoop);\r\n    }\r\n\r\n    /**\r\n     * 停止检测循环\r\n     *\r\n     */\r\n    //TODO:coverage\r\n    static stopCheck(): void {\r\n        ILaya.systemTimer.clear(null, CacheManger._checkLoop);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 检测函数\r\n     */\r\n    private static _checkLoop(): void {\r\n        var cacheList: any[] = CacheManger._cacheList;\r\n        if (cacheList.length < 1) return;\r\n        var tTime: number = ILaya.Browser.now();\r\n        var count: number;\r\n        var len: number;\r\n        len = count = cacheList.length;\r\n        while (count > 0) {\r\n            CacheManger._index++;\r\n            CacheManger._index = CacheManger._index % len;\r\n            cacheList[CacheManger._index].tryDispose(false);\r\n            if (ILaya.Browser.now() - tTime > CacheManger.loopTimeLimit) break;\r\n            count--;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n","import { CacheManger } from \"./CacheManger\"\r\n\r\n/**\r\n * @private\r\n * TODO:\r\n */\r\nexport class VectorGraphManager {\r\n    //TODO:\r\n    static instance: VectorGraphManager;\r\n\r\n    useDic: any = {};\r\n    shapeDic: any = {};\r\n    shapeLineDic: any = {};\r\n\r\n    private _id: number = 0;\r\n    private _checkKey: boolean = false;\r\n    private _freeIdArray: any[] = [];\r\n\r\n    constructor() {\r\n        CacheManger.regCacheByFunction(this.startDispose.bind(this), this.getCacheList.bind(this));\r\n    }\r\n\r\n    static getInstance(): VectorGraphManager {\r\n        return VectorGraphManager.instance = VectorGraphManager.instance || new VectorGraphManager();\r\n    }\r\n\r\n    /**\r\n     * 得到个空闲的ID\r\n     * @return\r\n     */\r\n    getId(): number {\r\n        //if (_freeIdArray.length > 0) {\r\n        //return _freeIdArray.pop();\r\n        //}\r\n        return this._id++;\r\n    }\r\n\r\n    /**\r\n     * 添加一个图形到列表中\r\n     * @param\tid\r\n     * @param\tshape\r\n     */\r\n    addShape(id: number, shape: any): void {\r\n        this.shapeDic[id] = shape;\r\n        if (!this.useDic[id]) {\r\n            this.useDic[id] = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 添加一个线图形到列表中\r\n     * @param\tid\r\n     * @param\tLine\r\n     */\r\n    addLine(id: number, Line: any): void {\r\n        this.shapeLineDic[id] = Line;\r\n        if (!this.shapeLineDic[id]) {\r\n            this.shapeLineDic[id] = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 检测一个对象是否在使用中\r\n     * @param\tid\r\n     */\r\n    getShape(id: number): void {\r\n        if (this._checkKey) {\r\n            if (this.useDic[id] != null) {\r\n                this.useDic[id] = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 删除一个图形对象\r\n     * @param\tid\r\n     */\r\n    deleteShape(id: number): void {\r\n        if (this.shapeDic[id]) {\r\n            this.shapeDic[id] = null;\r\n            delete this.shapeDic[id];\r\n        }\r\n        if (this.shapeLineDic[id]) {\r\n            this.shapeLineDic[id] = null;\r\n            delete this.shapeLineDic[id];\r\n        }\r\n        if (this.useDic[id] != null) {\r\n            delete this.useDic[id];\r\n        }\r\n        //_freeIdArray.push(id);\r\n    }\r\n\r\n    /**\r\n     * 得到缓存列表\r\n     * @return\r\n     */\r\n    getCacheList(): any[] {\r\n        var str: any;\r\n        var list: any[] = [];\r\n        for (str in this.shapeDic) {\r\n            list.push(this.shapeDic[str]);\r\n        }\r\n        for (str in this.shapeLineDic) {\r\n            list.push(this.shapeLineDic[str]);\r\n        }\r\n        return list;\r\n    }\r\n\r\n    /**\r\n     * 开始清理状态，准备销毁\r\n     */\r\n    startDispose(key: boolean): void {\r\n        var str: any;\r\n        for (str in this.useDic) {\r\n            this.useDic[str] = false;\r\n        }\r\n        this._checkKey = true;\r\n    }\r\n\r\n    /**\r\n     * 确认销毁\r\n     */\r\n    endDispose(): void {\r\n        if (this._checkKey) {\r\n            var str: any;\r\n            for (str in this.useDic) {\r\n                if (!this.useDic[str]) {\r\n                    this.deleteShape(str);\r\n                }\r\n            }\r\n            this._checkKey = false;\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { Sprite } from \"./Sprite\";\r\nimport { GraphicsBounds } from \"./GraphicsBounds\";\r\nimport { SpriteConst } from \"./SpriteConst\";\r\nimport { AlphaCmd } from \"./cmd/AlphaCmd\"\r\nimport { ClipRectCmd } from \"./cmd/ClipRectCmd\"\r\nimport { Draw9GridTexture } from \"./cmd/Draw9GridTexture\"\r\nimport { DrawCircleCmd } from \"./cmd/DrawCircleCmd\"\r\nimport { DrawCurvesCmd } from \"./cmd/DrawCurvesCmd\"\r\nimport { DrawImageCmd } from \"./cmd/DrawImageCmd\"\r\nimport { DrawLineCmd } from \"./cmd/DrawLineCmd\"\r\nimport { DrawLinesCmd } from \"./cmd/DrawLinesCmd\"\r\nimport { DrawPathCmd } from \"./cmd/DrawPathCmd\"\r\nimport { DrawPieCmd } from \"./cmd/DrawPieCmd\"\r\nimport { DrawPolyCmd } from \"./cmd/DrawPolyCmd\"\r\nimport { DrawRectCmd } from \"./cmd/DrawRectCmd\"\r\nimport { DrawTextureCmd } from \"./cmd/DrawTextureCmd\"\r\nimport { DrawTexturesCmd } from \"./cmd/DrawTexturesCmd\"\r\nimport { DrawTrianglesCmd } from \"./cmd/DrawTrianglesCmd\"\r\nimport { FillTextCmd } from \"./cmd/FillTextCmd\"\r\nimport { FillTextureCmd } from \"./cmd/FillTextureCmd\"\r\nimport { RestoreCmd } from \"./cmd/RestoreCmd\"\r\nimport { RotateCmd } from \"./cmd/RotateCmd\"\r\nimport { SaveCmd } from \"./cmd/SaveCmd\"\r\nimport { ScaleCmd } from \"./cmd/ScaleCmd\"\r\nimport { TransformCmd } from \"./cmd/TransformCmd\"\r\nimport { TranslateCmd } from \"./cmd/TranslateCmd\"\r\nimport { Event } from \"../events/Event\"\r\nimport { Matrix } from \"../maths/Matrix\"\r\nimport { Point } from \"../maths/Point\"\r\nimport { Rectangle } from \"../maths/Rectangle\"\r\nimport { Render } from \"../renders/Render\"\r\nimport { Context } from \"../resource/Context\"\r\nimport { Texture } from \"../resource/Texture\"\r\nimport { Utils } from \"../utils/Utils\"\r\nimport { VectorGraphManager } from \"../utils/VectorGraphManager\"\r\nimport { ILaya } from \"../../ILaya\";\r\nimport { HTMLChar } from \"../utils/HTMLChar\";\r\n\r\n/**\r\n * <code>Graphics</code> 类用于创建绘图显示对象。Graphics可以同时绘制多个位图或者矢量图，还可以结合save，restore，transform，scale，rotate，translate，alpha等指令对绘图效果进行变化。\r\n * Graphics以命令流方式存储，可以通过cmds属性访问所有命令流。Graphics是比Sprite更轻量级的对象，合理使用能提高应用性能(比如把大量的节点绘图改为一个节点的Graphics命令集合，能减少大量节点创建消耗)。\r\n * @see laya.display.Sprite#graphics\r\n */\r\nexport class Graphics {\r\n\r\n\r\n    /**@internal */\r\n    _sp: Sprite = null;\r\n    /**@internal */\r\n    _one: any = null;\r\n    /**@internal */\r\n    _render: (sprite: Sprite, context: Context, x: number, y: number)=>void = this._renderEmpty;\r\n    /**@private */\r\n    private _cmds: any[] = null;\r\n    /**@private */\r\n    protected _vectorgraphArray: any[] = null;\r\n    /**@private */\r\n    private _graphicBounds: GraphicsBounds = null;\r\n    /**@private */\r\n    autoDestroy: boolean = false;\r\n\r\n    constructor() {\r\n        this._createData();\r\n    }\r\n\r\n    /**@internal */\r\n    _createData(): void {\r\n\r\n    }\r\n\r\n    /**@internal */\r\n    _clearData(): void {\r\n\r\n    }\r\n\r\n    /**@internal */\r\n    _destroyData(): void {\r\n\r\n    }\r\n\r\n    /**\r\n     * <p>销毁此对象。</p>\r\n     */\r\n    destroy(): void {\r\n        this.clear(true);\r\n        if (this._graphicBounds) this._graphicBounds.destroy();\r\n        this._graphicBounds = null;\r\n        this._vectorgraphArray = null;\r\n        if (this._sp) {\r\n            this._sp._renderType = 0;\r\n            this._sp._setRenderType(0);\r\n            this._sp = null;\r\n        }\r\n        this._destroyData();\r\n    }\r\n\r\n    /**\r\n     * <p>清空绘制命令。</p>\r\n     * @param recoverCmds 是否回收绘图指令数组，设置为true，则对指令数组进行回收以节省内存开销，建议设置为true进行回收，但如果手动引用了数组，不建议回收\r\n     */\r\n    clear(recoverCmds: boolean = true): void {\r\n        //TODO:内存回收all\r\n        if (recoverCmds) {\r\n            var tCmd: any = this._one;\r\n            if (this._cmds) {\r\n                var i: number, len: number = this._cmds.length;\r\n                for (i = 0; i < len; i++) {\r\n                    tCmd = this._cmds[i];\r\n                    tCmd.recover();\r\n                }\r\n                this._cmds.length = 0;\r\n            } else if (tCmd) {\r\n                tCmd.recover();\r\n            }\r\n        } else {\r\n            this._cmds = null;\r\n        }\r\n\r\n        this._one = null;\r\n        this._render = this._renderEmpty;\r\n        this._clearData();\r\n        //_sp && (_sp._renderType &= ~SpriteConst.IMAGE);\r\n        if (this._sp) {\r\n            this._sp._renderType &= ~SpriteConst.GRAPHICS;\r\n            this._sp._setRenderType(this._sp._renderType);\r\n        }\r\n        this._repaint();\r\n        if (this._vectorgraphArray) {\r\n            for (i = 0, len = this._vectorgraphArray.length; i < len; i++) {\r\n                VectorGraphManager.getInstance().deleteShape(this._vectorgraphArray[i]);\r\n            }\r\n            this._vectorgraphArray.length = 0;\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    private _clearBoundsCache(): void {\r\n        if (this._graphicBounds) this._graphicBounds.reset();\r\n    }\r\n\r\n    /**@private */\r\n    private _initGraphicBounds(): void {\r\n        if (!this._graphicBounds) {\r\n            this._graphicBounds = GraphicsBounds.create();\r\n            this._graphicBounds._graphics = this;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 重绘此对象。\r\n     */\r\n    _repaint(): void {\r\n        this._clearBoundsCache();\r\n        this._sp && this._sp.repaint();\r\n    }\r\n\r\n    /**@internal */\r\n    //TODO:coverage\r\n    _isOnlyOne(): boolean {\r\n        return !this._cmds || this._cmds.length === 0;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 命令流。存储了所有绘制命令。\r\n     */\r\n    get cmds(): any[] {\r\n        //TODO:单命令不对\r\n        return this._cmds;\r\n    }\r\n\r\n    set cmds(value: any[]) {\r\n        if (this._sp) {\r\n            this._sp._renderType |= SpriteConst.GRAPHICS;\r\n            this._sp._setRenderType(this._sp._renderType);\r\n        }\r\n        this._cmds = value;\r\n        this._render = this._renderAll;\r\n        this._repaint();\r\n    }\r\n\r\n    /**\r\n     * 获取位置及宽高信息矩阵(比较耗CPU，频繁使用会造成卡顿，尽量少用)。\r\n     * @param realSize\t（可选）使用图片的真实大小，默认为false\r\n     * @return 位置与宽高组成的 一个 Rectangle 对象。\r\n     */\r\n    getBounds(realSize: boolean = false): Rectangle {\r\n        this._initGraphicBounds();\r\n        return this._graphicBounds.getBounds(realSize);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * @param realSize\t（可选）使用图片的真实大小，默认为false\r\n     * 获取端点列表。\r\n     */\r\n    getBoundPoints(realSize: boolean = false): any[] {\r\n        this._initGraphicBounds();\r\n        return this._graphicBounds.getBoundPoints(realSize);\r\n    }\r\n\r\n    /**\r\n     * 绘制单独图片\r\n     * @param texture\t\t纹理。\r\n     * @param x \t\t（可选）X轴偏移量。\r\n     * @param y \t\t（可选）Y轴偏移量。\r\n     * @param width\t\t（可选）宽度。\r\n     * @param height\t（可选）高度。\r\n     */\r\n    drawImage(texture: Texture, x: number = 0, y: number = 0, width: number = 0, height: number = 0): DrawImageCmd {\r\n        if (!texture) return null;\r\n        if (!width) width = texture.sourceWidth;\r\n        if (!height) height = texture.sourceHeight;\r\n        if (texture.getIsReady()) {\r\n            var wRate: number = width / texture.sourceWidth;\r\n            var hRate: number = height / texture.sourceHeight;\r\n            width = texture.width * wRate;\r\n            height = texture.height * hRate;\r\n            if (width <= 0 || height <= 0) return null;\r\n\r\n            x += texture.offsetX * wRate;\r\n            y += texture.offsetY * hRate;\r\n        }\r\n\r\n        if (this._sp) {\r\n            this._sp._renderType |= SpriteConst.GRAPHICS;\r\n            this._sp._setRenderType(this._sp._renderType);\r\n        }\r\n\r\n        var args: DrawImageCmd = DrawImageCmd.create.call(this, texture, x, y, width, height);\r\n\r\n        if (this._one == null) {\r\n            this._one = args;\r\n            this._render = this._renderOneImg;\r\n            //if(_sp)_sp._renderType |= SpriteConst.IMAGE;\r\n        } else {\r\n            this._saveToCmd(null, args);\r\n        }\r\n        //if (!tex.loaded) {\r\n        //tex.once(Event.LOADED, this, _textureLoaded, [tex, args]);\r\n        //}\r\n        this._repaint();\r\n        return args;\r\n    }\r\n\r\n    /**\r\n     * 绘制纹理，相比drawImage功能更强大，性能会差一些\r\n     * @param texture\t\t纹理。\r\n     * @param x \t\t（可选）X轴偏移量。\r\n     * @param y \t\t（可选）Y轴偏移量。\r\n     * @param width\t\t（可选）宽度。\r\n     * @param height\t（可选）高度。\r\n     * @param matrix\t（可选）矩阵信息。\r\n     * @param alpha\t\t（可选）透明度。\r\n     * @param color\t\t（可选）颜色滤镜。\r\n     * @param blendMode （可选）混合模式。\r\n     */\r\n    drawTexture(texture: Texture|null, x: number = 0, y: number = 0, width: number = 0, height: number = 0, matrix: Matrix|null = null, alpha: number = 1, color: string|null = null, blendMode: string|null = null, uv?: number[]): DrawTextureCmd|null {\r\n        if (!texture || alpha < 0.01) return null;\r\n        if (!texture.getIsReady()) return null;\r\n        if (!width) width = texture.sourceWidth;\r\n        if (!height) height = texture.sourceHeight;\r\n        if (texture.getIsReady()) {\r\n            var wRate: number = width / texture.sourceWidth;\r\n            var hRate: number = height / texture.sourceHeight;\r\n            width = texture.width * wRate;\r\n            height = texture.height * hRate;\r\n            if (width <= 0 || height <= 0) return null;\r\n\r\n            x += texture.offsetX * wRate;\r\n            y += texture.offsetY * hRate;\r\n        }\r\n\r\n        if (this._sp) {\r\n            this._sp._renderType |= SpriteConst.GRAPHICS;\r\n            this._sp._setRenderType(this._sp._renderType);\r\n        }\r\n\r\n        // canvas 模式不支持\r\n        var args: DrawTextureCmd = DrawTextureCmd.create.call(this, texture, x, y, width, height, matrix, alpha, color, blendMode, uv);\r\n        this._repaint();\r\n\r\n        return this._saveToCmd(null, args);\r\n    }\r\n\r\n    /**\r\n     * 批量绘制同样纹理。\r\n     * @param texture 纹理。\r\n     * @param pos 绘制次数和坐标。\r\n     */\r\n    drawTextures(texture: Texture, pos: any[]): DrawTexturesCmd|null {\r\n        if (!texture) return null;\r\n        return this._saveToCmd(Render._context.drawTextures, DrawTexturesCmd.create.call(this, texture, pos));\r\n    }\r\n\r\n    /**\r\n     * 绘制一组三角形\r\n     * @param texture\t纹理。\r\n     * @param x\t\t\tX轴偏移量。\r\n     * @param y\t\t\tY轴偏移量。\r\n     * @param vertices  顶点数组。\r\n     * @param indices\t顶点索引。\r\n     * @param uvData\tUV数据。\r\n     * @param matrix\t缩放矩阵。\r\n     * @param alpha\t\talpha\r\n     * @param color\t\t颜色变换\r\n     * @param blendMode\tblend模式\r\n     */\r\n    drawTriangles(texture: Texture, x: number, y: number, vertices: Float32Array, uvs: Float32Array, indices: Uint16Array, matrix: Matrix = null, alpha: number = 1, color: string = null, blendMode: string = null, colorNum: number = undefined): DrawTrianglesCmd {\r\n        return this._saveToCmd(Render._context.drawTriangles, DrawTrianglesCmd.create.call(this, texture, x, y, vertices, uvs, indices, matrix, alpha, color, blendMode, colorNum));\r\n    }\r\n\r\n    /**\r\n     * 用texture填充。\r\n     * @param texture\t\t纹理。\r\n     * @param x\t\t\tX轴偏移量。\r\n     * @param y\t\t\tY轴偏移量。\r\n     * @param width\t\t（可选）宽度。\r\n     * @param height\t（可选）高度。\r\n     * @param type\t\t（可选）填充类型 repeat|repeat-x|repeat-y|no-repeat\r\n     * @param offset\t（可选）贴图纹理偏移\r\n     *\r\n     */\r\n    fillTexture(texture: Texture, x: number, y: number, width: number = 0, height: number = 0, type: string = \"repeat\", offset: Point|null = null): FillTextureCmd|null {\r\n        if (texture && texture.getIsReady())\r\n            return this._saveToCmd(Render._context._fillTexture, FillTextureCmd.create.call(this, texture, x, y, width, height, type, offset || Point.EMPTY, {}));\r\n        else\r\n            return null;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 保存到命令流。\r\n     */\r\n    _saveToCmd(fun: Function, args: any): any {\r\n        if (this._sp) {\r\n            this._sp._renderType |= SpriteConst.GRAPHICS;\r\n            this._sp._setRenderType(this._sp._renderType);\r\n        }\r\n        if (this._one == null) {\r\n            this._one = args;\r\n            this._render = this._renderOne;\r\n        } else {\r\n            //_sp && (_sp._renderType &= ~SpriteConst.IMAGE);\r\n            this._render = this._renderAll;\r\n            (this._cmds || (this._cmds = [])).length === 0 && this._cmds.push(this._one);\r\n            this._cmds.push(args);\r\n        }\r\n        this._repaint();\r\n        return args;\r\n    }\r\n\r\n    /**\r\n     * 设置剪裁区域，超出剪裁区域的坐标不显示。\r\n     * @param x X 轴偏移量。\r\n     * @param y Y 轴偏移量。\r\n     * @param width 宽度。\r\n     * @param height 高度。\r\n     */\r\n    clipRect(x: number, y: number, width: number, height: number): ClipRectCmd {\r\n        return this._saveToCmd(Render._context.clipRect, ClipRectCmd.create.call(this, x, y, width, height));\r\n    }\r\n\r\n    /**\r\n     * 在画布上绘制文本。\r\n     * @param text 在画布上输出的文本。\r\n     * @param x 开始绘制文本的 x 坐标位置（相对于画布）。\r\n     * @param y 开始绘制文本的 y 坐标位置（相对于画布）。\r\n     * @param font 定义字号和字体，比如\"20px Arial\"。\r\n     * @param color 定义文本颜色，比如\"#ff0000\"。\r\n     * @param textAlign 文本对齐方式，可选值：\"left\"，\"center\"，\"right\"。\r\n     */\r\n    fillText(text: string, x: number, y: number, font: string, color: string, textAlign: string): FillTextCmd {\r\n        return this._saveToCmd(Render._context.fillText, FillTextCmd.create.call(this, text, null, x, y, font || ILaya.Text.defaultFontStr(), color, textAlign, 0, \"\"));\r\n    }\r\n\r\n    /**\r\n     * 在画布上绘制“被填充且镶边的”文本。\r\n     * @param text\t\t\t在画布上输出的文本。\r\n     * @param x\t\t\t\t开始绘制文本的 x 坐标位置（相对于画布）。\r\n     * @param y\t\t\t\t开始绘制文本的 y 坐标位置（相对于画布）。\r\n     * @param font\t\t\t定义字体和字号，比如\"20px Arial\"。\r\n     * @param fillColor\t\t定义文本颜色，比如\"#ff0000\"。\r\n     * @param textAlign\t\t文本对齐方式，可选值：\"left\"，\"center\"，\"right\"。\r\n     * @param lineWidth\t\t镶边线条宽度。\r\n     * @param borderColor\t定义镶边文本颜色。\r\n     */\r\n\r\n    fillBorderText(text: string, x: number, y: number, font: string, fillColor: string, textAlign: string, lineWidth: number, borderColor: string): FillTextCmd {\r\n        return this._saveToCmd(Render._context.fillText, FillTextCmd.create.call(this, text, null, x, y, font || ILaya.Text.defaultFontStr(), fillColor, textAlign, lineWidth, borderColor));\r\n    }\r\n\r\n    /*** @private */\r\n\r\n\r\n    fillWords(words: any[], x: number, y: number, font: string, color: string): FillTextCmd {\r\n        return this._saveToCmd(Render._context.fillText, FillTextCmd.create.call(this, null, words, x, y, font || ILaya.Text.defaultFontStr(), color));\r\n    }\r\n\r\n    /*** @private */\r\n\r\n\r\n    fillBorderWords(words: any[], x: number, y: number, font: string, fillColor: string, borderColor: string, lineWidth: number): FillTextCmd {\r\n        return this._saveToCmd(Render._context.fillText, FillTextCmd.create.call(this, null, words, x, y, font || ILaya.Text.defaultFontStr(), fillColor, \"\", lineWidth, borderColor));\r\n    }\r\n\r\n    /**\r\n     * 在画布上绘制文本（没有填色）。文本的默认颜色是黑色。\r\n     * @param text\t\t在画布上输出的文本。\r\n     * @param x\t\t\t开始绘制文本的 x 坐标位置（相对于画布）。\r\n     * @param y\t\t\t开始绘制文本的 y 坐标位置（相对于画布）。\r\n     * @param font\t\t定义字体和字号，比如\"20px Arial\"。\r\n     * @param color\t\t定义文本颜色，比如\"#ff0000\"。\r\n     * @param lineWidth\t线条宽度。\r\n     * @param textAlign\t文本对齐方式，可选值：\"left\"，\"center\"，\"right\"。\r\n     */\r\n\r\n    strokeText(text: string, x: number, y: number, font: string, color: string, lineWidth: number, textAlign: string): FillTextCmd {\r\n        return this._saveToCmd(Render._context.fillText, FillTextCmd.create.call(this, text, null, x, y, font || ILaya.Text.defaultFontStr(), null, textAlign, lineWidth, color));\r\n    }\r\n\r\n    /**\r\n     * 设置透明度。\r\n     * @param value 透明度。\r\n     */\r\n    alpha(alpha: number): AlphaCmd {\r\n        return this._saveToCmd(Render._context.alpha, AlphaCmd.create.call(this, alpha));\r\n    }\r\n\r\n    /**\r\n     * 替换绘图的当前转换矩阵。\r\n     * @param mat 矩阵。\r\n     * @param pivotX\t（可选）水平方向轴心点坐标。\r\n     * @param pivotY\t（可选）垂直方向轴心点坐标。\r\n     */\r\n    transform(matrix: Matrix, pivotX: number = 0, pivotY: number = 0): TransformCmd {\r\n        return this._saveToCmd(Render._context._transform, TransformCmd.create.call(this, matrix, pivotX, pivotY));\r\n    }\r\n\r\n    /**\r\n     * 旋转当前绘图。(推荐使用transform，性能更高)\r\n     * @param angle\t\t旋转角度，以弧度计。\r\n     * @param pivotX\t（可选）水平方向轴心点坐标。\r\n     * @param pivotY\t（可选）垂直方向轴心点坐标。\r\n     */\r\n    rotate(angle: number, pivotX: number = 0, pivotY: number = 0): RotateCmd {\r\n        return this._saveToCmd(Render._context._rotate, RotateCmd.create.call(this, angle, pivotX, pivotY));\r\n    }\r\n\r\n    /**\r\n     * 缩放当前绘图至更大或更小。(推荐使用transform，性能更高)\r\n     * @param scaleX\t水平方向缩放值。\r\n     * @param scaleY\t垂直方向缩放值。\r\n     * @param pivotX\t（可选）水平方向轴心点坐标。\r\n     * @param pivotY\t（可选）垂直方向轴心点坐标。\r\n     */\r\n    scale(scaleX: number, scaleY: number, pivotX: number = 0, pivotY: number = 0): ScaleCmd {\r\n        return this._saveToCmd(Render._context._scale, ScaleCmd.create.call(this, scaleX, scaleY, pivotX, pivotY));\r\n    }\r\n\r\n    /**\r\n     * 重新映射画布上的 (0,0) 位置。\r\n     * @param x 添加到水平坐标（x）上的值。\r\n     * @param y 添加到垂直坐标（y）上的值。\r\n     */\r\n    translate(tx: number, ty: number): TranslateCmd {\r\n        return this._saveToCmd(Render._context.translate, TranslateCmd.create.call(this, tx, ty));\r\n    }\r\n\r\n    /**\r\n     * 保存当前环境的状态。\r\n     */\r\n    save(): SaveCmd {\r\n        return this._saveToCmd(Render._context._save, SaveCmd.create.call(this));\r\n    }\r\n\r\n    /**\r\n     * 返回之前保存过的路径状态和属性。\r\n     */\r\n    restore(): RestoreCmd {\r\n        return this._saveToCmd(Render._context.restore, RestoreCmd.create.call(this));\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 替换文本内容。\r\n     * @param text 文本内容。\r\n     * @return 替换成功则值为true，否则值为flase。\r\n     */\r\n    replaceText(text: string): boolean {\r\n        this._repaint();\r\n        //todo 该函数现在加速器应该不对\r\n        var cmds: any[] = this._cmds;\r\n        if (!cmds) {\r\n            if (this._one && this._isTextCmd(this._one)) {\r\n                this._one.text = text;\r\n                return true;\r\n            }\r\n        } else {\r\n            for (var i: number = cmds.length - 1; i > -1; i--) {\r\n                if (this._isTextCmd(cmds[i])) {\r\n                    cmds[i].text = text;\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**@private */\r\n    private _isTextCmd(cmd: any): boolean {\r\n        var cmdID: string = cmd.cmdID;\r\n        return cmdID == FillTextCmd.ID;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 替换文本颜色。\r\n     * @param color 颜色。\r\n     */\r\n    replaceTextColor(color: string): void {\r\n        this._repaint();\r\n        var cmds: any[] = this._cmds;\r\n        if (!cmds) {\r\n            if (this._one && this._isTextCmd(this._one)) {\r\n                this._setTextCmdColor(this._one, color);\r\n            }\r\n        } else {\r\n            for (var i: number = cmds.length - 1; i > -1; i--) {\r\n                if (this._isTextCmd(cmds[i])) {\r\n                    this._setTextCmdColor(cmds[i], color);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    private _setTextCmdColor(cmdO: any, color: string): void {\r\n        var cmdID: string = cmdO.cmdID;\r\n        switch (cmdID) {\r\n            case FillTextCmd.ID:\r\n                (cmdO as FillTextCmd).color = color;\r\n                break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 加载并显示一个图片。\r\n     * @param url\t\t图片地址。\r\n     * @param x\t\t\t（可选）显示图片的x位置。\r\n     * @param y\t\t\t（可选）显示图片的y位置。\r\n     * @param width\t\t（可选）显示图片的宽度，设置为0表示使用图片默认宽度。\r\n     * @param height\t（可选）显示图片的高度，设置为0表示使用图片默认高度。\r\n     * @param complete\t（可选）加载完成回调。\r\n     */\r\n    loadImage(url: string, x: number = 0, y: number = 0, width: number = 0, height: number = 0, complete: Function = null): void {\r\n        var tex: Texture = ILaya.Loader.getRes(url);\r\n        if (!tex) {\r\n            tex = new Texture();\r\n            tex.load(url);\r\n            ILaya.Loader.cacheTexture(url, tex);\r\n            tex.once(Event.READY, this, this.drawImage, [tex, x, y, width, height]);\r\n        } else {\r\n            if (!tex.getIsReady()) {\r\n                tex.once(Event.READY, this, this.drawImage, [tex, x, y, width, height]);\r\n            } else\r\n                this.drawImage(tex, x, y, width, height);\r\n        }\r\n        if (complete != null) {\r\n            tex.getIsReady() ? complete.call(this._sp) : tex.on(Event.READY, this._sp, complete);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _renderEmpty(sprite: Sprite, context: Context, x: number, y: number): void {\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _renderAll(sprite: Sprite, context: Context, x: number, y: number): void {\r\n        var cmds: any[] = this._cmds;\r\n        for (var i: number = 0, n: number = cmds.length; i < n; i++) {\r\n            cmds[i].run(context, x, y);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _renderOne(sprite: Sprite, context: Context, x: number, y: number): void {\r\n        context.sprite = sprite;\r\n        this._one.run(context, x, y);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _renderOneImg(sprite: Sprite, context: Context, x: number, y: number): void {\r\n        context.sprite = sprite;\r\n        this._one.run(context, x, y);\r\n    }\r\n\r\n    /**\r\n     * 绘制一条线。\r\n     * @param fromX\t\tX轴开始位置。\r\n     * @param fromY\t\tY轴开始位置。\r\n     * @param toX\t\tX轴结束位置。\r\n     * @param toY\t\tY轴结束位置。\r\n     * @param lineColor\t颜色。\r\n     * @param lineWidth\t（可选）线条宽度。\r\n     */\r\n    drawLine(fromX: number, fromY: number, toX: number, toY: number, lineColor: string, lineWidth: number = 1): DrawLineCmd {\r\n        var offset: number = (lineWidth < 1 || lineWidth % 2 === 0) ? 0 : 0.5;\r\n        return this._saveToCmd(Render._context._drawLine, DrawLineCmd.create.call(this, fromX + offset, fromY + offset, toX + offset, toY + offset, lineColor, lineWidth, 0));\r\n    }\r\n\r\n    /**\r\n     * 绘制一系列线段。\r\n     * @param x\t\t\t开始绘制的X轴位置。\r\n     * @param y\t\t\t开始绘制的Y轴位置。\r\n     * @param points\t线段的点集合。格式:[x1,y1,x2,y2,x3,y3...]。\r\n     * @param lineColor\t线段颜色，或者填充绘图的渐变对象。\r\n     * @param lineWidth\t（可选）线段宽度。\r\n     */\r\n    drawLines(x: number, y: number, points: any[], lineColor: any, lineWidth: number = 1): DrawLinesCmd {\r\n        if (!points || points.length < 4) return null;\r\n        var offset: number = (lineWidth < 1 || lineWidth % 2 === 0) ? 0 : 0.5;\r\n        //TODO 线段需要缓存\r\n        return this._saveToCmd(Render._context._drawLines, DrawLinesCmd.create.call(this, x + offset, y + offset, points, lineColor, lineWidth, 0));\r\n    }\r\n\r\n    /**\r\n     * 绘制一系列曲线。\r\n     * @param x\t\t\t开始绘制的 X 轴位置。\r\n     * @param y\t\t\t开始绘制的 Y 轴位置。\r\n     * @param points\t线段的点集合，格式[controlX, controlY, anchorX, anchorY...]。\r\n     * @param lineColor\t线段颜色，或者填充绘图的渐变对象。\r\n     * @param lineWidth\t（可选）线段宽度。\r\n     */\r\n    drawCurves(x: number, y: number, points: any[], lineColor: any, lineWidth: number = 1): DrawCurvesCmd {\r\n        return this._saveToCmd(Render._context.drawCurves, DrawCurvesCmd.create.call(this, x, y, points, lineColor, lineWidth));\r\n    }\r\n\r\n    /**\r\n     * 绘制矩形。\r\n     * @param x\t\t\t开始绘制的 X 轴位置。\r\n     * @param y\t\t\t开始绘制的 Y 轴位置。\r\n     * @param width\t\t矩形宽度。\r\n     * @param height\t矩形高度。\r\n     * @param fillColor\t填充颜色，或者填充绘图的渐变对象。\r\n     * @param lineColor\t（可选）边框颜色，或者填充绘图的渐变对象。\r\n     * @param lineWidth\t（可选）边框宽度。\r\n     */\r\n    drawRect(x: number, y: number, width: number, height: number, fillColor: any, lineColor: any = null, lineWidth: number = 1): DrawRectCmd {\r\n        var offset: number = (lineWidth >= 1 && lineColor) ? lineWidth / 2 : 0;\r\n        var lineOffset: number = lineColor ? lineWidth : 0;\r\n        return this._saveToCmd(Render._context.drawRect, DrawRectCmd.create.call(this, x + offset, y + offset, width - lineOffset, height - lineOffset, fillColor, lineColor, lineWidth));\r\n    }\r\n\r\n    /**\r\n     * 绘制圆形。\r\n     * @param x\t\t\t圆点X 轴位置。\r\n     * @param y\t\t\t圆点Y 轴位置。\r\n     * @param radius\t半径。\r\n     * @param fillColor\t填充颜色，或者填充绘图的渐变对象。\r\n     * @param lineColor\t（可选）边框颜色，或者填充绘图的渐变对象。\r\n     * @param lineWidth\t（可选）边框宽度。\r\n     */\r\n    drawCircle(x: number, y: number, radius: number, fillColor: any, lineColor: any = null, lineWidth: number = 1): DrawCircleCmd {\r\n        var offset: number = (lineWidth >= 1 && lineColor) ? lineWidth / 2 : 0;\r\n        return this._saveToCmd(Render._context._drawCircle, DrawCircleCmd.create.call(this, x, y, radius - offset, fillColor, lineColor, lineWidth, 0));\r\n    }\r\n\r\n    /**\r\n     * 绘制扇形。\r\n     * @param x\t\t\t\t开始绘制的 X 轴位置。\r\n     * @param y\t\t\t\t开始绘制的 Y 轴位置。\r\n     * @param radius\t\t扇形半径。\r\n     * @param startAngle\t开始角度。\r\n     * @param endAngle\t\t结束角度。\r\n     * @param fillColor\t\t填充颜色，或者填充绘图的渐变对象。\r\n     * @param lineColor\t\t（可选）边框颜色，或者填充绘图的渐变对象。\r\n     * @param lineWidth\t\t（可选）边框宽度。\r\n     */\r\n    drawPie(x: number, y: number, radius: number, startAngle: number, endAngle: number, fillColor: any, lineColor: any = null, lineWidth: number = 1): DrawPieCmd {\r\n        var offset: number = (lineWidth >= 1 && lineColor) ? lineWidth / 2 : 0;\r\n        var lineOffset: number = lineColor ? lineWidth : 0;\r\n\r\n        return this._saveToCmd(Render._context._drawPie, DrawPieCmd.create.call(this, x + offset, y + offset, radius - lineOffset, Utils.toRadian(startAngle), Utils.toRadian(endAngle), fillColor, lineColor, lineWidth, 0));\r\n    }\r\n\r\n    /**\r\n     * 绘制多边形。\r\n     * @param x\t\t\t开始绘制的 X 轴位置。\r\n     * @param y\t\t\t开始绘制的 Y 轴位置。\r\n     * @param points\t多边形的点集合。\r\n     * @param fillColor\t填充颜色，或者填充绘图的渐变对象。\r\n     * @param lineColor\t（可选）边框颜色，或者填充绘图的渐变对象。\r\n     * @param lineWidth\t（可选）边框宽度。\r\n     */\r\n    drawPoly(x: number, y: number, points: any[], fillColor: any, lineColor: any = null, lineWidth: number = 1): DrawPolyCmd {\r\n        var tIsConvexPolygon: boolean = false;\r\n        //这里加入多加形是否是凸边形\r\n        if (points.length > 6) {\r\n            tIsConvexPolygon = false;\r\n        } else {\r\n            tIsConvexPolygon = true;\r\n        }\r\n        var offset: number = (lineWidth >= 1 && lineColor) ? (lineWidth % 2 === 0 ? 0 : 0.5) : 0;\r\n        //TODO 非凸多边形需要缓存\r\n        return this._saveToCmd(Render._context._drawPoly, DrawPolyCmd.create.call(this, x + offset, y + offset, points, fillColor, lineColor, lineWidth, tIsConvexPolygon, 0));\r\n    }\r\n\r\n    /**\r\n     * 绘制路径。\r\n     * @param x\t\t开始绘制的 X 轴位置。\r\n     * @param y\t\t开始绘制的 Y 轴位置。\r\n     * @param paths\t路径集合，路径支持以下格式：[[\"moveTo\",x,y],[\"lineTo\",x,y],[\"arcTo\",x1,y1,x2,y2,r],[\"closePath\"]]。\r\n     * @param brush\t（可选）刷子定义，支持以下设置{fillStyle:\"#FF0000\"}。\r\n     * @param pen\t（可选）画笔定义，支持以下设置{strokeStyle,lineWidth,lineJoin:\"bevel|round|miter\",lineCap:\"butt|round|square\",miterLimit}。\r\n     */\r\n    drawPath(x: number, y: number, paths: any[], brush: any = null, pen: any = null): DrawPathCmd {\r\n        return this._saveToCmd(Render._context._drawPath, DrawPathCmd.create.call(this, x, y, paths, brush, pen));\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 绘制带九宫格的图片\r\n     * @param\ttexture\r\n     * @param\tx\r\n     * @param\ty\r\n     * @param\twidth\r\n     * @param\theight\r\n     * @param\tsizeGrid\r\n     */\r\n    draw9Grid(texture: Texture, x: number = 0, y: number = 0, width: number = 0, height: number = 0, sizeGrid: any[] = null): void {\r\n        this._saveToCmd(null, Draw9GridTexture.create(texture, x, y, width, height, sizeGrid));\r\n    }\r\n}","/**\r\n\t * @private\r\n\t * 静态常量集合\r\n\t */\r\nexport class Const {\r\n    static NOT_ACTIVE: number = 0x01;\r\n    static ACTIVE_INHIERARCHY: number = 0x02;\r\n    static AWAKED: number = 0x04;\r\n    static NOT_READY: number = 0x08;\r\n    static DISPLAY: number = 0x10;\r\n    static HAS_ZORDER: number = 0x20;\r\n    static HAS_MOUSE: number = 0x40;\r\n    static DISPLAYED_INSTAGE: number = 0x80;\r\n    static DRAWCALL_OPTIMIZE: number = 0x100;\r\n}\r\n\r\n","import { Const } from \"../Const\"\r\nimport { Sprite } from \"../display/Sprite\"\r\nimport { SpriteConst } from \"../display/SpriteConst\"\r\nimport { SpriteStyle } from \"../display/css/SpriteStyle\"\r\nimport { Matrix } from \"../maths/Matrix\"\r\nimport { Rectangle } from \"../maths/Rectangle\"\r\nimport { Context } from \"../resource/Context\"\r\nimport { Texture } from \"../resource/Texture\"\r\nimport { _RenderFunction } from \"./RenderSprite\"\r\n\r\n/**\r\n * @internal\r\n * 快速节点命令执行器\r\n * 多个指令组合才有意义，单个指令没必要在下面加\r\n */\r\nexport class LayaGLQuickRunner {\r\n    /*[FILEINDEX:10000]*/\r\n    static map: _RenderFunction[] = [];\r\n    private static curMat: Matrix = new Matrix();\r\n    /**@internal */\r\n    static __init__(): void {\r\n        /*\r\n           glQuickMap[\"drawNode;\"] = drawNode;\r\n           glQuickMap[\"drawNodes;\"] = drawNodes;\r\n           glQuickMap[\"drawLayaGL;\"] = drawLayaGL;\r\n           glQuickMap[\"drawLayaGL;drawNodes;\"] = drawLayaGL_drawNodes;\r\n           glQuickMap[\"save;alpha;drawNode;restore;\"] = save_alpha_drawNode_restore;\r\n           glQuickMap[\"save;alpha;drawLayaGL;restore;\"] = save_alpha_drawLayaGL_restore;\r\n         */\r\n        //glQuickMap[\"save;alpha;drawTextureWithGr;restore;\"] = save_alpha_drawTextureWithGr_restore;\r\n        //glQuickMap[\"save;transform;drawTextureWithGr;restore;\"] = save_alpha_transform_drawTextureWithGr_restore;\r\n        //glQuickMap[\"save;alpha;transform;drawTextureWithGr;restore;\"] = save_alpha_transform_drawTextureWithGr_restore;\r\n        //glQuickMap[\"drawTextureWithGr;\"] = drawTextureWithGr;\r\n        //glQuickMap[\"save;transform;drawNodes;restore;\"] = save_transform_drawNodes_restore;\r\n        //glQuickMap[\"save;transform;drawLayaGL;restore;\"] = save_alpha_transform_drawLayaGL_restore;\r\n        //glQuickMap[\"save;alpha;transform;drawLayaGL;restore;\"] = save_alpha_transform_drawLayaGL_restore;\r\n        //glQuickMap[\"save;alpha;transform;drawLayaGL;restore;\"] = save_alpha_transform_drawLayaGL_restore;\r\n        //map[SpriteConst.TEXTURE] = _drawTexture;\r\n        LayaGLQuickRunner.map[SpriteConst.ALPHA | SpriteConst.TRANSFORM | SpriteConst.GRAPHICS] = LayaGLQuickRunner.alpha_transform_drawLayaGL;\r\n        //map[ SpriteConst.GRAPHICS] = _drawLayaGL;\r\n        LayaGLQuickRunner.map[SpriteConst.ALPHA | SpriteConst.GRAPHICS] = LayaGLQuickRunner.alpha_drawLayaGL;\r\n        LayaGLQuickRunner.map[SpriteConst.TRANSFORM | SpriteConst.GRAPHICS] = LayaGLQuickRunner.transform_drawLayaGL;\r\n        LayaGLQuickRunner.map[SpriteConst.TRANSFORM | SpriteConst.CHILDS] = LayaGLQuickRunner.transform_drawNodes;\r\n\r\n        LayaGLQuickRunner.map[SpriteConst.ALPHA | SpriteConst.TRANSFORM | SpriteConst.TEXTURE] = LayaGLQuickRunner.alpha_transform_drawTexture;\r\n        LayaGLQuickRunner.map[SpriteConst.ALPHA | SpriteConst.TEXTURE] = LayaGLQuickRunner.alpha_drawTexture;\r\n        LayaGLQuickRunner.map[SpriteConst.TRANSFORM | SpriteConst.TEXTURE] = LayaGLQuickRunner.transform_drawTexture;\r\n        LayaGLQuickRunner.map[SpriteConst.GRAPHICS | SpriteConst.CHILDS] = LayaGLQuickRunner.drawLayaGL_drawNodes;\r\n    }\r\n\r\n    static transform_drawTexture(sprite: Sprite, context: Context, x: number, y: number): void {\r\n        var style: SpriteStyle = sprite._style;\r\n        var tex: Texture = sprite.texture;\r\n\r\n\r\n        /*\r\n        var ctx:WebGLContext2D = context as WebGLContext2D;\r\n        var ctxm:Matrix = ctx._curMat;\r\n        ctxm.copyTo(curMat);\r\n        //context.saveTransform(curMat);\r\n        ctx.transformByMatrixNoSave(sprite.getTransform(), x, y);\r\n        ctx.drawTexture(tex, -style.pivotX, -style.pivotY, sprite._width || tex.width, sprite._height || tex.height);\r\n        curMat.copyTo(ctxm);\r\n        //ctx.restoreTransform(curMat);\r\n        */\r\n\r\n        context.saveTransform(LayaGLQuickRunner.curMat);\r\n        context.transformByMatrix(sprite.transform, x, y);\r\n\r\n        var width:number = sprite._width || tex.sourceWidth;\r\n        var height:number = sprite._height || tex.sourceHeight;\r\n        var wRate:number = width / tex.sourceWidth;\r\n        var hRate:number = height / tex.sourceHeight;\r\n        width = tex.width * wRate;\r\n        height = tex.height * hRate;\r\n        if (width <= 0 || height <= 0) return null;\r\n        var px = -sprite.pivotX + tex.offsetX * wRate;\r\n        var py = -sprite.pivotY + tex.offsetY * hRate;\r\n        context.drawTexture(tex, px, py, width, height);\r\n\r\n        context.restoreTransform(LayaGLQuickRunner.curMat);\r\n\r\n        /*\r\n        context.saveTransform(curMat);\r\n        var w:int = sprite._width || tex.width;\r\n        var h:int = sprite._height || tex.height;\r\n        var mat:Matrix = sprite.transform;// (sprite as Object)._tfChanged?(sprite as Object)._adjustTransform():(sprite as Object)._transform;\r\n        mat.tx += x; mat.ty += y;\r\n        //(context as WebGLContext2D).drawTextureWithTransform(tex, -style.pivotX, -style.pivotY, w, h,mat,x,y,1,null,null);\r\n    \t\r\n        var ctx:WebGLContext2D = context;\r\n        var curMat:Matrix = ctx._curMat;\r\n        var tmpMat:Matrix = ctx._tmpMatrix;\r\n        var transform = mat;\r\n        //克隆transform,因为要应用tx，ty，这里不能修改原始的transform\r\n        tmpMat.a = transform.a; tmpMat.b = transform.b; tmpMat.c = transform.c; tmpMat.d = transform.d; tmpMat.tx = transform.tx + x; tmpMat.ty = transform.ty + y;\r\n        tmpMat._bTransform = transform._bTransform;\r\n        if (transform && curMat._bTransform) {\r\n            Matrix.mul(tmpMat, curMat, tmpMat);\r\n            transform = tmpMat;\r\n            transform._bTransform = true;\r\n        }else {\r\n            //如果curmat没有旋转。\r\n            transform = tmpMat;\r\n        }\r\n        ctx._drawTextureM(tex, x, y, w,h, mat, 1,null);\r\n    \t\r\n        //var st = __JS__(\"performance.now()\");\r\n        //Laya.stage.perfdt += (__JS__(\"performance.now()\")-st);\r\n        context.restoreTransform(curMat);\r\n        */\r\n    }\r\n\r\n    //static public function _drawTexture(sprite:Sprite, context:Context, x:Number, y:Number):void {\r\n    //var tex:Texture = sprite.texture;\r\n    //context.drawTexture(tex, x-sprite.pivotX, y-sprite.pivotY, sprite._width || tex.width, sprite._height || tex.height);\r\n    //}\r\n\r\n    static alpha_drawTexture(sprite: Sprite, context: Context, x: number, y: number): void {\r\n        var style: SpriteStyle = sprite._style;\r\n        var alpha: number;\r\n        var tex: Texture = sprite.texture;\r\n        if ((alpha = style.alpha) > 0.01 || sprite._needRepaint()) {\r\n            var temp: number = context.globalAlpha;\r\n            context.globalAlpha *= alpha;\r\n            context.drawTexture(tex, x - style.pivotX + tex.offsetX, y - style.pivotY + tex.offsetY, sprite._width || tex.width, sprite._height || tex.height);\r\n            context.globalAlpha = temp;\r\n        }\r\n    }\r\n\r\n    static alpha_transform_drawTexture(sprite: Sprite, context: Context, x: number, y: number): void {\r\n        var style: SpriteStyle = sprite._style;\r\n        var alpha: number;\r\n        var tex: Texture = sprite.texture;\r\n        if ((alpha = style.alpha) > 0.01 || sprite._needRepaint()) {\r\n            var temp: number = context.globalAlpha;\r\n            context.globalAlpha *= alpha;\r\n\r\n            context.saveTransform(LayaGLQuickRunner.curMat);\r\n            context.transformByMatrix(sprite.transform, x, y);\r\n            context.drawTexture(tex, -style.pivotX + tex.offsetX, -style.pivotY + tex.offsetY, sprite._width || tex.width, sprite._height || tex.height);\r\n            context.restoreTransform(LayaGLQuickRunner.curMat);\r\n\r\n            context.globalAlpha = temp;\r\n        }\r\n    }\r\n\r\n    static alpha_transform_drawLayaGL(sprite: Sprite, context: Context, x: number, y: number): void {\r\n        var style: SpriteStyle = sprite._style;\r\n        var alpha: number;\r\n        if ((alpha = style.alpha) > 0.01 || sprite._needRepaint()) {\r\n            var temp: number = context.globalAlpha;\r\n            context.globalAlpha *= alpha;\r\n\r\n            context.saveTransform(LayaGLQuickRunner.curMat);\r\n            context.transformByMatrix(sprite.transform, x, y);\r\n            sprite._graphics && sprite._graphics._render(sprite, context, -style.pivotX, -style.pivotY);\r\n            context.restoreTransform(LayaGLQuickRunner.curMat);\r\n\r\n            context.globalAlpha = temp;\r\n        }\r\n    }\r\n\r\n    static alpha_drawLayaGL(sprite: Sprite, context: Context, x: number, y: number): void {\r\n        var style: SpriteStyle = sprite._style;\r\n        var alpha: number;\r\n        if ((alpha = style.alpha) > 0.01 || sprite._needRepaint()) {\r\n            var temp: number = context.globalAlpha;\r\n            context.globalAlpha *= alpha;\r\n            sprite._graphics && sprite._graphics._render(sprite, context, x - style.pivotX, y - style.pivotY);\r\n            context.globalAlpha = temp;\r\n        }\r\n    }\r\n\r\n    //static public function _drawLayaGL(sprite:Sprite, context:Context, x:Number, y:Number):void {\r\n    //sprite._graphics._render(sprite, context, x, y);\r\n    //}\t\t\r\n\r\n    static transform_drawLayaGL(sprite: Sprite, context: Context, x: number, y: number): void {\r\n        var style: SpriteStyle = sprite._style;\r\n        //var transform:Matrix = sprite.transform;\r\n\r\n        //临时\r\n        //if (transform) {\r\n        context.saveTransform(LayaGLQuickRunner.curMat);\r\n        context.transformByMatrix(sprite.transform, x, y);\r\n        sprite._graphics && sprite._graphics._render(sprite, context, -style.pivotX, -style.pivotY);\r\n        context.restoreTransform(LayaGLQuickRunner.curMat);\r\n        //}else {\r\n        //sprite._graphics && sprite._graphics._render(sprite, context, -style.pivotX, -style.pivotY);\r\n        //}\t\t\t\r\n    }\r\n\r\n    static transform_drawNodes(sprite: Sprite, context: Context, x: number, y: number): void {\r\n        //var transform:Matrix = sprite.transform;\r\n        var textLastRender: boolean = sprite._getBit(Const.DRAWCALL_OPTIMIZE) && context.drawCallOptimize(true);\r\n\r\n        var style: SpriteStyle = sprite._style;\r\n        context.saveTransform(LayaGLQuickRunner.curMat);\r\n        context.transformByMatrix(sprite.transform, x, y);\r\n\r\n        //x = x-style.pivotX;\r\n        //y = y - style.pivotY;\r\n\r\n        x = -style.pivotX;\r\n        y = -style.pivotY;\r\n\r\n        var childs: any[] = sprite._children, n: number = childs.length, ele: any;\r\n        if (style.viewport) {\r\n            var rect: Rectangle = style.viewport;\r\n            var left: number = rect.x;\r\n            var top: number = rect.y;\r\n            var right: number = rect.right;\r\n            var bottom: number = rect.bottom;\r\n            var _x: number, _y: number;\r\n\r\n            for (i = 0; i < n; ++i) {\r\n                if ((ele = (<Sprite>childs[i]))._visible && ((_x = ele._x) < right && (_x + ele.width) > left && (_y = ele._y) < bottom && (_y + ele.height) > top)) {\r\n                    ele.render(context, x, y);\r\n                }\r\n            }\r\n        } else {\r\n            for (var i: number = 0; i < n; ++i)\r\n                (ele = ((<Sprite>childs[i])))._visible && ele.render(context, x, y);\r\n        }\r\n\r\n        context.restoreTransform(LayaGLQuickRunner.curMat);\r\n        textLastRender && context.drawCallOptimize(false);\r\n    }\r\n\r\n    static drawLayaGL_drawNodes(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\r\n        var textLastRender: boolean = sprite._getBit(Const.DRAWCALL_OPTIMIZE) && context.drawCallOptimize(true);\r\n\r\n        var style: SpriteStyle = sprite._style;\r\n        x = x - style.pivotX;\r\n        y = y - style.pivotY;\r\n        sprite._graphics && sprite._graphics._render(sprite, context, x, y);\r\n\r\n        var childs: any[] = sprite._children, n: number = childs.length, ele: any;\r\n        if (style.viewport) {\r\n            var rect: Rectangle = style.viewport;\r\n            var left: number = rect.x;\r\n            var top: number = rect.y;\r\n            var right: number = rect.right;\r\n            var bottom: number = rect.bottom;\r\n            var _x: number, _y: number;\r\n\r\n            for (i = 0; i < n; ++i) {\r\n                if ((ele = (<Sprite>childs[i]))._visible && ((_x = ele._x) < right && (_x + ele.width) > left && (_y = ele._y) < bottom && (_y + ele.height) > top)) {\r\n                    ele.render(context, x, y);\r\n                }\r\n            }\r\n        } else {\r\n            for (var i: number = 0; i < n; ++i)\r\n                (ele = ((<Sprite>childs[i])))._visible && ele.render(context, x, y);\r\n        }\r\n\r\n        textLastRender && context.drawCallOptimize(false);\r\n    }\r\n}\r\n\r\n","import { Const } from \"../Const\";\r\nimport { CacheStyle } from \"../display/css/CacheStyle\";\r\nimport { SpriteStyle } from \"../display/css/SpriteStyle\";\r\nimport { TextStyle } from \"../display/css/TextStyle\";\r\nimport { Graphics } from \"../display/Graphics\";\r\nimport { Sprite } from \"../display/Sprite\";\r\nimport { SpriteConst } from \"../display/SpriteConst\";\r\nimport { Filter } from \"../filters/Filter\";\r\nimport { Matrix } from \"../maths/Matrix\";\r\nimport { Point } from \"../maths/Point\";\r\nimport { Rectangle } from \"../maths/Rectangle\";\r\nimport { Context } from \"../resource/Context\";\r\nimport { HTMLCanvas } from \"../resource/HTMLCanvas\";\r\nimport { RenderTexture2D } from \"../resource/RenderTexture2D\";\r\nimport { Texture } from \"../resource/Texture\";\r\nimport { WebGLRTMgr } from \"../resource/WebGLRTMgr\";\r\nimport { Stat } from \"../utils/Stat\";\r\nimport { BlendMode } from \"../webgl/canvas/BlendMode\";\r\nimport { WebGLCacheAsNormalCanvas } from \"../webgl/canvas/WebGLCacheAsNormalCanvas\";\r\nimport { ShaderDefines2D } from \"../webgl/shader/d2/ShaderDefines2D\";\r\nimport { Value2D } from \"../webgl/shader/d2/value/Value2D\";\r\nimport { SubmitCMD } from \"../webgl/submit/SubmitCMD\";\r\nimport { WebGLContext } from \"../webgl/WebGLContext\";\r\nimport { LayaGLQuickRunner } from \"./LayaGLQuickRunner\";\r\nimport { ILaya } from \"../../ILaya\";\r\n\r\n/**\r\n * @private\r\n * \r\n */\r\nexport interface _RenderFunction{\r\n\t(sp:Sprite,ctx:Context,x:number,y:number):void;\r\n}\r\n\r\n/**\r\n * @private\r\n * 精灵渲染器\r\n */\r\nexport class RenderSprite {\r\n\t/** @private */\r\n\t//public static const IMAGE:int = 0x01;\r\n\t/** @private */\r\n\t//public static const ALPHA:int = 0x02;\r\n\t/** @private */\r\n\t//public static const TRANSFORM:int = 0x04;\r\n\t/** @private */\r\n\t//public static const BLEND:int = 0x08;\r\n\t/** @private */\r\n\t//public static const CANVAS:int = 0x10;\r\n\t/** @private */\r\n\t//public static const FILTERS:int = 0x20;\r\n\t/** @private */\r\n\t//public static const MASK:int = 0x40;\r\n\t/** @private */\r\n\t//public static const CLIP:int = 0x80;\r\n\t/** @private */\r\n\t//public static const STYLE:int = 0x100;\r\n\t/** @private */\r\n\t//public static const GRAPHICS:int = 0x200;\r\n\t/** @private */\r\n\t//public static const CUSTOM:int = 0x400;\r\n\t/** @private */\r\n\t//public static const CHILDS:int = 0x800;\r\n\t/** @private */\r\n\tstatic INIT: number = 0x11111;\r\n\t/** @private */\r\n\tstatic renders: RenderSprite[] = [];\r\n\t/** @private */\r\n\tprotected static NORENDER: RenderSprite =  new RenderSprite(0, null);\r\n\t/** @internal */\r\n\t_next: RenderSprite;\r\n\t/** @internal */\r\n\t_fun: Function;\r\n\r\n\t/** @internal */\r\n\tstatic __init__(): void {\r\n\t\tLayaGLQuickRunner.__init__();\r\n\t\tvar i: number, len: number;\r\n\t\tvar initRender: RenderSprite;\r\n\t\tinitRender = new RenderSprite(RenderSprite.INIT, null);\r\n\t\tlen = RenderSprite.renders.length = SpriteConst.CHILDS * 2;\r\n\t\tfor (i = 0; i < len; i++)\r\n\t\t\tRenderSprite.renders[i] = initRender;\r\n\r\n\t\tRenderSprite.renders[0] = new RenderSprite(0, null);\r\n\r\n\t\tfunction _initSame(value: any[], o: RenderSprite): void {\r\n\t\t\tvar n: number = 0;\r\n\t\t\tfor (var i: number = 0; i < value.length; i++) {\r\n\t\t\t\tn |= value[i];\r\n\t\t\t\tRenderSprite.renders[n] = o;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//_initSame([SpriteConst.IMAGE, SpriteConst.GRAPHICS, SpriteConst.TRANSFORM, SpriteConst.ALPHA], RunDriver.createRenderSprite(SpriteConst.IMAGE, null));\r\n\t\t//\r\n\t\t//renders[SpriteConst.IMAGE | SpriteConst.GRAPHICS] = RunDriver.createRenderSprite(SpriteConst.IMAGE | SpriteConst.GRAPHICS, null);\r\n\t\t//\r\n\t\t//renders[SpriteConst.IMAGE | SpriteConst.TRANSFORM | SpriteConst.GRAPHICS] = RunDriver.createRenderSprite(SpriteConst.IMAGE | SpriteConst.TRANSFORM | SpriteConst.GRAPHICS, null);\r\n\t}\r\n\r\n\tprivate static _initRenderFun(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\t\tvar type: number = sprite._renderType;\r\n\t\tvar r: RenderSprite = RenderSprite.renders[type] = RenderSprite._getTypeRender(type);\r\n\t\tr._fun(sprite, context, x, y);\r\n\t}\r\n\r\n\tprivate static _getTypeRender(type: number): RenderSprite {\r\n\t\tif (LayaGLQuickRunner.map[type]) return new RenderSprite(type, null);\r\n\t\tvar rst: RenderSprite|null = null;\r\n\t\tvar tType: number = SpriteConst.CHILDS;\r\n\t\twhile (tType > 0) {\r\n\t\t\tif (tType & type)\r\n\t\t\t\trst = new RenderSprite(tType, rst);\r\n\t\t\ttType = tType >> 1;\r\n\t\t}\r\n\t\treturn rst as RenderSprite;\r\n\t}\r\n\r\n\r\n\r\n\tconstructor(type: number, next: RenderSprite|null) {\r\n\r\n\t\tif (LayaGLQuickRunner.map[type]) {\r\n\t\t\tthis._fun = LayaGLQuickRunner.map[type];\r\n\t\t\tthis._next = RenderSprite.NORENDER;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis._next = next || RenderSprite.NORENDER;\r\n\t\tswitch (type) {\r\n\t\t\tcase 0:\r\n\t\t\t\tthis._fun = this._no;\r\n\t\t\t\treturn;\r\n\t\t\t//case SpriteConst.IMAGE: \r\n\t\t\t//_fun = this._image;\r\n\t\t\t//return;\r\n\t\t\tcase SpriteConst.ALPHA:\r\n\t\t\t\tthis._fun = this._alpha;\r\n\t\t\t\treturn;\r\n\t\t\tcase SpriteConst.TRANSFORM:\r\n\t\t\t\tthis._fun = this._transform;\r\n\t\t\t\treturn;\r\n\t\t\tcase SpriteConst.BLEND:\r\n\t\t\t\tthis._fun = this._blend;\r\n\t\t\t\treturn;\r\n\t\t\tcase SpriteConst.CANVAS:\r\n\t\t\t\tthis._fun = this._canvas;\r\n\t\t\t\treturn;\r\n\t\t\tcase SpriteConst.MASK:\r\n\t\t\t\tthis._fun = this._mask;\r\n\t\t\t\treturn;\r\n\t\t\tcase SpriteConst.CLIP:\r\n\t\t\t\tthis._fun = this._clip;\r\n\t\t\t\treturn;\r\n\t\t\tcase SpriteConst.STYLE:\r\n\t\t\t\tthis._fun = this._style;\r\n\t\t\t\treturn;\r\n\t\t\tcase SpriteConst.GRAPHICS:\r\n\t\t\t\tthis._fun = this._graphics;\r\n\t\t\t\treturn;\r\n\t\t\tcase SpriteConst.CHILDS:\r\n\t\t\t\tthis._fun = this._children;\r\n\t\t\t\treturn;\r\n\t\t\tcase SpriteConst.CUSTOM:\r\n\t\t\t\tthis._fun = this._custom;\r\n\t\t\t\treturn;\r\n\t\t\tcase SpriteConst.TEXTURE:\r\n\t\t\t\tthis._fun = this._texture;\r\n\t\t\t\treturn;\r\n\t\t\t//case SpriteConst.IMAGE | SpriteConst.GRAPHICS: \r\n\t\t\t//_fun = this._image2;\r\n\t\t\t//return;\r\n\t\t\t//case SpriteConst.IMAGE | SpriteConst.TRANSFORM | SpriteConst.GRAPHICS: \r\n\t\t\t//_fun = this._image2;\r\n\t\t\t//return;\r\n\t\t\tcase SpriteConst.FILTERS:\r\n\t\t\t\tthis._fun = Filter._filter;\r\n\t\t\t\treturn;\r\n\t\t\tcase RenderSprite.INIT:\r\n\t\t\t\tthis._fun = RenderSprite._initRenderFun;\r\n\t\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.onCreate(type);\r\n\t}\r\n\r\n\tprotected onCreate(type: number): void {\r\n\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_style(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\t\t//现在只有Text会走这里，Html已经不走这里了\r\n\t\tvar style: TextStyle = (<TextStyle>sprite._style);\r\n\t\tif (style.render != null) style.render(sprite, context, x, y);\r\n\t\tvar next: RenderSprite = this._next;\r\n\t\tnext._fun.call(next, sprite, context, x, y);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_no(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_custom(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\t\tsprite.customRender(context, x, y);\r\n\t\tthis._next._fun.call(this._next, sprite, context, 0, 0);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_clip(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\t\tvar next: RenderSprite = this._next;\r\n\t\tif (next == RenderSprite.NORENDER) return;\r\n\t\tvar r: Rectangle = sprite._style.scrollRect;\r\n\t\tvar width = r.width;\r\n\t\tvar height = r.height;\r\n\t\tif (width === 0 || height === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tcontext.save();\r\n\t\tcontext.clipRect(x, y, width, height);\r\n\t\tnext._fun.call(next, sprite, context, x - r.x, y - r.y);\r\n\t\tcontext.restore();\r\n\t}\r\n\r\n\t/*\r\n\tpublic function _mask(sprite:Sprite, context:Context, x:Number, y:Number):void {\r\n\t\tvar next:RenderSprite = this._next;\r\n\t\tnext._fun.call(next, sprite, context, x, y);\r\n\t\tvar mask:Sprite = sprite.mask;\r\n\t\tif (mask) {\r\n\t\t\tcontext.globalCompositeOperation = \"destination-in\";\r\n\t\t\tif (mask.numChildren > 0 || !mask.graphics._isOnlyOne()) {\r\n\t\t\t\tmask.cacheAs = \"bitmap\";\r\n\t\t\t}\r\n\t\t\tmask.render(context, x - sprite._style.pivotX, y - sprite._style.pivotY);\r\n\t\t}\r\n\t\tcontext.globalCompositeOperation = \"source-over\";\r\n\t}\r\n\t*/\r\n\r\n\t/**@internal */\r\n\t_texture(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\t\tvar tex: Texture = sprite.texture;\r\n\t\tif (tex._getSource()) {\r\n\t\t\tvar width: number = sprite._width || tex.sourceWidth;\r\n            var height: number = sprite._height || tex.sourceHeight;\r\n\t\t\tvar wRate: number = width / tex.sourceWidth;\r\n            var hRate: number = height / tex.sourceHeight;\r\n            width = tex.width * wRate;\r\n            height = tex.height * hRate;\r\n            if (width <= 0 || height <= 0) return;\r\n\r\n            var px = x - sprite.pivotX + tex.offsetX * wRate;\r\n\t\t\tvar py = y - sprite.pivotY + tex.offsetY * hRate;\r\n\r\n\t\t\tcontext.drawTexture(tex, px, py, width, height);\r\n\t\t}\r\n\t\tvar next: RenderSprite = this._next;\r\n\t\tif (next != RenderSprite.NORENDER)\r\n\t\t\tnext._fun.call(next, sprite, context, x, y);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_graphics(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\t\tvar style = sprite._style;\r\n\t\tvar g = sprite._graphics;\r\n\t\tg && g._render(sprite, context, x - style.pivotX, y - style.pivotY);\r\n\t\tvar next = this._next;\r\n\t\tif (next != RenderSprite.NORENDER)\r\n\t\t\tnext._fun.call(next, sprite, context, x, y);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_image(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\t\tvar style: SpriteStyle = sprite._style;\r\n\t\tcontext.drawTexture2(x, y, style.pivotX, style.pivotY, sprite.transform, sprite._graphics._one);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_image2(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\t\tvar style: SpriteStyle = sprite._style;\r\n\t\tcontext.drawTexture2(x, y, style.pivotX, style.pivotY, sprite.transform, sprite._graphics._one);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t//TODO:coverage\r\n\t_alpha(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\r\n\t\tvar style: SpriteStyle = sprite._style;\r\n\t\tvar alpha: number;\r\n\t\tif ((alpha = style.alpha) > 0.01 || sprite._needRepaint()) {\r\n\t\t\tvar temp: number = context.globalAlpha;\r\n\t\t\tcontext.globalAlpha *= alpha;\r\n\t\t\tvar next: RenderSprite = this._next;\r\n\t\t\tnext._fun.call(next, sprite, context, x, y);\r\n\t\t\tcontext.globalAlpha = temp;\r\n\t\t}\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_transform(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\t\tvar transform: Matrix = sprite.transform, _next: RenderSprite = this._next;\r\n\t\tvar style: SpriteStyle = sprite._style;\r\n\t\tif (transform && _next != RenderSprite.NORENDER) {\r\n\t\t\tcontext.save();\r\n\t\t\tcontext.transform(transform.a, transform.b, transform.c, transform.d, transform.tx + x, transform.ty + y);\r\n\t\t\t_next._fun.call(_next, sprite, context, 0, 0);\r\n\t\t\tcontext.restore();\r\n\t\t} else {\r\n\t\t\tif (_next != RenderSprite.NORENDER)\r\n\t\t\t\t_next._fun.call(_next, sprite, context, x, y);\r\n\t\t}\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_children(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\t\tvar style: SpriteStyle = sprite._style;\r\n\t\tvar childs: any[] = sprite._children, n: number = childs.length, ele: any;\r\n\t\tx = x - sprite.pivotX;\r\n\t\ty = y - sprite.pivotY;\r\n\t\tvar textLastRender: boolean = sprite._getBit(Const.DRAWCALL_OPTIMIZE) && context.drawCallOptimize(true);\r\n\t\tif (style.viewport) {\r\n\t\t\tvar rect: Rectangle = style.viewport;\r\n\t\t\tvar left: number = rect.x;\r\n\t\t\tvar top: number = rect.y;\r\n\t\t\tvar right: number = rect.right;\r\n\t\t\tvar bottom: number = rect.bottom;\r\n\t\t\tvar _x: number, _y: number;\r\n\r\n\t\t\tfor (i = 0; i < n; ++i) {\r\n\t\t\t\tif ((ele = (<Sprite>childs[i]))._visible && ((_x = ele._x) < right && (_x + ele.width) > left && (_y = ele._y) < bottom && (_y + ele.height) > top)) {\r\n\t\t\t\t\tele.render(context, x, y);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfor (var i: number = 0; i < n; ++i)\r\n\t\t\t\t(ele = ((<Sprite>childs[i])))._visible && ele.render(context, x, y);\r\n\t\t}\r\n\t\ttextLastRender && context.drawCallOptimize(false);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_canvas(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\r\n\t\tvar _cacheStyle: CacheStyle = sprite._cacheStyle;\r\n\t\tvar _next: RenderSprite = this._next;\r\n\r\n\t\tif (!_cacheStyle.enableCanvasRender) {\r\n\t\t\t_next._fun.call(_next, sprite, context, x, y);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t_cacheStyle.cacheAs === 'bitmap' ? (Stat.canvasBitmap++) : (Stat.canvasNormal++);\r\n\r\n\t\t//检查保存的文字是否失效了\r\n\t\tvar cacheNeedRebuild: boolean = false;\r\n\t\tvar textNeedRestore: boolean = false;\r\n\r\n\t\tif (_cacheStyle.canvas) {\r\n\t\t\t// 检查文字是否被释放了，以及clip是否改变了，需要重新cache了\r\n\t\t\tvar canv: any = _cacheStyle.canvas;\r\n\t\t\tvar ctx: any = canv.context;\r\n\t\t\tvar charRIs: any[] = canv.touches;\r\n\t\t\tif (charRIs) {\r\n\t\t\t\tfor (var ci: number = 0; ci < charRIs.length; ci++) {\r\n\t\t\t\t\tif (charRIs[ci].deleted) {\r\n\t\t\t\t\t\ttextNeedRestore = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcacheNeedRebuild = canv.isCacheValid && !canv.isCacheValid();\r\n\t\t}\r\n\r\n\t\tif (sprite._needRepaint() || (!_cacheStyle.canvas) || textNeedRestore || cacheNeedRebuild || ILaya.stage.isGlobalRepaint()) {\r\n\t\t\tif (_cacheStyle.cacheAs === 'normal') {\r\n\t\t\t\tif (context._targets) {// 如果有target说明父节点已经是一个cacheas bitmap了，就不再走cacheas normal的流程了\r\n\t\t\t\t\t_next._fun.call(_next, sprite, context, x, y);\r\n\t\t\t\t\treturn;\t//不再继续\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._canvas_webgl_normal_repaint(sprite, context);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis._canvas_repaint(sprite, context, x, y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar tRec: Rectangle = _cacheStyle.cacheRect;\r\n\t\t//Stage._dbgSprite.graphics.drawRect(x, y, 30,30, null, 'red');\r\n\t\tcontext.drawCanvas(_cacheStyle.canvas, x + tRec.x, y + tRec.y, tRec.width, tRec.height);\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_canvas_repaint(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\r\n\t\tvar _cacheStyle: CacheStyle = sprite._cacheStyle;\r\n\t\tvar _next: RenderSprite = this._next;\r\n\t\tvar tx: Context;\r\n\t\tvar canvas: HTMLCanvas = _cacheStyle.canvas;\r\n\t\tvar left: number;\r\n\t\tvar top: number;\r\n\t\tvar tRec: Rectangle;\r\n\t\tvar tCacheType: string = _cacheStyle.cacheAs;\r\n\r\n\t\tvar w: number, h: number;\r\n\t\tvar scaleX: number, scaleY: number;\r\n\r\n\t\tvar scaleInfo: Point;\r\n\t\tscaleInfo = _cacheStyle._calculateCacheRect(sprite, tCacheType, x, y);\r\n\t\tscaleX = scaleInfo.x;\r\n\t\tscaleY = scaleInfo.y;\r\n\r\n\t\t//显示对象实际的绘图区域\r\n\t\ttRec = _cacheStyle.cacheRect;\r\n\r\n\t\t//计算cache画布的大小\r\n\t\tw = tRec.width * scaleX;\r\n\t\th = tRec.height * scaleY;\r\n\t\tleft = tRec.x;\r\n\t\ttop = tRec.y;\r\n\r\n\t\tif (tCacheType === 'bitmap' && (w > 2048 || h > 2048)) {\r\n\t\t\tconsole.warn(\"cache bitmap size larger than 2048,cache ignored\");\r\n\t\t\t_cacheStyle.releaseContext();\r\n\t\t\t_next._fun.call(_next, sprite, context, x, y);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!canvas) {\r\n\t\t\t_cacheStyle.createContext();\r\n\t\t\tcanvas = _cacheStyle.canvas;\r\n\t\t}\r\n\t\ttx = canvas.context as Context;\r\n\r\n\t\t//WebGL用\r\n\t\ttx.sprite = sprite;\r\n\r\n\t\t(canvas.width != w || canvas.height != h) && canvas.size(w, h);//asbitmap需要合理的大小，所以size放到前面\r\n\r\n\t\tif (tCacheType === 'bitmap') tx.asBitmap = true;\r\n\t\telse if (tCacheType === 'normal') tx.asBitmap = false;\r\n\r\n\t\t//清理画布。之前记录的submit会被全部清掉\r\n\t\ttx.clear();\r\n\r\n\t\t//TODO:测试webgl下是否有缓存模糊\r\n\t\tif (scaleX != 1 || scaleY != 1) {\r\n\t\t\tvar ctx: any = tx;\r\n\t\t\tctx.save();\r\n\t\t\tctx.scale(scaleX, scaleY);\r\n\t\t\t_next._fun.call(_next, sprite, tx, -left, -top);\r\n\t\t\tctx.restore();\r\n\t\t\tsprite._applyFilters();\r\n\t\t} else {\r\n\t\t\tctx = tx;\r\n\t\t\t_next._fun.call(_next, sprite, tx, -left, -top);\r\n\t\t\tsprite._applyFilters();\r\n\t\t}\r\n\r\n\t\tif (_cacheStyle.staticCache) _cacheStyle.reCache = false;\r\n\t\tStat.canvasReCache++;\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_canvas_webgl_normal_repaint(sprite: Sprite, context: Context): void {\r\n\r\n\t\tvar _cacheStyle: CacheStyle = sprite._cacheStyle;\r\n\t\tvar _next: RenderSprite = this._next;\r\n\t\tvar canvas:WebGLCacheAsNormalCanvas = _cacheStyle.canvas as unknown as WebGLCacheAsNormalCanvas;\r\n\r\n\t\tvar tCacheType: string = _cacheStyle.cacheAs;\r\n\t\t_cacheStyle._calculateCacheRect(sprite, tCacheType, 0, 0);\r\n\r\n\t\tif (!canvas) {\r\n\t\t\tcanvas = new WebGLCacheAsNormalCanvas(context, sprite);\r\n\t\t\t_cacheStyle.canvas = ((canvas as any) as HTMLCanvas);\r\n\t\t}\r\n\t\tvar tx: Context = canvas.context as Context;\r\n\r\n\r\n\t\tcanvas.startRec();\r\n\t\t_next._fun.call(_next, sprite, tx, sprite.pivotX, sprite.pivotY);\t// 由于后面的渲染会减去pivot，而cacheas normal并不希望这样，只希望创建一个原始的图像。所以在这里补偿。\r\n\t\tsprite._applyFilters();\r\n\r\n\t\tStat.canvasReCache++;\r\n\t\tcanvas.endRec();\r\n\r\n\t\t//context.drawCanvas(canvas, x , y , 1, 1); // 这种情况下宽高没用\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_blend(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\t\tvar style: SpriteStyle = sprite._style;\r\n\t\tvar next: RenderSprite = this._next;\r\n\t\tif (style.blendMode) {\r\n\t\t\tcontext.save();\r\n\t\t\tcontext.globalCompositeOperation = style.blendMode;\r\n\t\t\tnext._fun.call(next, sprite, context, x, y);\r\n\t\t\tcontext.restore();\r\n\t\t} else {\r\n\t\t\tnext._fun.call(next, sprite, context, x, y);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t * mask的渲染。 sprite有mask属性的情况下，来渲染这个sprite\r\n\t * @param\tsprite\r\n\t * @param\tcontext\r\n\t * @param\tx\r\n\t * @param\ty\r\n\t */\r\n\t_mask(sprite: Sprite, context: Context, x: number, y: number): void {\r\n\t\tvar next: RenderSprite = this._next;\r\n\t\tvar mask: Sprite = sprite.mask;\r\n\t\tvar submitCMD: SubmitCMD;\r\n\t\tvar ctx: Context = (<Context>context);\r\n\t\tif (mask) {\r\n\t\t\tctx.save();\r\n\t\t\tvar preBlendMode: string = ctx.globalCompositeOperation;\r\n\t\t\tvar tRect: Rectangle = new Rectangle();\r\n\t\t\t//裁剪范围是根据mask来定的\r\n\t\t\ttRect.copyFrom(mask.getBounds());\r\n\t\t\ttRect.width = Math.round(tRect.width);\r\n\t\t\ttRect.height = Math.round(tRect.height);\r\n\t\t\ttRect.x = Math.round(tRect.x);\r\n\t\t\ttRect.y = Math.round(tRect.y);\r\n\t\t\tif (tRect.width > 0 && tRect.height > 0) {\r\n\t\t\t\tvar w: number = tRect.width;\r\n\t\t\t\tvar h: number = tRect.height;\r\n\t\t\t\tvar tmpRT: RenderTexture2D = WebGLRTMgr.getRT(w, h);\r\n\r\n\t\t\t\tctx.breakNextMerge();\r\n\t\t\t\t//先把mask画到tmpTarget上\r\n\t\t\t\tctx.pushRT();\r\n\t\t\t\tctx.addRenderObject(SubmitCMD.create([ctx, tmpRT, w, h], RenderSprite.tmpTarget, this));\r\n\t\t\t\tmask.render(ctx, -tRect.x, -tRect.y);\r\n\t\t\t\tctx.breakNextMerge();\r\n\t\t\t\tctx.popRT();\r\n\t\t\t\t//设置裁剪为mask的大小。要考虑pivot。有pivot的话，可能要从负的开始\r\n\t\t\t\tctx.save();\r\n\t\t\t\tctx.clipRect(x + tRect.x - sprite.getStyle().pivotX, y + tRect.y - sprite.getStyle().pivotY, w, h);\r\n\t\t\t\t//画出本节点的内容\r\n\t\t\t\tnext._fun.call(next, sprite, ctx, x, y);\r\n\t\t\t\tctx.restore();\r\n\r\n\t\t\t\t//设置混合模式\r\n\t\t\t\tpreBlendMode = ctx.globalCompositeOperation;\r\n\t\t\t\tctx.addRenderObject(SubmitCMD.create([\"mask\"], RenderSprite.setBlendMode, this));\r\n\r\n\t\t\t\tvar shaderValue: Value2D = Value2D.create(ShaderDefines2D.TEXTURE2D, 0);\r\n\t\t\t\tvar uv = Texture.INV_UV;\r\n\t\t\t\t//这个地方代码不要删除，为了解决在iphone6-plus上的诡异问题\r\n\t\t\t\t//renderTarget + StencilBuffer + renderTargetSize < 32 就会变得超级卡\r\n\t\t\t\t//所以增加的限制。王亚伟\r\n\t\t\t\t//  180725 本段限制代码已经删除，如果出了问题再找王亚伟\r\n\r\n\t\t\t\tctx.drawTarget(tmpRT, x + tRect.x - sprite.getStyle().pivotX, y + tRect.y - sprite.getStyle().pivotY, w, h, Matrix.TEMP.identity(), shaderValue, uv, 6);\r\n\t\t\t\tctx.addRenderObject(SubmitCMD.create([tmpRT], RenderSprite.recycleTarget, this));\r\n\r\n\t\t\t\t//恢复混合模式\r\n\t\t\t\tctx.addRenderObject(SubmitCMD.create([preBlendMode], RenderSprite.setBlendMode, this));\r\n\t\t\t}\r\n\t\t\tctx.restore();\r\n\t\t} else {\r\n\t\t\tnext._fun.call(next, sprite, context, x, y);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tstatic tempUV: any[] = new Array(8);\r\n\tstatic tmpTarget(ctx: Context, rt: RenderTexture2D, w: number, h: number): void {\r\n\t\trt.start();\r\n\t\trt.clear(0, 0, 0, 0);\r\n\t}\r\n\r\n\tstatic recycleTarget(rt: RenderTexture2D): void {\r\n\t\tWebGLRTMgr.releaseRT(rt);\r\n\t}\r\n\r\n\tstatic setBlendMode(blendMode: string): void {\r\n\t\tvar gl: WebGLContext = WebGLContext.mainContext;\r\n\t\tBlendMode.targetFns[BlendMode.TOINT[blendMode]](gl);\r\n\t}\r\n\r\n}\r\n\r\n","import { Bitmap } from \"./Bitmap\";\r\nimport { Texture } from \"./Texture\";\r\nimport { Texture2D } from \"./Texture2D\";\r\nimport { Context } from \"./Context\";\r\nimport { ILaya } from \"../../ILaya\";\r\nimport { Browser } from \"../utils/Browser\";\r\n\r\n\r\n/**\r\n * <code>HTMLCanvas</code> 是 Html Canvas 的代理类，封装了 Canvas 的属性和方法。\r\n */\r\nexport class HTMLCanvas extends Bitmap {\r\n\r\n    private _ctx: any;\r\n    /**@internal */\r\n    _source: HTMLCanvasElement;\r\n    /**@internal */\r\n    _texture: Texture|null;\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    get source() {\r\n        return this._source;\r\n    }\r\n    /**@internal \r\n     * @override\r\n    */\r\n    _getSource() {\r\n        return this._source;\r\n    }\r\n    /**\r\n     * 根据指定的类型，创建一个 <code>HTMLCanvas</code> 实例。\r\n     */\r\n    constructor(createCanvas: boolean = false) {\r\n        super();\r\n        if (createCanvas)\t//webgl模式下不建立。除非强制指，例如绘制文字部分\r\n            this._source = Browser.createElement(\"canvas\");\r\n        else {\r\n            this._source = this as unknown as HTMLCanvasElement;\r\n        }\r\n        this.lock = true;\r\n    }\r\n\r\n    /**\r\n     * 清空画布内容。\r\n     */\r\n    clear(): void {\r\n        if (this._ctx){\r\n            if(this._ctx.clear){\r\n                this._ctx.clear();\r\n            }else{\r\n                this._ctx.clearRect(0,0,this._width,this._height);\r\n            }\r\n        }\r\n        if (this._texture) {\r\n            this._texture.destroy();\r\n            this._texture = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 销毁。\r\n     * @override\r\n     */\r\n    destroy(): void {\r\n        super.destroy();\r\n        this._setCPUMemory(0);\r\n        this._ctx && this._ctx.destroy && this._ctx.destroy();\r\n        this._ctx = null;\r\n    }\r\n\r\n    /**\r\n     * 释放。\r\n     */\r\n    release(): void {\r\n    }\r\n\r\n    /**\r\n     * Canvas 渲染上下文。\r\n     */\r\n    get context(): Context {\r\n\t\tif (this._ctx) return this._ctx;\r\n\t\t//@ts-ignore\r\n        if (this._source == this) {\t//是webgl并且不是真的画布。如果是真的画布，可能真的想要2d context\r\n            this._ctx = new ILaya.Context();\r\n        } else {\r\n            this._ctx = this._source.getContext(ILaya.Render.isConchApp ? 'layagl' : '2d');\r\n        }\r\n        this._ctx._canvas = this;\r\n        //if(!Browser.onLimixiu) _ctx.size = function(w:Number, h:Number):void {};\t这个是干什么的，会导致ctx的size不好使\r\n        return this._ctx;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 设置 Canvas 渲染上下文。是webgl用来替换_ctx用的\r\n     * @param\tcontext Canvas 渲染上下文。\r\n     */\r\n    _setContext(context: Context): void {\r\n        this._ctx = context;\r\n    }\r\n\r\n    /**\r\n     * 获取 Canvas 渲染上下文。\r\n     * @param\tcontextID 上下文ID.\r\n     * @param\tother\r\n     * @return  Canvas 渲染上下文 Context 对象。\r\n     */\r\n    getContext(contextID: string, other: any = null): Context {\r\n        return this.context;\r\n    }\r\n\r\n\r\n    /**\r\n     * 获取内存大小。\r\n     * @return 内存大小。\r\n     */\r\n    //TODO:coverage\r\n    getMemSize(): number {\r\n        return 0;//TODO:待调整\r\n    }\r\n\r\n    /**\r\n     * 设置宽高。\r\n     * @param\tw 宽度。\r\n     * @param\th 高度。\r\n     */\r\n    size(w: number, h: number): void {\r\n        if (this._width != w || this._height != h || (this._source && (this._source.width != w || this._source.height != h))) {\r\n            this._width = w;\r\n            this._height = h;\r\n            this._setCPUMemory(w * h * 4);\r\n            this._ctx && this._ctx.size && this._ctx.size(w, h);\r\n            if (this._source) {// && this._source instanceof HTMLCanvasElement){\r\n                this._source.height = h;\r\n                this._source.width = w;\r\n            }\r\n            if (this._texture) {\r\n                this._texture.destroy();\r\n                this._texture = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 获取texture实例\r\n     */\r\n    getTexture(): Texture {\r\n        if (!this._texture) {\r\n            var bitmap: Texture2D = new Texture2D();\r\n            bitmap.loadImageSource(this.source);\r\n            this._texture = new Texture(bitmap);\r\n        }\r\n        return this._texture;\r\n    }\r\n\r\n    /**\r\n     * 把图片转换为base64信息\r\n     * @param\ttype \"image/png\"\r\n     * @param\tencoderOptions\t质量参数，取值范围为0-1\r\n     */\r\n    toBase64(type: string, encoderOptions: number): string|null {\r\n        if (this._source) {\r\n            if (ILaya.Render.isConchApp) {\r\n                var win: any = window as any;\r\n                if (win.conchConfig.threadMode == 2) {\r\n                    throw \"native 2 thread mode use toBase64Async\";\r\n                }\r\n                var width: number = this._ctx._targets.sourceWidth;\r\n                var height: number = this._ctx._targets.sourceHeight;\r\n                var data: any = this._ctx._targets.getData(0, 0, width, height);\r\n                return win.conchToBase64FlipY ? win.conchToBase64FlipY(type, encoderOptions, data.buffer, width, height) : win.conchToBase64(type, encoderOptions, data.buffer, width, height);\r\n            }\r\n            else {\r\n                return (this._source as HTMLCanvasElement).toDataURL(type, encoderOptions);\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    //native多线程\r\n    toBase64Async(type: string, encoderOptions: number, callBack: Function): void {\r\n        var width: number = this._ctx._targets.sourceWidth;\r\n        var height: number = this._ctx._targets.sourceHeight;\r\n        this._ctx._targets.getDataAsync(0, 0, width, height, function (data: Uint8Array): void {\r\n            let win = window as any;\r\n            var base64 = win.conchToBase64FlipY ? win.conchToBase64FlipY(type, encoderOptions, data.buffer, width, height) : win.conchToBase64(type, encoderOptions, data.buffer, width, height);\r\n            callBack(base64);\r\n        });\r\n    }\r\n}\r\n\r\n","import { Graphics } from \"../display/Graphics\"\r\nimport { Point } from \"../maths/Point\"\r\nimport { Rectangle } from \"../maths/Rectangle\"\r\nimport { ILaya } from \"../../ILaya\";\r\n\r\n/**\r\n * 鼠标点击区域，可以设置绘制一系列矢量图作为点击区域和非点击区域（目前只支持圆形，矩形，多边形）\r\n *\r\n */\r\nexport class HitArea {\r\n\r\n    /**@private */\r\n    private static _cmds: any[] = [];\r\n    /**@private */\r\n    private static _rect: Rectangle = new Rectangle();\r\n    /**@private */\r\n    private static _ptPoint: Point = new Point();\r\n    /**@private */\r\n    private _hit: Graphics;\r\n    /**@private */\r\n    private _unHit: Graphics;\r\n\r\n    /**\r\n     * 检测对象是否包含指定的点。\r\n     * @param\tx\t点的 X 轴坐标值（水平位置）。\r\n     * @param\ty\t点的 Y 轴坐标值（垂直位置）。\r\n     * @return\t如果包含指定的点，则值为 true；否则为 false。\r\n     */\r\n    contains(x: number, y: number): boolean {\r\n        if (!HitArea._isHitGraphic(x, y, this.hit)) return false;\r\n        return !HitArea._isHitGraphic(x, y, this.unHit);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 是否击中Graphic\r\n     */\r\n    static _isHitGraphic(x: number, y: number, graphic: Graphics): boolean {\r\n        if (!graphic) return false;\r\n        var cmds: any[] = graphic.cmds;\r\n        if (!cmds && graphic._one) {\r\n            cmds = HitArea._cmds;\r\n            cmds.length = 1;\r\n            cmds[0] = graphic._one;\r\n        }\r\n        if (!cmds) return false;\r\n        var i: number, len: number;\r\n        len = cmds.length;\r\n        var cmd: any;\r\n        for (i = 0; i < len; i++) {\r\n            cmd = cmds[i];\r\n            if (!cmd) continue;\r\n            switch (cmd.cmdID) {\r\n                case \"Translate\":\r\n                    x -= cmd.tx;\r\n                    y -= cmd.ty;\r\n            }\r\n            if (HitArea._isHitCmd(x, y, cmd)) return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 是否击中绘图指令\r\n     */\r\n    static _isHitCmd(x: number, y: number, cmd: any): boolean {\r\n        if (!cmd) return false;\r\n        var rst: boolean = false;\r\n        switch (cmd.cmdID) {\r\n            case \"DrawRect\":\r\n                HitArea._rect.setTo(cmd.x, cmd.y, cmd.width, cmd.height);\r\n                rst = HitArea._rect.contains(x, y);\r\n                break;\r\n            case \"DrawCircle\":\r\n                var d: number;\r\n                x -= cmd.x;\r\n                y -= cmd.y;\r\n                d = x * x + y * y;\r\n                rst = d < cmd.radius * cmd.radius;\r\n                break;\r\n            case \"DrawPoly\":\r\n                x -= cmd.x;\r\n                y -= cmd.y;\r\n                rst = HitArea._ptInPolygon(x, y, cmd.points);\r\n                break;\r\n        }\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 坐标是否在多边形内\r\n     */\r\n    static _ptInPolygon(x: number, y: number, areaPoints: any[]): boolean {\r\n        var p: Point = HitArea._ptPoint;\r\n        p.setTo(x, y);\r\n        // 交点个数\r\n        var nCross: number = 0;\r\n        var p1x: number, p1y: number, p2x: number, p2y: number;\r\n        var len: number;\r\n        len = areaPoints.length;\r\n        for (var i: number = 0; i < len; i += 2) {\r\n            p1x = areaPoints[i];\r\n            p1y = areaPoints[i + 1];\r\n            p2x = areaPoints[(i + 2) % len];\r\n            p2y = areaPoints[(i + 3) % len];\r\n            //var p1:Point = areaPoints[i];\r\n            //var p2:Point = areaPoints[(i + 1) % areaPoints.length]; // 最后一个点与第一个点连线\r\n            if (p1y == p2y) continue;\r\n            if (p.y < Math.min(p1y, p2y)) continue;\r\n            if (p.y >= Math.max(p1y, p2y)) continue;\r\n            // 求交点的x坐标\r\n            var tx: number = (p.y - p1y) * (p2x - p1x) / (p2y - p1y) + p1x;\r\n            // 只统计p1p2与p向右射线的交点\r\n            if (tx > p.x) nCross++;\r\n        }\r\n        // 交点为偶数，点在多边形之外\r\n        return (nCross % 2 == 1);\r\n    }\r\n\r\n    /**\r\n     * 可点击区域，可以设置绘制一系列矢量图作为点击区域（目前只支持圆形，矩形，多边形）\r\n     */\r\n    get hit(): Graphics {\r\n        if (!this._hit) this._hit = new ILaya.Graphics();\r\n        return this._hit;\r\n    }\r\n\r\n    set hit(value: Graphics) {\r\n        this._hit = value;\r\n    }\r\n\r\n    /**\r\n     * 不可点击区域，可以设置绘制一系列矢量图作为非点击区域（目前只支持圆形，矩形，多边形）\r\n     */\r\n    get unHit(): Graphics {\r\n        if (!this._unHit) this._unHit = new ILaya.Graphics();\r\n        return this._unHit;\r\n    }\r\n\r\n    set unHit(value: Graphics) {\r\n        this._unHit = value;\r\n    }\r\n}\r\n\r\n","import { Matrix } from \"../maths/Matrix\"\r\nimport { Handler } from \"./Handler\";\r\nimport { Sprite } from \"../display/Sprite\";\r\nimport { Node } from \"../display/Node\";\r\nimport { Graphics } from \"../display/Graphics\";\r\nimport { ILaya } from \"../../ILaya\";\r\nimport { HitArea } from \"../utils/HitArea\";\r\n\r\n\r\n/**\r\n * <code>ClassUtils</code> 是一个类工具类。\r\n */\r\nexport class ClassUtils {\r\n    /**@private */\r\n    private static DrawTypeDic: any = { \"Rect\": [\"drawRect\", [[\"x\", 0], [\"y\", 0], [\"width\", 0], [\"height\", 0], [\"fillColor\", null], [\"lineColor\", null], [\"lineWidth\", 1]]], \"Circle\": [\"drawCircle\", [[\"x\", 0], [\"y\", 0], [\"radius\", 0], [\"fillColor\", null], [\"lineColor\", null], [\"lineWidth\", 1]]], \"Pie\": [\"drawPie\", [[\"x\", 0], [\"y\", 0], [\"radius\", 0], [\"startAngle\", 0], [\"endAngle\", 0], [\"fillColor\", null], [\"lineColor\", null], [\"lineWidth\", 1]]], \"Image\": [\"drawTexture\", [[\"x\", 0], [\"y\", 0], [\"width\", 0], [\"height\", 0]]], \"Texture\": [\"drawTexture\", [[\"skin\", null], [\"x\", 0], [\"y\", 0], [\"width\", 0], [\"height\", 0]], 1, \"_adptTextureData\"], \"FillTexture\": [\"fillTexture\", [[\"skin\", null], [\"x\", 0], [\"y\", 0], [\"width\", 0], [\"height\", 0], [\"repeat\", null]], 1, \"_adptTextureData\"], \"FillText\": [\"fillText\", [[\"text\", \"\"], [\"x\", 0], [\"y\", 0], [\"font\", null], [\"color\", null], [\"textAlign\", null]], 1], \"Line\": [\"drawLine\", [[\"x\", 0], [\"y\", 0], [\"toX\", 0], [\"toY\", 0], [\"lineColor\", null], [\"lineWidth\", 0]], 0, \"_adptLineData\"], \"Lines\": [\"drawLines\", [[\"x\", 0], [\"y\", 0], [\"points\", \"\"], [\"lineColor\", null], [\"lineWidth\", 0]], 0, \"_adptLinesData\"], \"Curves\": [\"drawCurves\", [[\"x\", 0], [\"y\", 0], [\"points\", \"\"], [\"lineColor\", null], [\"lineWidth\", 0]], 0, \"_adptLinesData\"], \"Poly\": [\"drawPoly\", [[\"x\", 0], [\"y\", 0], [\"points\", \"\"], [\"fillColor\", null], [\"lineColor\", null], [\"lineWidth\", 1]], 0, \"_adptLinesData\"] };\r\n    /**@private */\r\n    private static _temParam: any[] = [];\r\n    /**@private */\r\n    private static _classMap: any = {}\r\n    /**@private */\r\n    private static _tM: Matrix;\r\n    /**@private */\r\n    private static _alpha: number;\r\n\r\n    /**\r\n     * 注册 Class 映射，方便在class反射时获取。\r\n     * @param\tclassName 映射的名字或者别名。\r\n     * @param\tclassDef 类的全名或者类的引用，全名比如:\"laya.display.Sprite\"。\r\n     */\r\n    static regClass(className: string, classDef: any): void {\r\n        ClassUtils._classMap[className] = classDef;\r\n    }\r\n\r\n    /**\r\n     * 根据类名短名字注册类，比如传入[Sprite]，功能同regClass(\"Sprite\",Sprite);\r\n     * @param\tclasses 类数组\r\n     */\r\n    static regShortClassName(classes: any[]): void {\r\n        for (var i: number = 0; i < classes.length; i++) {\r\n            var classDef: any = classes[i];\r\n            var className: string = classDef.name;\r\n            ClassUtils._classMap[className] = classDef;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 返回注册的 Class 映射。\r\n     * @param\tclassName 映射的名字。\r\n     */\r\n    static getRegClass(className: string): any {\r\n        return ClassUtils._classMap[className];\r\n    }\r\n\r\n    /**\r\n     * 根据名字返回类对象。\r\n     * @param\tclassName 类名(比如laya.display.Sprite)或者注册的别名(比如Sprite)。\r\n     * @return 类对象\r\n     */\r\n    static getClass(className: string): any {\r\n        var classObject = ClassUtils._classMap[className] || ClassUtils._classMap['Laya.' + className] || className;\r\n\r\n        var glaya: any = ILaya.Laya\r\n        if (typeof (classObject) == 'string') return (ILaya.__classMap[classObject as string] || glaya[className]);\r\n        return classObject;\r\n    }\r\n\r\n    /**\r\n     * 根据名称创建 Class 实例。\r\n     * @param\tclassName 类名(比如laya.display.Sprite)或者注册的别名(比如Sprite)。\r\n     * @return\t返回类的实例。\r\n     */\r\n    static getInstance(className: string): any {\r\n        var compClass: any = ClassUtils.getClass(className);\r\n        if (compClass) return new compClass();\r\n        else console.warn(\"[error] Undefined class:\", className);\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * 根据指定的 json 数据创建节点对象。\r\n     * 比如:\r\n     * {\r\n     * \t\"type\":\"Sprite\",\r\n     * \t\"props\":{\r\n     * \t\t\"x\":100,\r\n     * \t\t\"y\":50,\r\n     * \t\t\"name\":\"item1\",\r\n     * \t\t\"scale\":[2,2]\r\n     * \t},\r\n     * \t\"customProps\":{\r\n     * \t\t\"x\":100,\r\n     * \t\t\"y\":50,\r\n     * \t\t\"name\":\"item1\",\r\n     * \t\t\"scale\":[2,2]\r\n     * \t},\r\n     * \t\"child\":[\r\n     * \t\t{\r\n     * \t\t\t\"type\":\"Text\",\r\n     * \t\t\t\"props\":{\r\n     * \t\t\t\t\"text\":\"this is a test\",\r\n     * \t\t\t\t\"var\":\"label\",\r\n     * \t\t\t\t\"rumtime\":\"\"\r\n     * \t\t\t}\r\n     * \t\t}\r\n     * \t]\r\n     * }\r\n     * @param\tjson json字符串或者Object对象。\r\n     * @param\tnode node节点，如果为空，则新创建一个。\r\n     * @param\troot 根节点，用来设置var定义。\r\n     * @return\t生成的节点。\r\n     */\r\n    static createByJson(json: any, node: any = null, root: Node = null, customHandler: Handler = null, instanceHandler: Handler = null): any {\r\n        if (typeof (json) == 'string') json = JSON.parse((<string>json));\r\n        var props: any = json.props;\r\n\r\n        if (!node) {\r\n            node = instanceHandler ? instanceHandler.runWith(json) : ClassUtils.getInstance(props.runtime || json.type);\r\n            if (!node) return null;\r\n        }\r\n\r\n        var child: any[] = json.child;\r\n        if (child) {\r\n            for (var i: number = 0, n: number = child.length; i < n; i++) {\r\n                var data: any = child[i];\r\n                if ((data.props.name === \"render\" || data.props.renderType === \"render\") && node[\"_$set_itemRender\"])\r\n                    node.itemRender = data;\r\n                else {\r\n                    if (data.type == \"Graphic\") {\r\n                        ClassUtils._addGraphicsToSprite(data, node);\r\n                    } else if (ClassUtils._isDrawType(data.type)) {\r\n                        ClassUtils._addGraphicToSprite(data, node, true);\r\n                    } else {\r\n                        var tChild: any = ClassUtils.createByJson(data, null, root, customHandler, instanceHandler)\r\n                        if (data.type === \"Script\") {\r\n                            if (\"owner\" in tChild) {\r\n                                tChild[\"owner\"] = node;\r\n                            } else if (\"target\" in tChild) {\r\n                                tChild[\"target\"] = node;\r\n                            }\r\n                        } else if (data.props.renderType == \"mask\") {\r\n                            node.mask = tChild;\r\n                        } else {\r\n                            node.addChild(tChild);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (props) {\r\n            for (var prop in props) {\r\n                var value: any = props[prop];\r\n                if (prop === \"var\" && root) {\r\n                    root[value] = node;\r\n                } else if (value instanceof Array && node[prop] instanceof Function) {\r\n                    node[prop].apply(node, value);\r\n                } else {\r\n                    node[prop] = value;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (customHandler && json.customProps) {\r\n            customHandler.runWith([node, json]);\r\n        }\r\n\r\n        if (node[\"created\"]) node.created();\r\n\r\n        return node;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 将graphic对象添加到Sprite上\r\n     * @param graphicO graphic对象描述\r\n     */\r\n    static _addGraphicsToSprite(graphicO: any, sprite: Sprite): void {\r\n        var graphics: any[] = graphicO.child;\r\n        if (!graphics || graphics.length < 1) return;\r\n        var g: Graphics = ClassUtils._getGraphicsFromSprite(graphicO, sprite);\r\n        var ox: number = 0;\r\n        var oy: number = 0;\r\n        if (graphicO.props) {\r\n            ox = ClassUtils._getObjVar(graphicO.props, \"x\", 0);\r\n            oy = ClassUtils._getObjVar(graphicO.props, \"y\", 0);\r\n        }\r\n        if (ox != 0 && oy != 0) {\r\n            g.translate(ox, oy);\r\n        }\r\n        var i: number, len: number;\r\n        len = graphics.length;\r\n        for (i = 0; i < len; i++) {\r\n            ClassUtils._addGraphicToGraphics(graphics[i], g);\r\n        }\r\n        if (ox != 0 && oy != 0) {\r\n            g.translate(-ox, -oy);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 将graphic绘图指令添加到sprite上\r\n     * @param graphicO 绘图指令描述\r\n     */\r\n    static _addGraphicToSprite(graphicO: any, sprite: Sprite, isChild: boolean = false): void {\r\n        var g: Graphics = isChild ? ClassUtils._getGraphicsFromSprite(graphicO, sprite) : sprite.graphics;\r\n        ClassUtils._addGraphicToGraphics(graphicO, g);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private static _getGraphicsFromSprite(dataO: any, sprite: Sprite): Graphics {\r\n        if (!dataO || !dataO.props) return sprite.graphics;\r\n        var propsName: string = dataO.props.renderType;\r\n        if (propsName === \"hit\" || propsName === \"unHit\") {\r\n            var hitArea: HitArea = sprite._style.hitArea || (sprite.hitArea = new HitArea());\r\n            if (!hitArea[propsName]) {\r\n                hitArea[propsName] = new Graphics();\r\n            }\r\n            var g: Graphics = hitArea[propsName];\r\n        }\r\n        if (!g) g = sprite.graphics;\r\n        return g;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private static _getTransformData(propsO: any): Matrix {\r\n        var m: Matrix;\r\n\r\n        if (\"pivotX\" in propsO || \"pivotY\" in propsO) {\r\n            m = m || new Matrix();\r\n            m.translate(-ClassUtils._getObjVar(propsO, \"pivotX\", 0), -ClassUtils._getObjVar(propsO, \"pivotY\", 0));\r\n        }\r\n\r\n        var sx: number = ClassUtils._getObjVar(propsO, \"scaleX\", 1), sy: number = ClassUtils._getObjVar(propsO, \"scaleY\", 1);\r\n        var rotate: number = ClassUtils._getObjVar(propsO, \"rotation\", 0);\r\n        var skewX: number = ClassUtils._getObjVar(propsO, \"skewX\", 0);\r\n        var skewY: number = ClassUtils._getObjVar(propsO, \"skewY\", 0);\r\n\r\n        if (sx != 1 || sy != 1 || rotate != 0) {\r\n            m = m || new Matrix();\r\n            m.scale(sx, sy);\r\n            m.rotate(rotate * 0.0174532922222222);\r\n        }\r\n\r\n        return m;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private static _addGraphicToGraphics(graphicO: any, graphic: Graphics): void {\r\n        var propsO: any;\r\n        propsO = graphicO.props;\r\n        if (!propsO) return;\r\n        var drawConfig: any;\r\n        drawConfig = ClassUtils.DrawTypeDic[graphicO.type];\r\n        if (!drawConfig) return;\r\n\r\n        var g: Graphics = graphic;\r\n        var params: any = ClassUtils._getParams(propsO, drawConfig[1], drawConfig[2], drawConfig[3]);\r\n        var m: Matrix = ClassUtils._tM;\r\n        if (m || ClassUtils._alpha != 1) {\r\n            g.save();\r\n            if (m) g.transform(m);\r\n            if (ClassUtils._alpha != 1) g.alpha(ClassUtils._alpha);\r\n        }\r\n        g[drawConfig[0]].apply(g, params);\r\n        if (m || ClassUtils._alpha != 1) {\r\n            g.restore();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private static _adptLineData(params: any[]): any[] {\r\n        params[2] = parseFloat(params[0]) + parseFloat(params[2]);\r\n        params[3] = parseFloat(params[1]) + parseFloat(params[3]);\r\n        return params;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private static _adptTextureData(params: any[]): any[] {\r\n        params[0] = ILaya.Loader.getRes(params[0]);\r\n        return params;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private static _adptLinesData(params: any[]): any[] {\r\n        params[2] = ClassUtils._getPointListByStr(params[2]);\r\n        return params;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    static _isDrawType(type: string): boolean {\r\n        if (type === \"Image\") return false;\r\n        return type in ClassUtils.DrawTypeDic;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private static _getParams(obj: any, params: any[], xPos: number = 0, adptFun: string = null): any[] {\r\n        var rst: any = ClassUtils._temParam;\r\n        rst.length = params.length;\r\n        var i: number, len: number;\r\n        len = params.length;\r\n        for (i = 0; i < len; i++) {\r\n            rst[i] = ClassUtils._getObjVar(obj, params[i][0], params[i][1]);\r\n        }\r\n        ClassUtils._alpha = ClassUtils._getObjVar(obj, \"alpha\", 1);\r\n        var m: Matrix;\r\n        m = ClassUtils._getTransformData(obj);\r\n        if (m) {\r\n            if (!xPos) xPos = 0;\r\n\r\n            m.translate(rst[xPos], rst[xPos + 1]);\r\n            rst[xPos] = rst[xPos + 1] = 0;\r\n            ClassUtils._tM = m;\r\n        } else {\r\n            ClassUtils._tM = null;\r\n        }\r\n        if (adptFun && ClassUtils[adptFun]) {\r\n            rst = ClassUtils[adptFun](rst);\r\n        }\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    static _getPointListByStr(str: string): any[] {\r\n        var pointArr: any[] = str.split(\",\");\r\n        var i: number, len: number;\r\n        len = pointArr.length;\r\n        for (i = 0; i < len; i++) {\r\n            pointArr[i] = parseFloat(pointArr[i]);\r\n        }\r\n        return pointArr;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private static _getObjVar(obj: any, key: string, noValue: any): any {\r\n        if (key in obj) {\r\n            return obj[key];\r\n        }\r\n        return noValue;\r\n    }\r\n}\r\n\r\n","import { Rectangle } from \"../../maths/Rectangle\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * @internal\r\n * Graphic bounds数据类\r\n */\r\nexport class BoundsStyle {\r\n    /**@private */\r\n    bounds: Rectangle|null;\r\n    /**用户设的bounds*/\r\n    userBounds: Rectangle|null;\r\n    /**缓存的bounds顶点,sprite计算bounds用*/\r\n    temBM: any[]|null;\r\n\r\n    /**\r\n     * 重置\r\n     */\r\n    reset(): BoundsStyle {\r\n        if (this.bounds) this.bounds.recover();\r\n        if (this.userBounds) this.userBounds.recover();\r\n        this.bounds = null;\r\n        this.userBounds = null;\r\n        this.temBM = null;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 回收\r\n     */\r\n    recover(): void {\r\n        Pool.recover(\"BoundsStyle\", this.reset());\r\n    }\r\n\r\n    /**\r\n     * 创建\r\n     */\r\n    static create(): BoundsStyle {\r\n        return Pool.getItemByClass(\"BoundsStyle\", BoundsStyle);\r\n    }\r\n}\r\n\r\n","import { Sprite } from \"../Sprite\"\r\nimport { Point } from \"../../maths/Point\"\r\nimport { Rectangle } from \"../../maths/Rectangle\"\r\nimport { Context } from \"../../resource/Context\"\r\nimport { HTMLCanvas } from \"../../resource/HTMLCanvas\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * @internal\r\n * 存储cache相关\r\n */\r\nexport class CacheStyle {\r\n\r\n    static EMPTY: CacheStyle = new CacheStyle();\r\n    /**当前实际的cache状态*/\r\n    cacheAs: string;\r\n    /**是否开启canvas渲染*/\r\n    enableCanvasRender: boolean;\r\n    /**用户设的cacheAs类型*/\r\n    userSetCache: string;\r\n    /**是否需要为滤镜cache*/\r\n    cacheForFilters: boolean;\r\n    /**是否为静态缓存*/\r\n    staticCache: boolean;\r\n    /**是否需要刷新缓存*/\r\n    reCache: boolean;\r\n    /**mask对象*/\r\n    mask: Sprite;\r\n    /**作为mask时的父对象*/\r\n    maskParent: Sprite;\r\n    /**滤镜数据*/\r\n    filters: any[];\r\n    /**当前缓存区域*/\r\n    cacheRect: Rectangle;\r\n    /**当前使用的canvas*/\r\n    canvas: HTMLCanvas;\r\n    //TODO:webgl是否还需要\r\n    /**滤镜数据*/\r\n    filterCache: any;\r\n    //TODO:webgl是否还需要\r\n    /**是否有发光滤镜*/\r\n    hasGlowFilter: boolean;\r\n\r\n    constructor() {\r\n        this.reset();\r\n    }\r\n\r\n    /**\r\n     * 是否需要Bitmap缓存\r\n     * @return\r\n     */\r\n    needBitmapCache(): boolean {\r\n        return this.cacheForFilters || !!this.mask;\r\n    }\r\n\r\n    /**\r\n     * 是否需要开启canvas渲染\r\n     */\r\n    needEnableCanvasRender(): boolean {\r\n        return this.userSetCache != \"none\" || this.cacheForFilters || !!this.mask;\r\n    }\r\n\r\n    /**\r\n     * 释放cache的资源\r\n     */\r\n    releaseContext(): void {\r\n        if (this.canvas && ((<any>this.canvas)).size) {\r\n            Pool.recover(\"CacheCanvas\", this.canvas);\r\n            this.canvas.size(0, 0);\r\n            // 微信在iphone8和mate20上个bug，size存在但是不起作用，可能是canvas对象不是我们的。\r\n            // 为了避免canvas不消失，再强制设置宽高为0 TODO 没有测试\r\n            try {\r\n                ((<any>this.canvas)).width = 0;\r\n                ((<any>this.canvas)).height = 0;\r\n            } catch (e) {\r\n\r\n            }\r\n        }\r\n        this.canvas = null;\r\n    }\r\n\r\n    createContext(): void {\r\n        if (!this.canvas) {\r\n            this.canvas = Pool.getItem(\"CacheCanvas\") || new HTMLCanvas(false);\r\n            var tx: Context = this.canvas.context as Context;\r\n            if (!tx) {\r\n                tx = this.canvas.getContext('2d') as Context;\t//如果是webGL的话，这个会返回WebGLContext2D\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * 释放滤镜资源\r\n     */\r\n    releaseFilterCache(): void {\r\n        var fc: any = this.filterCache;\r\n        if (fc) {\r\n            fc.destroy();\r\n            fc.recycle();\r\n            this.filterCache = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 回收\r\n     */\r\n    recover(): void {\r\n        if (this === CacheStyle.EMPTY) return;\r\n        Pool.recover(\"SpriteCache\", this.reset());\r\n    }\r\n\r\n    /**\r\n     * 重置\r\n     */\r\n    reset(): CacheStyle {\r\n        this.releaseContext();\r\n        this.releaseFilterCache();\r\n        this.cacheAs = \"none\";\r\n        this.enableCanvasRender = false;\r\n        this.userSetCache = \"none\";\r\n        this.cacheForFilters = false;\r\n        this.staticCache = false;\r\n        this.reCache = true;\r\n        this.mask = null;\r\n        this.maskParent = null;\r\n        this.filterCache = null;\r\n        this.filters = null;\r\n        this.hasGlowFilter = false;\r\n        if (this.cacheRect) this.cacheRect.recover();\r\n        this.cacheRect = null;\r\n        return this\r\n    }\r\n\r\n    /**\r\n     * 创建一个SpriteCache\r\n     */\r\n    static create(): CacheStyle {\r\n        return Pool.getItemByClass(\"SpriteCache\", CacheStyle);\r\n    }\r\n\r\n    private static _scaleInfo: Point = new Point();\r\n    static CANVAS_EXTEND_EDGE: number = 16;\r\n    /**\r\n    * @internal\r\n    */\r\n    _calculateCacheRect(sprite: Sprite, tCacheType: string, x: number, y: number): Point {\r\n        var _cacheStyle: CacheStyle = sprite._cacheStyle;\r\n        if (!_cacheStyle.cacheRect)\r\n            _cacheStyle.cacheRect = Rectangle.create();\r\n        var tRec: Rectangle;\r\n\r\n        //计算显示对象的绘图区域\r\n        if (tCacheType === \"bitmap\") {\r\n            tRec = sprite.getSelfBounds();\r\n            tRec.width = tRec.width + CacheStyle.CANVAS_EXTEND_EDGE * 2;\r\n            tRec.height = tRec.height + CacheStyle.CANVAS_EXTEND_EDGE * 2;\r\n            tRec.x = tRec.x - sprite.pivotX;\r\n            tRec.y = tRec.y - sprite.pivotY;\r\n            tRec.x = tRec.x - CacheStyle.CANVAS_EXTEND_EDGE;\r\n            tRec.y = tRec.y - CacheStyle.CANVAS_EXTEND_EDGE;\r\n            tRec.x = Math.floor(tRec.x + x) - x;\r\n            tRec.y = Math.floor(tRec.y + y) - y;\r\n            tRec.width = Math.floor(tRec.width);\r\n            tRec.height = Math.floor(tRec.height);\r\n            _cacheStyle.cacheRect.copyFrom(tRec);\r\n        } else {\r\n            _cacheStyle.cacheRect.setTo(-sprite._style.pivotX, -sprite._style.pivotY, 1, 1);\r\n        }\r\n        tRec = _cacheStyle.cacheRect;\r\n\r\n\r\n        //处理显示对象的scrollRect偏移\r\n        if (sprite._style.scrollRect) {\r\n            var scrollRect: Rectangle = sprite._style.scrollRect;\r\n            tRec.x -= scrollRect.x;\r\n            tRec.y -= scrollRect.y;\r\n        }\r\n        CacheStyle._scaleInfo.setTo(1, 1);\r\n\r\n        return CacheStyle._scaleInfo;\r\n    }\r\n}\r\n\r\n","import { Rectangle } from \"../../maths/Rectangle\"\r\nimport { Dragging } from \"../../utils/Dragging\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 元素样式\r\n */\r\nexport class SpriteStyle {\r\n\r\n    static EMPTY: SpriteStyle = new SpriteStyle();\r\n    scaleX: number;\r\n    scaleY: number;\r\n    skewX: number;\r\n    skewY: number;\r\n    pivotX: number;\r\n    pivotY: number;\r\n    rotation: number;\r\n    alpha: number;\r\n    scrollRect: Rectangle;\r\n    viewport: Rectangle;\r\n    hitArea: any;\r\n    dragging: Dragging;\r\n    blendMode: string;\r\n\r\n    constructor() {\r\n        this.reset();\r\n    }\r\n\r\n    /**\r\n     * 重置，方便下次复用\r\n     */\r\n    reset(): SpriteStyle {\r\n        this.scaleX = this.scaleY = 1;\r\n        this.skewX = this.skewY = 0;\r\n        this.pivotX = this.pivotY = this.rotation = 0;\r\n        this.alpha = 1;\r\n        if (this.scrollRect) this.scrollRect.recover();\r\n        this.scrollRect = null;\r\n        if (this.viewport) this.viewport.recover();\r\n        this.viewport = null;\r\n        this.hitArea = null;\r\n        this.dragging = null;\r\n        this.blendMode = null;\r\n        return this\r\n    }\r\n\r\n    /**\r\n     * 回收\r\n     */\r\n    recover(): void {\r\n        if (this === SpriteStyle.EMPTY) return;\r\n        Pool.recover(\"SpriteStyle\", this.reset());\r\n    }\r\n\r\n    /**\r\n     * 从对象池中创建\r\n     */\r\n    static create(): SpriteStyle {\r\n        return Pool.getItemByClass(\"SpriteStyle\", SpriteStyle);\r\n    }\r\n}\r\n\r\n","import { Const } from \"../Const\"\r\nimport { Component } from \"../components/Component\"\r\nimport { Event } from \"../events/Event\"\r\nimport { EventDispatcher } from \"../events/EventDispatcher\"\r\nimport { Pool } from \"../utils/Pool\"\r\nimport { Stat } from \"../utils/Stat\"\r\nimport { Timer } from \"../utils/Timer\"\r\nimport { Sprite } from \"./Sprite\";\r\nimport { ILaya } from \"../../ILaya\";\r\nimport { ClassUtils } from \"../utils/ClassUtils\";\r\n\r\n/**\r\n * 添加到父对象后调度。\r\n * @eventType Event.ADDED\r\n */\r\n/*[Event(name = \"added\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 被父对象移除后调度。\r\n * @eventType Event.REMOVED\r\n */\r\n/*[Event(name = \"removed\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 加入节点树时调度。\r\n * @eventType Event.DISPLAY\r\n */\r\n/*[Event(name = \"display\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 从节点树移除时调度。\r\n * @eventType Event.UNDISPLAY\r\n */\r\n/*[Event(name = \"undisplay\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n *  <code>Node</code> 类是可放在显示列表中的所有对象的基类。该显示列表管理 Laya 运行时中显示的所有对象。使用 Node 类排列显示列表中的显示对象。Node 对象可以有子显示对象。\r\n */\r\nexport class Node extends EventDispatcher {\r\n    /**@private */\r\n    protected static ARRAY_EMPTY: any[] = [];\r\n    /**@private */\r\n    private _bits: number = 0;\r\n    /**@internal 子对象集合，请不要直接修改此对象。*/\r\n    _children: any[] = Node.ARRAY_EMPTY;\r\n\r\n    /**@internal 仅仅用来处理输入事件的,并不是真正意义上的子对象 */\r\n    _extUIChild: any[] = Node.ARRAY_EMPTY;\r\n\r\n    /**@internal 父节点对象*/\r\n    _parent: Node = null;\r\n\r\n    /**节点名称。*/\r\n    name: string = \"\";\r\n    /**[只读]是否已经销毁。对象销毁后不能再使用。*/\r\n    destroyed: boolean = false;\r\n    /**@internal */\r\n    _conchData: any;\r\n\r\n    constructor() {\r\n        super();\r\n        this.createGLBuffer();\r\n    }\r\n\r\n    createGLBuffer(): void {\r\n    }\r\n\r\n    /**@internal */\r\n    _setBit(type: number, value: boolean): void {\r\n        if (type === Const.DISPLAY) {\r\n            var preValue: boolean = this._getBit(type);\r\n            if (preValue != value) this._updateDisplayedInstage();\r\n        }\r\n        if (value) this._bits |= type;\r\n        else this._bits &= ~type;\r\n    }\r\n\r\n    /**@internal */\r\n    _getBit(type: number): boolean {\r\n        return (this._bits & type) != 0;\r\n    }\r\n\r\n    /**@internal */\r\n    _setUpNoticeChain(): void {\r\n        if (this._getBit(Const.DISPLAY)) this._setBitUp(Const.DISPLAY);\r\n    }\r\n\r\n    /**@internal */\r\n    _setBitUp(type: number): void {\r\n        var ele: Node = this;\r\n        ele._setBit(type, true);\r\n        ele = ele._parent;\r\n        while (ele) {\r\n            if (ele._getBit(type)) return;\r\n            ele._setBit(type, true);\r\n            ele = ele._parent;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * <p>增加事件侦听器，以使侦听器能够接收事件通知。</p>\r\n     * <p>如果侦听鼠标事件，则会自动设置自己和父亲节点的属性 mouseEnabled 的值为 true(如果父节点mouseEnabled=false，则停止设置父节点mouseEnabled属性)。</p>\r\n     * @param\ttype\t\t事件的类型。\r\n     * @param\tcaller\t\t事件侦听函数的执行域。\r\n     * @param\tlistener\t事件侦听函数。\r\n     * @param\targs\t\t（可选）事件侦听函数的回调参数。\r\n     * @return 此 EventDispatcher 对象。\r\n     * @override\r\n     */\r\n    on(type: string, caller: any, listener: Function, args: any[] = null): EventDispatcher {\r\n        if (type === Event.DISPLAY || type === Event.UNDISPLAY) {\r\n            if (!this._getBit(Const.DISPLAY)) this._setBitUp(Const.DISPLAY);\r\n        }\r\n        return this._createListener(type, caller, listener, args, false);\r\n    }\r\n\r\n    /**\r\n     * <p>增加事件侦听器，以使侦听器能够接收事件通知，此侦听事件响应一次后则自动移除侦听。</p>\r\n     * <p>如果侦听鼠标事件，则会自动设置自己和父亲节点的属性 mouseEnabled 的值为 true(如果父节点mouseEnabled=false，则停止设置父节点mouseEnabled属性)。</p>\r\n     * @param\ttype\t\t事件的类型。\r\n     * @param\tcaller\t\t事件侦听函数的执行域。\r\n     * @param\tlistener\t事件侦听函数。\r\n     * @param\targs\t\t（可选）事件侦听函数的回调参数。\r\n     * @return 此 EventDispatcher 对象。\r\n     * @override\r\n     */\r\n    once(type: string, caller: any, listener: Function, args: any[] = null): EventDispatcher {\r\n        if (type === Event.DISPLAY || type === Event.UNDISPLAY) {\r\n            if (!this._getBit(Const.DISPLAY)) this._setBitUp(Const.DISPLAY);\r\n        }\r\n        return this._createListener(type, caller, listener, args, true);\r\n    }\r\n\r\n    /**\r\n     * <p>销毁此对象。destroy对象默认会把自己从父节点移除，并且清理自身引用关系，等待js自动垃圾回收机制回收。destroy后不能再使用。</p>\r\n     * <p>destroy时会移除自身的事情监听，自身的timer监听，移除子对象及从父节点移除自己。</p>\r\n     * @param destroyChild\t（可选）是否同时销毁子节点，若值为true,则销毁子节点，否则不销毁子节点。\r\n     */\r\n    destroy(destroyChild: boolean = true): void {\r\n        this.destroyed = true;\r\n        this._destroyAllComponent();\r\n        this._parent && this._parent.removeChild(this);\r\n\r\n        //销毁子节点\r\n        if (this._children) {\r\n            if (destroyChild) this.destroyChildren();\r\n            else this.removeChildren();\r\n        }\r\n        this.onDestroy();\r\n\r\n        this._children = null;\r\n\r\n        //移除所有事件监听\r\n        this.offAll();\r\n\r\n        //移除所有timer\r\n        //this.timer.clearAll(this);\t\t\t\r\n    }\r\n\r\n    /**\r\n     * 销毁时执行\r\n     * 此方法为虚方法，使用时重写覆盖即可\r\n     */\r\n    onDestroy(): void {\r\n        //trace(\"onDestroy node\", this.name);\r\n    }\r\n\r\n    /**\r\n     * 销毁所有子对象，不销毁自己本身。\r\n     */\r\n    destroyChildren(): void {\r\n        //销毁子节点\r\n        if (this._children) {\r\n            //为了保持销毁顺序，所以需要正序销毁\r\n            for (var i: number = 0, n: number = this._children.length; i < n; i++) {\r\n                this._children[0].destroy(true);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 添加子节点。\r\n     * @param\tnode 节点对象\r\n     * @return\t返回添加的节点\r\n     */\r\n    addChild(node: Node): Node {\r\n        if (!node || this.destroyed || node === this) return node;\r\n        if ((<Sprite>node)._zOrder) this._setBit(Const.HAS_ZORDER, true);\r\n        if (node._parent === this) {\r\n            var index: number = this.getChildIndex(node);\r\n            if (index !== this._children.length - 1) {\r\n                this._children.splice(index, 1);\r\n                this._children.push(node);\r\n                this._childChanged();\r\n            }\r\n        } else {\r\n            node._parent && node._parent.removeChild(node);\r\n            this._children === Node.ARRAY_EMPTY && (this._children = []);\r\n            this._children.push(node);\r\n            node._setParent(this);\r\n            this._childChanged();\r\n        }\r\n\r\n        return node;\r\n    }\r\n\r\n    addInputChild(node: Node): Node {\r\n        if (this._extUIChild == Node.ARRAY_EMPTY) {\r\n            this._extUIChild = [node];\r\n        } else {\r\n            if (this._extUIChild.indexOf(node) >= 0) {\r\n                return null;\r\n            }\r\n            this._extUIChild.push(node);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    removeInputChild(node: Node): void {\r\n        var idx: number = this._extUIChild.indexOf(node);\r\n        if (idx >= 0) {\r\n            this._extUIChild.splice(idx, 1);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 批量增加子节点\r\n     * @param\t...args 无数子节点。\r\n     */\r\n    addChildren(...args): void {\r\n        var i: number = 0, n: number = args.length;\r\n        while (i < n) {\r\n            this.addChild(args[i++]);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 添加子节点到指定的索引位置。\r\n     * @param\tnode 节点对象。\r\n     * @param\tindex 索引位置。\r\n     * @return\t返回添加的节点。\r\n     */\r\n    addChildAt(node: Node, index: number): Node {\r\n        if (!node || this.destroyed || node === this) return node;\r\n        if (((<Sprite>node))._zOrder) this._setBit(Const.HAS_ZORDER, true);\r\n        if (index >= 0 && index <= this._children.length) {\r\n            if (node._parent === this) {\r\n                var oldIndex: number = this.getChildIndex(node);\r\n                this._children.splice(oldIndex, 1);\r\n                this._children.splice(index, 0, node);\r\n                this._childChanged();\r\n            } else {\r\n                node._parent && node._parent.removeChild(node);\r\n                this._children === Node.ARRAY_EMPTY && (this._children = []);\r\n                this._children.splice(index, 0, node);\r\n                node._setParent(this);\r\n            }\r\n            return node;\r\n        } else {\r\n            throw new Error(\"appendChildAt:The index is out of bounds\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 根据子节点对象，获取子节点的索引位置。\r\n     * @param\tnode 子节点。\r\n     * @return\t子节点所在的索引位置。\r\n     */\r\n    getChildIndex(node: Node): number {\r\n        return this._children.indexOf(node);\r\n    }\r\n\r\n    /**\r\n     * 根据子节点的名字，获取子节点对象。\r\n     * @param\tname 子节点的名字。\r\n     * @return\t节点对象。\r\n     */\r\n    getChildByName(name: string): Node {\r\n        var nodes: any[] = this._children;\r\n        if (nodes) {\r\n            for (var i: number = 0, n: number = nodes.length; i < n; i++) {\r\n                var node: Node = nodes[i];\r\n                if (node.name === name) return node;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * 根据子节点的索引位置，获取子节点对象。\r\n     * @param\tindex 索引位置\r\n     * @return\t子节点\r\n     */\r\n    getChildAt(index: number): Node {\r\n        return this._children[index] || null;\r\n    }\r\n\r\n    /**\r\n     * 设置子节点的索引位置。\r\n     * @param\tnode 子节点。\r\n     * @param\tindex 新的索引。\r\n     * @return\t返回子节点本身。\r\n     */\r\n    setChildIndex(node: Node, index: number): Node {\r\n        var childs: any[] = this._children;\r\n        if (index < 0 || index >= childs.length) {\r\n            throw new Error(\"setChildIndex:The index is out of bounds.\");\r\n        }\r\n\r\n        var oldIndex: number = this.getChildIndex(node);\r\n        if (oldIndex < 0) throw new Error(\"setChildIndex:node is must child of this object.\");\r\n        childs.splice(oldIndex, 1);\r\n        childs.splice(index, 0, node);\r\n        this._childChanged();\r\n        return node;\r\n    }\r\n\r\n    /**\r\n     * 子节点发生改变。\r\n     * @private\r\n     * @param\tchild 子节点。\r\n     */\r\n    protected _childChanged(child: Node = null): void {\r\n\r\n    }\r\n\r\n    /**\r\n     * 删除子节点。\r\n     * @param\tnode 子节点\r\n     * @return\t被删除的节点\r\n     */\r\n    removeChild(node: Node): Node {\r\n        if (!this._children) return node;\r\n        var index: number = this._children.indexOf(node);\r\n        return this.removeChildAt(index);\r\n    }\r\n\r\n    /**\r\n     * 从父容器删除自己，如已经被删除不会抛出异常。\r\n     * @return 当前节点（ Node ）对象。\r\n     */\r\n    removeSelf(): Node {\r\n        this._parent && this._parent.removeChild(this);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 根据子节点名字删除对应的子节点对象，如果找不到不会抛出异常。\r\n     * @param\tname 对象名字。\r\n     * @return 查找到的节点（ Node ）对象。\r\n     */\r\n    removeChildByName(name: string): Node {\r\n        var node: Node = this.getChildByName(name);\r\n        node && this.removeChild(node);\r\n        return node;\r\n    }\r\n\r\n    /**\r\n     * 根据子节点索引位置，删除对应的子节点对象。\r\n     * @param\tindex 节点索引位置。\r\n     * @return\t被删除的节点。\r\n     */\r\n    removeChildAt(index: number): Node {\r\n        var node: Node = this.getChildAt(index);\r\n        if (node) {\r\n            this._children.splice(index, 1);\r\n            node._setParent(null);\r\n        }\r\n        return node;\r\n    }\r\n\r\n    /**\r\n     * 删除指定索引区间的所有子对象。\r\n     * @param\tbeginIndex 开始索引。\r\n     * @param\tendIndex 结束索引。\r\n     * @return 当前节点对象。\r\n     */\r\n    removeChildren(beginIndex: number = 0, endIndex: number = 0x7fffffff): Node {\r\n        if (this._children && this._children.length > 0) {\r\n            var childs: any[] = this._children;\r\n            if (beginIndex === 0 && endIndex >= childs.length - 1) {\r\n                var arr: any[] = childs;\r\n                this._children = Node.ARRAY_EMPTY;\r\n            } else {\r\n                arr = childs.splice(beginIndex, endIndex - beginIndex);\r\n            }\r\n            for (var i: number = 0, n: number = arr.length; i < n; i++) {\r\n                arr[i]._setParent(null);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 替换子节点。\r\n     * 将传入的新节点对象替换到已有子节点索引位置处。\r\n     * @param\tnewNode 新节点。\r\n     * @param\toldNode 老节点。\r\n     * @return\t返回新节点。\r\n     */\r\n    replaceChild(newNode: Node, oldNode: Node): Node {\r\n        var index: number = this._children.indexOf(oldNode);\r\n        if (index > -1) {\r\n            this._children.splice(index, 1, newNode);\r\n            oldNode._setParent(null);\r\n            newNode._setParent(this);\r\n            return newNode;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * 子对象数量。\r\n     */\r\n    get numChildren(): number {\r\n        return this._children.length;\r\n    }\r\n\r\n    /**父节点。*/\r\n    get parent(): Node {\r\n        return this._parent;\r\n    }\r\n\r\n    /**@private */\r\n    protected _setParent(value: Node): void {\r\n        if (this._parent !== value) {\r\n            if (value) {\r\n                this._parent = value;\r\n                //如果父对象可见，则设置子对象可见\r\n                this._onAdded();\r\n                this.event(Event.ADDED);\r\n                if (this._getBit(Const.DISPLAY)) {\r\n                    this._setUpNoticeChain();\r\n                    value.displayedInStage && this._displayChild(this, true);\r\n                }\r\n                value._childChanged(this);\r\n            } else {\r\n                //设置子对象不可见\r\n                this._onRemoved();\r\n                this.event(Event.REMOVED);\r\n                this._parent._childChanged();\r\n                if (this._getBit(Const.DISPLAY)) this._displayChild(this, false);\r\n                this._parent = value;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**表示是否在显示列表中显示。*/\r\n    get displayedInStage(): boolean {\r\n        if (this._getBit(Const.DISPLAY)) return this._getBit(Const.DISPLAYED_INSTAGE);\r\n        this._setBitUp(Const.DISPLAY);\r\n        return this._getBit(Const.DISPLAYED_INSTAGE);\r\n    }\r\n\r\n    /**@private */\r\n    private _updateDisplayedInstage(): void {\r\n        var ele: Node;\r\n        ele = this;\r\n        var stage: Node = ILaya.stage;\r\n        var displayedInStage: boolean = false;\r\n        while (ele) {\r\n            if (ele._getBit(Const.DISPLAY)) {\r\n                displayedInStage = ele._getBit(Const.DISPLAYED_INSTAGE);\r\n                break;\r\n            }\r\n            if (ele === stage || ele._getBit(Const.DISPLAYED_INSTAGE)) {\r\n                displayedInStage = true;\r\n                break;\r\n            }\r\n            ele = ele._parent;\r\n        }\r\n        this._setBit(Const.DISPLAYED_INSTAGE, displayedInStage);\r\n    }\r\n\r\n    /**@internal */\r\n    _setDisplay(value: boolean): void {\r\n        if (this._getBit(Const.DISPLAYED_INSTAGE) !== value) {\r\n            this._setBit(Const.DISPLAYED_INSTAGE, value);\r\n            if (value) this.event(Event.DISPLAY);\r\n            else this.event(Event.UNDISPLAY);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置指定节点对象是否可见(是否在渲染列表中)。\r\n     * @private\r\n     * @param\tnode 节点。\r\n     * @param\tdisplay 是否可见。\r\n     */\r\n    private _displayChild(node: Node, display: boolean): void {\r\n        var childs: any[] = node._children;\r\n        if (childs) {\r\n            for (var i: number = 0, n: number = childs.length; i < n; i++) {\r\n                var child: Node = childs[i];\r\n                if (!child._getBit(Const.DISPLAY)) continue;\r\n                if (child._children.length > 0) {\r\n                    this._displayChild(child, display);\r\n                } else {\r\n                    child._setDisplay(display);\r\n                }\r\n            }\r\n        }\r\n        node._setDisplay(display);\r\n    }\r\n\r\n    /**\r\n     * 当前容器是否包含指定的 <code>Node</code> 节点对象 。\r\n     * @param\tnode  指定的 <code>Node</code> 节点对象 。\r\n     * @return\t一个布尔值表示是否包含指定的 <code>Node</code> 节点对象 。\r\n     */\r\n    contains(node: Node): boolean {\r\n        if (node === this) return true;\r\n        while (node) {\r\n            if (node._parent === this) return true;\r\n            node = node._parent;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 定时重复执行某函数。功能同Laya.timer.timerLoop()。\r\n     * @param\tdelay\t\t间隔时间(单位毫秒)。\r\n     * @param\tcaller\t\t执行域(this)。\r\n     * @param\tmethod\t\t结束时的回调方法。\r\n     * @param\targs\t\t（可选）回调参数。\r\n     * @param\tcoverBefore\t（可选）是否覆盖之前的延迟执行，默认为true。\r\n     * @param\tjumpFrame 时钟是否跳帧。基于时间的循环回调，单位时间间隔内，如能执行多次回调，出于性能考虑，引擎默认只执行一次，设置jumpFrame=true后，则回调会连续执行多次\r\n     */\r\n    timerLoop(delay: number, caller: any, method: Function, args: any[] = null, coverBefore: boolean = true, jumpFrame: boolean = false): void {\r\n        var timer: Timer = this.scene ? this.scene.timer : ILaya.timer;\r\n        timer.loop(delay, caller, method, args, coverBefore, jumpFrame);\r\n    }\r\n\r\n    /**\r\n     * 定时执行某函数一次。功能同Laya.timer.timerOnce()。\r\n     * @param\tdelay\t\t延迟时间(单位毫秒)。\r\n     * @param\tcaller\t\t执行域(this)。\r\n     * @param\tmethod\t\t结束时的回调方法。\r\n     * @param\targs\t\t（可选）回调参数。\r\n     * @param\tcoverBefore\t（可选）是否覆盖之前的延迟执行，默认为true。\r\n     */\r\n    timerOnce(delay: number, caller: any, method: Function, args: any[] = null, coverBefore: boolean = true): void {\r\n        var timer: Timer = this.scene ? this.scene.timer : ILaya.timer;\r\n        timer._create(false, false, delay, caller, method, args, coverBefore);\r\n    }\r\n\r\n    /**\r\n     * 定时重复执行某函数(基于帧率)。功能同Laya.timer.frameLoop()。\r\n     * @param\tdelay\t\t间隔几帧(单位为帧)。\r\n     * @param\tcaller\t\t执行域(this)。\r\n     * @param\tmethod\t\t结束时的回调方法。\r\n     * @param\targs\t\t（可选）回调参数。\r\n     * @param\tcoverBefore\t（可选）是否覆盖之前的延迟执行，默认为true。\r\n     */\r\n    frameLoop(delay: number, caller: any, method: Function, args: any[] = null, coverBefore: boolean = true): void {\r\n        var timer: Timer = this.scene ? this.scene.timer : ILaya.timer;\r\n        timer._create(true, true, delay, caller, method, args, coverBefore);\r\n    }\r\n\r\n    /**\r\n     * 定时执行一次某函数(基于帧率)。功能同Laya.timer.frameOnce()。\r\n     * @param\tdelay\t\t延迟几帧(单位为帧)。\r\n     * @param\tcaller\t\t执行域(this)\r\n     * @param\tmethod\t\t结束时的回调方法\r\n     * @param\targs\t\t（可选）回调参数\r\n     * @param\tcoverBefore\t（可选）是否覆盖之前的延迟执行，默认为true\r\n     */\r\n    frameOnce(delay: number, caller: any, method: Function, args: any[] = null, coverBefore: boolean = true): void {\r\n        var timer: Timer = this.scene ? this.scene.timer : ILaya.timer;\r\n        timer._create(true, false, delay, caller, method, args, coverBefore);\r\n    }\r\n\r\n    /**\r\n     * 清理定时器。功能同Laya.timer.clearTimer()。\r\n     * @param\tcaller 执行域(this)。\r\n     * @param\tmethod 结束时的回调方法。\r\n     */\r\n    clearTimer(caller: any, method: Function): void {\r\n        var timer: Timer = this.scene ? this.scene.timer : ILaya.timer;\r\n        timer.clear(caller, method);\r\n    }\r\n\r\n    /**\r\n     * <p>延迟运行指定的函数。</p>\r\n     * <p>在控件被显示在屏幕之前调用，一般用于延迟计算数据。</p>\r\n     * @param method 要执行的函数的名称。例如，functionName。\r\n     * @param args 传递给 <code>method</code> 函数的可选参数列表。\r\n     *\r\n     * @see #runCallLater()\r\n     */\r\n    callLater(method: Function, args: any[] = null): void {\r\n        var timer: Timer = this.scene ? this.scene.timer : ILaya.timer;\r\n        timer.callLater(this, method, args);\r\n    }\r\n\r\n    /**\r\n     * <p>如果有需要延迟调用的函数（通过 <code>callLater</code> 函数设置），则立即执行延迟调用函数。</p>\r\n     * @param method 要执行的函数名称。例如，functionName。\r\n     * @see #callLater()\r\n     */\r\n    runCallLater(method: Function): void {\r\n        var timer: Timer = this.scene ? this.scene.timer : ILaya.timer;\r\n        timer.runCallLater(this, method);\r\n    }\r\n\r\n    //============================组件化支持==============================\r\n    /** @private */\r\n    private _components: any[];\r\n    /**@private */\r\n    private _activeChangeScripts: any[];//TODO:可用对象池\r\n\r\n    /**@internal */\r\n    _scene: Node;\r\n\r\n    /**\r\n     * 获得所属场景。\r\n     * @return\t场景。\r\n     */\r\n    get scene(): any {\r\n        return this._scene;\r\n    }\r\n\r\n    /**\r\n     * 获取自身是否激活。\r\n     *   @return\t自身是否激活。\r\n     */\r\n    get active(): boolean {\r\n        return !this._getBit(Const.NOT_READY) && !this._getBit(Const.NOT_ACTIVE);\r\n    }\r\n\r\n    /**\r\n     * 设置是否激活。\r\n     * @param\tvalue 是否激活。\r\n     */\r\n    set active(value: boolean) {\r\n        value = !!value;\r\n        if (!this._getBit(Const.NOT_ACTIVE) !== value) {\r\n            if (this._activeChangeScripts && this._activeChangeScripts.length !== 0) {\r\n                if (value)\r\n                    throw \"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.\";\r\n                else\r\n                    throw \"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.\";\r\n            } else {\r\n                this._setBit(Const.NOT_ACTIVE, !value);\r\n                if (this._parent) {\r\n                    if (this._parent.activeInHierarchy) {\r\n                        if (value) this._processActive();\r\n                        else this._processInActive();\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * 获取在场景中是否激活。\r\n     *   @return\t在场景中是否激活。\r\n     */\r\n    get activeInHierarchy(): boolean {\r\n        return this._getBit(Const.ACTIVE_INHIERARCHY);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    protected _onActive(): void {\r\n        Stat.spriteCount++;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    protected _onInActive(): void {\r\n        Stat.spriteCount--;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    protected _onActiveInScene(): void {\r\n        //override it.\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    protected _onInActiveInScene(): void {\r\n        //override it.\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _parse(data: any, spriteMap: any): void {\r\n        //override it.\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _setBelongScene(scene: Node): void {\r\n        if (!this._scene) {\r\n            this._scene = scene;\r\n            this._onActiveInScene();\r\n            for (var i: number = 0, n: number = this._children.length; i < n; i++)\r\n                this._children[i]._setBelongScene(scene);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _setUnBelongScene(): void {\r\n        if (this._scene !== this) {//移除节点本身是scene不继续派发\r\n            this._onInActiveInScene();\r\n            this._scene = null;\r\n            for (var i: number = 0, n: number = this._children.length; i < n; i++)\r\n                this._children[i]._setUnBelongScene();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 组件被激活后执行，此时所有节点和组件均已创建完毕，次方法只执行一次\r\n     * 此方法为虚方法，使用时重写覆盖即可\r\n     */\r\n    onAwake(): void {\r\n        //this.name  && trace(\"onAwake node \", this.name);\r\n    }\r\n\r\n    /**\r\n     * 组件被启用后执行，比如节点被添加到舞台后\r\n     * 此方法为虚方法，使用时重写覆盖即可\r\n     */\r\n    onEnable(): void {\r\n        //this.name  && trace(\"onEnable node \", this.name);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _processActive(): void {\r\n        (this._activeChangeScripts) || (this._activeChangeScripts = []);\r\n        this._activeHierarchy(this._activeChangeScripts);//处理属性,保证属性的正确性和即时性\r\n        this._activeScripts();//延时处理组件\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _activeHierarchy(activeChangeScripts: any[]): void {\r\n        this._setBit(Const.ACTIVE_INHIERARCHY, true);\r\n        if (this._components) {\r\n            for (var i: number = 0, n: number = this._components.length; i < n; i++) {\r\n                var comp: Component = this._components[i];\r\n                if (comp._isScript())//TODO:maybe should combime the logic with script and unScript. \r\n                    (comp._enabled) && (activeChangeScripts.push(comp));\r\n                else\r\n                    comp._setActive(true);\r\n            }\r\n        }\r\n\r\n        this._onActive();\r\n        for (i = 0, n = this._children.length; i < n; i++) {\r\n            var child: Node = this._children[i];\r\n            (!child._getBit(Const.NOT_ACTIVE) && !child._getBit(Const.NOT_READY)) && (child._activeHierarchy(activeChangeScripts));\r\n        }\r\n        if (!this._getBit(Const.AWAKED)) {\r\n            this._setBit(Const.AWAKED, true);\r\n            this.onAwake();\r\n        }\r\n        this.onEnable();\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private _activeScripts(): void {\r\n        for (var i: number = 0, n: number = this._activeChangeScripts.length; i < n; i++) {\r\n            var comp: Component = this._activeChangeScripts[i]\r\n            if (!comp._awaked) {\r\n                comp._awaked = true;\r\n                comp._onAwake();\r\n            }\r\n            comp._onEnable();\r\n        }\r\n        this._activeChangeScripts.length = 0;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private _processInActive(): void {\r\n        (this._activeChangeScripts) || (this._activeChangeScripts = []);\r\n        this._inActiveHierarchy(this._activeChangeScripts);//处理属性,保证属性的正确性和即时性\r\n        this._inActiveScripts();//延时处理组件\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _inActiveHierarchy(activeChangeScripts: any[]): void {\r\n        this._onInActive();\r\n        if (this._components) {\r\n            for (var i: number = 0, n: number = this._components.length; i < n; i++) {\r\n                var comp: Component = this._components[i];\r\n                comp._setActive(false);\r\n                (comp._isScript() && comp._enabled) && (activeChangeScripts.push(comp));\r\n            }\r\n        }\r\n        this._setBit(Const.ACTIVE_INHIERARCHY, false);\r\n\r\n        for (i = 0, n = this._children.length; i < n; i++) {\r\n            var child: Node = this._children[i];\r\n            (child && !child._getBit(Const.NOT_ACTIVE)) && (child._inActiveHierarchy(activeChangeScripts));\r\n        }\r\n        this.onDisable();\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private _inActiveScripts(): void {\r\n        for (var i: number = 0, n: number = this._activeChangeScripts.length; i < n; i++)\r\n            this._activeChangeScripts[i].onDisable();\r\n        this._activeChangeScripts.length = 0;\r\n    }\r\n\r\n    /**\r\n     * 组件被禁用时执行，比如从节点从舞台移除后\r\n     * 此方法为虚方法，使用时重写覆盖即可\r\n     */\r\n    onDisable(): void {\r\n        //trace(\"onDisable node\", this.name);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    protected _onAdded(): void {\r\n        if (this._activeChangeScripts && this._activeChangeScripts.length !== 0) {\r\n            throw \"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.\";\r\n        } else {\r\n            var parentScene: Node = this._parent.scene;\r\n            parentScene && this._setBelongScene(parentScene);\r\n            (this._parent.activeInHierarchy && this.active) && this._processActive();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    protected _onRemoved(): void {\r\n        if (this._activeChangeScripts && this._activeChangeScripts.length !== 0) {\r\n            throw \"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.\";\r\n        } else {\r\n            (this._parent.activeInHierarchy && this.active) && this._processInActive();\r\n            this._parent.scene && this._setUnBelongScene();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _addComponentInstance(comp: Component): void {\r\n        this._components = this._components || [];\r\n        this._components.push(comp);\r\n\r\n        comp.owner = this;\r\n        comp._onAdded();\r\n        if (this.activeInHierarchy)\r\n            comp._setActive(true);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _destroyComponent(comp: Component): void {\r\n        if (this._components) {\r\n            for (var i: number = 0, n: number = this._components.length; i < n; i++) {\r\n                var item: Component = this._components[i];\r\n                if (item === comp) {\r\n                    item._destroy();\r\n                    this._components.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _destroyAllComponent(): void {\r\n        if (this._components) {\r\n            for (var i: number = 0, n: number = this._components.length; i < n; i++) {\r\n                var item: Component = this._components[i];\r\n                item && item._destroy();\r\n            }\r\n            this._components.length = 0;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal 克隆。\r\n     * @param\tdestObject 克隆源。\r\n     */\r\n    _cloneTo(destObject: any, srcRoot: Node, dstRoot: Node): void {\r\n        var destNode: Node = (<Node>destObject);\r\n        if (this._components) {\r\n            for (var i: number = 0, n: number = this._components.length; i < n; i++) {\r\n                var destComponent: Component = destNode.addComponent(this._components[i].constructor);\r\n                this._components[i]._cloneTo(destComponent);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 添加组件实例。\r\n     * @param\tcomponent 组建实例。\r\n     * @return\t组件。\r\n     */\r\n    addComponentIntance(component: Component): any {\r\n        if (component.owner)\r\n            throw \"Node:the component has belong to other node.\";\r\n        if (component.isSingleton && this.getComponent(((<any>component)).constructor))\r\n            throw \"Node:the component is singleton,can't add the second one.\";\r\n        this._addComponentInstance(component);\r\n        return component;\r\n    }\r\n\r\n    /**\r\n     * 添加组件。\r\n     * @param\tcomponentType 组件类型。\r\n     * @return\t组件。\r\n     */\r\n    addComponent(componentType: typeof Component): any {\r\n        var comp: Component = Pool.createByClass(componentType);\r\n        comp._destroyed = false;\r\n        if (comp.isSingleton && this.getComponent(componentType))\r\n            throw \"无法实例\" + componentType + \"组件\" + \"，\" + componentType + \"组件已存在！\";\r\n        this._addComponentInstance(comp);\r\n        return comp;\r\n    }\r\n\r\n    /**\r\n     * 获得组件实例，如果没有则返回为null\r\n     * @param\tcomponentType 组建类型\r\n     * @return\t返回组件\r\n     */\r\n    getComponent(componentType: typeof Component): any {\r\n        if (this._components) {\r\n            for (var i: number = 0, n: number = this._components.length; i < n; i++) {\r\n                var comp: Component = this._components[i];\r\n                if (comp instanceof componentType)\r\n                    return comp;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * 获得组件实例，如果没有则返回为null\r\n     * @param\tcomponentType 组建类型\r\n     * @return\t返回组件数组\r\n     */\r\n    getComponents(componentType: typeof Component): any[] {\r\n        var arr: any[];\r\n        if (this._components) {\r\n            for (var i: number = 0, n: number = this._components.length; i < n; i++) {\r\n                var comp: Component = this._components[i];\r\n                if (comp instanceof componentType) {\r\n                    arr = arr || [];\r\n                    arr.push(comp);\r\n                }\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 获取timer\r\n     */\r\n    get timer(): Timer {\r\n        return this.scene ? this.scene.timer : ILaya.timer;\r\n    }\r\n}\r\n\r\n\r\nClassUtils.regClass(\"laya.display.Node\", Node);\r\nClassUtils.regClass(\"Laya.Node\", Node);","import { ILaya } from \"../../ILaya\";\r\nimport { Const } from \"../Const\";\r\nimport { Event } from \"../events/Event\";\r\nimport { EventDispatcher } from \"../events/EventDispatcher\";\r\nimport { ColorFilter } from \"../filters/ColorFilter\";\r\nimport { Filter } from \"../filters/Filter\";\r\nimport { GrahamScan } from \"../maths/GrahamScan\";\r\nimport { Matrix } from \"../maths/Matrix\";\r\nimport { Point } from \"../maths/Point\";\r\nimport { Rectangle } from \"../maths/Rectangle\";\r\nimport { RenderSprite } from \"../renders/RenderSprite\";\r\nimport { Context } from \"../resource/Context\";\r\nimport { HTMLCanvas } from \"../resource/HTMLCanvas\";\r\nimport { Texture } from \"../resource/Texture\";\r\nimport { Texture2D } from \"../resource/Texture2D\";\r\nimport { ClassUtils } from \"../utils/ClassUtils\";\r\nimport { Handler } from \"../utils/Handler\";\r\nimport { Utils } from \"../utils/Utils\";\r\nimport { BoundsStyle } from \"./css/BoundsStyle\";\r\nimport { CacheStyle } from \"./css/CacheStyle\";\r\nimport { SpriteStyle } from \"./css/SpriteStyle\";\r\nimport { Graphics } from \"./Graphics\";\r\nimport { Node } from \"./Node\";\r\nimport { SpriteConst } from \"./SpriteConst\";\r\nimport { Stage } from \"./Stage\";\r\nimport { URL } from \"../net/URL\";\r\nimport { RenderTexture2D } from \"../resource/RenderTexture2D\";\r\n\r\n\r\n/**在显示对象上按下后调度。\r\n * @eventType Event.MOUSE_DOWN\r\n * */\r\n/*[Event(name = \"mousedown\", type = \"laya.events.Event\")]*/\r\n/**在显示对象抬起后调度。\r\n * @eventType Event.MOUSE_UP\r\n * */\r\n/*[Event(name = \"mouseup\", type = \"laya.events.Event\")]*/\r\n/**鼠标在对象身上进行移动后调度\r\n * @eventType Event.MOUSE_MOVE\r\n * */\r\n/*[Event(name = \"mousemove\", type = \"laya.events.Event\")]*/\r\n/**鼠标经过对象后调度。\r\n * @eventType Event.MOUSE_OVER\r\n * */\r\n/*[Event(name = \"mouseover\", type = \"laya.events.Event\")]*/\r\n/**鼠标离开对象后调度。\r\n * @eventType Event.MOUSE_OUT\r\n * */\r\n/*[Event(name = \"mouseout\", type = \"laya.events.Event\")]*/\r\n/**鼠标点击对象后调度。\r\n * @eventType Event.CLICK\r\n * */\r\n/*[Event(name = \"click\", type = \"laya.events.Event\")]*/\r\n/**开始拖动后调度。\r\n * @eventType Event.DRAG_START\r\n * */\r\n/*[Event(name = \"dragstart\", type = \"laya.events.Event\")]*/\r\n/**拖动中调度。\r\n * @eventType Event.DRAG_MOVE\r\n * */\r\n/*[Event(name = \"dragmove\", type = \"laya.events.Event\")]*/\r\n/**拖动结束后调度。\r\n * @eventType Event.DRAG_END\r\n * */\r\n/*[Event(name = \"dragend\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * <p> <code>Sprite</code> 是基本的显示图形的显示列表节点。 <code>Sprite</code> 默认没有宽高，默认不接受鼠标事件。通过 <code>graphics</code> 可以绘制图片或者矢量图，支持旋转，缩放，位移等操作。<code>Sprite</code>同时也是容器类，可用来添加多个子节点。</p>\r\n * <p>注意： <code>Sprite</code> 默认没有宽高，可以通过<code>getBounds</code>函数获取；也可手动设置宽高；还可以设置<code>autoSize=true</code>，然后再获取宽高。<code>Sprite</code>的宽高一般用于进行碰撞检测和排版，并不影响显示图像大小，如果需要更改显示图像大小，请使用 <code>scaleX</code> ， <code>scaleY</code> ， <code>scale</code>。</p>\r\n * <p> <code>Sprite</code> 默认不接受鼠标事件，即<code>mouseEnabled=false</code>，但是只要对其监听任意鼠标事件，会自动打开自己以及所有父对象的<code>mouseEnabled=true</code>。所以一般也无需手动设置<code>mouseEnabled</code>。</p>\r\n * <p>LayaAir引擎API设计精简巧妙。核心显示类只有一个<code>Sprite</code>。<code>Sprite</code>针对不同的情况做了渲染优化，所以保证一个类实现丰富功能的同时，又达到高性能。</p>\r\n *\r\n * @example <caption>创建了一个 <code>Sprite</code> 实例。</caption>\r\n * package\r\n * {\r\n * \timport laya.display.Sprite;\r\n * \timport laya.events.Event;\r\n *\r\n * \tpublic class Sprite_Example\r\n * \t{\r\n * \t\tprivate var sprite:Sprite;\r\n * \t\tprivate var shape:Sprite\r\n * \t\tpublic function Sprite_Example()\r\n * \t\t{\r\n * \t\t\tLaya.init(640, 800);//设置游戏画布宽高、渲染模式。\r\n * \t\t\tLaya.stage.bgColor = \"#efefef\";//设置画布的背景颜色。\r\n * \t\t\tonInit();\r\n * \t\t}\r\n * \t\tprivate function onInit():void\r\n * \t\t{\r\n * \t\t\tsprite = new Sprite();//创建一个 Sprite 类的实例对象 sprite 。\r\n * \t\t\tsprite.loadImage(\"resource/ui/bg.png\");//加载并显示图片。\r\n * \t\t\tsprite.x = 200;//设置 sprite 对象相对于父容器的水平方向坐标值。\r\n * \t\t\tsprite.y = 200;//设置 sprite 对象相对于父容器的垂直方向坐标值。\r\n * \t\t\tsprite.pivotX = 0;//设置 sprite 对象的水平方法轴心点坐标。\r\n * \t\t\tsprite.pivotY = 0;//设置 sprite 对象的垂直方法轴心点坐标。\r\n * \t\t\tLaya.stage.addChild(sprite);//将此 sprite 对象添加到显示列表。\r\n * \t\t\tsprite.on(Event.CLICK, this, onClickSprite);//给 sprite 对象添加点击事件侦听。\r\n\t\r\n * \t\t\tshape = new Sprite();//创建一个 Sprite 类的实例对象 sprite 。\r\n * \t\t\tshape.graphics.drawRect(0, 0, 100, 100, \"#ccff00\", \"#ff0000\", 2);//绘制一个有边框的填充矩形。\r\n * \t\t\tshape.x = 400;//设置 shape 对象相对于父容器的水平方向坐标值。\r\n * \t\t\tshape.y = 200;//设置 shape 对象相对于父容器的垂直方向坐标值。\r\n * \t\t\tshape.width = 100;//设置 shape 对象的宽度。\r\n * \t\t\tshape.height = 100;//设置 shape 对象的高度。\r\n * \t\t\tshape.pivotX = 50;//设置 shape 对象的水平方法轴心点坐标。\r\n * \t\t\tshape.pivotY = 50;//设置 shape 对象的垂直方法轴心点坐标。\r\n * \t\t\tLaya.stage.addChild(shape);//将此 shape 对象添加到显示列表。\r\n * \t\t\tshape.on(Event.CLICK, this, onClickShape);//给 shape 对象添加点击事件侦听。\r\n * \t\t}\r\n * \t\tprivate function onClickSprite():void\r\n * \t\t{\r\n * \t\t\ttrace(\"点击 sprite 对象。\");\r\n * \t\t\tsprite.rotation += 5;//旋转 sprite 对象。\r\n * \t\t}\r\n * \t\tprivate function onClickShape():void\r\n * \t\t{\r\n * \t\t\ttrace(\"点击 shape 对象。\");\r\n * \t\t\tshape.rotation += 5;//旋转 shape 对象。\r\n * \t\t}\r\n * \t}\r\n * }\r\n *\r\n * @example\r\n * var sprite;\r\n * var shape;\r\n * Sprite_Example();\r\n * function Sprite_Example()\r\n * {\r\n *     Laya.init(640, 800);//设置游戏画布宽高、渲染模式。\r\n *     Laya.stage.bgColor = \"#efefef\";//设置画布的背景颜色。\r\n *     onInit();\r\n * }\r\n * function onInit()\r\n * {\r\n *     sprite = new laya.display.Sprite();//创建一个 Sprite 类的实例对象 sprite 。\r\n *     sprite.loadImage(\"resource/ui/bg.png\");//加载并显示图片。\r\n *     sprite.x = 200;//设置 sprite 对象相对于父容器的水平方向坐标值。\r\n *     sprite.y = 200;//设置 sprite 对象相对于父容器的垂直方向坐标值。\r\n *     sprite.pivotX = 0;//设置 sprite 对象的水平方法轴心点坐标。\r\n *     sprite.pivotY = 0;//设置 sprite 对象的垂直方法轴心点坐标。\r\n *     Laya.stage.addChild(sprite);//将此 sprite 对象添加到显示列表。\r\n *     sprite.on(Event.CLICK, this, onClickSprite);//给 sprite 对象添加点击事件侦听。\r\n\t\r\n *     shape = new laya.display.Sprite();//创建一个 Sprite 类的实例对象 sprite 。\r\n *     shape.graphics.drawRect(0, 0, 100, 100, \"#ccff00\", \"#ff0000\", 2);//绘制一个有边框的填充矩形。\r\n *     shape.x = 400;//设置 shape 对象相对于父容器的水平方向坐标值。\r\n *     shape.y = 200;//设置 shape 对象相对于父容器的垂直方向坐标值。\r\n *     shape.width = 100;//设置 shape 对象的宽度。\r\n *     shape.height = 100;//设置 shape 对象的高度。\r\n *     shape.pivotX = 50;//设置 shape 对象的水平方法轴心点坐标。\r\n *     shape.pivotY = 50;//设置 shape 对象的垂直方法轴心点坐标。\r\n *     Laya.stage.addChild(shape);//将此 shape 对象添加到显示列表。\r\n *     shape.on(laya.events.Event.CLICK, this, onClickShape);//给 shape 对象添加点击事件侦听。\r\n * }\r\n * function onClickSprite()\r\n * {\r\n *     console.log(\"点击 sprite 对象。\");\r\n *     sprite.rotation += 5;//旋转 sprite 对象。\r\n * }\r\n * function onClickShape()\r\n * {\r\n *     console.log(\"点击 shape 对象。\");\r\n *     shape.rotation += 5;//旋转 shape 对象。\r\n * }\r\n *\r\n * @example\r\n * import Sprite = laya.display.Sprite;\r\n * class Sprite_Example {\r\n *     private sprite: Sprite;\r\n *     private shape: Sprite\r\n *     public Sprite_Example() {\r\n *         Laya.init(640, 800);//设置游戏画布宽高、渲染模式。\r\n *         Laya.stage.bgColor = \"#efefef\";//设置画布的背景颜色。\r\n *         this.onInit();\r\n *     }\r\n *     private onInit(): void {\r\n *         this.sprite = new Sprite();//创建一个 Sprite 类的实例对象 sprite 。\r\n *         this.sprite.loadImage(\"resource/ui/bg.png\");//加载并显示图片。\r\n *         this.sprite.x = 200;//设置 sprite 对象相对于父容器的水平方向坐标值。\r\n *         this.sprite.y = 200;//设置 sprite 对象相对于父容器的垂直方向坐标值。\r\n *         this.sprite.pivotX = 0;//设置 sprite 对象的水平方法轴心点坐标。\r\n *         this.sprite.pivotY = 0;//设置 sprite 对象的垂直方法轴心点坐标。\r\n *         Laya.stage.addChild(this.sprite);//将此 sprite 对象添加到显示列表。\r\n *         this.sprite.on(laya.events.Event.CLICK, this, this.onClickSprite);//给 sprite 对象添加点击事件侦听。\r\n\t\r\n *         this.shape = new Sprite();//创建一个 Sprite 类的实例对象 sprite 。\r\n *         this.shape.graphics.drawRect(0, 0, 100, 100, \"#ccff00\", \"#ff0000\", 2);//绘制一个有边框的填充矩形。\r\n *         this.shape.x = 400;//设置 shape 对象相对于父容器的水平方向坐标值。\r\n *         this.shape.y = 200;//设置 shape 对象相对于父容器的垂直方向坐标值。\r\n *         this.shape.width = 100;//设置 shape 对象的宽度。\r\n *         this.shape.height = 100;//设置 shape 对象的高度。\r\n *         this.shape.pivotX = 50;//设置 shape 对象的水平方法轴心点坐标。\r\n *         this.shape.pivotY = 50;//设置 shape 对象的垂直方法轴心点坐标。\r\n *         Laya.stage.addChild(this.shape);//将此 shape 对象添加到显示列表。\r\n *         this.shape.on(laya.events.Event.CLICK, this, this.onClickShape);//给 shape 对象添加点击事件侦听。\r\n *     }\r\n *     private onClickSprite(): void {\r\n *         console.log(\"点击 sprite 对象。\");\r\n *         this.sprite.rotation += 5;//旋转 sprite 对象。\r\n *     }\r\n *     private onClickShape(): void {\r\n *         console.log(\"点击 shape 对象。\");\r\n *         this.shape.rotation += 5;//旋转 shape 对象。\r\n *     }\r\n * }\r\n */\r\nexport class Sprite extends Node {\r\n    /**@internal */\r\n    _x: number = 0;\r\n    /**@internal */\r\n    _y: number = 0;\r\n    /**@internal */\r\n    _width: number = 0;\r\n    /**@internal */\r\n    _height: number = 0;\r\n    /**@internal */\r\n    _visible: boolean = true;\r\n    /**@internal 鼠标状态，0:auto,1:mouseEnabled=false,2:mouseEnabled=true。*/\r\n    _mouseState: number = 0;\r\n    /**@internal z排序，数值越大越靠前。*/\r\n    _zOrder: number = 0;\r\n    /**@internal */\r\n    _renderType: number = 0;\r\n    /**@internal */\r\n    _transform: Matrix|null = null;\r\n    /**@internal */\r\n    protected _tfChanged: boolean = false;\r\n    /**@internal */\r\n    protected _repaint: number = SpriteConst.REPAINT_NONE;\r\n    /**@internal */\r\n    private _texture: Texture|null = null;\r\n\r\n    //以下变量为系统调用，请不要直接使用\r\n    /**@internal */\r\n    _style: SpriteStyle = SpriteStyle.EMPTY;\r\n    /**@internal */\r\n    _cacheStyle: CacheStyle = CacheStyle.EMPTY;\r\n    /**@internal */\r\n    _boundStyle: BoundsStyle|null = null;\r\n    /**@internal */\r\n    _graphics: Graphics|null = null;\r\n\r\n    /**\r\n     * <p>鼠标事件与此对象的碰撞检测是否可穿透。碰撞检测发生在鼠标事件的捕获阶段，此阶段引擎会从stage开始递归检测stage及其子对象，直到找到命中的目标对象或者未命中任何对象。</p>\r\n     * <p>穿透表示鼠标事件发生的位置处于本对象绘图区域内时，才算命中，而与对象宽高和值为Rectangle对象的hitArea属性无关。如果sprite.hitArea值是HitArea对象，表示显式声明了此对象的鼠标事件响应区域，而忽略对象的宽高、mouseThrough属性。</p>\r\n     * <p>影响对象鼠标事件响应区域的属性为：width、height、hitArea，优先级顺序为：hitArea(type:HitArea)>hitArea(type:Rectangle)>width/height。</p>\r\n     * @default false\t不可穿透，此对象的鼠标响应区域由width、height、hitArea属性决定。</p>\r\n     */\r\n    mouseThrough: boolean = false;\r\n    /**\r\n     * <p>指定是否自动计算宽高数据。默认值为 false 。</p>\r\n     * <p>Sprite宽高默认为0，并且不会随着绘制内容的变化而变化，如果想根据绘制内容获取宽高，可以设置本属性为true，或者通过getBounds方法获取。设置为true，对性能有一定影响。</p>\r\n     */\r\n    autoSize: boolean = false;\r\n    /**\r\n     * <p>指定鼠标事件检测是优先检测自身，还是优先检测其子对象。鼠标事件检测发生在鼠标事件的捕获阶段，此阶段引擎会从stage开始递归检测stage及其子对象，直到找到命中的目标对象或者未命中任何对象。</p>\r\n     * <p>如果为false，优先检测子对象，当有子对象被命中时，中断检测，获得命中目标。如果未命中任何子对象，最后再检测此对象；如果为true，则优先检测本对象，如果本对象没有被命中，直接中断检测，表示没有命中目标；如果本对象被命中，则进一步递归检测其子对象，以确认最终的命中目标。</p>\r\n     * <p>合理使用本属性，能减少鼠标事件检测的节点，提高性能。可以设置为true的情况：开发者并不关心此节点的子节点的鼠标事件检测结果，也就是以此节点作为其子节点的鼠标事件检测依据。</p>\r\n     * <p>Stage对象和UI的View组件默认为true。</p>\r\n     * @default false\t优先检测此对象的子对象，当递归检测完所有子对象后，仍然没有找到目标对象，最后再检测此对象。\r\n     */\r\n    hitTestPrior: boolean = false;\r\n\r\n    /**@inheritDoc \r\n     * @override\r\n    */\r\n    destroy(destroyChild: boolean = true): void {\r\n        super.destroy(destroyChild);\r\n        this._style && this._style.recover();\r\n        this._cacheStyle && this._cacheStyle.recover();\r\n        this._boundStyle && this._boundStyle.recover();\r\n        this._style = null;\r\n        this._cacheStyle = null;\r\n        this._boundStyle = null;\r\n        this._transform = null;\r\n        if (this._graphics && this._graphics.autoDestroy) {\r\n            this._graphics.destroy();\r\n        }\r\n        this._graphics = null;\r\n        this.texture = null;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    /**根据zOrder进行重新排序。*/\r\n    updateZOrder(): void {\r\n        Utils.updateOrder(this._children) && this.repaint();\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _getBoundsStyle(): BoundsStyle {\r\n        if (!this._boundStyle) this._boundStyle = BoundsStyle.create();\r\n        return this._boundStyle;\r\n    }\r\n\r\n    /**@internal */\r\n    _setCustomRender(): void {\r\n\r\n    }\r\n\r\n    /**\r\n     * 设置是否开启自定义渲染，只有开启自定义渲染，才能使用customRender函数渲染。\r\n     */\r\n    set customRenderEnable(b: boolean) {\r\n        if (b) {\r\n            this._renderType |= SpriteConst.CUSTOM;\r\n            this._setRenderType(this._renderType);\r\n            this._setCustomRender();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * <p>指定显示对象是否缓存为静态图像，cacheAs时，子对象发生变化，会自动重新缓存，同时也可以手动调用reCache方法更新缓存。</p>\r\n     * <p>建议把不经常变化的“复杂内容”缓存为静态图像，能极大提高渲染性能。cacheAs有\"none\"，\"normal\"和\"bitmap\"三个值可选。\r\n     * <li>默认为\"none\"，不做任何缓存。</li>\r\n     * <li>当值为\"normal\"时，canvas模式下进行画布缓存，webgl模式下进行命令缓存。</li>\r\n     * <li>当值为\"bitmap\"时，canvas模式下进行依然是画布缓存，webgl模式下使用renderTarget缓存。</li></p>\r\n     * <p>webgl下renderTarget缓存模式缺点：会额外创建renderTarget对象，增加内存开销，缓存面积有最大2048限制，不断重绘时会增加CPU开销。优点：大幅减少drawcall，渲染性能最高。\r\n     * webgl下命令缓存模式缺点：只会减少节点遍历及命令组织，不会减少drawcall数，性能中等。优点：没有额外内存开销，无需renderTarget支持。</p>\r\n     */\r\n    get cacheAs(): string {\r\n        return this._cacheStyle.cacheAs;\r\n    }\r\n\r\n    /**@internal */\r\n    _setCacheAs(value: string): void {\r\n        //_dataf32[SpriteConst.POSCACHE] = value == \"bitmap\"?2:(value == \"normal\"?1:0);\r\n    }\r\n\r\n    set cacheAs(value: string) {\r\n        if (value === this._cacheStyle.userSetCache) return;\r\n        if (this.mask && value === 'normal') return;\r\n        this._setCacheAs(value);\r\n        this._getCacheStyle().userSetCache = value;\r\n        this._checkCanvasEnable();\r\n        this.repaint();\r\n    }\r\n\r\n    /**\r\n     * 更新_cnavas相关的状态\r\n     */\r\n    private _checkCanvasEnable(): void {\r\n        var tEnable: boolean = this._cacheStyle.needEnableCanvasRender();\r\n        this._getCacheStyle().enableCanvasRender = tEnable;\r\n        if (tEnable) {\r\n            if (this._cacheStyle.needBitmapCache()) {\r\n                this._cacheStyle.cacheAs = \"bitmap\";\r\n            } else {\r\n                this._cacheStyle.cacheAs = this._cacheStyle.userSetCache;\r\n            }\r\n            this._cacheStyle.reCache = true;\r\n            this._renderType |= SpriteConst.CANVAS;\r\n        } else {\r\n            this._cacheStyle.cacheAs = \"none\";\r\n            this._cacheStyle.releaseContext();\r\n            this._renderType &= ~SpriteConst.CANVAS;\r\n        }\r\n        this._setCacheAs(this._cacheStyle.cacheAs);\r\n        this._setRenderType(this._renderType);\r\n    }\r\n\r\n    /**设置cacheAs为非空时此值才有效，staticCache=true时，子对象变化时不会自动更新缓存，只能通过调用reCache方法手动刷新。*/\r\n    get staticCache(): boolean {\r\n        return this._cacheStyle.staticCache;\r\n    }\r\n\r\n    set staticCache(value: boolean) {\r\n        this._getCacheStyle().staticCache = value;\r\n        if (!value) this.reCache();\r\n    }\r\n\r\n    /**在设置cacheAs的情况下，调用此方法会重新刷新缓存。*/\r\n    reCache(): void {\r\n        this._cacheStyle.reCache = true;\r\n        this._repaint |= SpriteConst.REPAINT_CACHE;\r\n    }\r\n\r\n    getRepaint(): number {\r\n        return this._repaint;\r\n    }\r\n\r\n    /**@internal */\r\n    _setX(value: number): void {\r\n        this._x = value;\r\n    }\r\n\r\n    /**@internal */\r\n    _setY(value: number): void {\r\n        this._y = value;\r\n    }\r\n\r\n    /**@internal */\r\n    _setWidth(texture: Texture, value: number): void {\r\n    }\r\n\r\n    /**@internal */\r\n    _setHeight(texture: Texture, value: number): void {\r\n    }\r\n\r\n    /**表示显示对象相对于父容器的水平方向坐标值。*/\r\n    get x(): number {\r\n        return this._x;\r\n    }\r\n\r\n    set x(value: number) {\r\n        if (this.destroyed) return;\r\n        if (this._x !== value) {\r\n            this._setX(value);\r\n            //_setTranformChange();\r\n            this.parentRepaint(SpriteConst.REPAINT_CACHE);\r\n            var p: Sprite = this._cacheStyle.maskParent;\r\n            if (p) {\r\n                p.repaint(SpriteConst.REPAINT_CACHE);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**表示显示对象相对于父容器的垂直方向坐标值。*/\r\n    get y(): number {\r\n        return this._y;\r\n    }\r\n\r\n    set y(value: number) {\r\n        if (this.destroyed) return;\r\n        if (this._y !== value) {\r\n            this._setY(value);\r\n            //_setTranformChange();\r\n            this.parentRepaint(SpriteConst.REPAINT_CACHE);\r\n            var p: Sprite = this._cacheStyle.maskParent;\r\n            if (p) {\r\n                p.repaint(SpriteConst.REPAINT_CACHE);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * <p>显示对象的宽度，单位为像素，默认为0。</p>\r\n     * <p>此宽度用于鼠标碰撞检测，并不影响显示对象图像大小。需要对显示对象的图像进行缩放，请使用scale、scaleX、scaleY。</p>\r\n     * <p>可以通过getbounds获取显示对象图像的实际宽度。</p>\r\n     */\r\n    get width(): number {\r\n        return this.get_width();\r\n    }\r\n\r\n    set width(value: number) {\r\n        this.set_width(value);\r\n    }\r\n\r\n    // for ts\r\n    set_width(value: number): void {\r\n        if (this._width !== value) {\r\n            this._width = value;\r\n            this._setWidth(this.texture, value);\r\n            this._setTranformChange();\r\n            //repaint();\r\n        }\r\n    }\r\n    get_width(): number {\r\n        if (!this.autoSize) return this._width || (this.texture ? this.texture.width : 0);\r\n        if (this.texture) return this.texture.width;\r\n        if (!this._graphics && this._children.length === 0) return 0;\r\n        return this.getSelfBounds().width;\r\n    }\r\n\r\n    /**\r\n     * <p>显示对象的高度，单位为像素，默认为0。</p>\r\n     * <p>此高度用于鼠标碰撞检测，并不影响显示对象图像大小。需要对显示对象的图像进行缩放，请使用scale、scaleX、scaleY。</p>\r\n     * <p>可以通过getbounds获取显示对象图像的实际高度。</p>\r\n     */\r\n    get height(): number {\r\n        return this.get_height();\r\n    }\r\n\r\n    set height(value: number) {\r\n        this.set_height(value);\r\n    }\r\n\r\n    // for ts\r\n    set_height(value: number): void {\r\n        if (this._height !== value) {\r\n            this._height = value;\r\n            this._setHeight(this.texture, value);\r\n            this._setTranformChange();\r\n            //repaint();\r\n        }\r\n    }\r\n    get_height(): number {\r\n        if (!this.autoSize) return this._height || (this.texture ? this.texture.height : 0);\r\n        if (this.texture) return this.texture.height;\r\n        if (!this._graphics && this._children.length === 0) return 0;\r\n        return this.getSelfBounds().height;\r\n    }\r\n\r\n    /**\r\n     * <p>对象的显示宽度（以像素为单位）。</p>\r\n     */\r\n    get displayWidth(): number {\r\n        return this.width * this.scaleX;\r\n    }\r\n\r\n    /**\r\n     * <p>对象的显示高度（以像素为单位）。</p>\r\n     */\r\n    get displayHeight(): number {\r\n        return this.height * this.scaleY;\r\n    }\r\n\r\n    /**\r\n     * 设置对象bounds大小，如果有设置，则不再通过getBounds计算，合理使用能提高性能。\r\n     * @param\tbound bounds矩形区域\r\n     */\r\n    setSelfBounds(bound: Rectangle): void {\r\n        this._getBoundsStyle().userBounds = bound;\r\n    }\r\n\r\n    /**\r\n     * <p>获取本对象在父容器坐标系的矩形显示区域。</p>\r\n     * <p><b>注意：</b>计算量较大，尽量少用。</p>\r\n     * @return 矩形区域。\r\n     */\r\n    getBounds(): Rectangle {\r\n        return this._getBoundsStyle().bounds = Rectangle._getWrapRec(this._boundPointsToParent());\r\n    }\r\n\r\n    /**\r\n     * 获取本对象在自己坐标系的矩形显示区域。\r\n     * <p><b>注意：</b>计算量较大，尽量少用。</p>\r\n     * @return 矩形区域。\r\n     */\r\n    getSelfBounds(): Rectangle {\r\n        if (this._boundStyle && this._boundStyle.userBounds) return this._boundStyle.userBounds;\r\n        if (!this._graphics && this._children.length === 0 && !this._texture)\r\n            return Rectangle.TEMP.setTo(0, 0, this.width, this.height); // 如果没有graphics则取对象指定的大小。原来是0000\r\n        //if (_renderType === (SpriteConst.IMAGE | SpriteConst.GRAPHICS)) {\r\n        //_getBoundsStyle();\r\n        //if (!_boundStyle.bounds) _boundStyle.bounds = Rectangle.create();\r\n        //var tDrawCmd:Array = _graphics._one;\r\n        //return _boundStyle.bounds.setTo(tDrawCmd[1], tDrawCmd[2], tDrawCmd[3], tDrawCmd[4]);\r\n        //}\r\n        return this._getBoundsStyle().bounds = Rectangle._getWrapRec(this._getBoundPointsM(false));\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 获取本对象在父容器坐标系的显示区域多边形顶点列表。\r\n     * 当显示对象链中有旋转时，返回多边形顶点列表，无旋转时返回矩形的四个顶点。\r\n     * @param ifRotate\t（可选）之前的对象链中是否有旋转。\r\n     * @return 顶点列表。结构：[x1,y1,x2,y2,x3,y3,...]。\r\n     */\r\n    _boundPointsToParent(ifRotate: boolean = false): any[] {\r\n        var pX: number = 0, pY: number = 0;\r\n        if (this._style) {\r\n            pX = this.pivotX;\r\n            pY = this.pivotY;\r\n            ifRotate = ifRotate || (this._style.rotation !== 0);\r\n            if (this._style.scrollRect) {\r\n                pX += this._style.scrollRect.x;\r\n                pY += this._style.scrollRect.y;\r\n            }\r\n        }\r\n        var pList: any[] = this._getBoundPointsM(ifRotate);\r\n        if (!pList || pList.length < 1) return pList;\r\n\r\n        if (pList.length != 8) {\r\n            pList = ifRotate ? GrahamScan.scanPList(pList) : Rectangle._getWrapRec(pList, Rectangle.TEMP)._getBoundPoints();\r\n        }\r\n\r\n        if (!this.transform) {\r\n            Utils.transPointList(pList, this._x - pX, this._y - pY);\r\n            return pList;\r\n        }\r\n        var tPoint: Point = Point.TEMP;\r\n        var i: number, len: number = pList.length;\r\n        for (i = 0; i < len; i += 2) {\r\n            tPoint.x = pList[i];\r\n            tPoint.y = pList[i + 1];\r\n            this.toParentPoint(tPoint);\r\n            pList[i] = tPoint.x;\r\n            pList[i + 1] = tPoint.y;\r\n        }\r\n        return pList;\r\n    }\r\n\r\n    /**\r\n     * 返回此实例中的绘图对象（ <code>Graphics</code> ）的显示区域，不包括子对象。\r\n     * @param realSize\t（可选）使用图片的真实大小，默认为false\r\n     * @return 一个 Rectangle 对象，表示获取到的显示区域。\r\n     */\r\n    getGraphicBounds(realSize: boolean = false): Rectangle {\r\n        if (!this._graphics) return Rectangle.TEMP.setTo(0, 0, 0, 0);\r\n        return this._graphics.getBounds(realSize);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 获取自己坐标系的显示区域多边形顶点列表\r\n     * @param ifRotate\t（可选）当前的显示对象链是否由旋转\r\n     * @return 顶点列表。结构：[x1,y1,x2,y2,x3,y3,...]。\r\n     */\r\n    _getBoundPointsM(ifRotate: boolean = false): any[] {\r\n        if (this._boundStyle && this._boundStyle.userBounds) return this._boundStyle.userBounds._getBoundPoints();\r\n        if (!this._boundStyle) this._getBoundsStyle();\r\n        if (!this._boundStyle.temBM) this._boundStyle.temBM = [];\r\n        if (this._style.scrollRect) {\r\n            var rst: any[] = Utils.clearArray(this._boundStyle.temBM);\r\n            var rec: Rectangle = Rectangle.TEMP;\r\n            rec.copyFrom(this._style.scrollRect);\r\n            Utils.concatArray(rst, rec._getBoundPoints());\r\n            return rst;\r\n        }\r\n        var pList: any[];\r\n        if (this._graphics) {\r\n            pList = this._graphics.getBoundPoints();\r\n        } else {\r\n            pList = Utils.clearArray(this._boundStyle.temBM);\r\n            if (this._texture) {\r\n                rec = Rectangle.TEMP;\r\n                rec.setTo(0, 0, this.width || this._texture.width, this.height || this._texture.height);\r\n                Utils.concatArray(pList, rec._getBoundPoints());\r\n            }\r\n        }\r\n        //处理子对象区域\r\n        var child: Sprite;\r\n        var cList: any[];\r\n        var __childs: any[];\r\n        __childs = this._children;\r\n        for (var i: number = 0, n: number = __childs.length; i < n; i++) {\r\n            //child = getChildAt(i) as Sprite; \r\n            child = (<Sprite>__childs[i]);\r\n            if (child instanceof Sprite && child._visible === true) {\r\n                cList = child._boundPointsToParent(ifRotate);\r\n                if (cList)\r\n                    pList = pList ? Utils.concatArray(pList, cList) : cList;\r\n            }\r\n        }\r\n        return pList;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 获取cache数据。\r\n     * @return  cache数据 CacheStyle 。\r\n     */\r\n    _getCacheStyle(): CacheStyle {\r\n        this._cacheStyle === CacheStyle.EMPTY && (this._cacheStyle = CacheStyle.create());\r\n        return this._cacheStyle;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 获取样式。\r\n     * @return  样式 Style 。\r\n     */\r\n    getStyle(): SpriteStyle {\r\n        this._style === SpriteStyle.EMPTY && (this._style = SpriteStyle.create());\r\n        return this._style;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 设置样式。\r\n     * @param\tvalue 样式。\r\n     */\r\n    setStyle(value: SpriteStyle): void {\r\n        this._style = value;\r\n    }\r\n\r\n    /**X轴缩放值，默认值为1。设置为负数，可以实现水平反转效果，比如scaleX=-1。*/\r\n    get scaleX(): number {\r\n        return this._style.scaleX;\r\n    }\r\n\r\n    set scaleX(value: number) {\r\n        this.set_scaleX(value);\r\n    }\r\n\r\n    /**@internal */\r\n    _setScaleX(value: number): void {\r\n        this._style.scaleX = value;\r\n    }\r\n\r\n    /**Y轴缩放值，默认值为1。设置为负数，可以实现垂直反转效果，比如scaleX=-1。*/\r\n    get scaleY(): number {\r\n        return this._style.scaleY;\r\n    }\r\n\r\n    set scaleY(value: number) {\r\n        this.set_scaleY(value);\r\n    }\r\n\r\n    /**@internal */\r\n    _setScaleY(value: number): void {\r\n        this._style.scaleY = value;\r\n    }\r\n\r\n\r\n    set_scaleX(value: number): void {\r\n        var style: SpriteStyle = this.getStyle();\r\n        if (style.scaleX !== value) {\r\n            this._setScaleX(value);\r\n            this._setTranformChange();\r\n        }\r\n    }\r\n    get_scaleX(): number {\r\n        return this._style.scaleX;\r\n    }\r\n\r\n    set_scaleY(value: number): void {\r\n        var style: SpriteStyle = this.getStyle();\r\n        if (style.scaleY !== value) {\r\n            this._setScaleY(value);\r\n            this._setTranformChange();\r\n        }\r\n    }\r\n    get_scaleY(): number {\r\n        return this._style.scaleY;\r\n    }\r\n\r\n    /**旋转角度，默认值为0。以角度为单位。*/\r\n    get rotation(): number {\r\n        return this._style.rotation;\r\n    }\r\n\r\n    set rotation(value: number) {\r\n        var style: SpriteStyle = this.getStyle();\r\n        if (style.rotation !== value) {\r\n            this._setRotation(value);\r\n            this._setTranformChange();\r\n        }\r\n    }\r\n\r\n    /**@internal */\r\n    _setRotation(value: number): void {\r\n        this._style.rotation = value;\r\n    }\r\n\r\n    /**水平倾斜角度，默认值为0。以角度为单位。*/\r\n    get skewX(): number {\r\n        return this._style.skewX;\r\n    }\r\n\r\n    set skewX(value: number) {\r\n        var style: SpriteStyle = this.getStyle();\r\n        if (style.skewX !== value) {\r\n            this._setSkewX(value);\r\n            this._setTranformChange();\r\n        }\r\n    }\r\n\r\n    /**@internal */\r\n    _setSkewX(value: number): void {\r\n        this._style.skewX = value;\r\n    }\r\n\r\n    /**垂直倾斜角度，默认值为0。以角度为单位。*/\r\n    get skewY(): number {\r\n        return this._style.skewY;\r\n    }\r\n\r\n    set skewY(value: number) {\r\n        var style: SpriteStyle = this.getStyle();\r\n        if (style.skewY !== value) {\r\n            this._setSkewY(value);\r\n            this._setTranformChange();\r\n        }\r\n    }\r\n\r\n    /**@internal */\r\n    _setSkewY(value: number): void {\r\n        this._style.skewY = value;\r\n    }\r\n\r\n    /**@internal */\r\n    _createTransform(): Matrix {\r\n        return Matrix.create();\r\n    }\r\n\r\n    /**@private */\r\n    protected _adjustTransform(): Matrix {\r\n        this._tfChanged = false;\r\n        var style: SpriteStyle = this._style;\r\n        var sx: number = style.scaleX, sy: number = style.scaleY;\r\n        var sskx: number = style.skewX;\r\n        var ssky: number = style.skewY;\r\n        var rot: number = style.rotation;\r\n        var m: Matrix = this._transform || (this._transform = this._createTransform());\r\n        if (rot || sx !== 1 || sy !== 1 || sskx !== 0 || ssky !== 0) {\r\n            m._bTransform = true;\r\n            var skx: number = (rot - sskx) * 0.0174532922222222;//laya.CONST.PI180;\r\n            var sky: number = (rot + ssky) * 0.0174532922222222;\r\n            var cx: number = Math.cos(sky);\r\n            var ssx: number = Math.sin(sky);\r\n            var cy: number = Math.sin(skx);\r\n            var ssy: number = Math.cos(skx);\r\n            m.a = sx * cx;\r\n            m.b = sx * ssx;\r\n            m.c = -sy * cy;\r\n            m.d = sy * ssy;\r\n            m.tx = m.ty = 0;\r\n        } else {\r\n            m.identity();\r\n            this._renderType &= ~SpriteConst.TRANSFORM;\r\n            this._setRenderType(this._renderType);\r\n        }\r\n        return m;\r\n    }\r\n\r\n    /**@internal */\r\n    _setTransform(value: Matrix): void {\r\n\r\n    }\r\n\r\n    /**\r\n     * <p>对象的矩阵信息。通过设置矩阵可以实现节点旋转，缩放，位移效果。</p>\r\n     * <p>矩阵更多信息请参考 <code>Matrix</code></p>\r\n     */\r\n    get transform(): Matrix {\r\n        return this._tfChanged ? this._adjustTransform() : this._transform;\r\n    }\r\n\r\n    set transform(value: Matrix) {\r\n        this.set_transform(value);\r\n    }\r\n\r\n    get_transform(): Matrix {\r\n        return this._tfChanged ? this._adjustTransform() : this._transform;\r\n    }\r\n\r\n    set_transform(value: Matrix): void {\r\n        this._tfChanged = false;\r\n        var m: Matrix = this._transform || (this._transform = this._createTransform());\r\n        value.copyTo(m);\r\n        this._setTransform(m);\r\n        //设置transform时重置x,y\r\n        if (value) {\r\n            this._x = m.tx;\r\n            this._y = m.ty;\r\n            m.tx = m.ty = 0;\r\n        }\r\n        if (value) this._renderType |= SpriteConst.TRANSFORM;\r\n        else {\r\n            this._renderType &= ~SpriteConst.TRANSFORM;\r\n        }\r\n        this._setRenderType(this._renderType);\r\n        this.parentRepaint();\r\n    }\r\n\r\n    /**@internal */\r\n    _setPivotX(value: number): void {\r\n        var style: SpriteStyle = this.getStyle();\r\n        style.pivotX = value;\r\n    }\r\n\r\n    /**@internal */\r\n    _getPivotX(): number {\r\n        return this._style.pivotX;\r\n    }\r\n\r\n    /**@internal */\r\n    _setPivotY(value: number): void {\r\n        var style: SpriteStyle = this.getStyle();\r\n        style.pivotY = value;\r\n    }\r\n\r\n    /**@internal */\r\n    _getPivotY(): number {\r\n        return this._style.pivotY;\r\n    }\r\n\r\n    /**X轴 轴心点的位置，单位为像素，默认为0。轴心点会影响对象位置，缩放中心，旋转中心。*/\r\n    get pivotX(): number {\r\n        return this._getPivotX();\r\n    }\r\n\r\n    set pivotX(value: number) {\r\n        this._setPivotX(value);\r\n        this.repaint();\r\n    }\r\n\r\n    /**Y轴 轴心点的位置，单位为像素，默认为0。轴心点会影响对象位置，缩放中心，旋转中心。*/\r\n    get pivotY(): number {\r\n        return this._getPivotY();\r\n    }\r\n\r\n    set pivotY(value: number) {\r\n        this._setPivotY(value);\r\n        this.repaint();\r\n    }\r\n\r\n    /**@internal */\r\n    _setAlpha(value: number): void {\r\n        if (this._style.alpha !== value) {\r\n            var style: SpriteStyle = this.getStyle();\r\n            style.alpha = value;\r\n            if (value !== 1) this._renderType |= SpriteConst.ALPHA;\r\n            else this._renderType &= ~SpriteConst.ALPHA;\r\n            this._setRenderType(this._renderType);\r\n            this.parentRepaint();\r\n        }\r\n    }\r\n\r\n    /**@internal */\r\n    _getAlpha(): number {\r\n        return this._style.alpha;\r\n    }\r\n\r\n    /**透明度，值为0-1，默认值为1，表示不透明。更改alpha值会影响drawcall。*/\r\n    get alpha(): number {\r\n        return this._getAlpha();\r\n    }\r\n\r\n    set alpha(value: number) {\r\n        value = value < 0 ? 0 : (value > 1 ? 1 : value);\r\n        this._setAlpha(value);\r\n    }\r\n\r\n    /**表示是否可见，默认为true。如果设置不可见，节点将不被渲染。*/\r\n    get visible(): boolean {\r\n        return this.get_visible();\r\n    }\r\n\r\n    set visible(value: boolean) {\r\n        this.set_visible(value);\r\n    }\r\n\r\n    get_visible(): boolean {\r\n        return this._visible;\r\n    }\r\n\r\n    set_visible(value: boolean): void {\r\n        if (this._visible !== value) {\r\n            this._visible = value;\r\n            this.parentRepaint(SpriteConst.REPAINT_ALL);\r\n        }\r\n    }\r\n\r\n    /**@internal */\r\n    _setBlendMode(value: string): void {\r\n\r\n    }\r\n\r\n    /**指定要使用的混合模式。目前只支持\"lighter\"。*/\r\n    get blendMode(): string {\r\n        return this._style.blendMode;\r\n    }\r\n\r\n    set blendMode(value: string) {\r\n        this._setBlendMode(value);\r\n        this.getStyle().blendMode = value;\r\n        if (value && value != \"source-over\") this._renderType |= SpriteConst.BLEND;\r\n        else this._renderType &= ~SpriteConst.BLEND;\r\n        this._setRenderType(this._renderType);\r\n        this.parentRepaint();\r\n    }\r\n\r\n    /**绘图对象。封装了绘制位图和矢量图的接口，Sprite所有的绘图操作都通过Graphics来实现的。*/\r\n    get graphics(): Graphics {\r\n        if (!this._graphics) {\r\n            this.graphics = new Graphics();\r\n            this._graphics.autoDestroy = true;\r\n        }\r\n        return this._graphics;\r\n    }\r\n\r\n    /**@internal */\r\n    _setGraphics(value: Graphics): void {\r\n    }\r\n\r\n    /**@internal */\r\n    _setGraphicsCallBack(): void {\r\n    }\r\n\r\n    set graphics(value: Graphics) {\r\n        if (this._graphics) this._graphics._sp = null;\r\n        this._graphics = value;\r\n        if (value) {\r\n            this._setGraphics(value);\r\n            this._renderType |= SpriteConst.GRAPHICS;\r\n            value._sp = this;\r\n        } else {\r\n            this._renderType &= ~SpriteConst.GRAPHICS;\r\n        }\r\n        this._setRenderType(this._renderType);\r\n        this.repaint();\r\n    }\r\n\r\n    /**\r\n     * <p>显示对象的滚动矩形范围，具有裁剪效果(如果只想限制子对象渲染区域，请使用viewport)</p>\r\n     * <p> srollRect和viewport的区别：<br/>\r\n     * 1.srollRect自带裁剪效果，viewport只影响子对象渲染是否渲染，不具有裁剪效果（性能更高）。<br/>\r\n     * 2.设置rect的x,y属性均能实现区域滚动效果，但scrollRect会保持0,0点位置不变。</p>\r\n     */\r\n    get scrollRect(): Rectangle {\r\n        return this._style.scrollRect;\r\n    }\r\n\r\n    /**@internal */\r\n    _setScrollRect(value: Rectangle): void {\r\n\r\n    }\r\n\r\n    set scrollRect(value: Rectangle) {\r\n        this.getStyle().scrollRect = value;\r\n        this._setScrollRect(value);\r\n        //viewport = value;\r\n        this.repaint();\r\n        if (value) {\r\n            this._renderType |= SpriteConst.CLIP;\r\n        } else {\r\n            this._renderType &= ~SpriteConst.CLIP;\r\n        }\r\n        this._setRenderType(this._renderType);\r\n    }\r\n\r\n    /**\r\n     * <p>设置坐标位置。相当于分别设置x和y属性。</p>\r\n     * <p>因为返回值为Sprite对象本身，所以可以使用如下语法：spr.pos(...).scale(...);</p>\r\n     * @param\tx\t\t\tX轴坐标。\r\n     * @param\ty\t\t\tY轴坐标。\r\n     * @param \tspeedMode\t（可选）是否极速模式，正常是调用this.x=value进行赋值，极速模式直接调用内部函数处理，如果未重写x,y属性，建议设置为急速模式性能更高。\r\n     * @return\t返回对象本身。\r\n     */\r\n    pos(x: number, y: number, speedMode: boolean = false): Sprite {\r\n        if (this._x !== x || this._y !== y) {\r\n            if (this.destroyed) return this;\r\n            if (speedMode) {\r\n                this._setX(x);\r\n                this._setY(y);\r\n                this.parentRepaint(SpriteConst.REPAINT_CACHE);\r\n                var p: Sprite = this._cacheStyle.maskParent;\r\n                if (p) {\r\n                    p.repaint(SpriteConst.REPAINT_CACHE);\r\n                }\r\n            } else {\r\n                this.x = x;\r\n                this.y = y;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * <p>设置轴心点。相当于分别设置pivotX和pivotY属性。</p>\r\n     * <p>因为返回值为Sprite对象本身，所以可以使用如下语法：spr.pivot(...).pos(50, 100);</p>\r\n     * @param\tx X轴心点。\r\n     * @param\ty Y轴心点。\r\n     * @return\t返回对象本身。\r\n     */\r\n    pivot(x: number, y: number): Sprite {\r\n        this.pivotX = x;\r\n        this.pivotY = y;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * <p>设置宽高。相当于分别设置width和height属性。</p>\r\n     * <p>因为返回值为Sprite对象本身，所以可以使用如下语法：spr.size(...).pos(50, 100);</p>\r\n     * @param\twidth 宽度值。\r\n     * @param\thegiht 高度值。\r\n     * @return\t返回对象本身。\r\n     */\r\n    size(width: number, height: number): Sprite {\r\n        this.width = width;\r\n        this.height = height;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * <p>设置缩放。相当于分别设置scaleX和scaleY属性。</p>\r\n     * <p>因为返回值为Sprite对象本身，所以可以使用如下语法：spr.scale(...).pos(50, 100);</p>\r\n     * @param\tscaleX\t\tX轴缩放比例。\r\n     * @param\tscaleY\t\tY轴缩放比例。\r\n     * @param \tspeedMode\t（可选）是否极速模式，正常是调用this.scaleX=value进行赋值，极速模式直接调用内部函数处理，如果未重写scaleX,scaleY属性，建议设置为急速模式性能更高。\r\n     * @return\t返回对象本身。\r\n     */\r\n    scale(scaleX: number, scaleY: number, speedMode: boolean = false): Sprite {\r\n        var style: SpriteStyle = this.getStyle();\r\n        if (style.scaleX != scaleX || style.scaleY != scaleY) {\r\n            if (this.destroyed) return this;\r\n            if (speedMode) {\r\n                this._setScaleX(scaleX);\r\n                this._setScaleY(scaleY);\r\n                this._setTranformChange();\r\n            } else {\r\n                this.scaleX = scaleX;\r\n                this.scaleY = scaleY;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * <p>设置倾斜角度。相当于分别设置skewX和skewY属性。</p>\r\n     * <p>因为返回值为Sprite对象本身，所以可以使用如下语法：spr.skew(...).pos(50, 100);</p>\r\n     * @param\tskewX 水平倾斜角度。\r\n     * @param\tskewY 垂直倾斜角度。\r\n     * @return\t返回对象本身\r\n     */\r\n    skew(skewX: number, skewY: number): Sprite {\r\n        this.skewX = skewX;\r\n        this.skewY = skewY;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 更新、呈现显示对象。由系统调用。\r\n     * @param\tcontext 渲染的上下文引用。\r\n     * @param\tx X轴坐标。\r\n     * @param\ty Y轴坐标。\r\n     */\r\n    render(ctx: Context, x: number, y: number): void {\r\n        RenderSprite.renders[this._renderType]._fun(this, ctx, x + this._x, y + this._y);\r\n        /*\r\n        var rt:int = _renderType;\r\n        var style:SpriteStyle = _style;\r\n        var oldAlpha:Number = ctx.globalAlpha;\r\n        var save:Boolean = false;\r\n        if (rt & SpriteConst.TRANSFORM ) {\r\n            ctx.save();\r\n            save = true;\r\n            ctx.transform(transform.a, transform.b, transform.c, transform.d, transform.tx + x+_x, transform.ty + y+_y);\r\n        }\r\n    \t\r\n        if ( rt & SpriteConst.ALPHA) {\r\n            var alpha:Number = style.alpha;\r\n            if (alpha > 0.01 || _needRepaint()) {\r\n                //var temp:Number = context.globalAlpha;\r\n                ctx.globalAlpha *= alpha;\r\n                //context.globalAlpha = temp;\r\n            }\t\t\t\t\r\n        }\r\n    \t\r\n        if ( rt & SpriteConst.TEXTURE ) {\r\n            var tex:Texture = texture;\r\n            ctx.drawTexture(tex, x-pivotX+_x, y-pivotY+_y, tex.width, tex.height);\r\n        }\r\n    \t\r\n        if ( rt & SpriteConst.GRAPHICS) {\r\n            _graphics && _graphics._render(this, ctx, x-pivotX+_x, y-pivotY+_y);\r\n        }\r\n    \t\r\n        if (_children.length) {\r\n            _children.forEach(function(c:Sprite) {\r\n                c._visible && c.render(ctx, x - pivotX+_x, y - pivotY+_y);\r\n            } );\r\n        }\r\n        ctx.globalAlpha = oldAlpha;//TODO 可能慢\r\n        if (save) {\r\n            ctx.restore();\r\n        }\r\n        */\r\n        this._repaint = 0;\r\n    }\r\n\r\n    /**\r\n     * <p>绘制 当前<code>Sprite</code> 到 <code>Canvas</code> 上，并返回一个HtmlCanvas。</p>\r\n     * <p>绘制的结果可以当作图片源，再次绘制到其他Sprite里面，示例：</p>\r\n     *\r\n     * var htmlCanvas:HTMLCanvas = sprite.drawToCanvas(100, 100, 0, 0);//把精灵绘制到canvas上面\r\n     * var sp:Sprite = new Sprite();//创建精灵\r\n     * sp.graphics.drawTexture(htmlCanvas.getTexture());//把截图绘制到精灵上\r\n     * Laya.stage.addChild(sp);//把精灵显示到舞台\r\n     *\r\n     * <p>也可以获取原始图片数据，分享到网上，从而实现截图效果，示例：</p>\r\n     *\r\n     * var htmlCanvas:HTMLCanvas = sprite.drawToCanvas(100, 100, 0, 0);//把精灵绘制到canvas上面\r\n     * htmlCanvas.toBase64(\"image/png\",0.9);//打印图片base64信息，可以发给服务器或者保存为图片\r\n     *\r\n     * @param\tcanvasWidth 画布宽度。\r\n     * @param\tcanvasHeight 画布高度。\r\n     * @param\tx 绘制的 X 轴偏移量。\r\n     * @param\ty 绘制的 Y 轴偏移量。\r\n     * @return  HTMLCanvas 对象。\r\n     */\r\n    drawToCanvas(canvasWidth: number, canvasHeight: number, offsetX: number, offsetY: number): HTMLCanvas {\r\n        //console.log('drawToCanvas is deprecated, please use drawToTexture');\r\n        return Sprite.drawToCanvas(this, this._renderType, canvasWidth, canvasHeight, offsetX, offsetY);\r\n    }\r\n\r\n    /**\r\n     * 绘制到一个Texture对象\r\n     * @param canvasWidth \r\n     * @param canvasHeight \r\n     * @param offsetX \r\n     * @param offsetY \r\n     */\r\n    drawToTexture(canvasWidth: number, canvasHeight: number, offsetX: number, offsetY: number, rt:RenderTexture2D|null=null): Texture|RenderTexture2D {\r\n        return Sprite.drawToTexture(this, this._renderType, canvasWidth, canvasHeight, offsetX, offsetY,rt);\r\n    }\r\n\r\n    /**\r\n     * 把当前对象渲染到指定的贴图上。贴图由外部指定，避免每次都创建。\r\n     * @param offx \r\n     * @param offy \r\n     * @param tex 输出渲染结果\r\n     */\r\n    drawToTexture3D(offx: number, offy: number, tex: Texture2D) {\r\n        throw 'not implement'\r\n    }\r\n\r\n\r\n    /**\r\n     * @private\r\n     * 绘制到画布。\r\n     */\r\n    static drawToCanvas(sprite: Sprite, _renderType: number, canvasWidth: number, canvasHeight: number, offsetX: number, offsetY: number): HTMLCanvas {\r\n        offsetX -= sprite.x;\r\n        offsetY -= sprite.y;\r\n        offsetX |= 0;\r\n        offsetY |= 0;\r\n        canvasWidth |= 0;\r\n        canvasHeight |= 0;\r\n        var ctx: Context = new Context();\r\n        ctx.size(canvasWidth, canvasHeight);\r\n        ctx.asBitmap = true;\r\n        ctx._targets.start();\r\n        ctx._targets.clear(0, 0, 0, 0);\r\n        RenderSprite.renders[_renderType]._fun(sprite, ctx, offsetX, offsetY);\r\n        ctx.flush();\r\n        ctx._targets.end();\r\n        ctx._targets.restore();\r\n        var dt: Uint8Array = ctx._targets.getData(0, 0, canvasWidth, canvasHeight);\r\n        ctx.destroy();\r\n        var imgdata: any = new ImageData(canvasWidth, canvasHeight);;\t//创建空的imagedata。因为下面要翻转，所以不直接设置内容\r\n        //翻转getData的结果。\r\n        var lineLen: number = canvasWidth * 4;\r\n        var temp: Uint8Array = new Uint8Array(lineLen);\r\n        var dst: Uint8Array = imgdata.data;\r\n        var y: number = canvasHeight - 1;\r\n        var off: number = y * lineLen;\r\n        var srcoff: number = 0;\r\n        for (; y >= 0; y--) {\r\n            dst.set(dt.subarray(srcoff, srcoff + lineLen), off);\r\n            off -= lineLen;\r\n            srcoff += lineLen;\r\n        }\r\n        //imgdata.data.set(dt);\r\n        //画到2d画布上\r\n        var canv: HTMLCanvas = new HTMLCanvas(true);\r\n        canv.size(canvasWidth, canvasHeight);\r\n        var ctx2d: CanvasRenderingContext2D = <CanvasRenderingContext2D>(canv.getContext('2d') as any);\r\n        ctx2d.putImageData(imgdata, 0, 0);;\r\n        return canv;\r\n    }\r\n\r\n\tstatic drawtocanvCtx:Context;\r\n    /**\r\n     * @private \r\n     * \r\n     */\r\n    static drawToTexture(sprite: Sprite, _renderType: number, canvasWidth: number, canvasHeight: number, offsetX: number, offsetY: number, rt:RenderTexture2D|null=null): Texture|RenderTexture2D {\r\n\t\tif(!Sprite.drawtocanvCtx){\r\n\t\t\tSprite.drawtocanvCtx = new Context();\r\n\t\t}\r\n        offsetX -= sprite.x;\r\n        offsetY -= sprite.y;\r\n        offsetX |= 0;\r\n        offsetY |= 0;\r\n        canvasWidth |= 0;\r\n        canvasHeight |= 0;\r\n\t\tvar ctx = rt?Sprite.drawtocanvCtx:new Context();\r\n\t\tctx.clear();\r\n\t\tctx.size(canvasWidth, canvasHeight);\r\n\t\tif(rt){\r\n\t\t\tctx._targets=rt;\r\n\t\t}else{\r\n\t\t\tctx.asBitmap=true;\r\n\t\t}\r\n\t\tif(ctx._targets){\r\n\t\t\tctx._targets.start();\r\n\t\t\tctx._targets.clear(0, 0, 0, 0);\t// 否则没有地方调用clear\r\n\t\t\tRenderSprite.renders[_renderType]._fun(sprite, ctx, offsetX, offsetY);\r\n\t\t\tctx.flush();\r\n\t\t\tctx._targets.end();\r\n\t\t\tctx._targets.restore();\r\n\t\t}\r\n\t\tif(!rt){\r\n        \tvar rtex: Texture = new Texture(((<Texture2D>(ctx._targets as any))), Texture.INV_UV);\r\n        \tctx.destroy(true);// 保留 _targets\r\n\t\t\treturn rtex;\r\n\t\t}\r\n\t\tsprite._repaint=0;\r\n\t\treturn rt;\r\n    }\r\n\r\n    /**\r\n     * <p>自定义更新、呈现显示对象。一般用来扩展渲染模式，请合理使用，可能会导致在加速器上无法渲染。</p>\r\n     * <p><b>注意</b>不要在此函数内增加或删除树节点，否则会对树节点遍历造成影响。</p>\r\n     * @param\tcontext  渲染的上下文引用。\r\n     * @param\tx X轴坐标。\r\n     * @param\ty Y轴坐标。\r\n     */\r\n    customRender(context: Context, x: number, y: number): void {\r\n        //_renderType |= SpriteConst.CUSTOM;\r\n        //_setRenderType(_renderType);\r\n        this._repaint = SpriteConst.REPAINT_ALL;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 应用滤镜。\r\n     */\r\n    _applyFilters(): void {\r\n        // canvas 模式不支持\r\n    }\r\n\r\n    /**滤镜集合。可以设置多个滤镜组合。*/\r\n    get filters(): any[] {\r\n        return this._cacheStyle.filters;\r\n    }\r\n\r\n    /**@internal */\r\n    _setColorFilter(value: any): void { }\r\n\r\n    set filters(value: any[]) {\r\n        value && value.length === 0 && (value = null);\r\n        if (this._cacheStyle.filters == value) return;\r\n        this._getCacheStyle().filters = value ? value.slice() : null;\r\n        if (value && value.length) {\r\n            //temp TODO \r\n            this._setColorFilter(value[0]);\r\n            this._renderType |= SpriteConst.FILTERS;\r\n        } else {\r\n            this._setColorFilter(null);\r\n            this._renderType &= ~SpriteConst.FILTERS;\r\n        }\r\n        this._setRenderType(this._renderType);\r\n\r\n        if (value && value.length > 0) {\r\n            if (!this._getBit(Const.DISPLAY)) this._setBitUp(Const.DISPLAY);\r\n            if (!(value.length == 1 && (value[0] instanceof ColorFilter))) {\r\n                this._getCacheStyle().cacheForFilters = true;\r\n                this._checkCanvasEnable();\r\n            }\r\n        } else {\r\n            if (this._cacheStyle.cacheForFilters) {\r\n                this._cacheStyle.cacheForFilters = false;\r\n                this._checkCanvasEnable();\r\n            }\r\n        }\r\n        this._getCacheStyle().hasGlowFilter = this._isHaveGlowFilter();\r\n        this.repaint();\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 查看当前原件中是否包含发光滤镜。\r\n     * @return 一个 Boolean 值，表示当前原件中是否包含发光滤镜。\r\n     */\r\n    _isHaveGlowFilter(): boolean {\r\n        var i: number, len: number;\r\n        if (this.filters) {\r\n            for (i = 0; i < this.filters.length; i++) {\r\n                if (this.filters[i].type == Filter.GLOW) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        for (i = 0, len = this._children.length; i < len; i++) {\r\n            if (this._children[i]._isHaveGlowFilter()) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 把本地坐标转换为相对stage的全局坐标。\r\n     * @param point\t\t\t\t本地坐标点。\r\n     * @param createNewPoint\t（可选）是否创建一个新的Point对象作为返回值，默认为false，使用输入的point对象返回，减少对象创建开销。\r\n     * @param globalNode\t\tglobal节点，默认为Laya.stage\r\n     * @return 转换后的坐标的点。\r\n     */\r\n    localToGlobal(point: Point, createNewPoint: boolean = false, globalNode: Sprite|null = null): Point {\r\n        //if (!_displayedInStage || !point) return point;\r\n        if (createNewPoint === true) {\r\n            point = new Point(point.x, point.y);\r\n        }\r\n        var ele: Sprite = this;\r\n        globalNode = globalNode || ILaya.stage;\r\n        while (ele && !ele.destroyed) {\r\n            if (ele == globalNode) break;\r\n            point = ele.toParentPoint(point);\r\n            ele = (<Sprite>ele.parent);\r\n        }\r\n\r\n        return point;\r\n    }\r\n\r\n    /**\r\n     * 把stage的全局坐标转换为本地坐标。\r\n     * @param point\t\t\t\t全局坐标点。\r\n     * @param createNewPoint\t（可选）是否创建一个新的Point对象作为返回值，默认为false，使用输入的point对象返回，减少对象创建开销。\r\n     * @param globalNode\t\tglobal节点，默认为Laya.stage\r\n     * @return 转换后的坐标的点。\r\n     */\r\n    globalToLocal(point: Point, createNewPoint: boolean = false, globalNode: Sprite|null = null): Point {\r\n        //if (!_displayedInStage || !point) return point;\r\n        if (createNewPoint) {\r\n            point = new Point(point.x, point.y);\r\n        }\r\n        var ele: Sprite = this;\r\n        var list: any[] = [];\r\n        globalNode = globalNode || ILaya.stage;\r\n        while (ele && !ele.destroyed) {\r\n            if (ele == globalNode) break;\r\n            list.push(ele);\r\n            ele = (<Sprite>ele.parent);\r\n        }\r\n        var i: number = list.length - 1;\r\n        while (i >= 0) {\r\n            ele = list[i];\r\n            point = ele.fromParentPoint(point);\r\n            i--;\r\n        }\r\n        return point;\r\n    }\r\n\r\n    /**\r\n     * 将本地坐标系坐标转转换到父容器坐标系。\r\n     * @param point 本地坐标点。\r\n     * @return  转换后的点。\r\n     */\r\n    toParentPoint(point: Point): Point {\r\n        if (!point) return point;\r\n        point.x -= this.pivotX;\r\n        point.y -= this.pivotY;\r\n        if (this.transform) {\r\n            this._transform.transformPoint(point);\r\n        }\r\n        point.x += this._x;\r\n        point.y += this._y;\r\n        var scroll: Rectangle = this._style.scrollRect;\r\n        if (scroll) {\r\n            point.x -= scroll.x;\r\n            point.y -= scroll.y;\r\n        }\r\n        return point;\r\n    }\r\n\r\n    /**\r\n     * 将父容器坐标系坐标转换到本地坐标系。\r\n     * @param point 父容器坐标点。\r\n     * @return  转换后的点。\r\n     */\r\n    fromParentPoint(point: Point): Point {\r\n        if (!point) return point;\r\n        point.x -= this._x;\r\n        point.y -= this._y;\r\n        var scroll: Rectangle = this._style.scrollRect;\r\n        if (scroll) {\r\n            point.x += scroll.x;\r\n            point.y += scroll.y;\r\n        }\r\n        if (this.transform) {\r\n            //_transform.setTranslate(0,0);\r\n            this._transform.invertTransformPoint(point);\r\n        }\r\n        point.x += this.pivotX;\r\n        point.y += this.pivotY;\r\n        return point;\r\n    }\r\n\r\n    /**\r\n     * 将Stage坐标系坐标转换到本地坐标系。\r\n     * @param point 父容器坐标点。\r\n     * @return  转换后的点。\r\n     */\r\n    fromStagePoint(point: Point): Point {\r\n        // TODO 没做\r\n        return point;\r\n    }\r\n\r\n    /**\r\n     * <p>增加事件侦听器，以使侦听器能够接收事件通知。</p>\r\n     * <p>如果侦听鼠标事件，则会自动设置自己和父亲节点的属性 mouseEnabled 的值为 true(如果父节点mouseEnabled=false，则停止设置父节点mouseEnabled属性)。</p>\r\n     * @param type\t\t事件的类型。\r\n     * @param caller\t事件侦听函数的执行域。\r\n     * @param listener\t事件侦听函数。\r\n     * @param args\t\t（可选）事件侦听函数的回调参数。\r\n     * @return 此 EventDispatcher 对象。\r\n     * @override\r\n     */\r\n    on(type: string, caller: any, listener: Function, args: any[] = null): EventDispatcher {\r\n        //如果是鼠标事件，则设置自己和父对象为可接受鼠标交互事件\r\n        if (this._mouseState !== 1 && this.isMouseEvent(type)) {\r\n            this.mouseEnabled = true;\r\n            this._setBit(Const.HAS_MOUSE, true);\r\n            if (this._parent) {\r\n                this._onDisplay();\r\n            }\r\n            return this._createListener(type, caller, listener, args, false);\r\n        }\r\n        return super.on(type, caller, listener, args);\r\n    }\r\n\r\n    /**\r\n     * <p>增加事件侦听器，以使侦听器能够接收事件通知，此侦听事件响应一次后则自动移除侦听。</p>\r\n     * <p>如果侦听鼠标事件，则会自动设置自己和父亲节点的属性 mouseEnabled 的值为 true(如果父节点mouseEnabled=false，则停止设置父节点mouseEnabled属性)。</p>\r\n     * @param type\t\t事件的类型。\r\n     * @param caller\t事件侦听函数的执行域。\r\n     * @param listener\t事件侦听函数。\r\n     * @param args\t\t（可选）事件侦听函数的回调参数。\r\n     * @return 此 EventDispatcher 对象。\r\n     * @override\r\n     */\r\n    once(type: string, caller: any, listener: Function, args: any[] = null): EventDispatcher {\r\n        //如果是鼠标事件，则设置自己和父对象为可接受鼠标交互事件\r\n        if (this._mouseState !== 1 && this.isMouseEvent(type)) {\r\n            this.mouseEnabled = true;\r\n            this._setBit(Const.HAS_MOUSE, true);\r\n            if (this._parent) {\r\n                this._onDisplay();\r\n            }\r\n            return this._createListener(type, caller, listener, args, true);\r\n        }\r\n        return super.once(type, caller, listener, args);\r\n    }\r\n\r\n    /** @private */\r\n    protected _onDisplay(v?: boolean): void {\r\n        if (this._mouseState !== 1) {\r\n            var ele: Sprite = this;\r\n            ele = (<Sprite>ele.parent);\r\n            while (ele && ele._mouseState !== 1) {\r\n                if (ele._getBit(Const.HAS_MOUSE)) break;\r\n                ele.mouseEnabled = true;\r\n                ele._setBit(Const.HAS_MOUSE, true);\r\n                ele = (<Sprite>ele.parent);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**@private \r\n     * @override\r\n    */\r\n    protected _setParent(value: Node): void {\r\n        super._setParent(value);\r\n        if (value && this._getBit(Const.HAS_MOUSE)) {\r\n            this._onDisplay();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * <p>加载并显示一个图片。相当于加载图片后，设置texture属性</p>\r\n     * <p>注意：2.0改动：多次调用，只会显示一个图片（1.0会显示多个图片）,x,y,width,height参数取消。</p>\r\n     * @param url\t\t图片地址。\r\n     * @param complete\t（可选）加载完成回调。\r\n     * @return\t返回精灵对象本身。\r\n     */\r\n    loadImage(url: string, complete: Handler = null): Sprite {\r\n        if (!url) {\r\n            this.texture = null;\r\n            loaded.call(this);\r\n        } else {\r\n            var tex: Texture = ILaya.Loader.textureMap[URL.formatURL(url)];\r\n            if (!tex) {\r\n                tex = new Texture();\r\n                tex.load(url);\r\n                ILaya.Loader.cacheTexture(url, tex);\r\n            }\r\n            this.texture = tex;\r\n            if (!tex.getIsReady()) tex.once(Event.READY, this, loaded);\r\n            else loaded.call(this);\r\n        }\r\n\r\n        function loaded(this:Sprite): void {\r\n            this.repaint(SpriteConst.REPAINT_ALL);\r\n            complete && complete.run();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 根据图片地址创建一个新的 <code>Sprite</code> 对象用于加载并显示此图片。\r\n     * @param\turl 图片地址。\r\n     * @return\t返回新的 <code>Sprite</code> 对象。\r\n     */\r\n    static fromImage(url: string): Sprite {\r\n        return new Sprite().loadImage(url);\r\n    }\r\n\r\n    /**cacheAs后，设置自己和父对象缓存失效。*/\r\n    repaint(type: number = SpriteConst.REPAINT_CACHE): void {\r\n        if (!(this._repaint & type)) {\r\n            this._repaint |= type;\r\n            this.parentRepaint(type);\r\n        }\r\n        if (this._cacheStyle && this._cacheStyle.maskParent) {\r\n            this._cacheStyle.maskParent.repaint(type);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * @internal\r\n     * 获取是否重新缓存。\r\n     * @return 如果重新缓存值为 true，否则值为 false。\r\n     */\r\n    _needRepaint(): boolean {\r\n        return (this._repaint & SpriteConst.REPAINT_CACHE) && this._cacheStyle.enableCanvasRender && this._cacheStyle.reCache;\r\n    }\r\n\r\n    /**@private\t\r\n     * @override\r\n    */\r\n    protected _childChanged(child: Node = null): void {\r\n        if (this._children.length) this._renderType |= SpriteConst.CHILDS;\r\n        else this._renderType &= ~SpriteConst.CHILDS;\r\n        this._setRenderType(this._renderType);\r\n        if (child && this._getBit(Const.HAS_ZORDER)) ILaya.systemTimer.callLater(this, this.updateZOrder);\r\n        this.repaint(SpriteConst.REPAINT_ALL);\r\n    }\r\n\r\n    /**cacheAs时，设置所有父对象缓存失效。 */\r\n    parentRepaint(type: number = SpriteConst.REPAINT_CACHE): void {\r\n        var p: Sprite = (<Sprite>this._parent);\r\n        if (p && !(p._repaint & type)) {\r\n            p._repaint |= type;\r\n            p.parentRepaint(type);\r\n        }\r\n    }\r\n\r\n    /**对舞台 <code>stage</code> 的引用。*/\r\n    get stage(): Stage {\r\n        return ILaya.stage;\r\n    }\r\n\r\n    /**\r\n     * <p>可以设置一个Rectangle区域作为点击区域，或者设置一个<code>HitArea</code>实例作为点击区域，HitArea内可以设置可点击和不可点击区域。</p>\r\n     * <p>如果不设置hitArea，则根据宽高形成的区域进行碰撞。</p>\r\n     */\r\n    get hitArea(): any {\r\n        return this._style.hitArea;\r\n    }\r\n\r\n    set hitArea(value: any) {\r\n        this.getStyle().hitArea = value;\r\n    }\r\n\r\n    /**@internal */\r\n    _setMask(value: Sprite): void {\r\n\r\n    }\r\n\r\n    /**\r\n     * <p>遮罩，可以设置一个对象(支持位图和矢量图)，根据对象形状进行遮罩显示。</p>\r\n     * <p>【注意】遮罩对象坐标系是相对遮罩对象本身的，和Flash机制不同</p>\r\n     */\r\n    get mask(): Sprite {\r\n        return this._cacheStyle.mask;\r\n    }\r\n\r\n    set mask(value: Sprite) {\r\n        if (value && this.mask && this.mask._cacheStyle.maskParent) return;\r\n        this._getCacheStyle().mask = value;\r\n        this._setMask(value);\r\n        this._checkCanvasEnable();\r\n        if (value) {\r\n            value._getCacheStyle().maskParent = this;\r\n        } else {\r\n            if (this.mask) {\r\n                this.mask._getCacheStyle().maskParent = null;\r\n            }\r\n        }\r\n        this._renderType |= SpriteConst.MASK;\r\n        this._setRenderType(this._renderType);\r\n        this.parentRepaint(SpriteConst.REPAINT_ALL);\r\n    }\r\n\r\n    /**\r\n     * 是否接受鼠标事件。\r\n     * 默认为false，如果监听鼠标事件，则会自动设置本对象及父节点的属性 mouseEnable 的值都为 true（如果父节点手动设置为false，则不会更改）。\r\n     * */\r\n    get mouseEnabled(): boolean {\r\n        return this._mouseState > 1;\r\n    }\r\n\r\n    set mouseEnabled(value: boolean) {\r\n        this._mouseState = value ? 2 : 1;\r\n    }\r\n\r\n    /**\r\n     * 开始拖动此对象。\r\n     * @param area\t\t\t\t（可选）拖动区域，此区域为当前对象注册点活动区域（不包括对象宽高），可选。\r\n     * @param hasInertia\t\t（可选）鼠标松开后，是否还惯性滑动，默认为false，可选。\r\n     * @param elasticDistance\t（可选）橡皮筋效果的距离值，0为无橡皮筋效果，默认为0，可选。\r\n     * @param elasticBackTime\t（可选）橡皮筋回弹时间，单位为毫秒，默认为300毫秒，可选。\r\n     * @param data\t\t\t\t（可选）拖动事件携带的数据，可选。\r\n     * @param disableMouseEvent\t（可选）禁用其他对象的鼠标检测，默认为false，设置为true能提高性能。\r\n     * @param ratio\t\t\t\t（可选）惯性阻尼系数，影响惯性力度和时长。\r\n     */\r\n    startDrag(area: Rectangle = null, hasInertia: boolean = false, elasticDistance: number = 0, elasticBackTime: number = 300, data: any = null, disableMouseEvent: boolean = false, ratio: number = 0.92): void {\r\n        this._style.dragging || (this.getStyle().dragging = new ILaya.Dragging());\r\n        this._style.dragging.start(this, area, hasInertia, elasticDistance, elasticBackTime, data, disableMouseEvent, ratio);\r\n    }\r\n\r\n    /**停止拖动此对象。*/\r\n    stopDrag(): void {\r\n        this._style.dragging && this._style.dragging.stop();\r\n    }\r\n\r\n    /**\r\n     * @internal \r\n     * @override\r\n    */\r\n    _setDisplay(value: boolean): void {\r\n        if (!value) {\r\n            if (this._cacheStyle) {\r\n                this._cacheStyle.releaseContext();\r\n                this._cacheStyle.releaseFilterCache();\r\n                if (this._cacheStyle.hasGlowFilter) {\r\n                    this._cacheStyle.hasGlowFilter = false;\r\n                }\r\n            }\r\n        }\r\n        super._setDisplay(value);\r\n    }\r\n\r\n    /**\r\n     * 检测某个点是否在此对象内。\r\n     * @param\tx 全局x坐标。\r\n     * @param\ty 全局y坐标。\r\n     * @return  表示是否在对象内。\r\n     */\r\n    hitTestPoint(x: number, y: number): boolean {\r\n        var point: Point = this.globalToLocal(Point.TEMP.setTo(x, y));\r\n        x = point.x;\r\n        y = point.y;\r\n        var rect: Rectangle = this._style.hitArea ? this._style.hitArea : (this._width > 0 && this._height > 0) ? Rectangle.TEMP.setTo(0, 0, this._width, this._height) : this.getSelfBounds();\r\n        return rect.contains(x, y);\r\n    }\r\n\r\n    /**获得相对于本对象上的鼠标坐标信息。*/\r\n    getMousePoint(): Point {\r\n        return this.globalToLocal(Point.TEMP.setTo(ILaya.stage.mouseX, ILaya.stage.mouseY));\r\n    }\r\n\r\n    /**\r\n     * 获得相对于stage的全局X轴缩放值（会叠加父亲节点的缩放值）。\r\n     */\r\n    get globalScaleX(): number {\r\n        var scale: number = 1;\r\n        var ele: Sprite = this;\r\n        while (ele) {\r\n            if (ele === ILaya.stage) break;\r\n            scale *= ele.scaleX;\r\n            ele = (<Sprite>ele.parent);\r\n        }\r\n        return scale;\r\n    }\r\n\r\n    /**\r\n     * 获得相对于stage的全局旋转值（会叠加父亲节点的旋转值）。\r\n     */\r\n    get globalRotation(): number {\r\n        var angle: number = 0;\r\n        var ele: Sprite = this;\r\n        while (ele) {\r\n            if (ele === ILaya.stage) break;\r\n            angle += ele.rotation;\r\n            ele = (<Sprite>ele.parent);\r\n        }\r\n        return angle;\r\n    }\r\n\r\n    /**\r\n     * 获得相对于stage的全局Y轴缩放值（会叠加父亲节点的缩放值）。\r\n     */\r\n    get globalScaleY(): number {\r\n        var scale: number = 1;\r\n        var ele: Sprite = this;\r\n        while (ele) {\r\n            if (ele === ILaya.stage) break;\r\n            scale *= ele.scaleY;\r\n            ele = (<Sprite>ele.parent);\r\n        }\r\n        return scale;\r\n    }\r\n\r\n    /**\r\n     * 返回鼠标在此对象坐标系上的 X 轴坐标信息。\r\n     */\r\n    get mouseX(): number {\r\n        return this.getMousePoint().x;\r\n    }\r\n\r\n    /**\r\n     * 返回鼠标在此对象坐标系上的 Y 轴坐标信息。\r\n     */\r\n    get mouseY(): number {\r\n        return this.getMousePoint().y;\r\n    }\r\n\r\n    /**z排序，更改此值，则会按照值的大小对同一容器的所有对象重新排序。值越大，越靠上。默认为0，则根据添加顺序排序。*/\r\n    get zOrder(): number {\r\n        return this._zOrder;\r\n    }\r\n\r\n    set zOrder(value: number) {\r\n        if (this._zOrder != value) {\r\n            this._zOrder = value;\r\n            if (this._parent) {\r\n                value && this._parent._setBit(Const.HAS_ZORDER, true);\r\n                ILaya.systemTimer.callLater(this._parent, this.updateZOrder);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置一个Texture实例，并显示此图片（如果之前有其他绘制，则会被清除掉）。\r\n     * 等同于graphics.clear();graphics.drawImage()，但性能更高\r\n     * 还可以赋值一个图片地址，则会自动加载图片，然后显示\r\n     */\r\n    get texture(): Texture {\r\n        return this._texture;\r\n    }\r\n\r\n    /**@internal */\r\n    _setTexture(value: Texture | string): void {\r\n\r\n    }\r\n\r\n    set texture(value: Texture) {\r\n        if (typeof (value) == 'string') {\r\n            this.loadImage((<string>((<any>value))));\r\n        } else if (this._texture != value) {\r\n            this._texture && this._texture._removeReference();\r\n            this._texture = value;\r\n            value && value._addReference();\r\n            this._setTexture(value);\r\n            this._setWidth(this._texture, this.width);\r\n            this._setHeight(this._texture, this.height);\r\n            if (value) this._renderType |= SpriteConst.TEXTURE;\r\n            else this._renderType &= ~SpriteConst.TEXTURE;\r\n            this._setRenderType(this._renderType);\r\n            this.repaint();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * <p>视口大小，视口外的子对象，将不被渲染(如果想实现裁剪效果，请使用srollRect)，合理使用能提高渲染性能。比如由一个个小图片拼成的地图块，viewport外面的小图片将不渲染</p>\r\n     * <p>srollRect和viewport的区别：<br/>\r\n     * 1. srollRect自带裁剪效果，viewport只影响子对象渲染是否渲染，不具有裁剪效果（性能更高）。<br/>\r\n     * 2. 设置rect的x,y属性均能实现区域滚动效果，但scrollRect会保持0,0点位置不变。</p>\r\n     * @default null\r\n     */\r\n    get viewport(): Rectangle {\r\n        return this._style.viewport;\r\n    }\r\n\r\n    set viewport(value: Rectangle) {\r\n        if (typeof (value) == 'string') {\r\n            var recArr: any[];\r\n            recArr = ((<string>((<any>value)))).split(\",\");\r\n            if (recArr.length > 3) {\r\n                value = new Rectangle(parseFloat(recArr[0]), parseFloat(recArr[1]), parseFloat(recArr[2]), parseFloat(recArr[3]));\r\n            }\r\n        }\r\n        this.getStyle().viewport = value;\r\n    }\r\n\r\n    /**@internal */\r\n    _setRenderType(type: number): void {\r\n\r\n    }\r\n\r\n    /**@internal */\r\n    _setTranformChange(): void {\r\n        this._tfChanged = true;\r\n        this._renderType |= SpriteConst.TRANSFORM;\r\n        this.parentRepaint(SpriteConst.REPAINT_CACHE);\r\n    }\r\n\r\n    /**@internal */\r\n    _setBgStyleColor(x: number, y: number, width: number, height: number, fillColor: any): void {\r\n\r\n    }\r\n\r\n    /**@internal */\r\n    _setBorderStyleColor(x: number, y: number, width: number, height: number, fillColor: any, borderWidth: number): void {\r\n\r\n    }\r\n\r\n    /**@private */\r\n    captureMouseEvent(exclusive: boolean): void {\r\n        ILaya.MouseManager.instance.setCapture(this, exclusive);\r\n    }\r\n\r\n    /**@private */\r\n    releaseMouseEvent(): void {\r\n        ILaya.MouseManager.instance.releaseCapture();\r\n    }\r\n\r\n    set drawCallOptimize(value: boolean) {\r\n        this._setBit(Const.DRAWCALL_OPTIMIZE, value);\r\n    }\r\n\r\n    get drawCallOptimize(): boolean {\r\n        return this._getBit(Const.DRAWCALL_OPTIMIZE);\r\n    }\r\n}\r\n\r\n\r\nClassUtils.regClass(\"laya.display.Sprite\", Sprite);\r\nClassUtils.regClass(\"Laya.Sprite\", Sprite);","import { SpriteStyle } from \"./SpriteStyle\";\r\nimport { BitmapFont } from \"../BitmapFont\"\r\nimport { Sprite } from \"../Sprite\"\r\nimport { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 文本的样式类\r\n */\r\nexport class TextStyle extends SpriteStyle {\r\n    /**\r\n    * 一个已初始化的 <code>TextStyle</code> 实例。\r\n    */\r\n    static EMPTY: TextStyle = new TextStyle();\r\n    /**\r\n     * 表示使用此文本格式的文本是否为斜体。\r\n     * @default false\r\n     */\r\n    italic: boolean = false;\r\n    /**\r\n     * <p>表示使用此文本格式的文本段落的水平对齐方式。</p>\r\n     * @default  \"left\"\r\n     */\r\n    align: string;\r\n    /**\r\n     * <p>表示使用此文本格式的文本字段是否自动换行。</p>\r\n     * 如果 wordWrap 的值为 true，则该文本字段自动换行；如果值为 false，则该文本字段不自动换行。\r\n     * @default false。\r\n     */\r\n    wordWrap: boolean;\r\n    /**\r\n     * <p>垂直行间距（以像素为单位）</p>\r\n     */\r\n    leading: number;\r\n    /**\r\n     * <p>默认边距信息</p>\r\n     * <p>[左边距，上边距，右边距，下边距]（边距以像素为单位）</p>\r\n     */\r\n    padding: any[];\r\n    /**\r\n     * 文本背景颜色，以字符串表示。\r\n     */\r\n    bgColor: string|null;\r\n    /**\r\n     * 文本边框背景颜色，以字符串表示。\r\n     */\r\n    borderColor: string|null;\r\n    /**\r\n     * <p>指定文本字段是否是密码文本字段。</p>\r\n     * 如果此属性的值为 true，则文本字段被视为密码文本字段，并使用星号而不是实际字符来隐藏输入的字符。如果为 false，则不会将文本字段视为密码文本字段。\r\n     */\r\n    asPassword: boolean;\r\n    /**\r\n     * <p>描边宽度（以像素为单位）。</p>\r\n     * 默认值0，表示不描边。\r\n     * @default 0\r\n     */\r\n    stroke: number;\r\n    /**\r\n     * <p>描边颜色，以字符串表示。</p>\r\n     * @default \"#000000\";\r\n     */\r\n    strokeColor: string;\r\n    /**是否为粗体*/\r\n    bold: boolean;\r\n    /**是否显示下划线*/\r\n    underline: boolean;\r\n    /**下划线颜色*/\r\n    underlineColor: string|null;\r\n    /**当前使用的位置字体。*/\r\n    currBitmapFont: BitmapFont|null;\r\n    /**\r\n     * @override\r\n     */\r\n    reset(): SpriteStyle {\r\n        super.reset();\r\n        this.italic = false;\r\n        this.align = \"left\";\r\n        this.wordWrap = false;\r\n        this.leading = 0;\r\n        this.padding = [0, 0, 0, 0];\r\n        this.bgColor = null;\r\n        this.borderColor = null;\r\n        this.asPassword = false;\r\n        this.stroke = 0;\r\n        this.strokeColor = \"#000000\";\r\n        this.bold = false;\r\n        this.underline = false;\r\n        this.underlineColor = null;\r\n        this.currBitmapFont = null;\r\n        return this;\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    recover(): void {\r\n        if (this === TextStyle.EMPTY)\r\n            return;\r\n        Pool.recover(\"TextStyle\", this.reset());\r\n    }\r\n\r\n    /**\r\n     * 从对象池中创建\r\n     */\r\n    static create(): TextStyle {\r\n        return Pool.getItemByClass(\"TextStyle\", TextStyle);\r\n    }\r\n\r\n    /**@inheritDoc\t */\r\n    render(sprite: Sprite, context: Context, x: number, y: number): void {\r\n        (this.bgColor || this.borderColor) && context.drawRect(x, y, sprite.width, sprite.height, this.bgColor, this.borderColor, 1);\r\n    }\r\n}\r\n\r\n","import { Sprite } from \"./Sprite\";\r\nimport { BitmapFont } from \"./BitmapFont\";\r\nimport { SpriteConst } from \"./SpriteConst\";\r\nimport { Graphics } from \"./Graphics\";\r\nimport { SpriteStyle } from \"./css/SpriteStyle\"\r\nimport { TextStyle } from \"./css/TextStyle\"\r\nimport { Event } from \"../events/Event\"\r\nimport { Point } from \"../maths/Point\"\r\nimport { Rectangle } from \"../maths/Rectangle\"\r\nimport { WordText } from \"../utils/WordText\"\r\nimport { Timer } from \"../utils/Timer\";\r\nimport { ILaya } from \"../../ILaya\";\r\nimport { ClassUtils } from \"../utils/ClassUtils\";\r\n\r\n/**\r\n * 文本内容发生改变后调度。\r\n * @eventType Event.CHANGE\r\n */\r\n/*[Event(name = \"change\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * <p> <code>Text</code> 类用于创建显示对象以显示文本。</p>\r\n * <p>\r\n * 注意：如果运行时系统找不到设定的字体，则用系统默认的字体渲染文字，从而导致显示异常。(通常电脑上显示正常，在一些移动端因缺少设置的字体而显示异常)。\r\n * </p>\r\n * @example\r\n * package\r\n * {\r\n * \timport laya.display.Text;\r\n * \tpublic class Text_Example\r\n * \t{\r\n * \t\tpublic function Text_Example()\r\n * \t\t{\r\n * \t\t\tLaya.init(640, 800);//设置游戏画布宽高、渲染模式。\r\n * \t\t\tLaya.stage.bgColor = \"#efefef\";//设置画布的背景颜色。\r\n * \t\t\tonInit();\r\n * \t\t}\r\n * \t\tprivate function onInit():void\r\n * \t\t{\r\n * \t\t\tvar text:Text = new Text();//创建一个 Text 类的实例对象 text 。\r\n * \t\t\ttext.text = \"这个是一个 Text 文本示例。\";\r\n * \t\t\ttext.color = \"#008fff\";//设置 text 的文本颜色。\r\n * \t\t\ttext.font = \"Arial\";//设置 text 的文本字体。\r\n * \t\t\ttext.bold = true;//设置 text 的文本显示为粗体。\r\n * \t\t\ttext.fontSize = 30;//设置 text 的字体大小。\r\n * \t\t\ttext.wordWrap = true;//设置 text 的文本自动换行。\r\n * \t\t\ttext.x = 100;//设置 text 对象的属性 x 的值，用于控制 text 对象的显示位置。\r\n * \t\t\ttext.y = 100;//设置 text 对象的属性 y 的值，用于控制 text 对象的显示位置。\r\n * \t\t\ttext.width = 300;//设置 text 的宽度。\r\n * \t\t\ttext.height = 200;//设置 text 的高度。\r\n * \t\t\ttext.italic = true;//设置 text 的文本显示为斜体。\r\n * \t\t\ttext.borderColor = \"#fff000\";//设置 text 的文本边框颜色。\r\n * \t\t\tLaya.stage.addChild(text);//将 text 添加到显示列表。\r\n * \t\t}\r\n * \t}\r\n * }\r\n * @example\r\n * Text_Example();\r\n * function Text_Example()\r\n * {\r\n *     Laya.init(640, 800);//设置游戏画布宽高、渲染模式。\r\n *     Laya.stage.bgColor = \"#efefef\";//设置画布的背景颜色。\r\n *     onInit();\r\n * }\r\n * function onInit()\r\n * {\r\n *     var text = new laya.display.Text();//创建一个 Text 类的实例对象 text 。\r\n *     text.text = \"这个是一个 Text 文本示例。\";\r\n *     text.color = \"#008fff\";//设置 text 的文本颜色。\r\n *     text.font = \"Arial\";//设置 text 的文本字体。\r\n *     text.bold = true;//设置 text 的文本显示为粗体。\r\n *     text.fontSize = 30;//设置 text 的字体大小。\r\n *     text.wordWrap = true;//设置 text 的文本自动换行。\r\n *     text.x = 100;//设置 text 对象的属性 x 的值，用于控制 text 对象的显示位置。\r\n *     text.y = 100;//设置 text 对象的属性 y 的值，用于控制 text 对象的显示位置。\r\n *     text.width = 300;//设置 text 的宽度。\r\n *     text.height = 200;//设置 text 的高度。\r\n *     text.italic = true;//设置 text 的文本显示为斜体。\r\n *     text.borderColor = \"#fff000\";//设置 text 的文本边框颜色。\r\n *     Laya.stage.addChild(text);//将 text 添加到显示列表。\r\n * }\r\n * @example\r\n * class Text_Example {\r\n *     constructor() {\r\n *         Laya.init(640, 800);//设置游戏画布宽高、渲染模式。\r\n *         Laya.stage.bgColor = \"#efefef\";//设置画布的背景颜色。\r\n *         this.onInit();\r\n *     }\r\n *     private onInit(): void {\r\n *         var text: laya.display.Text = new laya.display.Text();//创建一个 Text 类的实例对象 text 。\r\n *         text.text = \"这个是一个 Text 文本示例。\";\r\n *         text.color = \"#008fff\";//设置 text 的文本颜色。\r\n *         text.font = \"Arial\";//设置 text 的文本字体。\r\n *         text.bold = true;//设置 text 的文本显示为粗体。\r\n *         text.fontSize = 30;//设置 text 的字体大小。\r\n *         text.wordWrap = true;//设置 text 的文本自动换行。\r\n *         text.x = 100;//设置 text 对象的属性 x 的值，用于控制 text 对象的显示位置。\r\n *         text.y = 100;//设置 text 对象的属性 y 的值，用于控制 text 对象的显示位置。\r\n *         text.width = 300;//设置 text 的宽度。\r\n *         text.height = 200;//设置 text 的高度。\r\n *         text.italic = true;//设置 text 的文本显示为斜体。\r\n *         text.borderColor = \"#fff000\";//设置 text 的文本边框颜色。\r\n *         Laya.stage.addChild(text);//将 text 添加到显示列表。\r\n *     }\r\n * }\r\n */\r\nexport class Text extends Sprite {\r\n\r\n    /**visible不进行任何裁切。*/\r\n    static VISIBLE: string = \"visible\";\r\n    /**scroll 不显示文本域外的字符像素，并且支持 scroll 接口。*/\r\n    static SCROLL: string = \"scroll\";\r\n    /**hidden 不显示超出文本域的字符。*/\r\n    static HIDDEN: string = \"hidden\";\r\n\r\n    /**默认文本大小，默认为12*/\r\n    static defaultFontSize: number = 12;\r\n    /**默认文本字体，默认为Arial*/\r\n    static defaultFont: string = \"Arial\";\r\n\r\n    /**@private */\r\n    static defaultFontStr(): string {\r\n        return Text.defaultFontSize + \"px \" + Text.defaultFont;\r\n    }\r\n    /**语言包，是一个包含key:value的集合，用key索引，替换为目标value语言*/\r\n    static langPacks: any;\r\n    /**WebGL下，文字会被拆分为单个字符进行渲染，一些语系不能拆开显示，比如阿拉伯文，这时可以设置isComplexText=true，禁用文字拆分。*/\r\n    static isComplexText: boolean = false;\r\n    /**在IOS下，一些字体会找不到，引擎提供了字体映射功能，比如默认会把 \"黑体\" 映射为 \"黑体-简\"，更多映射，可以自己添加*/\r\n    static fontFamilyMap: any = { \"报隶\": \"报隶-简\", \"黑体\": \"黑体-简\", \"楷体\": \"楷体-简\", \"兰亭黑\": \"兰亭黑-简\", \"隶变\": \"隶变-简\", \"凌慧体\": \"凌慧体-简\", \"翩翩体\": \"翩翩体-简\", \"苹方\": \"苹方-简\", \"手札体\": \"手札体-简\", \"宋体\": \"宋体-简\", \"娃娃体\": \"娃娃体-简\", \"魏碑\": \"魏碑-简\", \"行楷\": \"行楷-简\", \"雅痞\": \"雅痞-简\", \"圆体\": \"圆体-简\" };\r\n    /**@internal 预测长度的文字，用来提升计算效率，不同语言找一个最大的字符即可*/\r\n    static _testWord: string = \"游\";\r\n    /**@private 位图字体字典。*/\r\n    private static _bitmapFonts: any;\r\n    //TODO:\r\n    static CharacterCache: boolean = true;\r\n    /**是否是从右向左的显示顺序*/\r\n    static RightToLeft: boolean = false;\r\n\r\n    /**@private */\r\n    private _clipPoint: Point|null;\r\n    /**@private 表示文本内容字符串。*/\r\n    protected _text: string;\r\n    /**@private 表示文本内容是否发生改变。*/\r\n    protected _isChanged: boolean;\r\n    /**@private 表示文本的宽度，以像素为单位。*/\r\n    protected _textWidth: number = 0;\r\n    /**@private 表示文本的高度，以像素为单位。*/\r\n    protected _textHeight: number = 0;\r\n    /**@private 存储文字行数信息。*/\r\n    protected _lines: any[]|null = [];\r\n    /**@private 保存每行宽度*/\r\n    protected _lineWidths: number[]|null = [];\r\n    /**@private 文本的内容位置 X 轴信息。*/\r\n    protected _startX: number = 0;\r\n    /**@private 文本的内容位置X轴信息。 */\r\n    protected _startY: number = 0;\r\n    /**@private */\r\n    protected _words: WordText[]|null;\r\n    /**@private */\r\n    protected _charSize: any = {};\r\n    /**@private */\r\n    protected _valign: string = \"top\";\r\n    /**@internal */\r\n    _fontSize: number = Text.defaultFontSize;\r\n    /**@internal */\r\n    _font: string = Text.defaultFont;\r\n    /**@internal */\r\n    _color: string = \"#000000\";\r\n\r\n    /**@private */\r\n    private _singleCharRender: boolean = false;\t// 拆分渲染\r\n\r\n    /**\r\n     * <p>overflow 指定文本超出文本域后的行为。其值为\"hidden\"、\"visible\"和\"scroll\"之一。</p>\r\n     * <p>性能从高到低依次为：hidden > visible > scroll。</p>\r\n     */\r\n    overflow: string = Text.VISIBLE;\r\n\r\n    /**\r\n     * 创建一个新的 <code>Text</code> 实例。\r\n     */\r\n    constructor() {\r\n        super();\r\n        this._style = TextStyle.EMPTY;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 获取样式。\r\n     * @return  样式 Style 。\r\n     * @override\r\n     */\r\n    getStyle(): SpriteStyle {\r\n        this._style === TextStyle.EMPTY && (this._style = TextStyle.create());\r\n        return this._style;\r\n    }\r\n\r\n    protected _getTextStyle(): TextStyle {\r\n        if (this._style === TextStyle.EMPTY) {\r\n            this._style = TextStyle.create();\r\n        }\r\n        return (<TextStyle>this._style);\r\n    }\r\n\r\n    /**\r\n     * 注册位图字体。\r\n     * @param\tname\t\t位图字体的名称。\r\n     * @param\tbitmapFont\t位图字体文件。\r\n     */\r\n    static registerBitmapFont(name: string, bitmapFont: BitmapFont): void {\r\n        Text._bitmapFonts || (Text._bitmapFonts = {});\r\n        Text._bitmapFonts[name] = bitmapFont;\r\n    }\r\n\r\n    /**\r\n     * 移除注册的位图字体文件。\r\n     * @param\tname\t\t位图字体的名称。\r\n     * @param\tdestroy\t\t是否销毁指定的字体文件。\r\n     */\r\n    static unregisterBitmapFont(name: string, destroy: boolean = true): void {\r\n        if (Text._bitmapFonts && Text._bitmapFonts[name]) {\r\n            var tBitmapFont: BitmapFont = Text._bitmapFonts[name];\r\n            if (destroy) tBitmapFont.destroy();\r\n            delete Text._bitmapFonts[name];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc \r\n     * @override\r\n    */\r\n    destroy(destroyChild: boolean = true): void {\r\n        super.destroy(destroyChild);\r\n        this._clipPoint = null;\r\n        this._lines = null;\r\n        this._lineWidths = null;\r\n\r\n        // 注意_words是一个数组（例如有换行）\r\n        this._words && this._words.forEach(function (w: WordText): void {\r\n            w.cleanCache();\r\n        });\r\n        this._words = null;\r\n\r\n        this._charSize = null;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    _getBoundPointsM(ifRotate: boolean = false): any[] {\r\n        var rec: Rectangle = Rectangle.TEMP;\r\n        rec.setTo(0, 0, this.width, this.height);\r\n        return rec._getBoundPoints();\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    getGraphicBounds(realSize: boolean = false): Rectangle {\r\n        var rec: Rectangle = Rectangle.TEMP;\r\n        rec.setTo(0, 0, this.width, this.height);\r\n        return rec;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    get width(): number {\r\n        if (this._width) return this._width;\r\n        return this.textWidth + this.padding[1] + this.padding[3];\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    set width(value: number) {\r\n        if (value != this._width) {\r\n            super.set_width(value);\r\n            this.isChanged = true;\r\n            if (this.borderColor) {\r\n                this._setBorderStyleColor(0, 0, this.width, this.height, this.borderColor, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _getCSSStyle(): TextStyle {\r\n        return (<TextStyle>this._style);\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    get height(): number {\r\n        if (this._height) return this._height;\r\n        return this.textHeight;\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    set height(value: number) {\r\n        if (value != this._height) {\r\n            super.set_height(value);\r\n            this.isChanged = true;\r\n            if (this.borderColor) {\r\n                this._setBorderStyleColor(0, 0, this.width, this.height, this.borderColor, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 表示文本的宽度，以像素为单位。\r\n     */\r\n    get textWidth(): number {\r\n        this._isChanged && ILaya.systemTimer.runCallLater(this, this.typeset);\r\n        return this._textWidth;\r\n    }\r\n\r\n    /**\r\n     * 表示文本的高度，以像素为单位。\r\n     */\r\n    get textHeight(): number {\r\n        this._isChanged && ILaya.systemTimer.runCallLater(this, this.typeset);\r\n        return this._textHeight;\r\n    }\r\n\r\n    /** 当前文本的内容字符串。*/\r\n    get text(): string {\r\n        return this._text || \"\";\r\n    }\r\n\r\n    // 为了转ts。ts不支持super.get set\r\n    get_text(): string {\r\n        return this._text || \"\";\r\n    }\r\n    set_text(value: string): void {\r\n        if (this._text !== value) {\r\n            this.lang(value + \"\");\r\n            this.isChanged = true;\r\n            this.event(Event.CHANGE);\r\n            if (this.borderColor) {\r\n                this._setBorderStyleColor(0, 0, this.width, this.height, this.borderColor, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    set text(value: string) {\r\n        this.set_text(value);\r\n    }\r\n\r\n    /**\r\n     * <p>根据指定的文本，从语言包中取当前语言的文本内容。并对此文本中的{i}文本进行替换。</p>\r\n     * <p>设置Text.langPacks语言包后，即可使用lang获取里面的语言</p>\r\n     * <p>例如：\r\n     * <li>（1）text 的值为“我的名字”，先取到这个文本对应的当前语言版本里的值“My name”，将“My name”设置为当前文本的内容。</li>\r\n     * <li>（2）text 的值为“恭喜你赢得{0}个钻石，{1}经验。”，arg1 的值为100，arg2 的值为200。\r\n     * \t\t\t则先取到这个文本对应的当前语言版本里的值“Congratulations on your winning {0} diamonds, {1} experience.”，\r\n     * \t\t\t然后将文本里的{0}、{1}，依据括号里的数字从0开始替换为 arg1、arg2 的值。\r\n     * \t\t\t将替换处理后的文本“Congratulations on your winning 100 diamonds, 200 experience.”设置为当前文本的内容。\r\n     * </li>\r\n     * </p>\r\n     * @param\ttext 文本内容。\r\n     * @param\t...args 文本替换参数。\r\n     */\r\n    lang(text: string, arg1: any = null, arg2: any = null, arg3: any = null, arg4: any = null, arg5: any = null, arg6: any = null, arg7: any = null, arg8: any = null, arg9: any = null, arg10: any = null): void {\r\n        text = Text.langPacks && Text.langPacks[text] ? Text.langPacks[text] : text;\r\n        if (arguments.length < 2) {\r\n            this._text = text;\r\n        } else {\r\n            for (var i: number = 0, n: number = arguments.length; i < n; i++) {\r\n                text = text.replace(\"{\" + i + \"}\", arguments[i + 1]);\r\n            }\r\n            this._text = text;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * <p>文本的字体名称，以字符串形式表示。</p>\r\n     * <p>默认值为：\"Arial\"，可以通过Text.defaultFont设置默认字体。</p>\r\n     * <p>如果运行时系统找不到设定的字体，则用系统默认的字体渲染文字，从而导致显示异常。(通常电脑上显示正常，在一些移动端因缺少设置的字体而显示异常)。</p>\r\n     * @see laya.display.Text#defaultFont\r\n     */\r\n    get font(): string {\r\n        return this._font;\r\n    }\r\n\r\n    set font(value: string) {\r\n        if (((<TextStyle>this._style)).currBitmapFont) {\r\n            this._getTextStyle().currBitmapFont = null;\r\n            this.scale(1, 1);\r\n        }\r\n        if (Text._bitmapFonts && Text._bitmapFonts[value]) {\r\n            this._getTextStyle().currBitmapFont = Text._bitmapFonts[value];\r\n        }\r\n\r\n        this._font = value;\r\n        this.isChanged = true;\r\n    }\r\n\r\n    /**\r\n     * <p>指定文本的字体大小（以像素为单位）。</p>\r\n     * <p>默认为20像素，可以通过 <code>Text.defaultFontSize</code> 设置默认大小。</p>\r\n     */\r\n    get fontSize(): number {\r\n        return this._fontSize;\r\n    }\r\n\r\n    set fontSize(value: number) {\r\n        if (this._fontSize != value) {\r\n            this._fontSize = value;\r\n            this.isChanged = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * <p>指定文本是否为粗体字。</p>\r\n     * <p>默认值为 false，这意味着不使用粗体字。如果值为 true，则文本为粗体字。</p>\r\n     */\r\n    get bold(): boolean {\r\n        return ((<TextStyle>this._style)).bold;\r\n    }\r\n\r\n    set bold(value: boolean) {\r\n        this._getTextStyle().bold = value;\r\n        this.isChanged = true;\r\n    }\r\n\r\n    /**\r\n     * <p>表示文本的颜色值。可以通过 <code>Text.defaultColor</code> 设置默认颜色。</p>\r\n     * <p>默认值为黑色。</p>\r\n     */\r\n    get color(): string {\r\n        return this._color;\r\n    }\r\n\r\n    set color(value: string) {\r\n        this.set_color(value);\r\n    }\r\n\r\n    // for转ts。 ts不支持 super.get/set\r\n    get_color(): string {\r\n        return this._color;\r\n    }\r\n    set_color(value: string): void {\r\n        if (this._color != value) {\r\n            this._color = value;\r\n            //如果仅仅更新颜色，无需重新排版\r\n            if (!this._isChanged && this._graphics) {\r\n                this._graphics.replaceTextColor(this.color)\r\n            } else {\r\n                this.isChanged = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * <p>表示使用此文本格式的文本是否为斜体。</p>\r\n     * <p>默认值为 false，这意味着不使用斜体。如果值为 true，则文本为斜体。</p>\r\n     */\r\n    get italic(): boolean {\r\n        return ((<TextStyle>this._style)).italic;\r\n    }\r\n\r\n    set italic(value: boolean) {\r\n        this._getTextStyle().italic = value;\r\n        this.isChanged = true;\r\n    }\r\n\r\n    /**\r\n     * <p>表示文本的水平显示方式。</p>\r\n     * <p><b>取值：</b>\r\n     * <li>\"left\"： 居左对齐显示。</li>\r\n     * <li>\"center\"： 居中对齐显示。</li>\r\n     * <li>\"right\"： 居右对齐显示。</li>\r\n     * </p>\r\n     */\r\n    get align(): string {\r\n        return ((<TextStyle>this._style)).align;\r\n    }\r\n\r\n    set align(value: string) {\r\n        this._getTextStyle().align = value;\r\n        this.isChanged = true;\r\n    }\r\n\r\n    /**\r\n     * <p>表示文本的垂直显示方式。</p>\r\n     * <p><b>取值：</b>\r\n     * <li>\"top\"： 居顶部对齐显示。</li>\r\n     * <li>\"middle\"： 居中对齐显示。</li>\r\n     * <li>\"bottom\"： 居底部对齐显示。</li>\r\n     * </p>\r\n     */\r\n    get valign(): string {\r\n        return this._valign;\r\n    }\r\n\r\n    set valign(value: string) {\r\n        this._valign = value;\r\n        this.isChanged = true;\r\n    }\r\n\r\n    /**\r\n     * <p>表示文本是否自动换行，默认为false。</p>\r\n     * <p>若值为true，则自动换行；否则不自动换行。</p>\r\n     */\r\n    get wordWrap(): boolean {\r\n        return ((<TextStyle>this._style)).wordWrap;\r\n    }\r\n\r\n    set wordWrap(value: boolean) {\r\n        this._getTextStyle().wordWrap = value;\r\n        this.isChanged = true;\r\n    }\r\n\r\n    /**\r\n     * 垂直行间距（以像素为单位）。\r\n     */\r\n    get leading(): number {\r\n        return ((<TextStyle>this._style)).leading;\r\n    }\r\n\r\n    set leading(value: number) {\r\n        this._getTextStyle().leading = value;\r\n        this.isChanged = true;\r\n    }\r\n\r\n    /**\r\n     * <p>边距信息。</p>\r\n     * <p>数据格式：[上边距，右边距，下边距，左边距]（边距以像素为单位）。</p>\r\n     */\r\n    get padding(): any[] {\r\n        return ((<TextStyle>this._style)).padding;\r\n    }\r\n\r\n    set padding(value: any[]) {\r\n        if (typeof (value) == 'string') {\r\n            var arr: any[];\r\n            arr = ((<string>(value as any))).split(\",\");\r\n            var i: number, len: number;\r\n            len = arr.length;\r\n            while (arr.length < 4) {\r\n                arr.push(0);\r\n            }\r\n            for (i = 0; i < len; i++) {\r\n                arr[i] = parseFloat(arr[i]) || 0;\r\n            }\r\n            value = arr;\r\n        }\r\n        this._getTextStyle().padding = value;\r\n        this.isChanged = true;\r\n    }\r\n\r\n    /**\r\n     * 文本背景颜色，以字符串表示。\r\n     */\r\n    get bgColor(): string {\r\n        return ((<TextStyle>this._style)).bgColor;\r\n    }\r\n\r\n    set bgColor(value: string) {\r\n        this.set_bgColor(value);\r\n    }\r\n\r\n    // fot ts\r\n    set_bgColor(value: string): void {\r\n        this._getTextStyle().bgColor = value;\r\n        this._renderType |= SpriteConst.STYLE;\r\n        this._setBgStyleColor(0, 0, this.width, this.height, value);\r\n        this._setRenderType(this._renderType);\r\n        this.isChanged = true;\r\n    }\r\n    get_bgColor(): string {\r\n        return ((<TextStyle>this._style)).bgColor;\r\n    }\r\n\r\n    /**\r\n     * 文本边框背景颜色，以字符串表示。\r\n     */\r\n    get borderColor(): string {\r\n        return ((<TextStyle>this._style)).borderColor;\r\n    }\r\n\r\n    set borderColor(value: string) {\r\n        this._getTextStyle().borderColor = value;\r\n        this._renderType |= SpriteConst.STYLE;\r\n        this._setBorderStyleColor(0, 0, this.width, this.height, value, 1);\r\n        this._setRenderType(this._renderType);\r\n        this.isChanged = true;\r\n    }\r\n\r\n    /**\r\n     * <p>描边宽度（以像素为单位）。</p>\r\n     * <p>默认值0，表示不描边。</p>\r\n     */\r\n    get stroke(): number {\r\n        return ((<TextStyle>this._style)).stroke;\r\n    }\r\n\r\n    set stroke(value: number) {\r\n        this._getTextStyle().stroke = value;\r\n        this.isChanged = true;\r\n    }\r\n\r\n    /**\r\n     * <p>描边颜色，以字符串表示。</p>\r\n     * <p>默认值为 \"#000000\"（黑色）;</p>\r\n     */\r\n    get strokeColor(): string {\r\n        return ((<TextStyle>this._style)).strokeColor;\r\n    }\r\n\r\n    set strokeColor(value: string) {\r\n        this._getTextStyle().strokeColor = value;\r\n        this.isChanged = true;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 一个布尔值，表示文本的属性是否有改变。若为true表示有改变。\r\n     */\r\n    protected set isChanged(value: boolean) {\r\n        if (this._isChanged !== value) {\r\n            this._isChanged = value;\r\n            value && ILaya.systemTimer.callLater(this, this.typeset);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    protected _getContextFont(): string {\r\n        return (this.italic ? \"italic \" : \"\") + (this.bold ? \"bold \" : \"\") + this.fontSize + \"px \" + (ILaya.Browser.onIPhone ? (Text.fontFamilyMap[this.font] || this.font) : this.font);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    protected _isPassWordMode(): boolean {\r\n        var style: TextStyle = (<TextStyle>this._style);\r\n        var password: boolean = style.asPassword;\r\n        if ((\"prompt\" in (this as any)) && this['prompt'] == this._text)\r\n            password = false;\r\n        return password;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    protected _getPassWordTxt(txt: string): string {\r\n        var len: number = txt.length;\r\n        var word: string;\r\n        word = \"\";\r\n        for (var j: number = len; j > 0; j--) {\r\n            word += \"●\";\r\n        }\r\n        return word;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 渲染文字。\r\n     * @param\tbegin 开始渲染的行索引。\r\n     * @param\tvisibleLineCount 渲染的行数。\r\n     */\r\n    protected _renderText(): void {\r\n        var padding: any[] = this.padding;\r\n        var visibleLineCount: number = this._lines.length;\r\n        // overflow为scroll或visible时会截行\r\n        if (this.overflow != Text.VISIBLE) {\r\n            visibleLineCount = Math.min(visibleLineCount, Math.floor((this.height - padding[0] - padding[2]) / (this.leading + this._charSize.height)) + 1);\r\n        }\r\n\r\n        var beginLine: number = this.scrollY / (this._charSize.height + this.leading) | 0;\r\n\r\n        var graphics: Graphics = this.graphics;\r\n        graphics.clear(true);\r\n\r\n        var ctxFont: string = this._getContextFont();\r\n        ILaya.Browser.context.font = ctxFont;\r\n\r\n        //处理垂直对齐\r\n        var startX: number = padding[3];\r\n        var textAlgin: string = \"left\";\r\n        var lines: any[] = this._lines;\r\n        var lineHeight: number = this.leading + this._charSize.height;\r\n        var tCurrBitmapFont: BitmapFont = ((<TextStyle>this._style)).currBitmapFont;\r\n        if (tCurrBitmapFont) {\r\n            lineHeight = this.leading + tCurrBitmapFont.getMaxHeight();\r\n        }\r\n        var startY: number = padding[0];\r\n\r\n        //处理水平对齐\r\n        if ((!tCurrBitmapFont) && this._width > 0 && this._textWidth <= this._width) {\r\n            if (this.align == \"right\") {\r\n                textAlgin = \"right\";\r\n                startX = this._width - padding[1];\r\n            } else if (this.align == \"center\") {\r\n                textAlgin = \"center\";\r\n                startX = this._width * 0.5 + padding[3] - padding[1];\r\n            }\r\n        }\r\n\r\n        if (this._height > 0) {\r\n            var tempVAlign: string = (this._textHeight > this._height) ? \"top\" : this.valign;\r\n            if (tempVAlign === \"middle\")\r\n                startY = (this._height - visibleLineCount * lineHeight) * 0.5 + padding[0] - padding[2];\r\n            else if (tempVAlign === \"bottom\")\r\n                startY = this._height - visibleLineCount * lineHeight - padding[2];\r\n        }\r\n\r\n        var style: TextStyle = (<TextStyle>this._style);\r\n        //drawBg(style);\r\n        if (tCurrBitmapFont && tCurrBitmapFont.autoScaleSize) {\r\n            var bitmapScale: number = tCurrBitmapFont.fontSize / this.fontSize;\r\n        }\r\n\r\n        //渲染\r\n        if (this._clipPoint) {\r\n            graphics.save();\r\n            if (tCurrBitmapFont && tCurrBitmapFont.autoScaleSize) {\r\n                var tClipWidth: number;\r\n                var tClipHeight: number;\r\n\r\n                this._width ? tClipWidth = (this._width - padding[3] - padding[1]) : tClipWidth = this._textWidth;\r\n                this._height ? tClipHeight = (this._height - padding[0] - padding[2]) : tClipHeight = this._textHeight;\r\n\r\n                tClipWidth *= bitmapScale;\r\n                tClipHeight *= bitmapScale;\r\n\r\n                graphics.clipRect(padding[3], padding[0], tClipWidth, tClipHeight);\r\n            } else {\r\n                graphics.clipRect(padding[3], padding[0], this._width ? (this._width - padding[3] - padding[1]) : this._textWidth, this._height ? (this._height - padding[0] - padding[2]) : this._textHeight);\r\n            }\r\n            this.repaint();\r\n        }\r\n\r\n        var password: boolean = style.asPassword;\r\n        // 输入框的prompt始终显示明文\r\n        if ((\"prompt\" in (this as any)) && this['prompt'] == this._text)\r\n            password = false;\r\n\r\n        var x: number = 0, y: number = 0;\r\n        var end: number = Math.min(this._lines.length, visibleLineCount + beginLine) || 1;\r\n        for (var i: number = beginLine; i < end; i++) {\r\n            var word: string = lines[i];\r\n            var _word: any;\r\n            if (password) {\r\n                var len: number = word.length;\r\n                word = \"\";\r\n                for (var j: number = len; j > 0; j--) {\r\n                    word += \"●\";\r\n                }\r\n            }\r\n\r\n            if (word == null) word = \"\";\r\n            x = startX - (this._clipPoint ? this._clipPoint.x : 0);\r\n            y = startY + lineHeight * i - (this._clipPoint ? this._clipPoint.y : 0);\r\n\r\n            this.underline && this._drawUnderline(textAlgin, x, y, i);\r\n\r\n            if (tCurrBitmapFont) {\r\n                var tWidth: number = this.width;\r\n                if (tCurrBitmapFont.autoScaleSize) {\r\n                    tWidth = this.width * bitmapScale;\r\n                }\r\n                tCurrBitmapFont._drawText(word, this, x, y, this.align, tWidth);\r\n            } else {\r\n                this._words || (this._words = []);\r\n                if (this._words.length > (i - beginLine)) {\r\n                    _word = this._words[i - beginLine];\r\n                } else {\r\n                    _word = new WordText();\r\n                    this._words.push(_word);\r\n                }\r\n                _word.setText(word);\r\n                ((<WordText>_word)).splitRender = this._singleCharRender;\r\n                style.stroke ? graphics.fillBorderText(_word, x, y, ctxFont, this.color, textAlgin, style.stroke, style.strokeColor) : graphics.fillText(_word, x, y, ctxFont, this.color, textAlgin);\r\n            }\r\n        }\r\n        if (tCurrBitmapFont && tCurrBitmapFont.autoScaleSize) {\r\n            var tScale: number = 1 / bitmapScale;\r\n            this.scale(tScale, tScale);\r\n        }\r\n\r\n        if (this._clipPoint) graphics.restore();\r\n\r\n        this._startX = startX;\r\n        this._startY = startY;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 绘制下划线\r\n     * @param\tx 本行坐标\r\n     * @param\ty 本行坐标\r\n     * @param\tlineIndex 本行索引\r\n     */\r\n    private _drawUnderline(align: string, x: number, y: number, lineIndex: number): void {\r\n        var lineWidth: number = this._lineWidths[lineIndex];\r\n        switch (align) {\r\n            case 'center':\r\n                x -= lineWidth / 2;\r\n                break;\r\n            case 'right':\r\n                x -= lineWidth;\r\n                break;\r\n            case 'left':\r\n            default:\r\n                break;\r\n        }\r\n\r\n        y += this._charSize.height;\r\n        this._graphics.drawLine(x, y, x + lineWidth, y, this.underlineColor || this.color, 1);\r\n    }\r\n\r\n    /**\r\n     * <p>排版文本。</p>\r\n     * <p>进行宽高计算，渲染、重绘文本。</p>\r\n     */\r\n    typeset(): void {\r\n        this._isChanged = false;\r\n\r\n        if (!this._text) {\r\n            this._clipPoint = null;\r\n            this._textWidth = this._textHeight = 0;\r\n            this.graphics.clear(true);\r\n            return;\r\n        }\r\n\r\n        if (ILaya.Render.isConchApp) {\r\n            (window as any).conchTextCanvas.font = this._getContextFont();;\r\n        } else {\r\n            ILaya.Browser.context.font = this._getContextFont();\r\n        }\r\n\r\n        this._lines.length = 0;\r\n        this._lineWidths.length = 0;\r\n        if (this._isPassWordMode())//如果是password显示状态应该使用密码符号计算\r\n        {\r\n            this._parseLines(this._getPassWordTxt(this._text));\r\n        } else\r\n            this._parseLines(this._text);\r\n\r\n        this._evalTextSize();\r\n        //启用Viewport\r\n        if (this._checkEnabledViewportOrNot()) this._clipPoint || (this._clipPoint = new Point(0, 0));\r\n        //否则禁用Viewport\r\n        else this._clipPoint = null;\r\n\r\n        this._renderText();\r\n    }\r\n\r\n    /**@private */\r\n    private _evalTextSize(): void {\r\n        var nw: number, nh: number;\r\n        nw = Math.max.apply(this, this._lineWidths);\r\n\r\n        //计算textHeight\r\n        if (((<TextStyle>this._style)).currBitmapFont)\r\n            nh = this._lines.length * (((<TextStyle>this._style)).currBitmapFont.getMaxHeight() + this.leading) + this.padding[0] + this.padding[2];\r\n        else{\r\n\t\t\tnh = this._lines.length * (this._charSize.height + this.leading) + this.padding[0] + this.padding[2];\r\n\t\t\tif(this._lines.length){\r\n\t\t\t\tnh-=this.leading; \t// 去掉最后一行的leading，否则多算了。\r\n\t\t\t}\r\n\t\t}\r\n        if (nw != this._textWidth || nh != this._textHeight) {\r\n            this._textWidth = nw;\r\n            this._textHeight = nh;\r\n            //TODO:\r\n            //if (!_width || !_height)\r\n            //conchModel && conchModel.size(_width || _textWidth, _height || _textHeight);\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    private _checkEnabledViewportOrNot(): boolean {\r\n        return this.overflow == Text.SCROLL && ((this._width > 0 && this._textWidth > this._width) || (this._height > 0 && this._textHeight > this._height)); // 设置了宽高并且超出了\r\n    }\r\n\r\n    /**\r\n     * <p>快速更改显示文本。不进行排版计算，效率较高。</p>\r\n     * <p>如果只更改文字内容，不更改文字样式，建议使用此接口，能提高效率。</p>\r\n     * @param text 文本内容。\r\n     */\r\n    changeText(text: string): void {\r\n        if (this._text !== text) {\r\n            this.lang(text + \"\");\r\n            if (this._graphics && this._graphics.replaceText(this._text)) {\r\n                //repaint();\r\n            } else {\r\n                this.typeset();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 分析文本换行。\r\n     */\r\n    protected _parseLines(text: string): void {\r\n        //自动换行和HIDDEN都需要计算换行位置或截断位置\r\n        var needWordWrapOrTruncate: boolean = this.wordWrap || this.overflow == Text.HIDDEN;\r\n        if (needWordWrapOrTruncate) {\r\n            var wordWrapWidth: number = this._getWordWrapWidth();\r\n        }\r\n\r\n        var bitmapFont: BitmapFont = ((<TextStyle>this._style)).currBitmapFont;\r\n        if (bitmapFont) {\r\n            this._charSize.width = bitmapFont.getMaxWidth();\r\n            this._charSize.height = bitmapFont.getMaxHeight();\r\n        } else {\r\n            var measureResult: any = null;\r\n            if (ILaya.Render.isConchApp) {\r\n                measureResult = (window as any).conchTextCanvas.measureText(Text._testWord);\r\n            } else {\r\n                measureResult = ILaya.Browser.context.measureText(Text._testWord);\r\n            }\r\n            if (!measureResult) measureResult = { width: 100 };\r\n            this._charSize.width = measureResult.width;\r\n            this._charSize.height = (measureResult.height || this.fontSize);\r\n        }\r\n\r\n        var lines: any[] = text.replace(/\\r\\n/g, \"\\n\").split(\"\\n\");\r\n        for (var i: number = 0, n: number = lines.length; i < n; i++) {\r\n            var line: string = lines[i];\r\n            // 开启了自动换行需要计算换行位置\r\n            // overflow为hidden需要计算截断位置\r\n            if (needWordWrapOrTruncate)\r\n                this._parseLine(line, wordWrapWidth);\r\n            else {\r\n                this._lineWidths.push(this._getTextWidth(line));\r\n                this._lines.push(line);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 解析行文本。\r\n     * @param\tline 某行的文本。\r\n     * @param\twordWrapWidth 文本的显示宽度。\r\n     */\r\n    protected _parseLine(line: string, wordWrapWidth: number): void {\r\n        var lines: any[] = this._lines;\r\n\r\n        var maybeIndex: number = 0;\r\n        var charsWidth: number = 0;\r\n        var wordWidth: number = 0;\r\n        var startIndex: number = 0;\r\n\r\n        charsWidth = this._getTextWidth(line);\r\n        //优化1，如果一行小于宽度，则直接跳过遍历\r\n        if (charsWidth <= wordWrapWidth) {\r\n            lines.push(line);\r\n            this._lineWidths.push(charsWidth);\r\n            return;\r\n        }\r\n\r\n        charsWidth = this._charSize.width;\r\n        //优化2，预算第几个字符会超出，减少遍历及字符宽度度量\r\n        maybeIndex = Math.floor(wordWrapWidth / charsWidth);\r\n        (maybeIndex == 0) && (maybeIndex = 1);\r\n        charsWidth = this._getTextWidth(line.substring(0, maybeIndex));\r\n        wordWidth = charsWidth;\r\n        for (var j: number = maybeIndex, m: number = line.length; j < m; j++) {\r\n            // 逐字符测量后加入到总宽度中，在某些情况下自动换行不准确。\r\n            // 目前已知在全是字符1的自动换行就会出现这种情况。\r\n            // 考虑性能，保留这种非方式。\r\n            charsWidth = this._getTextWidth(line.charAt(j));\r\n            wordWidth += charsWidth;\r\n            if (wordWidth > wordWrapWidth) {\r\n                if (this.wordWrap) {\r\n                    //截断换行单词\r\n                    var newLine: string = line.substring(startIndex, j);\r\n                    if (newLine.charCodeAt(newLine.length - 1) < 255) {\r\n                        //按照英文单词字边界截取 因此将会无视中文\r\n                        var execResult = /(?:\\w|-)+$/.exec(newLine);\r\n                        if (execResult) {\r\n                            j = execResult.index + startIndex;\r\n                            //此行只够容纳这一个单词 强制换行\r\n                            if (execResult.index == 0) j += newLine.length;\r\n                            //此行有多个单词 按单词分行\r\n                            else newLine = line.substring(startIndex, j);\r\n                        }\r\n                    }\r\n\r\n                    //如果自动换行，则另起一行\r\n                    lines.push(newLine);\r\n                    this._lineWidths.push(wordWidth - charsWidth);\r\n                    //如果非自动换行，则只截取字符串\r\n\r\n                    startIndex = j;\r\n                    if (j + maybeIndex < m) {\r\n                        j += maybeIndex;\r\n\r\n                        charsWidth = this._getTextWidth(line.substring(startIndex, j));\r\n                        wordWidth = charsWidth;\r\n                        j--;\r\n                    } else {\r\n                        //此处执行将不会在循环结束后再push一次\r\n                        lines.push(line.substring(startIndex, m));\r\n                        this._lineWidths.push(this._getTextWidth(lines[lines.length - 1]));\r\n                        startIndex = -1;\r\n                        break;\r\n                    }\r\n                } else if (this.overflow == Text.HIDDEN) {\r\n                    lines.push(line.substring(0, j));\r\n                    this._lineWidths.push(this._getTextWidth(lines[lines.length - 1]));\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        if (this.wordWrap && startIndex != -1) {\r\n            lines.push(line.substring(startIndex, m));\r\n            this._lineWidths.push(this._getTextWidth(lines[lines.length - 1]));\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    private _getTextWidth(text: string): number {\r\n        var bitmapFont: BitmapFont = ((<TextStyle>this._style)).currBitmapFont;\r\n        if (bitmapFont) return bitmapFont.getTextWidth(text);\r\n        else {\r\n            if (ILaya.Render.isConchApp) {\r\n                return (window as any).conchTextCanvas.measureText(text).width;;\r\n            }\r\n            else{\r\n\t\t\t\tlet ret = ILaya.Browser.context.measureText(text)||{width:100};\r\n\t\t\t\treturn ret.width;\r\n\t\t\t}\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 获取换行所需的宽度。\r\n     */\r\n    private _getWordWrapWidth(): number {\r\n        var p: any[] = this.padding;\r\n        var w: number;\r\n        var bitmapFont: BitmapFont = ((<TextStyle>this._style)).currBitmapFont;\r\n        if (bitmapFont && bitmapFont.autoScaleSize) w = this._width * (bitmapFont.fontSize / this.fontSize);\r\n        else w = this._width;\r\n\r\n        if (w <= 0) {\r\n            w = this.wordWrap ? 100 : ILaya.Browser.width;\r\n        }\r\n        w <= 0 && (w = 100);\r\n        return w - p[3] - p[1];\r\n    }\r\n\r\n    /**\r\n     * 返回字符在本类实例的父坐标系下的坐标。\r\n     * @param charIndex\t索引位置。\r\n     * @param out\t\t（可选）输出的Point引用。\r\n     * @return Point 字符在本类实例的父坐标系下的坐标。如果out参数不为空，则将结果赋值给指定的Point对象，否则创建一个新的Point对象返回。建议使用Point.TEMP作为out参数，可以省去Point对象创建和垃圾回收的开销，尤其是在需要频繁执行的逻辑中，比如帧循环和MOUSE_MOVE事件回调函数里面。\r\n     */\r\n    getCharPoint(charIndex: number, out: Point = null): Point {\r\n        this._isChanged && ILaya.systemTimer.runCallLater(this, this.typeset);\r\n        var len: number = 0, lines: any[] = this._lines, startIndex: number = 0;\r\n        for (var i: number = 0, n: number = lines.length; i < n; i++) {\r\n            len += lines[i].length;\r\n            if (charIndex < len) {\r\n                var line: number = i;\r\n                break;\r\n            }\r\n            startIndex = len;\r\n        }\r\n        //计算字符的宽度\r\n        var ctxFont: string = (this.italic ? \"italic \" : \"\") + (this.bold ? \"bold \" : \"\") + this.fontSize + \"px \" + this.font;\r\n        ILaya.Browser.context.font = ctxFont;\r\n        var width: number = this._getTextWidth(this._text.substring(startIndex, charIndex));\r\n        var point: Point = out || new Point();\r\n        return point.setTo(this._startX + width - (this._clipPoint ? this._clipPoint.x : 0), this._startY + line * (this._charSize.height + this.leading) - (this._clipPoint ? this._clipPoint.y : 0));\r\n    }\r\n\r\n    /**\r\n     * <p>设置横向滚动量。</p>\r\n     * <p>即使设置超出滚动范围的值，也会被自动限制在可能的最大值处。</p>\r\n     */\r\n    set scrollX(value: number) {\r\n        if (this.overflow != Text.SCROLL || (this.textWidth < this._width || !this._clipPoint)) return;\r\n\r\n        value = value < this.padding[3] ? this.padding[3] : value;\r\n        var maxScrollX: number = this._textWidth - this._width;\r\n        value = value > maxScrollX ? maxScrollX : value;\r\n\r\n        this._clipPoint.x = value;\r\n        this._renderText();\r\n    }\r\n\r\n    /**\r\n     * 获取横向滚动量。\r\n     */\r\n    get scrollX(): number {\r\n        if (!this._clipPoint) return 0;\r\n        return this._clipPoint.x;\r\n    }\r\n\r\n    /**\r\n     * 设置纵向滚动量（px)。即使设置超出滚动范围的值，也会被自动限制在可能的最大值处。\r\n     */\r\n    set scrollY(value: number) {\r\n        if (this.overflow != Text.SCROLL || (this.textHeight < this._height || !this._clipPoint)) return;\r\n\r\n        value = value < this.padding[0] ? this.padding[0] : value;\r\n        var maxScrollY: number = this._textHeight - this._height;\r\n        value = value > maxScrollY ? maxScrollY : value;\r\n\r\n        this._clipPoint.y = value;\r\n        this._renderText();\r\n    }\r\n\r\n    /**\r\n     * 获取纵向滚动量。\r\n     */\r\n    get scrollY(): number {\r\n        if (!this._clipPoint) return 0;\r\n        return this._clipPoint.y;\r\n    }\r\n\r\n    /**\r\n     * 获取横向可滚动最大值。\r\n     */\r\n    get maxScrollX(): number {\r\n        return (this.textWidth < this._width) ? 0 : this._textWidth - this._width;\r\n    }\r\n\r\n    /**\r\n     * 获取纵向可滚动最大值。\r\n     */\r\n    get maxScrollY(): number {\r\n        return (this.textHeight < this._height) ? 0 : this._textHeight - this._height;\r\n    }\r\n\r\n    /**返回文字行信息*/\r\n    get lines(): any[] {\r\n        if (this._isChanged) this.typeset();\r\n        return this._lines;\r\n    }\r\n\r\n    /**下划线的颜色，为null则使用字体颜色。*/\r\n    get underlineColor(): string {\r\n        return ((<TextStyle>this._style)).underlineColor;\r\n    }\r\n\r\n    set underlineColor(value: string) {\r\n        this._getTextStyle().underlineColor = value;\r\n        if (!this._isChanged) this._renderText();\r\n    }\r\n\r\n    /**是否显示下划线。*/\r\n    get underline(): boolean {\r\n        return ((<TextStyle>this._style)).underline;\r\n    }\r\n\r\n    set underline(value: boolean) {\r\n        this._getTextStyle().underline = value;\r\n    }\r\n\r\n    /** 设置是否单个字符渲染，如果Textd的内容一直改变，例如是一个增加的数字，就设置这个，防止无效占用缓存 */\r\n    set singleCharRender(value: boolean) {\r\n        this._singleCharRender = value;\r\n    }\r\n    get singleCharRender(): boolean {\r\n        return this._singleCharRender;\r\n\t}\r\n/*\t\r\n\tscale(scaleX: number, scaleY: number, speedMode: boolean = false): Sprite {\r\n\t\tsuper.scale(scaleX,scaleY, speedMode);\r\n        // 注意_words是一个数组（例如有换行）\r\n        this._words && this._words.forEach(function (w: WordText): void {\r\n            w.cleanCache();\r\n\t\t});\r\n\t\tthis.repaint();\r\n\t\treturn this;\r\n\t}\t\r\n*/\r\n}\r\n\r\n\r\nILaya.regClass(Text);\r\nClassUtils.regClass(\"laya.display.Text\", Text);\r\nClassUtils.regClass(\"Laya.Text\", Text);","import { Text } from \"./Text\";\r\nimport { Event } from \"../events/Event\"\r\nimport { Matrix } from \"../maths/Matrix\"\r\nimport { Utils } from \"../utils/Utils\"\r\nimport { ILaya } from \"../../ILaya\";\r\nimport { ClassUtils } from \"../utils/ClassUtils\";\r\nimport { TextStyle } from \"./css/TextStyle\";\r\n/**\r\n * 用户输入一个或多个文本字符时后调度。\r\n * @eventType Event.INPUT\r\n * */\r\n/*[Event(name = \"input\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 文本发生变化后调度。\r\n * @eventType Event.CHANGE\r\n * */\r\n/*[Event(name = \"change\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 用户在输入框内敲回车键后，将会调度 <code>enter</code> 事件。\r\n * @eventType Event.ENTER\r\n * */\r\n/*[Event(name = \"enter\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 显示对象获得焦点后调度。\r\n * @eventType Event.FOCUS\r\n * */\r\n/*[Event(name = \"focus\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 显示对象失去焦点后调度。\r\n * @eventType Event.BLUR\r\n * */\r\n/*[Event(name = \"blur\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * <p><code>Input</code> 类用于创建显示对象以显示和输入文本。</p>\r\n * <p>Input 类封装了原生的文本输入框，由于不同浏览器的差异，会导致此对象的默认文本的位置与用户点击输入时的文本的位置有少许的偏差。</p>\r\n */\r\nexport class Input extends Text {\r\n    /** 常规文本域。*/\r\n    static TYPE_TEXT: string = \"text\";\r\n    /** password 类型用于密码域输入。*/\r\n    static TYPE_PASSWORD: string = \"password\";\r\n    /** email 类型用于应该包含 e-mail 地址的输入域。*/\r\n    static TYPE_EMAIL: string = \"email\";\r\n    /** url 类型用于应该包含 URL 地址的输入域。*/\r\n    static TYPE_URL: string = \"url\";\r\n    /** number 类型用于应该包含数值的输入域。*/\r\n    static TYPE_NUMBER: string = \"number\";\r\n    /**\r\n     * <p>range 类型用于应该包含一定范围内数字值的输入域。</p>\r\n     * <p>range 类型显示为滑动条。</p>\r\n     * <p>您还能够设定对所接受的数字的限定。</p>\r\n     */\r\n    static TYPE_RANGE: string = \"range\";\r\n    /**  选取日、月、年。*/\r\n    static TYPE_DATE: string = \"date\";\r\n    /** month - 选取月、年。*/\r\n    static TYPE_MONTH: string = \"month\";\r\n    /** week - 选取周和年。*/\r\n    static TYPE_WEEK: string = \"week\";\r\n    /** time - 选取时间（小时和分钟）。*/\r\n    static TYPE_TIME: string = \"time\";\r\n    /** datetime - 选取时间、日、月、年（UTC 时间）。*/\r\n    static TYPE_DATE_TIME: string = \"datetime\";\r\n    /** datetime-local - 选取时间、日、月、年（本地时间）。*/\r\n    static TYPE_DATE_TIME_LOCAL: string = \"datetime-local\";\r\n    /**\r\n     * <p>search 类型用于搜索域，比如站点搜索或 Google 搜索。</p>\r\n     * <p>search 域显示为常规的文本域。</p>\r\n     */\r\n    static TYPE_SEARCH: string = \"search\";\r\n\r\n    /**@private */\r\n\tprotected static input: HTMLInputElement;\r\n    /**@private */\r\n    protected static area: any;\r\n    /**@private */\r\n    protected static inputElement: any;\r\n    /**@private */\r\n    protected static inputContainer: any;\r\n    /**@private */\r\n    protected static confirmButton: any;\r\n    /**@private */\r\n    protected static promptStyleDOM: any;\r\n\r\n    /**@private */\r\n    protected _focus: boolean;\r\n    /**@private */\r\n    protected _multiline: boolean = false;\r\n    /**@private */\r\n    protected _editable: boolean = true;\r\n    /**@private */\r\n    protected _restrictPattern: any;\r\n    /**@private */\r\n    protected _maxChars: number = 1E5;\r\n\r\n    private _type: string = \"text\";\r\n\r\n    /**输入提示符。*/\r\n    private _prompt: string = '';\r\n    /**输入提示符颜色。*/\r\n    private _promptColor: string = \"#A9A9A9\";\r\n    private _originColor: string = \"#000000\";\r\n    private _content: string = '';\r\n\r\n    /**@private */\r\n    static IOS_IFRAME: boolean = false;\r\n    private static inputHeight: number = 45;\r\n\r\n    /**表示是否处于输入状态。*/\r\n    static isInputting: boolean = false;\r\n\r\n    /**创建一个新的 <code>Input</code> 类实例。*/\r\n    constructor() {\r\n        super();\r\n        Input.IOS_IFRAME = (ILaya.Browser.onIOS && ILaya.Browser.window.top != ILaya.Browser.window.self);\r\n        this._width = 100;\r\n        this._height = 20;\r\n\r\n        this.multiline = false;\r\n        this.overflow = Text.SCROLL;\r\n\r\n        this.on(Event.MOUSE_DOWN, this, this._onMouseDown);\r\n        this.on(Event.UNDISPLAY, this, this._onUnDisplay);\r\n    }\r\n\r\n    /**@internal */\r\n    static __init__(): void {\r\n        Input._createInputElement();\r\n\r\n        // 移动端通过画布的touchend调用focus\r\n        if (ILaya.Browser.onMobile) {\r\n            var isTrue: boolean = false;\r\n            if (ILaya.Browser.onMiniGame || ILaya.Browser.onBDMiniGame || ILaya.Browser.onQGMiniGame || ILaya.Browser.onKGMiniGame || ILaya.Browser.onVVMiniGame || ILaya.Browser.onAlipayMiniGame || ILaya.Browser.onQQMiniGame || ILaya.Browser.onBLMiniGame || ILaya.Browser.onTTMiniGame || ILaya.Browser.onHWMiniGame) {\r\n                isTrue = true;\r\n            }\r\n            ILaya.Render.canvas.addEventListener(Input.IOS_IFRAME ? (isTrue ? \"touchend\" : \"click\") : \"touchend\", Input._popupInputMethod);\r\n        }\r\n    }\r\n\r\n    // 移动平台在单击事件触发后弹出输入法\r\n    private static _popupInputMethod(e: any): void {\r\n        //e.preventDefault();\r\n        if (!Input.isInputting) return;\r\n\r\n        var input: any = Input.inputElement;\r\n\r\n        // 弹出输入法。\r\n        input.focus();\r\n    }\r\n\r\n    private static _createInputElement(): void {\r\n        Input._initInput(Input.area = ILaya.Browser.createElement(\"textarea\"));\r\n        Input._initInput(Input.input = ILaya.Browser.createElement(\"input\"));\r\n\r\n        Input.inputContainer = ILaya.Browser.createElement(\"div\");\r\n        Input.inputContainer.style.position = \"absolute\";\r\n        Input.inputContainer.style.zIndex = 1E5;\r\n        ILaya.Browser.container.appendChild(Input.inputContainer);\r\n        Input.inputContainer.setPos = function (x: number, y: number): void {\r\n            Input.inputContainer.style.left = x + 'px';\r\n            Input.inputContainer.style.top = y + 'px';\r\n        };\r\n    }\r\n\r\n    private static _initInput(input: any): void {\r\n        var style: any = input.style;\r\n        style.cssText = \"position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;\";\r\n        style.resize = 'none';\r\n        style.backgroundColor = 'transparent';\r\n        style.border = 'none';\r\n        style.outline = 'none';\r\n        style.zIndex = 1;\r\n\r\n        input.addEventListener('input', Input._processInputting);\r\n\r\n        input.addEventListener('mousemove', Input._stopEvent);\r\n        input.addEventListener('mousedown', Input._stopEvent);\r\n        input.addEventListener('touchmove', Input._stopEvent);\r\n\r\n        input.setFontFace = function (fontFace: String): void { input.style.fontFamily = fontFace; };\r\n        if (!ILaya.Render.isConchApp) {\r\n            input.setColor = function (color: String): void { input.style.color = color; };\r\n            input.setFontSize = function (fontSize: number): void { input.style.fontSize = fontSize + 'px'; };\r\n        }\r\n    }\r\n\r\n    private static _processInputting(e: any): void {\r\n        var input: Input = Input.inputElement.target;\r\n        if (!input) return;\r\n\r\n        var value: string = Input.inputElement.value;\r\n\r\n        // 对输入字符进行限制\r\n        if (input._restrictPattern) {\r\n            // 部分输入法兼容\r\n            value = value.replace(/\\u2006|\\x27/g, \"\");\r\n\r\n            if (input._restrictPattern.test(value)) {\r\n                value = value.replace(input._restrictPattern, \"\");\r\n                Input.inputElement.value = value;\r\n            }\r\n        }\r\n\r\n        input._text = value;\r\n        input.event(Event.INPUT);\r\n    }\r\n\r\n    private static _stopEvent(e: any): void {\r\n        if (e.type == 'touchmove')\r\n            e.preventDefault();\r\n        e.stopPropagation && e.stopPropagation();\r\n    }\r\n\r\n    /**\r\n     * 设置光标位置和选取字符。\r\n     * @param\tstartIndex\t光标起始位置。\r\n     * @param\tendIndex\t光标结束位置。\r\n     */\r\n    setSelection(startIndex: number, endIndex: number): void {\r\n        this.focus = true;\r\n        Input.inputElement.selectionStart = startIndex;\r\n        Input.inputElement.selectionEnd = endIndex;\r\n    }\r\n\r\n    /**表示是否是多行输入框。*/\r\n    get multiline(): boolean {\r\n        return this._multiline;\r\n    }\r\n\r\n    set multiline(value: boolean) {\r\n        this._multiline = value;\r\n        this.valign = value ? \"top\" : \"middle\";\r\n    }\r\n\r\n    /**\r\n     * 获取对输入框的引用实例。\r\n     */\r\n    get nativeInput(): any {\r\n        return this._multiline ? Input.area : Input.input;\r\n    }\r\n\r\n    private _onUnDisplay(e: Event = null): void {\r\n        this.focus = false;\r\n    }\r\n\r\n    private _onMouseDown(e: Event): void {\r\n        this.focus = true;\r\n    }\r\n\r\n    private static stageMatrix: Matrix;\r\n\r\n    /**\r\n     * 在输入期间，如果 Input 实例的位置改变，调用_syncInputTransform同步输入框的位置。\r\n     */\r\n    private _syncInputTransform(): void {\r\n        var inputElement: any = this.nativeInput;\r\n        var transform: any = Utils.getTransformRelativeToWindow(this, this.padding[3], this.padding[0]);\r\n        var inputWid: number = this._width - this.padding[1] - this.padding[3];\r\n        var inputHei: number = this._height - this.padding[0] - this.padding[2];\r\n        if (ILaya.Render.isConchApp) {\r\n            inputElement.setScale(transform.scaleX, transform.scaleY);\r\n            inputElement.setSize(inputWid, inputHei);\r\n            inputElement.setPos(transform.x, transform.y);\r\n        } else {\r\n            Input.inputContainer.style.transform = Input.inputContainer.style.webkitTransform = \"scale(\" + transform.scaleX + \",\" + transform.scaleY + \") rotate(\" + (ILaya.stage.canvasDegree) + \"deg)\";\r\n            inputElement.style.width = inputWid + 'px';\r\n            inputElement.style.height = inputHei + 'px';\r\n            Input.inputContainer.style.left = transform.x + 'px';\r\n            Input.inputContainer.style.top = transform.y + 'px';\r\n        }\r\n    }\r\n\r\n    /**选中当前实例的所有文本。*/\r\n    select(): void {\r\n        this.nativeInput.select();\r\n    }\r\n\r\n    /**\r\n     * 表示焦点是否在此实例上。\r\n     */\r\n    get focus(): boolean {\r\n        return this._focus;\r\n    }\r\n\r\n    // 移动平台最后单击画布才会调用focus\r\n    // 因此 调用focus接口是无法都在移动平台立刻弹出键盘的\r\n    set focus(value: boolean) {\r\n        var input: any = this.nativeInput;\r\n\r\n        if (this._focus !== value) {\r\n            if (value) {\r\n                if (input.target) {\r\n                    input.target._focusOut();\r\n                } else {\r\n                    this._setInputMethod();\r\n                }\r\n                input.target = this;\r\n\r\n                this._focusIn();\r\n            } else {\r\n                input.target = null;\r\n                this._focusOut();\r\n                ILaya.Browser.document.body.scrollTop = 0;\r\n                input.blur();\r\n\r\n                if (ILaya.Render.isConchApp) input.setPos(-10000, -10000);\r\n                else if (Input.inputContainer.contains(input)) Input.inputContainer.removeChild(input);\r\n            }\r\n        }\r\n    }\r\n\r\n    private _setInputMethod(): void {\r\n        Input.input.parentElement && (Input.inputContainer.removeChild(Input.input));\r\n        Input.area.parentElement && (Input.inputContainer.removeChild(Input.area));\r\n\r\n        Input.inputElement = (this._multiline ? Input.area : Input.input);\r\n        Input.inputContainer.appendChild(Input.inputElement);\r\n        if (Text.RightToLeft) {\r\n            Input.inputElement.style.direction = \"rtl\";\r\n        }\r\n    }\r\n\r\n    private _focusIn(): void {\r\n        Input.isInputting = true;\r\n\t\tvar input: any = this.nativeInput;\r\n\t\t\r\n\t\tInput.input && (Input.input.type = this._type);\t\t// 设置input控件的 password\r\n\r\n        this._focus = true;\r\n\r\n        var cssStyle: any = input.style;\r\n        cssStyle.whiteSpace = (this.wordWrap ? \"pre-wrap\" : \"nowrap\");\r\n        this._setPromptColor();\r\n\r\n        input.readOnly = !this._editable;\r\n        if (ILaya.Render.isConchApp) {\r\n            input.setType(this._type);\r\n            input.setForbidEdit(!this._editable);\r\n        }\r\n        input.maxLength = this._maxChars;\r\n\r\n        var padding: any[] = this.padding;\r\n\r\n        //input.type = this._type;      不知道为什么说这个是只读的。但是as项目就没问题\r\n        input.value = this._content;\r\n        input.placeholder = this._prompt;\r\n\r\n        ILaya.stage.off(Event.KEY_DOWN, this, this._onKeyDown);\r\n        ILaya.stage.on(Event.KEY_DOWN, this, this._onKeyDown);\r\n        ILaya.stage.focus = this;\r\n        this.event(Event.FOCUS);\r\n\r\n        // PC端直接调用focus进入焦点。\r\n        if (ILaya.Browser.onPC) input.focus();\r\n\r\n        // PC浏览器隐藏文字\r\n        if (!ILaya.Browser.onMiniGame && !ILaya.Browser.onBDMiniGame && !ILaya.Browser.onQGMiniGame && !ILaya.Browser.onKGMiniGame && !ILaya.Browser.onVVMiniGame && !ILaya.Browser.onAlipayMiniGame && !ILaya.Browser.onQQMiniGame && !ILaya.Browser.onBLMiniGame && !ILaya.Browser.onTTMiniGame && !ILaya.Browser.onHWMiniGame) {\r\n            var temp: string = this._text;\r\n            this._text = null;\r\n        }\r\n        this.typeset();\r\n\r\n        // PC同步输入框外观。\r\n        input.setColor(this._originColor);\r\n        input.setFontSize(this.fontSize);\r\n        input.setFontFace(ILaya.Browser.onIPhone ? (Text.fontFamilyMap[this.font] || this.font) : this.font);\r\n        if (ILaya.Render.isConchApp) {\r\n            input.setMultiAble && input.setMultiAble(this._multiline);\r\n        }\r\n        cssStyle.lineHeight = (this.leading + this.fontSize) + \"px\";\r\n        cssStyle.fontStyle = (this.italic ? \"italic\" : \"normal\");\r\n        cssStyle.fontWeight = (this.bold ? \"bold\" : \"normal\");\r\n        cssStyle.textAlign = this.align;\r\n        cssStyle.padding = \"0 0\";\r\n\r\n        // 输入框重定位。\r\n        this._syncInputTransform();\r\n        if (!ILaya.Render.isConchApp && ILaya.Browser.onPC)\r\n            ILaya.systemTimer.frameLoop(1, this, this._syncInputTransform);\r\n    }\r\n\r\n    // 设置DOM输入框提示符颜色。\r\n    private _setPromptColor(): void {\r\n        // 创建style标签\r\n        Input.promptStyleDOM = ILaya.Browser.getElementById(\"promptStyle\");\r\n        if (!Input.promptStyleDOM) {\r\n            Input.promptStyleDOM = ILaya.Browser.createElement(\"style\");\r\n            Input.promptStyleDOM.setAttribute(\"id\", \"promptStyle\");\r\n            ILaya.Browser.document.head.appendChild(Input.promptStyleDOM);\r\n        }\r\n\r\n        // 设置style标签\r\n        Input.promptStyleDOM.innerText = \"input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {\" + \"color:\" + this._promptColor + \"}\" + \"input:-moz-placeholder, textarea:-moz-placeholder {\" + \"color:\" + this._promptColor + \"}\" + \"input::-moz-placeholder, textarea::-moz-placeholder {\" + \"color:\" + this._promptColor + \"}\" + \"input:-ms-input-placeholder, textarea:-ms-input-placeholder {\" + \"color:\" + this._promptColor + \"}\";\r\n    }\r\n\r\n    /**@private */\r\n    private _focusOut(): void {\r\n        if(!Input.isInputting)return;\r\n        Input.isInputting = false;\r\n        this._focus = false;\r\n\r\n        this._text = null;\r\n        this._content = this.nativeInput.value;\r\n        if (!this._content) {\r\n            super.set_text(this._prompt);\r\n            super.set_color(this._promptColor);\r\n        } else {\r\n            super.set_text(this._content);\r\n            super.set_color(this._originColor);\r\n        }\r\n\r\n        ILaya.stage.off(Event.KEY_DOWN, this, this._onKeyDown);\r\n        ILaya.stage.focus = null;\r\n        this.event(Event.BLUR);\r\n        this.event(Event.CHANGE);\r\n        if (ILaya.Render.isConchApp) this.nativeInput.blur();\r\n        // 只有PC会注册此事件。\r\n        ILaya.Browser.onPC && ILaya.systemTimer.clear(this, this._syncInputTransform);\r\n    }\r\n\r\n    /**@private */\r\n    private _onKeyDown(e: any): void {\r\n        if (e.keyCode === 13) {\r\n            // 移动平台单行输入状态下点击回车收回输入法。 \r\n            if (ILaya.Browser.onMobile && !this._multiline)\r\n                this.focus = false;\r\n\r\n            this.event(Event.ENTER);\r\n        }\r\n    }\r\n\r\n    /**@inheritDoc \r\n     * @override\r\n    */\r\n    set text(value: string) {\r\n        super.set_color(this._originColor);\r\n\r\n        value += '';\r\n\r\n        if (this._focus) {\r\n            this.nativeInput.value = value || '';\r\n            this.event(Event.CHANGE);\r\n        } else {\r\n            // 单行时不允许换行\r\n            if (!this._multiline)\r\n                value = value.replace(/\\r?\\n/g, '');\r\n\r\n            this._content = value;\r\n\r\n            if (value)\r\n                super.set_text(value);\r\n            else {\r\n                super.set_text(this._prompt);\r\n                super.set_color(this.promptColor);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    get text(): string {\r\n        if (this._focus)\r\n            return this.nativeInput.value;\r\n        else\r\n            return this._content || \"\";\r\n    }\r\n    /**\r\n     * \r\n     * @param text \r\n     * @override\r\n     */\r\n    changeText(text: string): void {\r\n        this._content = text;\r\n\r\n        if (this._focus) {\r\n            this.nativeInput.value = text || '';\r\n            this.event(Event.CHANGE);\r\n        } else\r\n            super.changeText(text);\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n    set color(value: string) {\r\n        if (this._focus)\r\n            this.nativeInput.setColor(value);\r\n\r\n        super.set_color(this._content ? value : this._promptColor);\r\n        this._originColor = value;\r\n    }\r\n    /**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n    get color() {\r\n        return super.color;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n    set bgColor(value: string) {\r\n        super.set_bgColor(value);\r\n        if (ILaya.Render.isConchApp)\r\n            this.nativeInput.setBgColor(value);\r\n    }\r\n    /**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n    get bgColor() {\r\n        return super.bgColor;\r\n    }\r\n\r\n    /**限制输入的字符。*/\r\n    get restrict(): string {\r\n        if (this._restrictPattern) {\r\n            return this._restrictPattern.source;\r\n        }\r\n        return \"\";\r\n    }\r\n\r\n    set restrict(pattern: string) {\r\n        // H5保存RegExp\r\n        if (pattern) {\r\n            pattern = \"[^\" + pattern + \"]\";\r\n\r\n            // 如果pattern为^\\00-\\FF，则我们需要的正则表达式是\\00-\\FF\r\n            if (pattern.indexOf(\"^^\") > -1)\r\n                pattern = pattern.replace(\"^^\", \"\");\r\n\r\n            this._restrictPattern = new RegExp(pattern, \"g\");\r\n        } else\r\n            this._restrictPattern = null;\r\n    }\r\n\r\n    /**\r\n     * 是否可编辑。\r\n     */\r\n    set editable(value: boolean) {\r\n        this._editable = value;\r\n        if (ILaya.Render.isConchApp) {\r\n            (Input.input as any).setForbidEdit(!value);\r\n        }\r\n    }\r\n\r\n    get editable(): boolean {\r\n        return this._editable;\r\n    }\r\n\r\n    /**\r\n     * <p>字符数量限制，默认为10000。</p>\r\n     * <p>设置字符数量限制时，小于等于0的值将会限制字符数量为10000。</p>\r\n     */\r\n    get maxChars(): number {\r\n        return this._maxChars;\r\n    }\r\n\r\n    set maxChars(value: number) {\r\n        if (value <= 0)\r\n            value = 1E5;\r\n        this._maxChars = value;\r\n    }\r\n\r\n    /**\r\n     * 设置输入提示符。\r\n     */\r\n    get prompt(): string {\r\n        return this._prompt;\r\n    }\r\n\r\n    set prompt(value: string) {\r\n        if (!this._text && value)\r\n            super.set_color(this._promptColor);\r\n\r\n        this.promptColor = this._promptColor;\r\n\r\n        if (this._text)\r\n            super.set_text((this._text == this._prompt) ? value : this._text);\r\n        else\r\n            super.set_text(value);\r\n\r\n        this._prompt = Text.langPacks && Text.langPacks[value] ? Text.langPacks[value] : value;\r\n    }\r\n\r\n    /**\r\n     * 设置输入提示符颜色。\r\n     */\r\n    get promptColor(): string {\r\n        return this._promptColor;\r\n    }\r\n\r\n    set promptColor(value: string) {\r\n        this._promptColor = value;\r\n        if (!this._content) super.set_color(value);\r\n    }\r\n\r\n    /**\r\n     * <p>输入框类型为Input静态常量之一。</p>\r\n     * <ul>\r\n     * <li>TYPE_TEXT</li>\r\n     * <li>TYPE_PASSWORD</li>\r\n     * <li>TYPE_EMAIL</li>\r\n     * <li>TYPE_URL</li>\r\n     * <li>TYPE_NUMBER</li>\r\n     * <li>TYPE_RANGE</li>\r\n     * <li>TYPE_DATE</li>\r\n     * <li>TYPE_MONTH</li>\r\n     * <li>TYPE_WEEK</li>\r\n     * <li>TYPE_TIME</li>\r\n     * <li>TYPE_DATE_TIME</li>\r\n     * <li>TYPE_DATE_TIME_LOCAL</li>\r\n     * </ul>\r\n     * <p>平台兼容性参见http://www.w3school.com.cn/html5/html_5_form_input_types.asp。</p>\r\n     */\r\n    get type(): string {\r\n        return this._type;\r\n    }\r\n\r\n    set type(value: string) {\r\n        if (value === \"password\") this._getTextStyle().asPassword = true;\r\n        else this._getTextStyle().asPassword = false;\r\n        this._type = value;\r\n    }\r\n}\r\n\r\nClassUtils.regClass(\"laya.display.Input\", Input);\r\nClassUtils.regClass(\"Laya.Input\", Input);","import { Event } from \"./Event\";\r\nimport { Node } from \"../display/Node\"\r\n//import { Sprite } from \"../display/Sprite\"\r\nimport { Browser } from \"../utils/Browser\"\r\nimport { Pool } from \"../utils/Pool\"\r\nimport { ILaya } from \"../../ILaya\";\r\n\r\n/**\r\n * @private\r\n * Touch事件管理类，处理多点触控下的鼠标事件\r\n */\r\nexport class TouchManager {\r\n\r\n    static I: TouchManager = new TouchManager();\r\n    private static _oldArr: any[] = [];\r\n    private static _newArr: any[] = [];\r\n    private static _tEleArr: any[] = [];\r\n    /**\r\n     * 当前over的touch表\r\n     */\r\n    private preOvers: any[] = [];\r\n    /**\r\n     * 当前down的touch表\r\n     */\r\n    private preDowns: any[] = [];\r\n    private preRightDowns: any[] = [];\r\n    /**\r\n     * 是否启用\r\n     */\r\n    enable: boolean = true;\r\n\r\n    /**\r\n     * @internal\r\n     * 用于派发事件用的Event对象\r\n     */\r\n    _event: Event = new Event();\r\n\r\n    private _lastClickTime: number = 0;\r\n\r\n    private _clearTempArrs(): void {\r\n        TouchManager._oldArr.length = 0;\r\n        TouchManager._newArr.length = 0;\r\n        TouchManager._tEleArr.length = 0;\r\n    }\r\n\r\n    /**\r\n     * 从touch表里查找对应touchID的数据\r\n     * @param touchID touch ID\r\n     * @param arr touch表\r\n     * @return\r\n     *\r\n     */\r\n    private getTouchFromArr(touchID: number, arr: any[]): any {\r\n        var i: number, len: number;\r\n        len = arr.length;\r\n        var tTouchO: any;\r\n        for (i = 0; i < len; i++) {\r\n            tTouchO = arr[i];\r\n            if (tTouchO.id == touchID) {\r\n                return tTouchO;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * 从touch表里移除一个元素\r\n     * @param touchID touch ID\r\n     * @param arr touch表\r\n     *\r\n     */\r\n    private removeTouchFromArr(touchID: number, arr: any[]): void {\r\n        //DebugTxt.dTrace(\"removeTouch:\"+touchID);\r\n        var i: number;\r\n        for (i = arr.length - 1; i >= 0; i--) {\r\n            if (arr[i].id == touchID) {\r\n                //DebugTxt.dTrace(\"removeedTouch:\"+touchID);\r\n                arr.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 创建一个touch数据\r\n     * @param ele 当前的根节点\r\n     * @param touchID touchID\r\n     * @return\r\n     *\r\n     */\r\n    private createTouchO(ele: any, touchID: number): any {\r\n        var rst: any;\r\n        rst = Pool.getItem(\"TouchData\") || {};\r\n        rst.id = touchID;\r\n        rst.tar = ele;\r\n\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     * 处理touchStart\r\n     * @param ele\t\t根节点\r\n     * @param touchID\ttouchID\r\n     * @param isLeft\t（可选）是否为左键\r\n     */\r\n    onMouseDown(ele: any, touchID: number, isLeft: boolean = false): void {\r\n        if (!this.enable)\r\n            return;\r\n        var preO: any;\r\n        var tO: any;\r\n        var arrs: any[];\r\n        preO = this.getTouchFromArr(touchID, this.preOvers);\r\n\r\n        arrs = this.getEles(ele, null, TouchManager._tEleArr);\r\n        if (!preO) {\r\n            tO = this.createTouchO(ele, touchID);\r\n            this.preOvers.push(tO);\r\n        } else {\r\n            //理论上不会发生，相同触摸事件必然不会在end之前再次出发\r\n            preO.tar = ele;\r\n        }\r\n        if (Browser.onMobile)\r\n            this.sendEvents(arrs, Event.MOUSE_OVER);\r\n\r\n        var preDowns: any[];\r\n        preDowns = isLeft ? this.preDowns : this.preRightDowns;\r\n        preO = this.getTouchFromArr(touchID, preDowns);\r\n        if (!preO) {\r\n            tO = this.createTouchO(ele, touchID);\r\n            preDowns.push(tO);\r\n        } else {\r\n            //理论上不会发生，相同触摸事件必然不会在end之前再次出发\r\n            preO.tar = ele;\r\n\r\n        }\r\n        this.sendEvents(arrs, isLeft ? Event.MOUSE_DOWN : Event.RIGHT_MOUSE_DOWN);\r\n        this._clearTempArrs();\r\n\r\n    }\r\n\r\n    /**\r\n     * 派发事件。\r\n     * @param eles\t\t对象列表。\r\n     * @param type\t\t事件类型。\r\n     */\r\n    private sendEvents(eles: any[], type: string): void {\r\n        var i: number, len: number;\r\n        len = eles.length;\r\n        this._event._stoped = false;\r\n        var _target: any;\r\n        _target = eles[0];\r\n        for (i = 0; i < len; i++) {\r\n            var tE = eles[i];\r\n            if (tE.destroyed) return;\r\n            tE.event(type, this._event.setTo(type, tE, _target));\r\n            if (this._event._stoped)\r\n                break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 获取对象列表。\r\n     * @param start\t起始节点。\r\n     * @param end\t结束节点。\r\n     * @param rst\t返回值。如果此值不为空，则将其赋值为计算结果，从而避免创建新数组；如果此值为空，则创建新数组返回。\r\n     * @return Array 返回节点列表。\r\n     */\r\n    private getEles(start: Node, end: Node = null, rst: any[] = null): any[] {\r\n        if (!rst) {\r\n            rst = [];\r\n        } else {\r\n            rst.length = 0;\r\n        }\r\n        while (start && start != end) {\r\n            rst.push(start);\r\n            start = start.parent;\r\n        }\r\n        return rst;\r\n    }\r\n\r\n    /**\r\n     * touchMove时处理out事件和over时间。\r\n     * @param eleNew\t新的根节点。\r\n     * @param elePre\t旧的根节点。\r\n     * @param touchID\t（可选）touchID，默认为0。\r\n     */\r\n    private checkMouseOutAndOverOfMove(eleNew: Node, elePre: Node, touchID: number = 0): void {\r\n        if (elePre == eleNew)\r\n            return;\r\n        var tar: Node;\r\n        var arrs: any[];\r\n        var i: number, len: number;\r\n        if (elePre.contains(eleNew)) {\r\n            arrs = this.getEles(eleNew, elePre, TouchManager._tEleArr);\r\n            this.sendEvents(arrs, Event.MOUSE_OVER);\r\n        } else if (eleNew.contains(elePre)) {\r\n            arrs = this.getEles(elePre, eleNew, TouchManager._tEleArr);\r\n            this.sendEvents(arrs, Event.MOUSE_OUT);\r\n        } else {\r\n            //arrs = getEles(elePre);\r\n            arrs = TouchManager._tEleArr;\r\n            arrs.length = 0;\r\n            var oldArr: any[];\r\n            oldArr = this.getEles(elePre, null, TouchManager._oldArr);\r\n            var newArr: any[];\r\n            newArr = this.getEles(eleNew, null, TouchManager._newArr);\r\n            len = oldArr.length;\r\n            var tIndex: number;\r\n            for (i = 0; i < len; i++) {\r\n                tar = oldArr[i];\r\n                tIndex = newArr.indexOf(tar);\r\n                if (tIndex >= 0) {\r\n                    newArr.splice(tIndex, newArr.length - tIndex);\r\n                    break;\r\n\r\n                } else {\r\n                    arrs.push(tar);\r\n                }\r\n            }\r\n            if (arrs.length > 0) {\r\n                this.sendEvents(arrs, Event.MOUSE_OUT);\r\n            }\r\n\r\n            if (newArr.length > 0) {\r\n                this.sendEvents(newArr, Event.MOUSE_OVER);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 处理TouchMove事件\r\n     * @param ele 根节点\r\n     * @param touchID touchID\r\n     *\r\n     */\r\n    onMouseMove(ele: any, touchID: number): void {\r\n        if (!this.enable)\r\n            return;\r\n        //DebugTxt.dTrace(\"onMouseMove:\"+touchID);\r\n        var preO: any;\r\n        preO = this.getTouchFromArr(touchID, this.preOvers);\r\n        var arrs: any[];\r\n\r\n        var tO: any;\r\n        if (!preO) {\r\n            //理论上不会发生，因为必然先有touchstart再有touchMove\r\n            arrs = this.getEles(ele, null, TouchManager._tEleArr);\r\n            this.sendEvents(arrs, Event.MOUSE_OVER);\r\n            this.preOvers.push(this.createTouchO(ele, touchID));\r\n        } else {\r\n            this.checkMouseOutAndOverOfMove(ele, preO.tar);\r\n            preO.tar = ele;\r\n            arrs = this.getEles(ele, null, TouchManager._tEleArr);\r\n        }\r\n\r\n        this.sendEvents(arrs, Event.MOUSE_MOVE);\r\n        this._clearTempArrs();\r\n    }\r\n\r\n    getLastOvers(): any[] {\r\n        TouchManager._tEleArr.length = 0;\r\n        if (this.preOvers.length > 0 && this.preOvers[0].tar) {\r\n            return this.getEles(this.preOvers[0].tar, null, TouchManager._tEleArr);\r\n        }\r\n        TouchManager._tEleArr.push(ILaya.stage);\r\n        return TouchManager._tEleArr;\r\n    }\r\n\r\n    stageMouseOut(): void {\r\n        var lastOvers: any[];\r\n        lastOvers = this.getLastOvers();\r\n        this.preOvers.length = 0;\r\n        this.sendEvents(lastOvers, Event.MOUSE_OUT);\r\n    }\r\n\r\n    /**\r\n     * 处理TouchEnd事件\r\n     * @param ele\t\t根节点\r\n     * @param touchID\ttouchID\r\n     * @param isLeft\t是否为左键\r\n     */\r\n    onMouseUp(ele: any, touchID: number, isLeft: boolean = false): void {\r\n        if (!this.enable)\r\n            return;\r\n        var preO: any;\r\n        var tO: any;\r\n        var arrs: any[];\r\n        var oldArr: any[];\r\n        var i: number, len: number;\r\n        var tar: Node;\r\n        var sendArr: any[];\r\n\r\n        var onMobile: boolean = Browser.onMobile;\r\n\r\n        //处理up\r\n        arrs = this.getEles(ele, null, TouchManager._tEleArr);\r\n        this.sendEvents(arrs, isLeft ? Event.MOUSE_UP : Event.RIGHT_MOUSE_UP);\r\n\r\n        //处理click\r\n        var preDowns: any[];\r\n        preDowns = isLeft ? this.preDowns : this.preRightDowns;\r\n        preO = this.getTouchFromArr(touchID, preDowns);\r\n        if (!preO) {\r\n\r\n        } else {\r\n            var isDouble: boolean;\r\n            var now: number = Browser.now();\r\n            isDouble = now - this._lastClickTime < 300;\r\n            this._lastClickTime = now;\r\n            if (ele == preO.tar) {\r\n                sendArr = arrs;\r\n            } else {\r\n                oldArr = this.getEles(preO.tar, null, TouchManager._oldArr);\r\n                sendArr = TouchManager._newArr;\r\n                sendArr.length = 0;\r\n                len = oldArr.length;\r\n                for (i = 0; i < len; i++) {\r\n                    tar = oldArr[i];\r\n                    if (arrs.indexOf(tar) >= 0) {\r\n                        sendArr.push(tar);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (sendArr.length > 0) {\r\n                this.sendEvents(sendArr, isLeft ? Event.CLICK : Event.RIGHT_CLICK);\r\n            }\r\n            if (isLeft && isDouble) {\r\n                this.sendEvents(sendArr, Event.DOUBLE_CLICK);\r\n            }\r\n            this.removeTouchFromArr(touchID, preDowns);\r\n            preO.tar = null;\r\n            Pool.recover(\"TouchData\", preO);\r\n        }\r\n\r\n        //处理out\r\n        preO = this.getTouchFromArr(touchID, this.preOvers);\r\n        if (!preO) {\r\n            //理论上不会发生，因为必然先有touchstart再有touchEnd\r\n        } else {\r\n            if (onMobile) {\r\n                sendArr = this.getEles(preO.tar, null, sendArr);\r\n                if (sendArr && sendArr.length > 0) {\r\n                    this.sendEvents(sendArr, Event.MOUSE_OUT);\r\n                }\r\n                this.removeTouchFromArr(touchID, this.preOvers);\r\n                preO.tar = null;\r\n                Pool.recover(\"TouchData\", preO);\r\n            }\r\n        }\r\n        this._clearTempArrs();\r\n    }\r\n}\r\n\r\n","import { Event } from \"./Event\";\r\nimport { TouchManager } from \"./TouchManager\";\r\nimport { Input } from \"../display/Input\"\r\nimport { Sprite } from \"../display/Sprite\"\r\nimport { Point } from \"../maths/Point\"\r\nimport { Rectangle } from \"../maths/Rectangle\"\r\nimport { Browser } from \"../utils/Browser\"\r\nimport { Stage } from \"../display/Stage\";\r\nimport { ILaya } from \"../../ILaya\";\r\n\r\n\r\n/**\r\n * <p><code>MouseManager</code> 是鼠标、触摸交互管理器。</p>\r\n * <p>鼠标事件流包括捕获阶段、目标阶段、冒泡阶段。<br/>\r\n * 捕获阶段：此阶段引擎会从stage开始递归检测stage及其子对象，直到找到命中的目标对象或者未命中任何对象；<br/>\r\n * 目标阶段：找到命中的目标对象；<br/>\r\n * 冒泡阶段：事件离开目标对象，按节点层级向上逐层通知，直到到达舞台的过程。</p>\r\n */\r\nexport class MouseManager {\r\n    /**\r\n     * MouseManager 单例引用。\r\n     */\r\n    static instance: MouseManager = new MouseManager();\r\n\r\n    /**是否开启鼠标检测，默认为true*/\r\n    static enabled: boolean = true;\r\n    /**是否开启多点触控*/\r\n    static multiTouchEnabled: boolean = true;\r\n    /** canvas 上的鼠标X坐标。*/\r\n    mouseX: number = 0;\r\n    /** canvas 上的鼠标Y坐标。*/\r\n    mouseY: number = 0;\r\n    /** 是否禁用除 stage 以外的鼠标事件检测。*/\r\n    disableMouseEvent: boolean = false;\r\n    /** 鼠标按下的时间。单位为毫秒。*/\r\n    mouseDownTime: number = 0;\r\n    /** 鼠标移动精度。*/\r\n    mouseMoveAccuracy: number = 2;\r\n    /** @private */\r\n    private static _isTouchRespond: boolean;\r\n    /** @internal */\r\n    _event: Event = new Event();\r\n    private _stage: Stage;\r\n\r\n    /** @private 希望capture鼠标事件的对象。*/\r\n    private _captureSp: Sprite = null;\r\n    /** @private 现在不支持直接把绝对坐标转到本地坐标，只能一级一级做下去，因此记录一下这个链*/\r\n    private _captureChain: Sprite[] = [];\r\n    /** @private capture对象独占消息 */\r\n    private _captureExlusiveMode: boolean = false;\r\n    /** @private 在发送事件的过程中，是否发送给了_captureSp */\r\n    private _hitCaputreSp: boolean = false;\r\n\r\n    private _point: Point = new Point();\r\n    private _rect: Rectangle = new Rectangle();\r\n    private _target: any;\r\n    private _lastMoveTimer: number = 0;\r\n    private _isLeftMouse: boolean;\r\n    private _prePoint: Point = new Point();\r\n    private _touchIDs: any = {};\r\n    private _curTouchID: number = NaN;\r\n    private _id: number = 1;\r\n    private static _isFirstTouch: boolean = true;\r\n    /**\r\n     * @private\r\n     * 初始化。\r\n     */\r\n    __init__(stage: Stage, canvas: any): void {\r\n        this._stage = stage;\r\n        var _this: MouseManager = this;\r\n        //var canvas:* = Render.canvas;\r\n\r\n        canvas.oncontextmenu = function (e: any): any {\r\n            if (MouseManager.enabled) return false;\r\n        }\r\n        canvas.addEventListener('mousedown', function (e: any): void {\r\n            if (MouseManager.enabled) {\r\n                if (!Browser.onIE)\r\n                    (e.cancelable) && (e.preventDefault());\r\n                _this.mouseDownTime = Browser.now();\r\n                _this.runEvent(e);\r\n            }\r\n        });\r\n        canvas.addEventListener('mouseup', function (e: any): void {\r\n            if (MouseManager.enabled) {\r\n                (e.cancelable) && (e.preventDefault());\r\n                _this.mouseDownTime = -Browser.now();\r\n                _this.runEvent(e);\r\n            }\r\n        }, true);\r\n        canvas.addEventListener('mousemove', function (e: any): void {\r\n            if (MouseManager.enabled) {\r\n                (e.cancelable) && (e.preventDefault());\r\n                var now: number = Browser.now();\r\n                if (now - _this._lastMoveTimer < 10) return;\r\n                _this._lastMoveTimer = now;\r\n                _this.runEvent(e);\r\n            }\r\n        }, true);\r\n        canvas.addEventListener(\"mouseout\", function (e: any): void {\r\n            if (MouseManager.enabled) _this.runEvent(e);\r\n        })\r\n        canvas.addEventListener(\"mouseover\", function (e: any): void {\r\n            if (MouseManager.enabled) _this.runEvent(e);\r\n        })\r\n        canvas.addEventListener(\"touchstart\", function (e: any): void {\r\n            if (MouseManager.enabled) {\r\n                if (!MouseManager._isFirstTouch && !Input.isInputting)\r\n                    (e.cancelable) && (e.preventDefault());\r\n                _this.mouseDownTime = Browser.now();\r\n                _this.runEvent(e);\r\n            }\r\n        });\r\n        canvas.addEventListener(\"touchend\", function (e: any): void {\r\n            if (MouseManager.enabled) {\r\n                if (!MouseManager._isFirstTouch && !Input.isInputting)\r\n                    (e.cancelable) && (e.preventDefault());\r\n                MouseManager._isFirstTouch = false;\r\n                _this.mouseDownTime = -Browser.now();\r\n                _this.runEvent(e);\r\n            } else {\r\n                _this._curTouchID = NaN;\r\n            }\r\n        }, true);\r\n        canvas.addEventListener(\"touchmove\", function (e: any): void {\r\n            if (MouseManager.enabled) {\r\n                (e.cancelable) && (e.preventDefault());\r\n                _this.runEvent(e);\r\n            }\r\n        }, true);\r\n        canvas.addEventListener(\"touchcancel\", function (e: any): void {\r\n            if (MouseManager.enabled) {\r\n                (e.cancelable) && (e.preventDefault());\r\n                _this.runEvent(e);\r\n            } else {\r\n                _this._curTouchID = NaN;\r\n            }\r\n        }, true);\r\n        canvas.addEventListener('mousewheel', function (e: any): void {\r\n            if (MouseManager.enabled) _this.runEvent(e);\r\n        });\r\n        canvas.addEventListener('DOMMouseScroll', function (e: any): void {\r\n            if (MouseManager.enabled) _this.runEvent(e);\r\n        });\r\n    }\r\n    private _tTouchID: number;\r\n\r\n    private initEvent(e: any, nativeEvent: any = null): void {\r\n        var _this: MouseManager = this;\r\n\r\n        _this._event._stoped = false;\r\n        _this._event.nativeEvent = nativeEvent || e;\r\n        _this._target = null;\r\n\r\n        this._point.setTo(e.pageX || e.clientX, e.pageY || e.clientY);\r\n        if (this._stage._canvasTransform) {\r\n            this._stage._canvasTransform.invertTransformPoint(this._point);\r\n            _this.mouseX = this._point.x;\r\n            _this.mouseY = this._point.y;\r\n        }\r\n\r\n        _this._event.touchId = e.identifier || 0;\r\n        this._tTouchID = _this._event.touchId;\r\n\r\n        var evt: Event;\r\n        evt = TouchManager.I._event;\r\n        evt._stoped = false;\r\n        evt.nativeEvent = _this._event.nativeEvent;\r\n        evt.touchId = _this._event.touchId;\r\n    }\r\n\r\n    private checkMouseWheel(e: any): void {\r\n        this._event.delta = e.wheelDelta ? e.wheelDelta * 0.025 : -e.detail;\r\n        var _lastOvers: any[] = TouchManager.I.getLastOvers();\r\n\r\n        for (var i: number = 0, n: number = _lastOvers.length; i < n; i++) {\r\n            var ele: any = _lastOvers[i];\r\n            ele.event(Event.MOUSE_WHEEL, this._event.setTo(Event.MOUSE_WHEEL, ele, this._target));\r\n        }\r\n        //\t\t\t_stage.event(Event.MOUSE_WHEEL, _event.setTo(Event.MOUSE_WHEEL, _stage, _target));\r\n    }\r\n\r\n    private onMouseMove(ele: any): void {\r\n\r\n        TouchManager.I.onMouseMove(ele, this._tTouchID);\r\n\r\n    }\r\n\r\n    private onMouseDown(ele: any): void {\r\n        if (Input.isInputting && ILaya.stage.focus && ILaya.stage.focus[\"focus\"] && !ILaya.stage.focus.contains(this._target)) {\r\n            // 从UI Input组件中取得Input引用\r\n            // _tf 是TextInput的属性\r\n            var pre_input: any = ILaya.stage.focus['_tf'] || ILaya.stage.focus;\r\n            var new_input: Input = ele['_tf'] || ele;\r\n\r\n            // 新的焦点是Input的情况下，不需要blur；\r\n            // 不过如果是Input和TextArea之间的切换，还是需要重新弹出输入法；\r\n            if (new_input instanceof Input && new_input.multiline == pre_input.multiline)\r\n                pre_input['_focusOut']();\r\n            else\r\n                pre_input.focus = false;\r\n        }\r\n        TouchManager.I.onMouseDown(ele, this._tTouchID, this._isLeftMouse);\r\n    }\r\n\r\n    private onMouseUp(ele: any): void {\r\n        TouchManager.I.onMouseUp(ele, this._tTouchID, this._isLeftMouse);\r\n    }\r\n\r\n    private check(sp: Sprite, mouseX: number, mouseY: number, callBack: Function): boolean {\r\n        this._point.setTo(mouseX, mouseY);\r\n        sp.fromParentPoint(this._point);\r\n        mouseX = this._point.x;\r\n        mouseY = this._point.y;\r\n\r\n        //如果有裁剪，则先判断是否在裁剪范围内\r\n        var scrollRect: Rectangle = sp._style.scrollRect;\r\n        if (scrollRect) {\r\n            this._rect.setTo(scrollRect.x, scrollRect.y, scrollRect.width, scrollRect.height);\r\n            if (!this._rect.contains(mouseX, mouseY)) return false;\r\n        }\r\n\r\n        //先判定子对象是否命中\r\n        if (!this.disableMouseEvent) {\r\n            //优先判断父对象\r\n            //默认情况下，hitTestPrior=mouseThrough=false，也就是优先check子对象\r\n            //$NEXTBIG:下个重大版本将sp.mouseThrough从此逻辑中去除，从而使得sp.mouseThrough只负责目标对象的穿透\r\n            if (sp.hitTestPrior && !sp.mouseThrough && !this.hitTest(sp, mouseX, mouseY)) {\r\n                return false;\r\n            }\r\n            for (var i: number = sp._children.length - 1; i > -1; i--) {\r\n                var child: Sprite = sp._children[i];\r\n                //只有接受交互事件的，才进行处理\r\n                if (!child.destroyed && child._mouseState > 1 && child._visible) {\r\n                    if (this.check(child, mouseX, mouseY, callBack)) return true;\r\n                }\r\n            }\r\n            // 检查逻辑子对象\r\n            for (i = sp._extUIChild.length - 1; i >= 0; i--) {\r\n                var c: Sprite = sp._extUIChild[i];\r\n                if (!c.destroyed && c._mouseState > 1 && c._visible) {\r\n                    if (this.check(c, mouseX, mouseY, callBack)) return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        //避免重复进行碰撞检测，考虑了判断条件的命中率。\r\n        var isHit: boolean = (sp.hitTestPrior && !sp.mouseThrough && !this.disableMouseEvent) ? true : this.hitTest(sp, mouseX, mouseY);\r\n\r\n        if (isHit) {\r\n            this._target = sp;\r\n            callBack.call(this, sp);\r\n            if (this._target == this._hitCaputreSp) {\r\n                this._hitCaputreSp = true;\r\n            }\r\n        } else if (callBack === this.onMouseUp && sp === this._stage) {\r\n            //如果stage外mouseUP\r\n            this._target = this._stage;\r\n            callBack.call(this, this._target);\r\n        }\r\n\r\n        return isHit;\r\n    }\r\n\r\n    private hitTest(sp: Sprite, mouseX: number, mouseY: number): boolean {\r\n        var isHit: boolean = false;\r\n        if (sp.scrollRect) {\r\n            mouseX -= sp._style.scrollRect.x;\r\n            mouseY -= sp._style.scrollRect.y;\r\n        }\r\n        var hitArea: any = sp._style.hitArea;\r\n        if (hitArea && hitArea._hit) {\r\n            return hitArea.contains(mouseX, mouseY);\r\n        }\r\n        if (sp.width > 0 && sp.height > 0 || sp.mouseThrough || hitArea) {\r\n            //判断是否在矩形区域内\r\n            if (!sp.mouseThrough) {\r\n                //MOD by liuzihao: saved call of 'hitRect' and 'this._rect' when 'sp.hitArea' is not null.\r\n                isHit = (hitArea ? hitArea : this._rect.setTo(0, 0, sp.width, sp.height)).contains(mouseX, mouseY);\r\n            } else {\r\n                //如果可穿透，则根据子对象实际大小进行碰撞\r\n                isHit = sp.getGraphicBounds().contains(mouseX, mouseY);\r\n            }\r\n        }\r\n        return isHit;\r\n    }\r\n\r\n\r\n    private _checkAllBaseUI(mousex: number, mousey: number, callback: Function): boolean {\r\n        var ret: boolean = this.handleExclusiveCapture(this.mouseX, this.mouseY, callback);\r\n        if (ret) return true;\r\n        ret = this.check(this._stage, this.mouseX, this.mouseY, callback);\r\n        //ret = check3DUI(mousex,mousey,callback) || ret;\t\t//在这里调结果不对，好像不会调用click\r\n        return this.handleCapture(this.mouseX, this.mouseY, callback) || ret;\r\n    }\r\n\r\n    /**\r\n     * 处理3d界面。\r\n     * @param\tmousex\r\n     * @param\tmousey\r\n     * @param\tcallback\r\n     * @return\r\n     */\r\n    check3DUI(mousex: number, mousey: number, callback: Function): boolean {\r\n        var uis: Sprite[] = this._stage._3dUI;\r\n        var i: number = 0;\r\n        var ret: boolean = false;\r\n        for (; i < uis.length; i++) {\r\n            var curui: Sprite = uis[i];\r\n            this._stage._curUIBase = curui;\r\n            if (!curui.destroyed && curui._mouseState > 1 && curui._visible) {\r\n                ret = ret || this.check(curui, this.mouseX, this.mouseY, callback);\r\n            }\r\n        }\r\n        this._stage._curUIBase = this._stage;\r\n        return ret;\r\n    }\r\n\r\n    handleExclusiveCapture(mousex: number, mousey: number, callback: Function): boolean {\r\n        if (this._captureExlusiveMode && this._captureSp && this._captureChain.length > 0) {\r\n            var cursp: Sprite;\r\n            // 坐标转到capture对象的相对坐标\r\n            this._point.setTo(mousex, mousey);\r\n            for (var i: number = 0; i < this._captureChain.length; i++) {\r\n                cursp = this._captureChain[i];\r\n                cursp.fromParentPoint(this._point);\r\n            }\r\n            this._target = cursp;\r\n            callback.call(this, cursp);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    handleCapture(mousex: number, mousey: number, callback: Function): boolean {\r\n        if (!this._hitCaputreSp && this._captureSp && this._captureChain.length > 0) {\r\n            var cursp: Sprite;\r\n            // 坐标转到capture对象的相对坐标\r\n            this._point.setTo(mousex, mousey);\r\n            for (var i: number = 0; i < this._captureChain.length; i++) {\r\n                cursp = this._captureChain[i];\r\n                cursp.fromParentPoint(this._point);\r\n            }\r\n            this._target = cursp;\r\n            callback.call(this, cursp);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 执行事件处理。\r\n     */\r\n    runEvent(evt: any): void {\r\n\r\n        var _this: MouseManager = this;\r\n        var i: number, n: number, touch: any;\r\n\r\n        if (evt.type !== 'mousemove') this._prePoint.x = this._prePoint.y = -1000000;\r\n\r\n        switch (evt.type) {\r\n            case 'mousedown':\r\n                this._touchIDs[0] = this._id++;\r\n                if (!MouseManager._isTouchRespond) {\r\n                    this._isLeftMouse = evt.button === 0;\r\n                    this.initEvent(evt);\r\n                    this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseDown);\r\n                } else\r\n                    MouseManager._isTouchRespond = false;\r\n                break;\r\n            case 'mouseup':\r\n                this._isLeftMouse = evt.button === 0;\r\n                this.initEvent(evt);\r\n                this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseUp);\r\n                break;\r\n            case 'mousemove':\r\n                if ((Math.abs(this._prePoint.x - evt.clientX) + Math.abs(this._prePoint.y - evt.clientY)) >= this.mouseMoveAccuracy) {\r\n                    this._prePoint.x = evt.clientX;\r\n                    this._prePoint.y = evt.clientY;\r\n                    this.initEvent(evt);\r\n                    this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseMove);\r\n                    //\t\t\t\t\t\tcheckMouseOut();\r\n                }\r\n                break;\r\n            case \"touchstart\":\r\n                MouseManager._isTouchRespond = true;\r\n                this._isLeftMouse = true;\r\n                var touches: any[] = evt.changedTouches;\r\n                for (i = 0, n = touches.length; i < n; i++) {\r\n                    touch = touches[i];\r\n                    //是否禁用多点触控\r\n                    if (MouseManager.multiTouchEnabled || isNaN(this._curTouchID)) {\r\n                        this._curTouchID = touch.identifier;\r\n                        //200次点击清理一下id资源\r\n                        if (this._id % 200 === 0) this._touchIDs = {};\r\n                        this._touchIDs[touch.identifier] = this._id++;\r\n                        this.initEvent(touch, evt);\r\n                        this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseDown);\r\n                    }\r\n                }\r\n\r\n                break;\r\n            case \"touchend\":\r\n            case \"touchcancel\":\r\n                MouseManager._isTouchRespond = true;\r\n                this._isLeftMouse = true;\r\n                var touchends: any[] = evt.changedTouches;\r\n                for (i = 0, n = touchends.length; i < n; i++) {\r\n                    touch = touchends[i];\r\n                    //是否禁用多点触控\r\n                    if (MouseManager.multiTouchEnabled || touch.identifier == this._curTouchID) {\r\n                        this._curTouchID = NaN;\r\n                        this.initEvent(touch, evt);\r\n                        var isChecked: boolean;\r\n                        isChecked = this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseUp);\r\n                        if (!isChecked) {\r\n                            this.onMouseUp(null);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                break;\r\n            case \"touchmove\":\r\n                var touchemoves: any[] = evt.changedTouches;\r\n                for (i = 0, n = touchemoves.length; i < n; i++) {\r\n                    touch = touchemoves[i];\r\n                    //是否禁用多点触控\r\n                    if (MouseManager.multiTouchEnabled || touch.identifier == this._curTouchID) {\r\n                        this.initEvent(touch, evt);\r\n                        this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseMove);\r\n                    }\r\n                }\r\n                break;\r\n            case \"wheel\":\r\n            case \"mousewheel\":\r\n            case \"DOMMouseScroll\":\r\n                this.checkMouseWheel(evt);\r\n                break;\r\n            case \"mouseout\":\r\n                //_stage.event(Event.MOUSE_OUT, _event.setTo(Event.MOUSE_OUT, _stage, _stage));\r\n                TouchManager.I.stageMouseOut();\r\n                break;\r\n            case \"mouseover\":\r\n                this._stage.event(Event.MOUSE_OVER, this._event.setTo(Event.MOUSE_OVER, this._stage, this._stage));\r\n                break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param\tsp\r\n     * @param\texlusive  是否是独占模式\r\n     */\r\n    setCapture(sp: Sprite, exclusive: boolean = false): void {\r\n        this._captureSp = sp;\r\n        this._captureExlusiveMode = exclusive;\r\n        this._captureChain.length = 0;\r\n        this._captureChain.push(sp);\r\n        var cursp: Sprite = sp;\r\n        while (true) {\r\n            if (cursp == ILaya.stage) break;\r\n            if (cursp == ILaya.stage._curUIBase) break;\r\n            cursp = (<Sprite>cursp.parent);\r\n            if (!cursp) break;\r\n            this._captureChain.splice(0, 0, cursp);\r\n        }\r\n    }\r\n\r\n    releaseCapture(): void {\r\n        console.log('release capture');\r\n        this._captureSp = null;\r\n    }\r\n}\r\n\r\n","import { ILaya } from \"../../ILaya\";\r\n/**\r\n\t * @private\r\n\t */\r\nexport class CallLater {\r\n    static I = new CallLater();\r\n    /**@private */\r\n    private _pool: LaterHandler[] = [];\r\n    /**@private */\r\n    private _map: {[key:string]:LaterHandler} = {};\r\n    /**@private */\r\n    private _laters: LaterHandler[] = [];\r\n\r\n    /**\r\n     * @internal\r\n     * 帧循环处理函数。\r\n     */\r\n    _update(): void {\r\n        let laters = this._laters;\r\n        let len = laters.length;\r\n        if (len > 0) {\r\n            for (let i = 0, n = len - 1; i <= n; i++) {\r\n                let handler = laters[i];\r\n                this._map[handler.key] = null;\r\n                if (handler.method !== null) {\r\n                    handler.run();\r\n                    handler.clear();\r\n                }\r\n                this._pool.push(handler);\r\n                i === n && (n = laters.length - 1);\r\n            }\r\n            laters.length = 0;\r\n        }\r\n    }\r\n\r\n    /** @private */\r\n    private _getHandler(caller: any, method: any): LaterHandler {\r\n        var cid: number = caller ? caller.$_GID || (caller.$_GID = ILaya.Utils.getGID()) : 0;\r\n        var mid: number = method.$_TID || (method.$_TID = (ILaya.Timer._mid++) );\r\n        return this._map[cid+'.'+mid]\r\n    }\r\n\r\n    /**\r\n     * 延迟执行。\r\n     * @param\tcaller 执行域(this)。\r\n     * @param\tmethod 定时器回调函数。\r\n     * @param\targs 回调参数。\r\n     */\r\n    callLater(caller: any, method: Function, args: any[] = null): void {\r\n        if (this._getHandler(caller, method) == null) {\r\n            let handler:LaterHandler;\r\n            if (this._pool.length)\r\n                handler  = this._pool.pop();\r\n            else \r\n                handler = new LaterHandler();\r\n            //设置属性\r\n            handler.caller = caller;\r\n            handler.method = method;\r\n            handler.args = args;\r\n            //索引handler\r\n            var cid: number = caller ? caller.$_GID : 0;\r\n            var mid: number = method[\"$_TID\"];\r\n            handler.key = cid +'.'+ mid;\r\n            this._map[handler.key] = handler\r\n            //插入队列\r\n            this._laters.push(handler);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 立即执行 callLater 。\r\n     * @param\tcaller 执行域(this)。\r\n     * @param\tmethod 定时器回调函数。\r\n     */\r\n    runCallLater(caller: any, method: Function): void {\r\n        var handler = this._getHandler(caller, method);\r\n        if (handler && handler.method != null) {\r\n            this._map[handler.key] = null;\r\n            handler.run();\r\n            handler.clear();\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n/** @private */\r\nclass LaterHandler {\r\n    key: string;\r\n    caller: any\r\n    method: Function;\r\n    args: any[];\r\n\r\n    clear(): void {\r\n        this.caller = null;\r\n        this.method = null;\r\n        this.args = null;\r\n    }\r\n\r\n    run(): void {\r\n        var caller = this.caller;\r\n        if (caller && caller.destroyed) return this.clear();\r\n        var method = this.method;\r\n        var args = this.args;\r\n        if (method == null) return;\r\n        args ? method.apply(caller, args) : method.call(caller);\r\n    }\r\n}\r\n","import { WebGL } from \"../webgl/WebGL\"\r\n\r\n\r\n/**\r\n * @private\r\n */\r\nexport class RunDriver {\r\n    //TODO:coverage\r\n    static createShaderCondition: Function = function (conditionScript: string): Function {\r\n        var fn: string = \"(function() {return \" + conditionScript + \";})\";\r\n        return (window as any).Laya._runScript(fn);//生成条件判断函数\r\n    }\r\n\r\n\r\n    /**\r\n     * 用于改变 WebGL宽高信息。\r\n     */\r\n    static changeWebGLSize: Function = function (w: number, h: number): void {\r\n        WebGL.onStageResize(w, h);\r\n    }\r\n}\r\n\r\n\r\n","import { Sprite } from \"./Sprite\";\r\nimport { Node } from \"./Node\";\r\nimport { Config } from \"./../../Config\";\r\nimport { Input } from \"./Input\";\r\nimport { SpriteConst } from \"./SpriteConst\";\r\nimport { Const } from \"../Const\"\r\nimport { Event } from \"../events/Event\"\r\nimport { MouseManager } from \"../events/MouseManager\"\r\nimport { Matrix } from \"../maths/Matrix\"\r\nimport { Point } from \"../maths/Point\"\r\nimport { Render } from \"../renders/Render\"\r\nimport { RenderInfo } from \"../renders/RenderInfo\"\r\nimport { Context } from \"../resource/Context\"\r\nimport { HTMLCanvas } from \"../resource/HTMLCanvas\"\r\nimport { Browser } from \"../utils/Browser\"\r\nimport { CallLater } from \"../utils/CallLater\"\r\nimport { ColorUtils } from \"../utils/ColorUtils\"\r\nimport { RunDriver } from \"../utils/RunDriver\"\r\nimport { VectorGraphManager } from \"../utils/VectorGraphManager\"\r\nimport { RenderState2D } from \"../webgl/utils/RenderState2D\";\r\nimport { WebGLContext } from \"../webgl/WebGLContext\";\r\nimport { Stat } from \"../utils/Stat\";\r\nimport { Timer } from \"../utils/Timer\";\r\nimport { ILaya } from \"../../ILaya\";\r\nimport { LayaGL } from \"../layagl/LayaGL\";\r\nimport { ClassUtils } from \"../utils/ClassUtils\";\r\n\r\n/**\r\n * stage大小经过重新调整时进行调度。\r\n * @eventType Event.RESIZE\r\n */\r\n/*[Event(name = \"resize\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 舞台获得焦点时调度。比如浏览器或者当前标签处于后台，重新切换回来时进行调度。\r\n * @eventType Event.FOCUS\r\n */\r\n/*[Event(name = \"focus\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 舞台失去焦点时调度。比如浏览器或者当前标签被切换到后台后调度。\r\n * @eventType Event.BLUR\r\n */\r\n/*[Event(name = \"blur\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 舞台焦点变化时调度，使用Laya.stage.isFocused可以获取当前舞台是否获得焦点。\r\n * @eventType Event.FOCUS_CHANGE\r\n */\r\n/*[Event(name = \"focuschange\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 舞台可见性发生变化时调度（比如浏览器或者当前标签被切换到后台后调度），使用Laya.stage.isVisibility可以获取当前是否处于显示状态。\r\n * @eventType Event.VISIBILITY_CHANGE\r\n */\r\n/*[Event(name = \"visibilitychange\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 浏览器全屏更改时调度，比如进入全屏或者退出全屏。\r\n * @eventType Event.FULL_SCREEN_CHANGE\r\n */\r\n/*[Event(name = \"fullscreenchange\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * <p> <code>Stage</code> 是舞台类，显示列表的根节点，所有显示对象都在舞台上显示。通过 Laya.stage 单例访问。</p>\r\n * <p>Stage提供几种适配模式，不同的适配模式会产生不同的画布大小，画布越大，渲染压力越大，所以要选择合适的适配方案。</p>\r\n * <p>Stage提供不同的帧率模式，帧率越高，渲染压力越大，越费电，合理使用帧率甚至动态更改帧率有利于改进手机耗电。</p>\r\n */\r\nexport class Stage extends Sprite {\r\n\t/**应用保持设计宽高不变，不缩放不变形，stage的宽高等于设计宽高。*/\r\n\tstatic SCALE_NOSCALE: string = \"noscale\";\r\n\t/**应用根据屏幕大小铺满全屏，非等比缩放会变形，stage的宽高等于设计宽高。*/\r\n\tstatic SCALE_EXACTFIT: string = \"exactfit\";\r\n\t/**应用显示全部内容，按照最小比率缩放，等比缩放不变形，一边可能会留空白，stage的宽高等于设计宽高。*/\r\n\tstatic SCALE_SHOWALL: string = \"showall\";\r\n\t/**应用按照最大比率缩放显示，宽或高方向会显示一部分，等比缩放不变形，stage的宽高等于设计宽高。*/\r\n\tstatic SCALE_NOBORDER: string = \"noborder\";\r\n\t/**应用保持设计宽高不变，不缩放不变形，stage的宽高等于屏幕宽高。*/\r\n\tstatic SCALE_FULL: string = \"full\";\r\n\t/**应用保持设计宽度不变，高度根据屏幕比缩放，stage的宽度等于设计高度，高度根据屏幕比率大小而变化*/\r\n\tstatic SCALE_FIXED_WIDTH: string = \"fixedwidth\";\r\n\t/**应用保持设计高度不变，宽度根据屏幕比缩放，stage的高度等于设计宽度，宽度根据屏幕比率大小而变化*/\r\n\tstatic SCALE_FIXED_HEIGHT: string = \"fixedheight\";\r\n\t/**应用保持设计比例不变，全屏显示全部内容(类似showall，但showall非全屏，会有黑边)，根据屏幕长宽比，自动选择使用SCALE_FIXED_WIDTH或SCALE_FIXED_HEIGHT*/\r\n\tstatic SCALE_FIXED_AUTO: string = \"fixedauto\";\r\n\r\n\t/**画布水平居左对齐。*/\r\n\tstatic ALIGN_LEFT: string = \"left\";\r\n\t/**画布水平居右对齐。*/\r\n\tstatic ALIGN_RIGHT: string = \"right\";\r\n\t/**画布水平居中对齐。*/\r\n\tstatic ALIGN_CENTER: string = \"center\";\r\n\t/**画布垂直居上对齐。*/\r\n\tstatic ALIGN_TOP: string = \"top\";\r\n\t/**画布垂直居中对齐。*/\r\n\tstatic ALIGN_MIDDLE: string = \"middle\";\r\n\t/**画布垂直居下对齐。*/\r\n\tstatic ALIGN_BOTTOM: string = \"bottom\";\r\n\r\n\t/**不更改屏幕。*/\r\n\tstatic SCREEN_NONE: string = \"none\";\r\n\t/**自动横屏。*/\r\n\tstatic SCREEN_HORIZONTAL: string = \"horizontal\";\r\n\t/**自动竖屏。*/\r\n\tstatic SCREEN_VERTICAL: string = \"vertical\";\r\n\r\n\t/**全速模式，以60的帧率运行。*/\r\n\tstatic FRAME_FAST: string = \"fast\";\r\n\t/**慢速模式，以30的帧率运行。*/\r\n\tstatic FRAME_SLOW: string = \"slow\";\r\n\t/**自动模式，以30的帧率运行，但鼠标活动后会自动加速到60，鼠标不动2秒后降低为30帧，以节省消耗。*/\r\n\tstatic FRAME_MOUSE: string = \"mouse\";\r\n\t/**休眠模式，以1的帧率运行*/\r\n\tstatic FRAME_SLEEP: string = \"sleep\";\r\n\r\n\t/**当前焦点对象，此对象会影响当前键盘事件的派发主体。*/\r\n\tfocus: Node;\r\n\t/**@private 相对浏览器左上角的偏移，弃用，请使用_canvasTransform。*/\r\n\toffset: Point = new Point();\r\n\t/**帧率类型，支持三种模式：fast-60帧(默认)，slow-30帧，mouse-30帧（鼠标活动后会自动加速到60，鼠标不动2秒后降低为30帧，以节省消耗），sleep-1帧。*/\r\n\tprivate _frameRate: string = \"fast\";\r\n\t/**设计宽度（初始化时设置的宽度Laya.init(width,height)）*/\r\n\tdesignWidth: number = 0;\r\n\t/**设计高度（初始化时设置的高度Laya.init(width,height)）*/\r\n\tdesignHeight: number = 0;\r\n\t/**画布是否发生翻转。*/\r\n\tcanvasRotation: boolean = false;\r\n\t/**画布的旋转角度。*/\r\n\tcanvasDegree: number = 0;\r\n\t/**\r\n\t * <p>设置是否渲染，设置为false，可以停止渲染，画面会停留到最后一次渲染上，减少cpu消耗，此设置不影响时钟。</p>\r\n\t * <p>比如非激活状态，可以设置renderingEnabled=false以节省消耗。</p>\r\n\t * */\r\n\trenderingEnabled: boolean = true;\r\n\t/**是否启用屏幕适配，可以适配后，在某个时候关闭屏幕适配，防止某些操作导致的屏幕意外改变*/\r\n\tscreenAdaptationEnabled: boolean = true;\r\n\t/**@internal */\r\n\t_canvasTransform: Matrix = new Matrix();\r\n\t/**@private */\r\n\tprivate _screenMode: string = \"none\";\r\n\t/**@private */\r\n\tprivate _scaleMode: string = \"noscale\";\r\n\t/**@private */\r\n\tprivate _alignV: string = \"top\";\r\n\t/**@private */\r\n\tprivate _alignH: string = \"left\";\r\n\t/**@private */\r\n\tprivate _bgColor: string = \"black\";\r\n\t/**@private */\r\n\tprivate _mouseMoveTime: number = 0;\r\n\t/**@private */\r\n\tprivate _renderCount: number = 0;\r\n\t/**@private */\r\n\tprivate _safariOffsetY: number = 0;\r\n\t/**@private */\r\n\tprivate _frameStartTime: number = 0;\r\n\t/**@private */\r\n\tprivate _previousOrientation: number = Browser.window.orientation;\r\n\t/**@private */\r\n\tprivate _isFocused: boolean;\r\n\t/**@private */\r\n\tprivate _isVisibility: boolean;\r\n\t/**@internal webgl Color*/\r\n\t_wgColor: number[]|null = [0, 0, 0, 1];\r\n\t/**@internal */\r\n\t_scene3Ds: any[] = [];\r\n\r\n\t/**@private */\r\n\tprivate _globalRepaintSet: boolean = false;\t\t// 设置全局重画标志。这个是给IDE用的。IDE的Image无法在onload的时候通知对应的sprite重画。\r\n\t/**@private */\r\n\tprivate _globalRepaintGet: boolean = false;\t\t// 一个get一个set是为了把标志延迟到下一帧的开始，防止部分对象接收不到。\r\n\r\n\t/**@internal */\r\n\t_3dUI: Sprite[] = [];\r\n\t/**@internal */\r\n\t_curUIBase: Sprite|null = null; \t\t// 给鼠标事件capture用的。用来找到自己的根。因为3d界面的根不是stage（界面链会被3d对象打断）\r\n\t/**使用物理分辨率作为canvas大小，会改进渲染效果，但是会降低性能*/\r\n\tuseRetinalCanvas: boolean = false;\r\n\t/**场景类，引擎中只有一个stage实例，此实例可以通过Laya.stage访问。*/\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tsuper.set_transform(this._createTransform());\r\n\t\t//重置默认值，请不要修改\r\n\t\tthis.mouseEnabled = true;\r\n\t\tthis.hitTestPrior = true;\r\n\t\tthis.autoSize = false;\r\n\t\tthis._setBit(Const.DISPLAYED_INSTAGE, true);\r\n\t\tthis._setBit(Const.ACTIVE_INHIERARCHY, true);\r\n\t\tthis._isFocused = true;\r\n\t\tthis._isVisibility = true;\r\n\r\n\t\t//this.drawCallOptimize=true;\r\n\t\tthis.useRetinalCanvas = Config.useRetinalCanvas;\r\n\r\n\t\tvar window: any = Browser.window;\r\n\t\t//var _me = this;\t\r\n\r\n\t\twindow.addEventListener(\"focus\", ()=>{\r\n\t\t\tthis._isFocused = true;\r\n\t\t\tthis.event(Event.FOCUS);\r\n\t\t\tthis.event(Event.FOCUS_CHANGE);\r\n\t\t});\r\n\t\twindow.addEventListener(\"blur\", ()=> {\r\n\t\t\tthis._isFocused = false;\r\n\t\t\tthis.event(Event.BLUR);\r\n\t\t\tthis.event(Event.FOCUS_CHANGE);\r\n\t\t\tif (this._isInputting()) Input[\"inputElement\"].target.focus = false;\r\n\t\t});\r\n\r\n\t\t// 各种浏览器兼容\r\n\t\tvar state = \"visibilityState\", visibilityChange = \"visibilitychange\";\r\n\t\tvar document: any = window.document;\r\n\t\tif (typeof document.hidden !== \"undefined\") {\r\n\t\t\tvisibilityChange = \"visibilitychange\";\r\n\t\t\tstate = \"visibilityState\";\r\n\t\t} else if (typeof document.mozHidden !== \"undefined\") {\r\n\t\t\tvisibilityChange = \"mozvisibilitychange\";\r\n\t\t\tstate = \"mozVisibilityState\";\r\n\t\t} else if (typeof document.msHidden !== \"undefined\") {\r\n\t\t\tvisibilityChange = \"msvisibilitychange\";\r\n\t\t\tstate = \"msVisibilityState\";\r\n\t\t} else if (typeof document.webkitHidden !== \"undefined\") {\r\n\t\t\tvisibilityChange = \"webkitvisibilitychange\";\r\n\t\t\tstate = \"webkitVisibilityState\";\r\n\t\t}\r\n\r\n\t\twindow.document.addEventListener(visibilityChange, ()=> {\r\n\t\t\tif (Browser.document[state] == \"hidden\") {\r\n\t\t\t\tthis._isVisibility = false;\r\n\t\t\t\tif (this._isInputting()) Input[\"inputElement\"].target.focus = false;\r\n\t\t\t} else {\r\n\t\t\t\tthis._isVisibility = true;\r\n\t\t\t}\r\n\t\t\tthis.renderingEnabled = this._isVisibility;\r\n\t\t\tthis.event(Event.VISIBILITY_CHANGE);\r\n\t\t});\r\n\t\twindow.addEventListener(\"resize\", ()=> {\r\n\t\t\t// 处理屏幕旋转。旋转后收起输入法。\r\n\t\t\tvar orientation: any = Browser.window.orientation;\r\n\t\t\tif (orientation != null && orientation != this._previousOrientation && this._isInputting()) {\r\n\t\t\t\tInput[\"inputElement\"].target.focus = false;\r\n\t\t\t}\r\n\t\t\tthis._previousOrientation = orientation;\r\n\r\n\t\t\t// 弹出输入法不应对画布进行resize。\r\n\t\t\tif (this._isInputting()) return;\r\n\r\n\t\t\t// Safari横屏工具栏偏移\r\n\t\t\tif (Browser.onSafari)\r\n\t\t\t\tthis._safariOffsetY = (Browser.window.__innerHeight || Browser.document.body.clientHeight || Browser.document.documentElement.clientHeight) - Browser.window.innerHeight;\r\n\r\n\t\t\tthis._resetCanvas();\r\n\t\t});\r\n\r\n\t\t// 微信的iframe不触发orientationchange。\r\n\t\twindow.addEventListener(\"orientationchange\", (e: any)=>{\r\n\t\t\tthis._resetCanvas();\r\n\t\t});\r\n\r\n\t\tthis.on(Event.MOUSE_MOVE, this, this._onmouseMove);\r\n\t\tif (Browser.onMobile) this.on(Event.MOUSE_DOWN, this, this._onmouseMove);\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t * 在移动端输入时，输入法弹出期间不进行画布尺寸重置。\r\n\t */\r\n\tprivate _isInputting(): boolean {\r\n\t\treturn (Browser.onMobile && Input.isInputting);\r\n\t}\r\n\r\n\t/**@inheritDoc @override*/\r\n\tset width(value: number) {\r\n\t\tthis.designWidth = value;\r\n\t\tsuper.set_width(value);\r\n\t\tILaya.systemTimer.callLater(this, this._changeCanvasSize);\r\n\t}\r\n\t/**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n\tget width(): number {\r\n\t\treturn super.get_width();\r\n\t}\r\n\r\n\t/**@inheritDoc @override */\r\n\tset height(value: number) {\r\n\t\tthis.designHeight = value;\r\n\t\tsuper.set_height(value);\r\n\t\tILaya.systemTimer.callLater(this, this._changeCanvasSize);\r\n\t}\r\n\r\n\t/** @override*/  \r\n\tget height(): number {\r\n\t\treturn super.get_height();\r\n\t}\r\n\r\n\t/**@override*/\r\n\tset transform(value: Matrix) {\r\n\t\tsuper.set_transform(value);\r\n\t}\r\n\t/**@inheritDoc @override*/ \r\n\tget transform(): Matrix {\r\n\t\tif (this._tfChanged) this._adjustTransform();\r\n\t\treturn (this._transform = this._transform || this._createTransform());\r\n\t}\r\n\r\n\t/**\r\n\t * 舞台是否获得焦点。\r\n\t */\r\n\tget isFocused(): boolean {\r\n\t\treturn this._isFocused;\r\n\t}\r\n\r\n\t/**\r\n\t * 舞台是否处于可见状态(是否进入后台)。\r\n\t */\r\n\tget isVisibility(): boolean {\r\n\t\treturn this._isVisibility;\r\n\t}\r\n\r\n\t/**@private */\r\n\tprivate _changeCanvasSize(): void {\r\n\t\tthis.setScreenSize(Browser.clientWidth * Browser.pixelRatio, Browser.clientHeight * Browser.pixelRatio);\r\n\t}\r\n\r\n\t/**@private */\r\n\tprotected _resetCanvas(): void {\r\n\t\tif (!this.screenAdaptationEnabled) return;\r\n\t\t//var canvas:HTMLCanvas = Render._mainCanvas;\r\n\t\t//var canvasStyle:* = canvas.source.style;\r\n\t\t//canvas.size(1, 1);\r\n\t\t//canvasStyle.transform = canvasStyle.webkitTransform = canvasStyle.msTransform = canvasStyle.mozTransform = canvasStyle.oTransform = \"\";\r\n\t\t//visible = false;\r\n\t\t//Laya.timer.once(100, this, this._changeCanvasSize);\r\n\t\tthis._changeCanvasSize();\r\n\t}\r\n\r\n\t/**\r\n\t * 设置屏幕大小，场景会根据屏幕大小进行适配。可以动态调用此方法，来更改游戏显示的大小。\r\n\t * @param\tscreenWidth\t\t屏幕宽度。\r\n\t * @param\tscreenHeight\t屏幕高度。\r\n\t */\r\n\tsetScreenSize(screenWidth: number, screenHeight: number): void {\r\n\t\t//计算是否旋转\r\n\t\tvar rotation: boolean = false;\r\n\t\tif (this._screenMode !== Stage.SCREEN_NONE) {\r\n\t\t\tvar screenType: string = screenWidth / screenHeight < 1 ? Stage.SCREEN_VERTICAL : Stage.SCREEN_HORIZONTAL;\r\n\t\t\trotation = screenType !== this._screenMode;\r\n\t\t\tif (rotation) {\r\n\t\t\t\t//宽高互换\r\n\t\t\t\tvar temp: number = screenHeight;\r\n\t\t\t\tscreenHeight = screenWidth;\r\n\t\t\t\tscreenWidth = temp;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.canvasRotation = rotation;\r\n\r\n\t\tvar canvas: HTMLCanvas = Render._mainCanvas;\r\n\t\tvar canvasStyle: any = canvas.source.style;\r\n\t\tvar mat: Matrix = this._canvasTransform.identity();\r\n\t\tvar scaleMode: string = this._scaleMode;\r\n\t\tvar scaleX: number = screenWidth / this.designWidth\r\n\t\tvar scaleY: number = screenHeight / this.designHeight;\r\n\t\tvar canvasWidth: number = this.useRetinalCanvas ? screenWidth : this.designWidth;\r\n\t\tvar canvasHeight: number = this.useRetinalCanvas ? screenHeight : this.designHeight;\r\n\t\tvar realWidth: number = screenWidth;\r\n\t\tvar realHeight: number = screenHeight;\r\n\t\tvar pixelRatio: number = Browser.pixelRatio;\r\n\t\tthis._width = this.designWidth;\r\n\t\tthis._height = this.designHeight;\r\n\r\n\t\t//处理缩放模式\r\n\t\tswitch (scaleMode) {\r\n\t\t\tcase Stage.SCALE_NOSCALE:\r\n\t\t\t\tscaleX = scaleY = 1;\r\n\t\t\t\trealWidth = this.designWidth;\r\n\t\t\t\trealHeight = this.designHeight;\r\n\t\t\t\tbreak;\r\n\t\t\tcase Stage.SCALE_SHOWALL:\r\n\t\t\t\tscaleX = scaleY = Math.min(scaleX, scaleY);\r\n\t\t\t\tcanvasWidth = realWidth = Math.round(this.designWidth * scaleX);\r\n\t\t\t\tcanvasHeight = realHeight = Math.round(this.designHeight * scaleY);\r\n\t\t\t\tbreak;\r\n\t\t\tcase Stage.SCALE_NOBORDER:\r\n\t\t\t\tscaleX = scaleY = Math.max(scaleX, scaleY);\r\n\t\t\t\trealWidth = Math.round(this.designWidth * scaleX);\r\n\t\t\t\trealHeight = Math.round(this.designHeight * scaleY);\r\n\t\t\t\tbreak;\r\n\t\t\tcase Stage.SCALE_FULL:\r\n\t\t\t\tscaleX = scaleY = 1;\r\n\t\t\t\tthis._width = canvasWidth = screenWidth;\r\n\t\t\t\tthis._height = canvasHeight = screenHeight;\r\n\t\t\t\tbreak;\r\n\t\t\tcase Stage.SCALE_FIXED_WIDTH:\r\n\t\t\t\tscaleY = scaleX;\r\n\t\t\t\tthis._height = canvasHeight = Math.round(screenHeight / scaleX);\r\n\t\t\t\tbreak;\r\n\t\t\tcase Stage.SCALE_FIXED_HEIGHT:\r\n\t\t\t\tscaleX = scaleY;\r\n\t\t\t\tthis._width = canvasWidth = Math.round(screenWidth / scaleY);\r\n\t\t\t\tbreak;\r\n\t\t\tcase Stage.SCALE_FIXED_AUTO:\r\n\t\t\t\tif ((screenWidth / screenHeight) < (this.designWidth / this.designHeight)) {\r\n\t\t\t\t\tscaleY = scaleX;\r\n\t\t\t\t\tthis._height = canvasHeight = Math.round(screenHeight / scaleX);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tscaleX = scaleY;\r\n\t\t\t\t\tthis._width = canvasWidth = Math.round(screenWidth / scaleY);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (this.useRetinalCanvas) {\r\n\t\t\trealWidth =  canvasWidth = screenWidth;\r\n\t\t\trealHeight = canvasHeight = screenHeight;\r\n\t\t}\r\n\r\n\t\t//根据不同尺寸缩放stage画面\r\n\t\tscaleX *= this.scaleX;\r\n\t\tscaleY *= this.scaleY;\r\n\t\tif (scaleX === 1 && scaleY === 1) {\r\n\t\t\tthis.transform.identity();\r\n\t\t} else {\r\n\t\t\tthis.transform.a = this._formatData(scaleX / (realWidth / canvasWidth));\r\n\t\t\tthis.transform.d = this._formatData(scaleY / (realHeight / canvasHeight));\r\n\t\t}\r\n\r\n\t\t//处理canvas大小\t\t\t\r\n\t\tcanvas.size(canvasWidth, canvasHeight);\r\n\t\tRunDriver.changeWebGLSize(canvasWidth, canvasHeight);\r\n\t\tmat.scale(realWidth / canvasWidth / pixelRatio, realHeight / canvasHeight / pixelRatio);\r\n\r\n\t\t//处理水平对齐\r\n\t\tif (this._alignH === Stage.ALIGN_LEFT) this.offset.x = 0;\r\n\t\telse if (this._alignH === Stage.ALIGN_RIGHT) this.offset.x = screenWidth - realWidth;\r\n\t\telse this.offset.x = (screenWidth - realWidth) * 0.5 / pixelRatio;\r\n\r\n\t\t//处理垂直对齐\r\n\t\tif (this._alignV === Stage.ALIGN_TOP) this.offset.y = 0;\r\n\t\telse if (this._alignV === Stage.ALIGN_BOTTOM) this.offset.y = screenHeight - realHeight;\r\n\t\telse this.offset.y = (screenHeight - realHeight) * 0.5 / pixelRatio;\r\n\r\n\t\t//处理用户自行设置的画布偏移\r\n\t\tthis.offset.x = Math.round(this.offset.x);\r\n\t\tthis.offset.y = Math.round(this.offset.y);\r\n\t\tmat.translate(this.offset.x, this.offset.y);\r\n\t\tif (this._safariOffsetY) mat.translate(0, this._safariOffsetY);\r\n\r\n\t\t//处理横竖屏\r\n\t\tthis.canvasDegree = 0;\r\n\t\tif (rotation) {\r\n\t\t\tif (this._screenMode === Stage.SCREEN_HORIZONTAL) {\r\n\t\t\t\tmat.rotate(Math.PI / 2);\r\n\t\t\t\tmat.translate(screenHeight / pixelRatio, 0);\r\n\t\t\t\tthis.canvasDegree = 90;\r\n\t\t\t} else {\r\n\t\t\t\tmat.rotate(-Math.PI / 2);\r\n\t\t\t\tmat.translate(0, screenWidth / pixelRatio);\r\n\t\t\t\tthis.canvasDegree = -90;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tmat.a = this._formatData(mat.a);\r\n\t\tmat.d = this._formatData(mat.d);\r\n\t\tmat.tx = this._formatData(mat.tx);\r\n\t\tmat.ty = this._formatData(mat.ty);\r\n\r\n\t\tsuper.set_transform(this.transform);\r\n\t\tcanvasStyle.transformOrigin = canvasStyle.webkitTransformOrigin = canvasStyle.msTransformOrigin = canvasStyle.mozTransformOrigin = canvasStyle.oTransformOrigin = \"0px 0px 0px\";\r\n\t\tcanvasStyle.transform = canvasStyle.webkitTransform = canvasStyle.msTransform = canvasStyle.mozTransform = canvasStyle.oTransform = \"matrix(\" + mat.toString() + \")\";\r\n\t\t//修正用户自行设置的偏移\r\n\t\tif (this._safariOffsetY) mat.translate(0, -this._safariOffsetY);\r\n\t\tmat.translate(parseInt(canvasStyle.left) || 0, parseInt(canvasStyle.top) || 0);\r\n\t\tthis.visible = true;\r\n\t\tthis._repaint |= SpriteConst.REPAINT_CACHE;\r\n\t\tthis.event(Event.RESIZE);\r\n\t}\r\n\r\n\t/**@private */\r\n\tprivate _formatData(value: number): number {\r\n\t\tif (Math.abs(value) < 0.000001) return 0;\r\n\t\tif (Math.abs(1 - value) < 0.001) return value > 0 ? 1 : -1;\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * <p>缩放模式。默认值为 \"noscale\"。</p>\r\n\t * <p><ul>取值范围：\r\n\t * <li>\"noscale\" ：不缩放；</li>\r\n\t * <li>\"exactfit\" ：全屏不等比缩放；</li>\r\n\t * <li>\"showall\" ：最小比例缩放；</li>\r\n\t * <li>\"noborder\" ：最大比例缩放；</li>\r\n\t * <li>\"full\" ：不缩放，stage的宽高等于屏幕宽高；</li>\r\n\t * <li>\"fixedwidth\" ：宽度不变，高度根据屏幕比缩放；</li>\r\n\t * <li>\"fixedheight\" ：高度不变，宽度根据屏幕比缩放；</li>\r\n\t * <li>\"fixedauto\" ：根据宽高比，自动选择使用fixedwidth或fixedheight；</li>\r\n\t * </ul></p>\r\n\t */\r\n\tget scaleMode(): string {\r\n\t\treturn this._scaleMode;\r\n\t}\r\n\r\n\tset scaleMode(value: string) {\r\n\t\tthis._scaleMode = value;\r\n\t\tILaya.systemTimer.callLater(this, this._changeCanvasSize);\r\n\t}\r\n\r\n\t/**\r\n\t * <p>水平对齐方式。默认值为\"left\"。</p>\r\n\t * <p><ul>取值范围：\r\n\t * <li>\"left\" ：居左对齐；</li>\r\n\t * <li>\"center\" ：居中对齐；</li>\r\n\t * <li>\"right\" ：居右对齐；</li>\r\n\t * </ul></p>\r\n\t */\r\n\tget alignH(): string {\r\n\t\treturn this._alignH;\r\n\t}\r\n\r\n\tset alignH(value: string) {\r\n\t\tthis._alignH = value;\r\n\t\tILaya.systemTimer.callLater(this, this._changeCanvasSize);\r\n\t}\r\n\r\n\t/**\r\n\t * <p>垂直对齐方式。默认值为\"top\"。</p>\r\n\t * <p><ul>取值范围：\r\n\t * <li>\"top\" ：居顶部对齐；</li>\r\n\t * <li>\"middle\" ：居中对齐；</li>\r\n\t * <li>\"bottom\" ：居底部对齐；</li>\r\n\t * </ul></p>\r\n\t */\r\n\tget alignV(): string {\r\n\t\treturn this._alignV;\r\n\t}\r\n\r\n\tset alignV(value: string) {\r\n\t\tthis._alignV = value;\r\n\t\tILaya.systemTimer.callLater(this, this._changeCanvasSize);\r\n\t}\r\n\r\n\t/**舞台的背景颜色，默认为黑色，null为透明。*/\r\n\tget bgColor(): string {\r\n\t\treturn this._bgColor;\r\n\t}\r\n\r\n\tset bgColor(value: string) {\r\n\t\tthis._bgColor = value;\r\n\t\tif (value)\r\n\t\t\tthis._wgColor = ColorUtils.create(value).arrColor;\r\n\t\telse\r\n\t\t\tthis._wgColor = null;\r\n\r\n\t\tif (value) {\r\n\t\t\tRender.canvas.style.background = value;\r\n\t\t} else {\r\n\t\t\tRender.canvas.style.background = \"none\";\r\n\t\t}\r\n\t}\r\n\r\n\t/**鼠标在 Stage 上的 X 轴坐标。@override*/\r\n\tget mouseX(): number {\r\n\t\treturn Math.round(MouseManager.instance.mouseX / this.clientScaleX);\r\n\t}\r\n\r\n\t/**鼠标在 Stage 上的 Y 轴坐标。@override*/\r\n\tget mouseY(): number {\r\n\t\treturn Math.round(MouseManager.instance.mouseY / this.clientScaleY);\r\n\t}\r\n\r\n\t/**@inheritDoc @override*/\r\n\tgetMousePoint(): Point {\r\n\t\treturn Point.TEMP.setTo(this.mouseX, this.mouseY);\r\n\t}\r\n\r\n\t/**当前视窗由缩放模式导致的 X 轴缩放系数。*/\r\n\tget clientScaleX(): number {\r\n\t\treturn this._transform ? this._transform.getScaleX() : 1;\r\n\t}\r\n\r\n\t/**当前视窗由缩放模式导致的 Y 轴缩放系数。*/\r\n\tget clientScaleY(): number {\r\n\t\treturn this._transform ? this._transform.getScaleY() : 1;\r\n\t}\r\n\r\n\t/**\r\n\t * <p>场景布局类型。</p>\r\n\t * <p><ul>取值范围：\r\n\t * <li>\"none\" ：不更改屏幕</li>\r\n\t * <li>\"horizontal\" ：自动横屏</li>\r\n\t * <li>\"vertical\" ：自动竖屏</li>\r\n\t * </ul></p>\r\n\t */\r\n\tget screenMode(): string {\r\n\t\treturn this._screenMode;\r\n\t}\r\n\r\n\tset screenMode(value: string) {\r\n\t\tthis._screenMode = value;\r\n\t}\r\n\r\n\t/**@inheritDoc @override*/\r\n\trepaint(type: number = SpriteConst.REPAINT_CACHE): void {\r\n\t\tthis._repaint |= type;\r\n\t}\r\n\r\n\t/**@inheritDoc @override*/\r\n\tparentRepaint(type: number = SpriteConst.REPAINT_CACHE): void {\r\n\t}\r\n\r\n\t/**@internal */\r\n\t_loop(): boolean {\r\n\t\tthis._globalRepaintGet = this._globalRepaintSet;\r\n\t\tthis._globalRepaintSet = false;\r\n\t\tthis.render(Render._context, 0, 0);\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**@private */\r\n\tgetFrameTm(): number {\r\n\t\treturn this._frameStartTime;\r\n\t}\r\n\r\n\t/**@private */\r\n\tprivate _onmouseMove(e: Event): void {\r\n\t\tthis._mouseMoveTime = Browser.now();\r\n\t}\r\n\r\n\t/**\r\n\t * <p>获得距当前帧开始后，过了多少时间，单位为毫秒。</p>\r\n\t * <p>可以用来判断函数内时间消耗，通过合理控制每帧函数处理消耗时长，避免一帧做事情太多，对复杂计算分帧处理，能有效降低帧率波动。</p>\r\n\t */\r\n\tgetTimeFromFrameStart(): number {\r\n\t\treturn Browser.now() - this._frameStartTime;\r\n\t}\r\n\r\n\t/**@inheritDoc @override*/\r\n\tset visible(value: boolean) {\r\n\t\tif (this.visible !== value) {\r\n\t\t\tsuper.set_visible(value);\r\n\t\t\tvar style: any = Render._mainCanvas.source.style;\r\n\t\t\tstyle.visibility = value ? \"visible\" : \"hidden\";\r\n\t\t}\r\n\t}\r\n\t/**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n\tget visible() {\r\n\t\treturn super.visible;\r\n\t}\r\n\r\n\t/** @private */\r\n\tstatic clear: Function = function (value: string): void {\r\n\t\t//修改需要同步到上面的native实现中\r\n\t\tContext.set2DRenderConfig();//渲染2D前要还原2D状态,否则可能受3D影响\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tRenderState2D.worldScissorTest && gl.disable(gl.SCISSOR_TEST);\r\n\t\tvar ctx: Context = Render.context;\r\n\t\t//兼容浏览器\r\n\t\tvar c: any[] = (ctx._submits._length == 0 || Config.preserveDrawingBuffer) ? ColorUtils.create(value).arrColor : ILaya.stage._wgColor;\r\n\t\tif (c)\r\n\t\t\tctx.clearBG(c[0], c[1], c[2], c[3]);\r\n\t\telse\r\n\t\t\tctx.clearBG(0, 0, 0, 0);\r\n\t\tRenderState2D.clear();\r\n\t};\r\n\r\n\r\n\t/**@inheritDoc @override*/\r\n\trender(context: Context, x: number, y: number): void {\r\n\t\tif (((<any>window)).conch) {\r\n\t\t\tthis.renderToNative(context, x, y);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this._frameRate === Stage.FRAME_SLEEP) {\r\n\t\t\tvar now: number = Browser.now();\r\n\t\t\tif (now - this._frameStartTime >= 1000) this._frameStartTime = now;\r\n\t\t\telse return;\r\n\t\t} else {\r\n\t\t\tif (!this._visible) {\r\n\t\t\t\tthis._renderCount++;\r\n\t\t\t\tif (this._renderCount % 5 === 0) {\r\n\t\t\t\t\tCallLater.I._update();\r\n\t\t\t\t\tStat.loopCount++;\r\n\t\t\t\t\tRenderInfo.loopCount = Stat.loopCount;\r\n\t\t\t\t\tthis._updateTimers();\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._frameStartTime = Browser.now();\r\n\t\t\tRenderInfo.loopStTm = this._frameStartTime;\r\n\t\t}\r\n\r\n\t\tthis._renderCount++;\r\n\t\tvar frameMode: string = this._frameRate === Stage.FRAME_MOUSE ? (((this._frameStartTime - this._mouseMoveTime) < 2000) ? Stage.FRAME_FAST : Stage.FRAME_SLOW) : this._frameRate;\r\n\t\tvar isFastMode: boolean = (frameMode !== Stage.FRAME_SLOW);\r\n\t\tvar isDoubleLoop: boolean = (this._renderCount % 2 === 0);\r\n\r\n\t\tStat.renderSlow = !isFastMode;\r\n\t\tif (!isFastMode && !isDoubleLoop)//统一双帧处理渲染\r\n\t\t\treturn;\r\n\r\n\t\tCallLater.I._update();\r\n\t\tStat.loopCount++;\r\n\t\tRenderInfo.loopCount = Stat.loopCount;\r\n\r\n\t\tif (this.renderingEnabled) {\r\n\t\t\tfor (var i: number = 0, n: number = this._scene3Ds.length; i < n; i++)//更新3D场景,必须提出来,否则在脚本中移除节点会导致BUG\r\n\t\t\t\tthis._scene3Ds[i]._update();\r\n\t\t\tcontext.clear();\r\n\t\t\tsuper.render(context, x, y);\r\n\t\t\tStat._StatRender.renderNotCanvas(context, x, y);\r\n\t\t}\r\n\r\n\t\tif (this.renderingEnabled) {\r\n\t\t\tStage.clear(this._bgColor);\r\n\t\t\tcontext.flush();\r\n\t\t\tVectorGraphManager.instance && VectorGraphManager.getInstance().endDispose();\r\n\t\t}\r\n\t\tthis._updateTimers();\r\n\t}\r\n\r\n\trenderToNative(context: Context, x: number, y: number): void {\r\n\t\tthis._renderCount++;\r\n\t\tif (!this._visible) {\r\n\t\t\tif (this._renderCount % 5 === 0) {\r\n\t\t\t\tCallLater.I._update();\r\n\t\t\t\tStat.loopCount++;\r\n\t\t\t\tRenderInfo.loopCount = Stat.loopCount;\r\n\t\t\t\tthis._updateTimers();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t//update\r\n\t\tCallLater.I._update();\r\n\t\tStat.loopCount++;\r\n\t\tRenderInfo.loopCount = Stat.loopCount;\r\n\r\n\t\t//render\r\n\t\tif (this.renderingEnabled) {\r\n\t\t\tfor (var i: number = 0, n: number = this._scene3Ds.length; i < n; i++)//更新3D场景,必须提出来,否则在脚本中移除节点会导致BUG\r\n\t\t\t\tthis._scene3Ds[i]._update();\r\n\t\t\tcontext.clear();\r\n\t\t\tsuper.render(context, x, y);\r\n\t\t\tStat._StatRender.renderNotCanvas(context, x, y);\r\n\t\t}\r\n\t\t//commit submit\r\n\t\tif (this.renderingEnabled) {\r\n\t\t\tStage.clear(this._bgColor);\r\n\t\t\tcontext.flush();\r\n\t\t\tVectorGraphManager.instance && VectorGraphManager.getInstance().endDispose();\r\n\t\t}\r\n\t\tthis._updateTimers();\r\n\t}\r\n\r\n\tprivate _updateTimers(): void {\r\n\t\tILaya.systemTimer._update();\r\n\t\tILaya.startTimer._update();\r\n\t\tILaya.physicsTimer._update();\r\n\t\tILaya.updateTimer._update();\r\n\t\tILaya.lateTimer._update();\r\n\t\tILaya.timer._update();\r\n\t}\r\n\r\n\t/**\r\n\t * <p>是否开启全屏，用户点击后进入全屏。</p>\r\n\t * <p>兼容性提示：部分浏览器不允许点击进入全屏，比如Iphone等。</p>\r\n\t */\r\n\tset fullScreenEnabled(value: boolean) {\r\n\t\tvar document: any = Browser.document;\r\n\t\tvar canvas: any = Render.canvas;\r\n\t\tif (value) {\r\n\t\t\tcanvas.addEventListener('mousedown', this._requestFullscreen);\r\n\t\t\tcanvas.addEventListener('touchstart', this._requestFullscreen);\r\n\t\t\tdocument.addEventListener(\"fullscreenchange\", this._fullScreenChanged);\r\n\t\t\tdocument.addEventListener(\"mozfullscreenchange\", this._fullScreenChanged);\r\n\t\t\tdocument.addEventListener(\"webkitfullscreenchange\", this._fullScreenChanged);\r\n\t\t\tdocument.addEventListener(\"msfullscreenchange\", this._fullScreenChanged);\r\n\t\t} else {\r\n\t\t\tcanvas.removeEventListener('mousedown', this._requestFullscreen);\r\n\t\t\tcanvas.removeEventListener('touchstart', this._requestFullscreen);\r\n\t\t\tdocument.removeEventListener(\"fullscreenchange\", this._fullScreenChanged);\r\n\t\t\tdocument.removeEventListener(\"mozfullscreenchange\", this._fullScreenChanged);\r\n\t\t\tdocument.removeEventListener(\"webkitfullscreenchange\", this._fullScreenChanged);\r\n\t\t\tdocument.removeEventListener(\"msfullscreenchange\", this._fullScreenChanged);\r\n\t\t}\r\n\t}\r\n\r\n\tget frameRate(): string {\r\n\t\tif (!ILaya.Render.isConchApp) {\r\n\t\t\treturn this._frameRate;\r\n\t\t} else {\r\n\t\t\treturn ((<any>this))._frameRateNative;\r\n\t\t}\r\n\t}\r\n\r\n\tset frameRate(value: string) {\r\n\t\tif (!ILaya.Render.isConchApp) {\r\n\t\t\tthis._frameRate = value;\r\n\t\t} else {\r\n\t\t\tvar c: any = ((<any>window)).conch;\r\n\t\t\tswitch (value) {\r\n\t\t\t\tcase Stage.FRAME_FAST:\r\n\t\t\t\t\tc.config.setLimitFPS(60);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Stage.FRAME_MOUSE:\r\n\t\t\t\t\tc.config.setMouseFrame(2000);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Stage.FRAME_SLOW:\r\n\t\t\t\t\tc.config.setSlowFrame(true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Stage.FRAME_SLEEP:\r\n\t\t\t\t\tc.config.setLimitFPS(1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\t((<any>this))._frameRateNative = value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**@private */\r\n\tprivate _requestFullscreen(): void {\r\n\t\tvar element: any = Browser.document.documentElement;\r\n\t\tif (element.requestFullscreen) {\r\n\t\t\telement.requestFullscreen();\r\n\t\t} else if (element.mozRequestFullScreen) {\r\n\t\t\telement.mozRequestFullScreen();\r\n\t\t} else if (element.webkitRequestFullscreen) {\r\n\t\t\telement.webkitRequestFullscreen();\r\n\t\t} else if (element.msRequestFullscreen) {\r\n\t\t\telement.msRequestFullscreen();\r\n\t\t}\r\n\t}\r\n\r\n\t/**@private */\r\n\tprivate _fullScreenChanged(): void {\r\n\t\tILaya.stage.event(Event.FULL_SCREEN_CHANGE);\r\n\t}\r\n\r\n\t/**退出全屏模式*/\r\n\texitFullscreen(): void {\r\n\t\tvar document: any = Browser.document;\r\n\t\tif (document.exitFullscreen) {\r\n\t\t\tdocument.exitFullscreen();\r\n\t\t} else if (document.mozCancelFullScreen) {\r\n\t\t\tdocument.mozCancelFullScreen();\r\n\t\t} else if (document.webkitExitFullscreen) {\r\n\t\t\tdocument.webkitExitFullscreen();\r\n\t\t}\r\n\t}\r\n\r\n\t/**@private */\r\n\tisGlobalRepaint(): boolean {\r\n\t\treturn this._globalRepaintGet;\r\n\t}\r\n\r\n\t/**@private */\r\n\tsetGlobalRepaint(): void {\r\n\t\tthis._globalRepaintSet = true;\r\n\t}\r\n\r\n\t/**@private */\r\n\tadd3DUI(uibase: Sprite): void {\r\n\t\tvar uiroot: Sprite = ((<any>uibase)).rootView;\r\n\t\tif (this._3dUI.indexOf(uiroot) >= 0) return;\r\n\t\tthis._3dUI.push(uiroot);\r\n\t}\r\n\r\n\t/**@private */\r\n\tremove3DUI(uibase: Sprite): boolean {\r\n\t\tvar uiroot: Sprite = ((<any>uibase)).rootView;\r\n\t\tvar p: number = this._3dUI.indexOf(uiroot);\r\n\t\tif (p >= 0) {\r\n\t\t\tthis._3dUI.splice(p, 1);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n\r\nClassUtils.regClass(\"laya.display.Stage\", Stage);\r\nClassUtils.regClass(\"Laya.Stage\", Stage);","import { Event } from \"./Event\";\r\nimport { ILaya } from \"../../ILaya\";\r\n\r\n/**\r\n * <p><code>KeyBoardManager</code> 是键盘事件管理类。该类从浏览器中接收键盘事件，并派发该事件。</p>\r\n * <p>派发事件时若 Stage.focus 为空则只从 Stage 上派发该事件，否则将从 Stage.focus 对象开始一直冒泡派发该事件。所以在 Laya.stage 上监听键盘事件一定能够收到，如果在其他地方监听，则必须处在Stage.focus的冒泡链上才能收到该事件。</p>\r\n * <p>用户可以通过代码 Laya.stage.focus=someNode 的方式来设置focus对象。</p>\r\n * <p>用户可统一的根据事件对象中 e.keyCode 来判断按键类型，该属性兼容了不同浏览器的实现。</p>\r\n */\r\nexport class KeyBoardManager {\r\n    private static _pressKeys: any = {};\r\n\r\n    /**是否开启键盘事件，默认为true*/\r\n    static enabled: boolean = true;\r\n    /**@internal */\r\n    static _event: Event = new Event();\r\n\r\n    /**@internal */\r\n    static __init__(): void {\r\n        KeyBoardManager._addEvent(\"keydown\");\r\n        KeyBoardManager._addEvent(\"keypress\");\r\n        KeyBoardManager._addEvent(\"keyup\");\r\n    }\r\n\r\n    private static _addEvent(type: string): void {\r\n        ILaya.Browser.document.addEventListener(type, function (e: any): void {\r\n            KeyBoardManager._dispatch(e, type);\r\n        }, true);\r\n    }\r\n\r\n    private static _dispatch(e: any, type: string): void {\r\n        if (!KeyBoardManager.enabled) return;\r\n        KeyBoardManager._event._stoped = false;\r\n        KeyBoardManager._event.nativeEvent = e;\r\n        KeyBoardManager._event.keyCode = e.keyCode || e.which || e.charCode;\r\n        //判断同时按下的键\r\n        if (type === \"keydown\") KeyBoardManager._pressKeys[KeyBoardManager._event.keyCode] = true;\r\n        else if (type === \"keyup\") KeyBoardManager._pressKeys[KeyBoardManager._event.keyCode] = null;\r\n\r\n        var target: any = (ILaya.stage.focus && (ILaya.stage.focus.event != null) && ILaya.stage.focus.displayedInStage) ? ILaya.stage.focus : ILaya.stage;\r\n        var ct: any = target;\r\n        while (ct) {\r\n            ct.event(type, KeyBoardManager._event.setTo(type, ct, target));\r\n            ct = ct.parent;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 返回指定键是否被按下。\r\n     * @param\tkey 键值。\r\n     * @return 是否被按下。\r\n     */\r\n    static hasKeyDown(key: number): boolean {\r\n        return KeyBoardManager._pressKeys[key];\r\n    }\r\n}\r\n\r\n","import { EventDispatcher } from \"../events/EventDispatcher\"\r\nimport { Handler } from \"../utils/Handler\"\r\n\r\n/**\r\n * <p> <code>SoundChannel</code> 用来控制程序中的声音。每个声音均分配给一个声道，而且应用程序可以具有混合在一起的多个声道。</p>\r\n * <p> <code>SoundChannel</code> 类包含控制声音的播放、暂停、停止、音量的方法，以及获取声音的播放状态、总时间、当前播放时间、总循环次数、播放地址等信息的方法。</p>\r\n */\r\nexport class SoundChannel extends EventDispatcher {\r\n    /**\r\n     * 声音地址。\r\n     */\r\n    url: string;\r\n    /**\r\n     * 循环次数。\r\n     */\r\n    loops: number;\r\n    /**\r\n     * 播放声音开始时间。\r\n     */\r\n    startTime: number;\r\n    /**\r\n     * 表示声音是否已暂停。\r\n     */\r\n    isStopped: boolean = false;\r\n    /**\r\n     * 播放完成处理器。\r\n     */\r\n    completeHandler: Handler;\r\n\r\n    /**\r\n     * 音量范围从 0（静音）至 1（最大音量）。\r\n     */\r\n    set volume(v: number) {\r\n\r\n    }\r\n\r\n    get volume(): number {\r\n        return 1;\r\n    }\r\n\r\n    /**\r\n     * 获取当前播放时间，单位是秒。\r\n     */\r\n    get position(): number {\r\n        return 0;\r\n    }\r\n\r\n    /**\r\n     * 获取总时间，单位是秒。\r\n     */\r\n    get duration(): number {\r\n        return 0;\r\n    }\r\n\r\n    /**\r\n     * 播放声音。\r\n     */\r\n    play(): void {\r\n\r\n    }\r\n\r\n    /**\r\n     * 停止播放。\r\n     */\r\n    stop(): void {\r\n        if (this.completeHandler) this.completeHandler.runWith(false);\r\n    }\r\n\r\n    /**\r\n     * 暂停播放。\r\n     */\r\n    pause(): void {\r\n    }\r\n\r\n    /**\r\n     * 继续播放。\r\n     */\r\n    resume(): void {\r\n    }\r\n\r\n    /**\r\n     * private\r\n     */\r\n    protected __runComplete(handler: Handler): void {\r\n        if (handler) {\r\n            handler.runWith(true);\r\n        }\r\n    }\r\n}\r\n\r\n","import { Event as LayaEvent } from \"../../events/Event\"\r\nimport { SoundChannel } from \"../SoundChannel\"\r\n//import { SoundManager } from \"../SoundManager\"\r\nimport { Render } from \"../../renders/Render\"\r\nimport { Browser } from \"../../utils/Browser\"\r\nimport { ILaya } from \"../../../ILaya\";\r\n\r\n/**\r\n * @private\r\n * audio标签播放声音的音轨控制\r\n */\r\nexport class AudioSoundChannel extends SoundChannel {\r\n\r\n    /**\r\n     * 播放用的audio标签\r\n     */\r\n    private _audio: HTMLAudioElement = null;\r\n    private _onEnd: (evt: Event) => void;\r\n    private _resumePlay: (evt: Event) => void;\r\n\r\n    constructor(audio: HTMLAudioElement) {\r\n        super();\r\n        this._onEnd = this.__onEnd.bind(this);\r\n        this._resumePlay = this.__resumePlay.bind(this);\r\n        audio.addEventListener(\"ended\", this._onEnd);\r\n        this._audio = audio;\r\n    }\r\n\r\n    private __onEnd(evt: Event): void {\r\n        if (this.loops == 1) {\r\n            if (this.completeHandler) {\r\n                ILaya.systemTimer.once(10, this, this.__runComplete, [this.completeHandler], false);\r\n                this.completeHandler = null;\r\n            }\r\n            this.stop();\r\n            this.event(LayaEvent.COMPLETE);\r\n            return;\r\n        }\r\n        if (this.loops > 0) {\r\n            this.loops--;\r\n        }\r\n        this.startTime = 0;\r\n        this.play();\r\n    }\r\n\r\n    private __resumePlay(): void {\r\n        if (this._audio) this._audio.removeEventListener(\"canplay\", this._resumePlay as any);\r\n        if (this.isStopped) return;\r\n        try {\r\n            this._audio.currentTime = this.startTime;\r\n            Browser.container.appendChild(this._audio);\r\n            this._audio.play();\r\n        } catch (e) {\r\n            //this.audio.play();\r\n            this.event(LayaEvent.ERROR);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 播放\r\n     * @override\r\n     */\r\n    play(): void {\r\n        this.isStopped = false;\r\n        try {\r\n            this._audio.playbackRate = ILaya.SoundManager.playbackRate;\r\n            this._audio.currentTime = this.startTime;\r\n        } catch (e) {\r\n            this._audio.addEventListener(\"canplay\", this._resumePlay as any);\r\n            return;\r\n        }\r\n        ILaya.SoundManager.addChannel(this);\r\n        Browser.container.appendChild(this._audio);\r\n        if (\"play\" in this._audio)\r\n            this._audio.play();\r\n    }\r\n\r\n    /**\r\n     * 当前播放到的位置\r\n     * @return\r\n     * @override\r\n     *\r\n     */\r\n    get position(): number {\r\n        if (!this._audio)\r\n            return 0;\r\n        return this._audio.currentTime;\r\n    }\r\n\r\n    /**\r\n     * 获取总时间。\r\n     * @override\r\n     */\r\n    get duration(): number {\r\n        if (!this._audio)\r\n            return 0;\r\n        return this._audio.duration;\r\n    }\r\n\r\n    /**\r\n     * 停止播放\r\n     * @override\r\n     */\r\n    stop(): void {\r\n        //trace(\"stop and remove event\");\r\n        super.stop();\r\n        this.isStopped = true;\r\n        ILaya.SoundManager.removeChannel(this);\r\n        this.completeHandler = null;\r\n        if (!this._audio)\r\n            return;\r\n        if (\"pause\" in this._audio)\r\n            //理论上应该全部使用stop，但是不知为什么，使用pause，为了安全我只修改在加速器模式下再调用一次stop\r\n            if (ILaya.Render.isConchApp) {\r\n                (this._audio as any).stop();\r\n            }\r\n        this._audio.pause();\r\n        this._audio.removeEventListener(\"ended\", this._onEnd as EventListener);\r\n        this._audio.removeEventListener(\"canplay\", this._resumePlay);\r\n        //ie下使用对象池可能会导致后面的声音播放不出来\r\n        if (!ILaya.Browser.onIE) {\r\n            if (this._audio != ILaya.AudioSound._musicAudio) {\r\n                ILaya.Pool.recover(\"audio:\" + this.url, this._audio);\r\n            }\r\n        }\r\n        Browser.removeElement(this._audio);\r\n        this._audio = null;\r\n        if (ILaya.SoundManager.autoReleaseSound)\r\n            ILaya.SoundManager.disposeSoundLater(this.url);\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    pause(): void {\r\n        this.isStopped = true;\r\n        ILaya.SoundManager.removeChannel(this);\r\n        if (\"pause\" in this._audio)\r\n            this._audio.pause();\r\n        if (ILaya.SoundManager.autoReleaseSound)\r\n            ILaya.SoundManager.disposeSoundLater(this.url);\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    resume(): void {\r\n        var audio = this._audio;\r\n        if (!audio)\r\n            return;\r\n        this.isStopped = false;\r\n        if (audio.readyState == 0) { //当音频放到后台一定时间后，会被卸载，音频会断开连接，并将readyState重置为0\r\n            audio.src = this.url;\r\n            audio.addEventListener(\"canplay\", this._resumePlay as any);\r\n            audio.load();\r\n        }\r\n        ILaya.SoundManager.addChannel(this);\r\n        if (\"play\" in audio) {\r\n            audio.play();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置音量\r\n     * @param v\r\n     * @override\r\n     *\r\n     */\r\n    set volume(v: number) {\r\n        if (!this._audio) return;\r\n        this._audio.volume = v;\r\n    }\r\n\r\n    /**\r\n     * 获取音量\r\n     * @return\r\n     * @override\r\n     *\r\n     */\r\n    get volume(): number {\r\n        if (!this._audio) return 1;\r\n        return this._audio.volume;\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { AudioSoundChannel } from \"./AudioSoundChannel\";\r\nimport { Event } from \"../../events/Event\"\r\nimport { EventDispatcher } from \"../../events/EventDispatcher\"\r\nimport { SoundChannel } from \"../SoundChannel\"\r\n//import { SoundManager } from \"../SoundManager\"\r\nimport { URL } from \"../../net/URL\"\r\nimport { Render } from \"../../renders/Render\"\r\nimport { Browser } from \"../../utils/Browser\"\r\nimport { Pool } from \"../../utils/Pool\"\r\nimport { ILaya } from \"../../../ILaya\";\r\n\r\n/**\r\n * @private\r\n * 使用Audio标签播放声音\r\n */\r\nexport class AudioSound extends EventDispatcher {\r\n\r\n    /**@private */\r\n    private static _audioCache: any = {};\r\n    /**\r\n     * 声音URL\r\n     */\r\n    url: string;\r\n    /**\r\n     * 播放用的audio标签\r\n     */\r\n    audio: HTMLAudioElement;\r\n    /**\r\n     * 是否已加载完成\r\n     */\r\n    loaded: boolean = false;\r\n    /**@internal */\r\n    static _musicAudio: HTMLAudioElement;\r\n    /**\r\n     * 释放声音\r\n     *\r\n     */\r\n    dispose(): void {\r\n        var ad: HTMLAudioElement = AudioSound._audioCache[this.url];\r\n        Pool.clearBySign(\"audio:\" + this.url);\r\n        if (ad) {\r\n            if (!Render.isConchApp) {\r\n                ad.src = \"\";\r\n            }\r\n            delete AudioSound._audioCache[this.url];\r\n        }\r\n    }\r\n\r\n    /**@internal */\r\n    static _initMusicAudio(): void {\r\n        if (AudioSound._musicAudio) return;\r\n        if (!AudioSound._musicAudio) AudioSound._musicAudio = (<HTMLAudioElement>Browser.createElement(\"audio\"));\r\n        if (!Render.isConchApp) {\r\n            Browser.document.addEventListener(\"mousedown\", AudioSound._makeMusicOK);\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    private static _makeMusicOK(): void {\r\n        Browser.document.removeEventListener(\"mousedown\", AudioSound._makeMusicOK);\r\n        if (!AudioSound._musicAudio.src) {\r\n            AudioSound._musicAudio.src = \"\";\r\n            AudioSound._musicAudio.load();\r\n        } else {\r\n            AudioSound._musicAudio.play();\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 加载声音\r\n     * @param url\r\n     *\r\n     */\r\n    load(url: string): void {\r\n        url = URL.formatURL(url);\r\n        this.url = url;\r\n        var ad: HTMLAudioElement;\r\n        if (url == ILaya.SoundManager._bgMusic) {\r\n            AudioSound._initMusicAudio();\r\n            ad = AudioSound._musicAudio;\r\n            if (ad.src != url) {\r\n                AudioSound._audioCache[ad.src] = null;\r\n                ad = null;\r\n            }\r\n        } else {\r\n            ad = AudioSound._audioCache[url];\r\n        }\r\n        if (ad && ad.readyState >= 2) {\r\n            this.event(Event.COMPLETE);\r\n            return;\r\n        }\r\n        if (!ad) {\r\n            if (url == ILaya.SoundManager._bgMusic) {\r\n                AudioSound._initMusicAudio();\r\n                ad = AudioSound._musicAudio;\r\n            } else {\r\n                ad = (<HTMLAudioElement>Browser.createElement(\"audio\"));\r\n            }\r\n            AudioSound._audioCache[url] = ad;\r\n            ad.src = url;\r\n        }\r\n\r\n        ad.addEventListener(\"canplaythrough\", onLoaded);\r\n        ad.addEventListener(\"error\", onErr);\r\n        var me: AudioSound = this;\r\n        function onLoaded(): void {\r\n            offs();\r\n            me.loaded = true;\r\n            me.event(Event.COMPLETE);\r\n        }\r\n\r\n        function onErr(): void {\r\n            ad.load = null;\r\n            offs();\r\n            me.event(Event.ERROR);\r\n        }\r\n\r\n        function offs(): void {\r\n            ad.removeEventListener(\"canplaythrough\", onLoaded);\r\n            ad.removeEventListener(\"error\", onErr);\r\n        }\r\n\r\n        this.audio = ad;\r\n        if (ad.load) {\r\n            ad.load();\r\n        } else {\r\n            onErr();\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * 播放声音\r\n     * @param startTime 起始时间\r\n     * @param loops 循环次数\r\n     * @return\r\n     *\r\n     */\r\n    play(startTime: number = 0, loops: number = 0): SoundChannel {\r\n        //trace(\"playAudioSound\");\r\n        if (!this.url) return null;\r\n        var ad: HTMLAudioElement;\r\n        if (this.url == ILaya.SoundManager._bgMusic) {\r\n            ad = AudioSound._musicAudio;\r\n        } else {\r\n            ad = AudioSound._audioCache[this.url];\r\n        }\r\n\r\n        if (!ad) return null;\r\n        var tAd: HTMLAudioElement;\r\n\r\n        tAd = Pool.getItem(\"audio:\" + this.url);\r\n\r\n        if (Render.isConchApp) {\r\n            if (!tAd) {\r\n                tAd = (<HTMLAudioElement>Browser.createElement(\"audio\"));\r\n                tAd.src = this.url;\r\n            }\r\n        }\r\n        else {\r\n            if (this.url == ILaya.SoundManager._bgMusic) {\r\n                AudioSound._initMusicAudio();\r\n                tAd = AudioSound._musicAudio;\r\n                tAd.src = this.url;\r\n            } else {\r\n                tAd = tAd ? tAd : ad.cloneNode(true) as HTMLAudioElement;\r\n            }\r\n        }\r\n        var channel: AudioSoundChannel = new AudioSoundChannel(tAd);\r\n        channel.url = this.url;\r\n        channel.loops = loops;\r\n        channel.startTime = startTime;\r\n        channel.play();\r\n        ILaya.SoundManager.addChannel(channel);\r\n        return channel;\r\n    }\r\n\r\n    /**\r\n     * 获取总时间。\r\n     */\r\n    get duration(): number {\r\n        var ad: HTMLAudioElement;\r\n        ad = AudioSound._audioCache[this.url];\r\n        if (!ad)\r\n            return 0;\r\n        return ad.duration;\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { Event } from \"../../events/Event\"\r\nimport { SoundChannel } from \"../SoundChannel\"\r\n//import { SoundManager } from \"../SoundManager\"\r\nimport { Browser } from \"../../utils/Browser\"\r\nimport { Utils } from \"../../utils/Utils\"\r\nimport { ILaya } from \"../../../ILaya\";\r\n//import { WebAudioSound } from \"./WebAudioSound\";\r\n\r\n/**\r\n * @private\r\n * web audio api方式播放声音的音轨控制\r\n */\r\nexport class WebAudioSoundChannel extends SoundChannel {\r\n    /**\r\n     * 声音原始文件数据\r\n     */\r\n    audioBuffer: any;\r\n\r\n    /**\r\n     * gain节点\r\n     */\r\n    private gain: any;\r\n\r\n    /**\r\n     * 播放用的数据\r\n     */\r\n    private bufferSource: any = null;\r\n    /**\r\n     * 当前时间\r\n     */\r\n    private _currentTime: number = 0;\r\n\r\n    /**\r\n     * 当前音量\r\n     */\r\n    private _volume: number = 1;\r\n\r\n    /**\r\n     * 播放开始时的时间戳\r\n     */\r\n    private _startTime: number = 0;\r\n\r\n    private _pauseTime: number = 0;\r\n\r\n    /**\r\n     * 播放设备\r\n     */\r\n    private context: any = ILaya.WebAudioSound.ctx;\r\n\r\n    private _onPlayEnd: Function;\r\n    private static _tryCleanFailed: boolean = false;\r\n    static SetTargetDelay: number = 0.001;\r\n    constructor() {\r\n        super();\r\n        this._onPlayEnd = Utils.bind(this.__onPlayEnd, this);\r\n        if (this.context[\"createGain\"]) {\r\n            this.gain = this.context[\"createGain\"]();\r\n        } else {\r\n            this.gain = this.context[\"createGainNode\"]();\r\n        }\r\n    }\r\n    /**\r\n     * 播放声音\r\n     * @override\r\n     */\r\n    play(): void {\r\n        ILaya.SoundManager.addChannel(this);\r\n        this.isStopped = false;\r\n        this._clearBufferSource();\r\n        if (!this.audioBuffer) return;\r\n        if (this.startTime >= this.duration) return stop();\r\n        var context: any = this.context;\r\n        var gain: any = this.gain;\r\n        var bufferSource: any = context.createBufferSource();\r\n        this.bufferSource = bufferSource;\r\n        bufferSource.buffer = this.audioBuffer;\r\n        bufferSource.connect(gain);\r\n        if (gain)\r\n            gain.disconnect();\r\n        gain.connect(context.destination);\r\n        bufferSource.onended = this._onPlayEnd;\r\n        // if (this.startTime >= this.duration) this.startTime = 0;\r\n        this._startTime = Browser.now();\r\n        if (this.gain.gain.setTargetAtTime) {\r\n            this.gain.gain.setTargetAtTime(this._volume, this.context.currentTime, WebAudioSoundChannel.SetTargetDelay);\r\n        } else\r\n            this.gain.gain.value = this._volume;\r\n        if (this.loops == 0) {\r\n            bufferSource.loop = true;\r\n        }\r\n        if (bufferSource.playbackRate.setTargetAtTime) {\r\n            bufferSource.playbackRate.setTargetAtTime(ILaya.SoundManager.playbackRate, this.context.currentTime, WebAudioSoundChannel.SetTargetDelay)\r\n        } else\r\n            bufferSource.playbackRate.value = ILaya.SoundManager.playbackRate;\r\n        bufferSource.start(0, this.startTime);\r\n        this._currentTime = 0;\r\n    }\r\n\r\n\r\n\r\n    private __onPlayEnd(): void {\r\n        if (this.loops == 1) {\r\n\r\n            if (this.completeHandler) {\r\n                ILaya.timer.once(10, this, this.__runComplete, [this.completeHandler], false);\r\n                this.completeHandler = null;\r\n            }\r\n            this.stop();\r\n            this.event(Event.COMPLETE);\r\n            return;\r\n        }\r\n        if (this.loops > 0) {\r\n            this.loops--;\r\n        }\r\n        this.startTime = 0;\r\n        this.play();\r\n    }\r\n\r\n    /**\r\n     * 获取当前播放位置\r\n     * @override\r\n     */\r\n    get position(): number {\r\n        if (this.bufferSource) {\r\n            return (Browser.now() - this._startTime) / 1000 + this.startTime;\r\n        }\r\n        return 0;\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    get duration(): number {\r\n        if (this.audioBuffer) {\r\n            return this.audioBuffer.duration;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    private _clearBufferSource(): void {\r\n        if (this.bufferSource) {\r\n            var sourceNode: any = this.bufferSource;\r\n            if (sourceNode.stop) {\r\n                sourceNode.stop(0);\r\n            } else {\r\n                sourceNode.noteOff(0);\r\n            }\r\n            sourceNode.disconnect(0);\r\n            sourceNode.onended = null;\r\n            if (!WebAudioSoundChannel._tryCleanFailed) this._tryClearBuffer(sourceNode);\r\n            this.bufferSource = null;\r\n        }\r\n    }\r\n\r\n    private _tryClearBuffer(sourceNode: any): void {\r\n        try {//已经支持buffer=null\r\n            sourceNode.buffer = null;\r\n        } catch (e) {\r\n            WebAudioSoundChannel._tryCleanFailed = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 停止播放\r\n     * @override\r\n     */\r\n    stop(): void {\r\n        super.stop();\r\n        this._clearBufferSource();\r\n        this.audioBuffer = null;\r\n        if (this.gain)\r\n            this.gain.disconnect();\r\n        this.isStopped = true;\r\n        ILaya.SoundManager.removeChannel(this);\r\n        this.completeHandler = null;\r\n        if (ILaya.SoundManager.autoReleaseSound)\r\n            ILaya.SoundManager.disposeSoundLater(this.url);\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    pause(): void {\r\n        if (!this.isStopped) {\r\n            this._pauseTime = this.position;\r\n        }\r\n        this._clearBufferSource();\r\n        if (this.gain)\r\n            this.gain.disconnect();\r\n        this.isStopped = true;\r\n        ILaya.SoundManager.removeChannel(this);\r\n        if (ILaya.SoundManager.autoReleaseSound)\r\n            ILaya.SoundManager.disposeSoundLater(this.url);\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    resume(): void {\r\n        this.startTime = this._pauseTime;\r\n        this.play();\r\n    }\r\n\r\n    /**\r\n     * 设置音量\r\n     * @override\r\n     */\r\n    set volume(v: number) {\r\n        this._volume = v;\r\n        if (this.isStopped) {\r\n            return;\r\n        }\r\n        if (this.gain.gain.setTargetAtTime) {\r\n            this.gain.gain.setTargetAtTime(v, this.context.currentTime, WebAudioSoundChannel.SetTargetDelay);\r\n        } else\r\n            this.gain.gain.value = v;\r\n    }\r\n\r\n    /**\r\n     * 获取音量\r\n     * @override\r\n     */\r\n    get volume(): number {\r\n        return this._volume;\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { WebAudioSoundChannel } from \"./WebAudioSoundChannel\";\r\nimport { Event } from \"../../events/Event\"\r\nimport { EventDispatcher } from \"../../events/EventDispatcher\"\r\nimport { SoundChannel } from \"../SoundChannel\"\r\n//import { SoundManager } from \"../SoundManager\"\r\nimport { URL } from \"../../net/URL\"\r\nimport { ILaya } from \"../../../ILaya\";\r\n\r\n/**\r\n * @private\r\n * web audio api方式播放声音\r\n */\r\nexport class WebAudioSound extends EventDispatcher {\r\n\r\n    private static _dataCache: any = {};\r\n\r\n    /**\r\n     * 是否支持web audio api\r\n     */\r\n    static webAudioEnabled: boolean = window[\"AudioContext\"] || window[\"webkitAudioContext\"] || window[\"mozAudioContext\"];\r\n\r\n    /**\r\n     * 播放设备\r\n     */\r\n    static ctx: any = WebAudioSound.webAudioEnabled ? new (window[\"AudioContext\"] || window[\"webkitAudioContext\"] || window[\"mozAudioContext\"])() : undefined;\r\n\r\n    /**\r\n     * 当前要解码的声音文件列表\r\n     */\r\n    static buffs: any[] = [];\r\n\r\n    /**\r\n     * 是否在解码中\r\n     */\r\n    static isDecoding: boolean = false;\r\n\r\n    /**\r\n     * 用于播放解锁声音以及解决Ios9版本的内存释放\r\n     */\r\n    static _miniBuffer: any = WebAudioSound.ctx ? WebAudioSound.ctx.createBuffer(1, 1, 22050) : undefined;\r\n\r\n    /**\r\n     * 事件派发器，用于处理加载解码完成事件的广播\r\n     */\r\n    static e: EventDispatcher = new EventDispatcher();\r\n    /**\r\n     * 是否已解锁声音播放\r\n     */\r\n    private static _unlocked: boolean = false;\r\n    /**\r\n     * 当前解码的声音信息\r\n     */\r\n    static tInfo: any;\r\n\r\n    private static __loadingSound: any = {};\r\n    /**\r\n     * 声音URL\r\n     */\r\n    url: string;\r\n    /**\r\n     * 是否已加载完成\r\n     */\r\n    loaded: boolean = false;\r\n\r\n    /**\r\n     * 声音文件数据\r\n     */\r\n    data: ArrayBuffer;\r\n    /**\r\n     * 声音原始文件数据\r\n     */\r\n    audioBuffer: any;\r\n    /**\r\n     * 待播放的声音列表\r\n     */\r\n    private __toPlays: any[];\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private _disposed: boolean = false;\r\n\r\n    /**\r\n     * 解码声音文件\r\n     *\r\n     */\r\n    static decode(): void {\r\n        if (WebAudioSound.buffs.length <= 0 || WebAudioSound.isDecoding) {\r\n            return;\r\n        }\r\n        WebAudioSound.isDecoding = true;\r\n        WebAudioSound.tInfo = WebAudioSound.buffs.shift();\r\n        WebAudioSound.ctx.decodeAudioData(WebAudioSound.tInfo[\"buffer\"], WebAudioSound._done, WebAudioSound._fail);\r\n    }\r\n\r\n    /**\r\n     * 解码成功回调\r\n     * @param audioBuffer\r\n     *\r\n     */\r\n    private static _done(audioBuffer: any): void {\r\n        WebAudioSound.e.event(\"loaded:\" + WebAudioSound.tInfo.url, audioBuffer);\r\n        WebAudioSound.isDecoding = false;\r\n        WebAudioSound.decode();\r\n    }\r\n\r\n    /**\r\n     * 解码失败回调\r\n     * @return\r\n     *\r\n     */\r\n    private static _fail(): void {\r\n        WebAudioSound.e.event(\"err:\" + WebAudioSound.tInfo.url, null);\r\n        WebAudioSound.isDecoding = false;\r\n        WebAudioSound.decode();\r\n    }\r\n\r\n    /**\r\n     * 播放声音以解锁IOS的声音\r\n     *\r\n     */\r\n    private static _playEmptySound(): void {\r\n        if (WebAudioSound.ctx == null) {\r\n            return;\r\n        }\r\n        var source: any = WebAudioSound.ctx.createBufferSource();\r\n        source.buffer = WebAudioSound._miniBuffer;\r\n        source.connect(WebAudioSound.ctx.destination);\r\n        source.start(0, 0, 0);\r\n    }\r\n\r\n    /**\r\n     * 尝试解锁声音\r\n     *\r\n     */\r\n    private static _unlock(): void {\r\n        if (WebAudioSound._unlocked) {\r\n            return;\r\n        }\r\n        WebAudioSound._playEmptySound();\r\n        if (WebAudioSound.ctx.state == \"running\") {\r\n            window.document.removeEventListener(\"mousedown\", WebAudioSound._unlock, true);\r\n            window.document.removeEventListener(\"touchend\", WebAudioSound._unlock, true);\r\n            window.document.removeEventListener(\"touchstart\", WebAudioSound._unlock, true);\r\n            WebAudioSound._unlocked = true;\r\n        }\r\n    }\r\n    /*;*/\r\n\r\n    static initWebAudio(): void {\r\n        if (WebAudioSound.ctx.state != \"running\") {\r\n            WebAudioSound._unlock(); // When played inside of a touch event, this will enable audio on iOS immediately.\r\n            window.document.addEventListener(\"mousedown\", WebAudioSound._unlock, true);\r\n            window.document.addEventListener(\"touchend\", WebAudioSound._unlock, true);\r\n            window.document.addEventListener(\"touchstart\", WebAudioSound._unlock, true);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 加载声音\r\n     * @param url\r\n     *\r\n     */\r\n    load(url: string): void {\r\n        var me: WebAudioSound = this;\r\n        url = URL.formatURL(url);\r\n        this.url = url;\r\n\r\n        this.audioBuffer = WebAudioSound._dataCache[url];\r\n        if (this.audioBuffer) {\r\n            this._loaded(this.audioBuffer);\r\n            return;\r\n        }\r\n        WebAudioSound.e.on(\"loaded:\" + url, this, this._loaded);\r\n        WebAudioSound.e.on(\"err:\" + url, this, this._err);\r\n        if (WebAudioSound.__loadingSound[url]) {\r\n            return;\r\n        }\r\n        WebAudioSound.__loadingSound[url] = true;\r\n\r\n        var request: any = new XMLHttpRequest();\r\n        request.open(\"GET\", url, true);\r\n        request.responseType = \"arraybuffer\";\r\n        request.onload = function (): void {\r\n            if (me._disposed) {\r\n                me._removeLoadEvents();\r\n                return;\r\n            }\r\n            me.data = request.response;\r\n            WebAudioSound.buffs.push({ \"buffer\": me.data, \"url\": me.url });\r\n            WebAudioSound.decode();\r\n        };\r\n        request.onerror = function (e: any): void {\r\n            me._err();\r\n        }\r\n        request.send();\r\n    }\r\n\r\n    private _err(): void {\r\n        this._removeLoadEvents();\r\n        WebAudioSound.__loadingSound[this.url] = false;\r\n        this.event(Event.ERROR);\r\n    }\r\n\r\n    private _loaded(audioBuffer: any): void {\r\n        this._removeLoadEvents();\r\n        if (this._disposed) {\r\n            return;\r\n        }\r\n        this.audioBuffer = audioBuffer;\r\n        WebAudioSound._dataCache[this.url] = this.audioBuffer;\r\n        this.loaded = true;\r\n        this.event(Event.COMPLETE);\r\n    }\r\n\r\n    private _removeLoadEvents(): void {\r\n        WebAudioSound.e.off(\"loaded:\" + this.url, this, this._loaded);\r\n        WebAudioSound.e.off(\"err:\" + this.url, this, this._err);\r\n    }\r\n\r\n    private __playAfterLoaded(): void {\r\n        if (!this.__toPlays) return;\r\n        var i: number, len: number;\r\n        var toPlays: any[];\r\n        toPlays = this.__toPlays;\r\n        len = toPlays.length;\r\n        var tParams: any[];\r\n        for (i = 0; i < len; i++) {\r\n            tParams = toPlays[i];\r\n            if (tParams[2] && !((<WebAudioSoundChannel>tParams[2])).isStopped) {\r\n                this.play(tParams[0], tParams[1], tParams[2]);\r\n            }\r\n        }\r\n        this.__toPlays.length = 0;\r\n    }\r\n\r\n    /**\r\n     * 播放声音\r\n     * @param startTime 起始时间\r\n     * @param loops 循环次数\r\n     * @return\r\n     *\r\n     */\r\n    play(startTime: number = 0, loops: number = 0, channel: WebAudioSoundChannel = null): SoundChannel {\r\n        channel = channel ? channel : new WebAudioSoundChannel();\r\n        if (!this.audioBuffer) {\r\n            if (this.url) {\r\n                if (!this.__toPlays) this.__toPlays = [];\r\n                this.__toPlays.push([startTime, loops, channel]);\r\n                this.once(Event.COMPLETE, this, this.__playAfterLoaded);\r\n                this.load(this.url);\r\n            }\r\n        }\r\n        channel.url = this.url;\r\n        channel.loops = loops;\r\n        channel.audioBuffer = this.audioBuffer;\r\n        channel.startTime = startTime;\r\n        channel.play();\r\n        ILaya.SoundManager.addChannel(channel);\r\n        return channel;\r\n    }\r\n\r\n    get duration(): number {\r\n        if (this.audioBuffer) {\r\n            return this.audioBuffer.duration;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    dispose(): void {\r\n        this._disposed = true;\r\n        delete WebAudioSound._dataCache[this.url];\r\n        delete WebAudioSound.__loadingSound[this.url];\r\n        this.audioBuffer = null;\r\n        this.data = null;\r\n        this.__toPlays = [];\r\n    }\r\n}\r\n\r\n\r\n","import { SoundChannel } from \"./SoundChannel\";\r\nimport { Event } from \"../events/Event\"\r\nimport { AudioSound } from \"./h5audio/AudioSound\"\r\nimport { WebAudioSound } from \"./webaudio/WebAudioSound\"\r\n//import { Loader } from \"../net/Loader\"\r\nimport { URL } from \"../net/URL\"\r\nimport { Handler } from \"../utils/Handler\"\r\nimport { Utils } from \"../utils/Utils\"\r\nimport { Sound } from \"./Sound\";\r\nimport { Stage } from \"../display/Stage\";\r\nimport { LoaderManager } from \"../net/LoaderManager\";\r\nimport { Timer } from \"../utils/Timer\";\r\nimport { ILaya } from \"../../ILaya\";\r\n/**\r\n * <code>SoundManager</code> 是一个声音管理类。提供了对背景音乐、音效的播放控制方法。\r\n * 引擎默认有两套声音方案：WebAudio和H5Audio\r\n * 播放音效，优先使用WebAudio播放声音，如果WebAudio不可用，则用H5Audio播放，H5Audio在部分机器上有兼容问题（比如不能混音，播放有延迟等）。\r\n * 播放背景音乐，则使用H5Audio播放（使用WebAudio会增加特别大的内存，并且要等加载完毕后才能播放，有延迟）\r\n * 建议背景音乐用mp3类型，音效用wav或者mp3类型（如果打包为app，音效只能用wav格式）。\r\n * 详细教程及声音格式请参考：http://ldc2.layabox.com/doc/?nav=ch-as-1-7-0\r\n */\r\nexport class SoundManager {\r\n\r\n\r\n    /**\r\n     * 背景音乐音量。\r\n     * @default 1\r\n     */\r\n    static musicVolume: number = 1;\r\n    /**\r\n     * 音效音量。\r\n     * @default 1\r\n     */\r\n    static soundVolume: number = 1;\r\n    /**\r\n     * 声音播放速率。\r\n     * @default 1\r\n     */\r\n    static playbackRate: number = 1;\r\n    /**\r\n     * 背景音乐使用Audio标签播放。\r\n     * @default true\r\n     */\r\n    private static _useAudioMusic: boolean = true;\r\n    /**@private 是否静音，默认为false。*/\r\n    private static _muted: boolean = false;\r\n    /**@private 是否音效静音，默认为false。*/\r\n    private static _soundMuted: boolean = false;\r\n    /**@private 是否背景音乐静音，默认为false。*/\r\n    private static _musicMuted: boolean = false;\r\n    /**@internal 当前背景音乐url。*/\r\n    static _bgMusic: string = null;\r\n    /**@private 当前背景音乐声道。*/\r\n    private static _musicChannel: SoundChannel = null;\r\n    /**@private 当前播放的Channel列表。*/\r\n    private static _channels: any[] = [];\r\n    /**@private */\r\n    private static _autoStopMusic: boolean;\r\n    /**@private */\r\n    private static _blurPaused: boolean = false;\r\n    /**@private */\r\n    private static _isActive: boolean = true;\r\n    /**@internal */\r\n    static _soundClass: new () => any;\r\n    /**@internal */\r\n    static _musicClass: new () => any;\r\n    /**@private */\r\n    private static _lastSoundUsedTimeDic: any = {};\r\n    /**@private */\r\n    private static _isCheckingDispose: boolean = false;\r\n\r\n    /**@internal */\r\n    static __init__(): boolean {\r\n\r\n        var win: any = ILaya.Browser.window;\r\n        var supportWebAudio: boolean = win[\"AudioContext\"] || win[\"webkitAudioContext\"] || win[\"mozAudioContext\"] ? true : false;\r\n        if (supportWebAudio) WebAudioSound.initWebAudio();\r\n        SoundManager._soundClass = supportWebAudio ? WebAudioSound : AudioSound;\r\n        AudioSound._initMusicAudio();\r\n        SoundManager._musicClass = AudioSound;\r\n        return supportWebAudio;\r\n    }\r\n\r\n    /**\r\n     * 音效播放后自动删除。\r\n     * @default true\r\n     */\r\n    static autoReleaseSound: boolean = true;\r\n\r\n    /**\r\n     * 添加播放的声音实例。\r\n     * @param channel <code>SoundChannel</code> 对象。\r\n     */\r\n    static addChannel(channel: SoundChannel): void {\r\n        if (SoundManager._channels.indexOf(channel) >= 0) return;\r\n        SoundManager._channels.push(channel);\r\n    }\r\n\r\n    /**\r\n     * 移除播放的声音实例。\r\n     * @param channel <code>SoundChannel</code> 对象。\r\n     */\r\n    static removeChannel(channel: SoundChannel): void {\r\n        var i: number;\r\n        for (i = SoundManager._channels.length - 1; i >= 0; i--) {\r\n            if (SoundManager._channels[i] == channel) {\r\n                SoundManager._channels.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    static disposeSoundLater(url: string): void {\r\n        SoundManager._lastSoundUsedTimeDic[url] = ILaya.Browser.now();\r\n        if (!SoundManager._isCheckingDispose) {\r\n            SoundManager._isCheckingDispose = true;\r\n            ILaya.timer.loop(5000, null, SoundManager._checkDisposeSound);\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    private static _checkDisposeSound(): void {\r\n        var key: string;\r\n        var tTime: number = ILaya.Browser.now();\r\n        var hasCheck: boolean = false;\r\n        for (key in SoundManager._lastSoundUsedTimeDic) {\r\n            if (tTime - SoundManager._lastSoundUsedTimeDic[key] > 30000) {\r\n                delete SoundManager._lastSoundUsedTimeDic[key];\r\n                SoundManager.disposeSoundIfNotUsed(key);\r\n            } else {\r\n                hasCheck = true;\r\n            }\r\n        }\r\n        if (!hasCheck) {\r\n            SoundManager._isCheckingDispose = false;\r\n            ILaya.timer.clear(null, SoundManager._checkDisposeSound);\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    static disposeSoundIfNotUsed(url: string): void {\r\n        var i: number;\r\n        for (i = SoundManager._channels.length - 1; i >= 0; i--) {\r\n            if (SoundManager._channels[i].url == url) {\r\n                return;\r\n            }\r\n        }\r\n        SoundManager.destroySound(url);\r\n    }\r\n\r\n    /**\r\n     * 失去焦点后是否自动停止背景音乐。\r\n     * @param v Boolean 失去焦点后是否自动停止背景音乐。\r\n     *\r\n     */\r\n    static set autoStopMusic(v: boolean) {\r\n        ILaya.stage.off(Event.BLUR, null, SoundManager._stageOnBlur);\r\n        ILaya.stage.off(Event.FOCUS, null, SoundManager._stageOnFocus);\r\n        ILaya.stage.off(Event.VISIBILITY_CHANGE, null, SoundManager._visibilityChange);\r\n        SoundManager._autoStopMusic = v;\r\n        if (v) {\r\n            ILaya.stage.on(Event.BLUR, null, SoundManager._stageOnBlur);\r\n            ILaya.stage.on(Event.FOCUS, null, SoundManager._stageOnFocus);\r\n            ILaya.stage.on(Event.VISIBILITY_CHANGE, null, SoundManager._visibilityChange);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 失去焦点后是否自动停止背景音乐。\r\n     */\r\n    static get autoStopMusic(): boolean {\r\n        return SoundManager._autoStopMusic;\r\n    }\r\n\r\n    private static _visibilityChange(): void {\r\n        if (ILaya.stage.isVisibility) {\r\n            SoundManager._stageOnFocus();\r\n        } else {\r\n            SoundManager._stageOnBlur();\r\n        }\r\n    }\r\n\r\n    private static _stageOnBlur(): void {\r\n        SoundManager._isActive = false;\r\n        if (SoundManager._musicChannel) {\r\n            if (!SoundManager._musicChannel.isStopped) {\r\n                SoundManager._blurPaused = true;\r\n                SoundManager._musicChannel.pause();\r\n\r\n            }\r\n\r\n        }\r\n        SoundManager.stopAllSound();\r\n        ILaya.stage.once(Event.MOUSE_DOWN, null, SoundManager._stageOnFocus);\r\n    }\r\n\r\n    private static _recoverWebAudio(): void {\r\n        if (WebAudioSound.ctx && WebAudioSound.ctx.state != \"running\" && WebAudioSound.ctx.resume)\r\n            WebAudioSound.ctx.resume();\r\n    }\r\n\r\n    private static _stageOnFocus(): void {\r\n        SoundManager._isActive = true;\r\n        SoundManager._recoverWebAudio();\r\n        ILaya.stage.off(Event.MOUSE_DOWN, null, SoundManager._stageOnFocus);\r\n        if (SoundManager._blurPaused) {\r\n            if (SoundManager._musicChannel && SoundManager._musicChannel.isStopped) {\r\n                SoundManager._blurPaused = false;\r\n                SoundManager._musicChannel.resume();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 背景音乐和所有音效是否静音。\r\n     */\r\n    static set muted(value: boolean) {\r\n        if (value == SoundManager._muted) return;\r\n        if (value) {\r\n            SoundManager.stopAllSound();\r\n        }\r\n        SoundManager.musicMuted = value;\r\n        SoundManager._muted = value;\r\n    }\r\n\r\n    static get muted(): boolean {\r\n        return SoundManager._muted;\r\n    }\r\n\r\n    /**\r\n     * 所有音效（不包括背景音乐）是否静音。\r\n     */\r\n    static set soundMuted(value: boolean) {\r\n        SoundManager._soundMuted = value;\r\n    }\r\n\r\n    static get soundMuted(): boolean {\r\n        return SoundManager._soundMuted;\r\n    }\r\n\r\n    /**\r\n     * 背景音乐（不包括音效）是否静音。\r\n     */\r\n    static set musicMuted(value: boolean) {\r\n        if (value == SoundManager._musicMuted) return;\r\n        if (value) {\r\n            if (SoundManager._bgMusic) {\r\n                if (SoundManager._musicChannel && !SoundManager._musicChannel.isStopped) {\r\n                    if (ILaya.Render.isConchApp) {\r\n                        if ((SoundManager._musicChannel as any)._audio) (SoundManager._musicChannel as any)._audio.muted = true;;\r\n                    }\r\n                    else {\r\n                        SoundManager._musicChannel.pause();\r\n                    }\r\n                } else {\r\n                    SoundManager._musicChannel = null;\r\n                }\r\n            } else {\r\n                SoundManager._musicChannel = null;\r\n            }\r\n\r\n            SoundManager._musicMuted = value;\r\n        } else {\r\n            SoundManager._musicMuted = value;\r\n            if (SoundManager._bgMusic) {\r\n                if (SoundManager._musicChannel) {\r\n                    if (ILaya.Render.isConchApp) {\r\n                        if ((SoundManager._musicChannel as any)._audio) (SoundManager._musicChannel as any)._audio.muted = false;;\r\n                    }\r\n                    else {\r\n                        SoundManager._musicChannel.resume();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    static get musicMuted(): boolean {\r\n        return SoundManager._musicMuted;\r\n    }\r\n\r\n    static get useAudioMusic(): boolean {\r\n        return SoundManager._useAudioMusic;\r\n    }\r\n\r\n    static set useAudioMusic(value: boolean) {\r\n        SoundManager._useAudioMusic = value;\r\n        if (value) {\r\n            SoundManager._musicClass = AudioSound;\r\n        } else {\r\n            SoundManager._musicClass = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 播放音效。音效可以同时播放多个。\r\n     * @param url\t\t\t声音文件地址。\r\n     * @param loops\t\t\t循环次数,0表示无限循环。\r\n     * @param complete\t\t声音播放完成回调  Handler对象。\r\n     * @param soundClass\t使用哪个声音类进行播放，null表示自动选择。\r\n     * @param startTime\t\t声音播放起始时间。\r\n     * @return SoundChannel对象，通过此对象可以对声音进行控制，以及获取声音信息。\r\n     */\r\n    static playSound(url: string, loops: number = 1, complete: Handler = null, soundClass: new () => any = null, startTime: number = 0): SoundChannel {\r\n        if (!SoundManager._isActive || !url) return null;\r\n        if (SoundManager._muted) return null;\r\n        SoundManager._recoverWebAudio();\r\n        url = URL.formatURL(url);\r\n        if (url == SoundManager._bgMusic) {\r\n            if (SoundManager._musicMuted) return null;\r\n        } else {\r\n            if (ILaya.Render.isConchApp) {\r\n                var ext: string = Utils.getFileExtension(url);\r\n                if (ext != \"wav\" && ext != \"ogg\") {\r\n                    alert(\"The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document.\");\r\n                    return null;\r\n                }\r\n            }\r\n            if (SoundManager._soundMuted) return null;\r\n        }\r\n        var tSound: Sound;\r\n        if (!ILaya.Browser.onBDMiniGame && !ILaya.Browser.onMiniGame && !ILaya.Browser.onKGMiniGame && !ILaya.Browser.onQGMiniGame && !ILaya.Browser.onVVMiniGame && !ILaya.Browser.onAlipayMiniGame && !ILaya.Browser.onQQMiniGame && !ILaya.Browser.onBLMiniGame && !ILaya.Browser.onTTMiniGame && !ILaya.Browser.onHWMiniGame) {\r\n            tSound = ILaya.loader.getRes(url);\r\n        }\r\n        if (!soundClass) soundClass = SoundManager._soundClass;\r\n        if (!tSound) {\r\n            tSound = new soundClass();\r\n            tSound.load(url);\r\n            if (!ILaya.Browser.onBDMiniGame && !ILaya.Browser.onMiniGame && !ILaya.Browser.onKGMiniGame && !ILaya.Browser.onQGMiniGame && !ILaya.Browser.onVVMiniGame && !ILaya.Browser.onAlipayMiniGame && !ILaya.Browser.onQQMiniGame && !ILaya.Browser.onBLMiniGame && !ILaya.Browser.onTTMiniGame && !ILaya.Browser.onHWMiniGame) {\r\n                ILaya.Loader.cacheRes(url, tSound);\r\n            }\r\n        }\r\n        var channel: SoundChannel;\r\n        channel = tSound.play(startTime, loops);\r\n        if (!channel) return null;\r\n        channel.url = url;\r\n        channel.volume = (url == SoundManager._bgMusic) ? SoundManager.musicVolume : SoundManager.soundVolume;\r\n        channel.completeHandler = complete;\r\n        return channel;\r\n    }\r\n\r\n    /**\r\n     * 释放声音资源。\r\n     * @param url\t声音播放地址。\r\n     */\r\n    static destroySound(url: string): void {\r\n        var tSound: Sound = ILaya.loader.getRes(url);\r\n        if (tSound) {\r\n            ILaya.Loader.clearRes(url);\r\n            tSound.dispose();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 播放背景音乐。背景音乐同时只能播放一个，如果在播放背景音乐时再次调用本方法，会先停止之前的背景音乐，再播放当前的背景音乐。\r\n     * @param url\t\t声音文件地址。\r\n     * @param loops\t\t循环次数,0表示无限循环。\r\n     * @param complete\t声音播放完成回调,complete 结果参数 true: 播放完成, false/undefined ：stop触发的complete。\r\n     * @param startTime\t声音播放起始时间。\r\n     * @return SoundChannel对象，通过此对象可以对声音进行控制，以及获取声音信息。\r\n     */\r\n    static playMusic(url: string, loops: number = 0, complete: Handler = null, startTime: number = 0): SoundChannel {\r\n        url = URL.formatURL(url);\r\n        SoundManager._bgMusic = url;\r\n        if (SoundManager._musicChannel) SoundManager._musicChannel.stop();\r\n        return SoundManager._musicChannel = SoundManager.playSound(url, loops, complete, SoundManager._musicClass, startTime);\r\n    }\r\n\r\n    /**\r\n     * 停止声音播放。此方法能够停止任意声音的播放（包括背景音乐和音效），只需传入对应的声音播放地址。\r\n     * @param url  声音文件地址。\r\n     */\r\n    static stopSound(url: string): void {\r\n        url = URL.formatURL(url);\r\n        var i: number;\r\n        var channel: SoundChannel;\r\n        for (i = SoundManager._channels.length - 1; i >= 0; i--) {\r\n            channel = SoundManager._channels[i];\r\n            if (channel.url == url) {\r\n                channel.stop();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 停止播放所有声音（包括背景音乐和音效）。\r\n     */\r\n    static stopAll(): void {\r\n        SoundManager._bgMusic = null;\r\n        var i: number;\r\n        var channel: SoundChannel;\r\n        for (i = SoundManager._channels.length - 1; i >= 0; i--) {\r\n            channel = SoundManager._channels[i];\r\n            channel.stop();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 停止播放所有音效（不包括背景音乐）。\r\n     */\r\n    static stopAllSound(): void {\r\n        var i: number;\r\n        var channel: SoundChannel;\r\n        for (i = SoundManager._channels.length - 1; i >= 0; i--) {\r\n            channel = SoundManager._channels[i];\r\n            if (channel.url != SoundManager._bgMusic) {\r\n                channel.stop();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 停止播放背景音乐（不包括音效）。\r\n     * @param url  声音文件地址。\r\n     */\r\n    static stopMusic(): void {\r\n        if (SoundManager._musicChannel) SoundManager._musicChannel.stop();\r\n        SoundManager._bgMusic = null;\r\n    }\r\n\r\n    /**\r\n     * 设置声音音量。根据参数不同，可以分别设置指定声音（背景音乐或音效）音量或者所有音效（不包括背景音乐）音量。\r\n     * @param volume\t音量。初始值为1。音量范围从 0（静音）至 1（最大音量）。\r\n     * @param url\t\t(default = null)声音播放地址。默认为null。为空表示设置所有音效（不包括背景音乐）的音量，不为空表示设置指定声音（背景音乐或音效）的音量。\r\n     */\r\n    static setSoundVolume(volume: number, url: string = null): void {\r\n        if (url) {\r\n            url = URL.formatURL(url);\r\n            SoundManager._setVolume(url, volume);\r\n        } else {\r\n            SoundManager.soundVolume = volume;\r\n            var i: number;\r\n            var channel: SoundChannel;\r\n            for (i = SoundManager._channels.length - 1; i >= 0; i--) {\r\n                channel = SoundManager._channels[i];\r\n                if (channel.url != SoundManager._bgMusic) {\r\n                    channel.volume = volume;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置背景音乐音量。音量范围从 0（静音）至 1（最大音量）。\r\n     * @param volume\t音量。初始值为1。音量范围从 0（静音）至 1（最大音量）。\r\n     */\r\n    static setMusicVolume(volume: number): void {\r\n        SoundManager.musicVolume = volume;\r\n        SoundManager._setVolume(SoundManager._bgMusic, volume);\r\n    }\r\n\r\n    /**\r\n     * 设置指定声音的音量。\r\n     * @param url\t\t声音文件url\r\n     * @param volume\t音量。初始值为1。\r\n     */\r\n    private static _setVolume(url: string, volume: number): void {\r\n        url = URL.formatURL(url);\r\n        var i: number;\r\n        var channel: SoundChannel;\r\n        for (i = SoundManager._channels.length - 1; i >= 0; i--) {\r\n            channel = SoundManager._channels[i];\r\n            if (channel.url == url) {\r\n                channel.volume = volume;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n","import { ILaya } from \"../../ILaya\";\r\n\r\n\r\n/**\r\n * 模板，预制件\r\n */\r\nexport class Prefab {\r\n\t/**@private */\r\n\tjson: any;\r\n\r\n\t/**\r\n\t * 通过预制创建实例\r\n\t */\r\n\tcreate(): any {\r\n\t\tif (this.json) return ILaya.SceneUtils.createByData(null, this.json);\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\n","import { Sprite } from \"./Sprite\";\r\nimport { Rectangle } from \"../maths/Rectangle\"\r\nimport { Texture } from \"../resource/Texture\"\r\nimport { Handler } from \"../utils/Handler\"\r\nimport { ILaya } from \"../../ILaya\";\r\nimport { ClassUtils } from \"../utils/ClassUtils\";\r\n/**\r\n * <code>BitmapFont</code> 是位图字体类，用于定义位图字体信息。\r\n * 字体制作及使用方法，请参考文章\r\n * @see http://ldc2.layabox.com/doc/?nav=ch-js-1-2-5\r\n */\r\nexport class BitmapFont {\r\n    private _texture: Texture;\r\n    private _fontCharDic: any = {};\r\n    private _fontWidthMap: any = {};\r\n    private _complete: Handler;\r\n    private _path: string;\r\n    private _maxWidth: number = 0;\r\n    private _spaceWidth: number = 10;\r\n    private _padding: any[];\r\n\r\n    /**当前位图字体字号，使用时，如果字号和设置不同，并且autoScaleSize=true，则按照设置字号比率进行缩放显示。*/\r\n    fontSize: number = 12;\r\n    /**表示是否根据实际使用的字体大小缩放位图字体大小。*/\r\n    autoScaleSize: boolean = false;\r\n    /**字符间距（以像素为单位）。*/\r\n    letterSpacing: number = 0;\r\n\r\n    /**\r\n     * 通过指定位图字体文件路径，加载位图字体文件，加载完成后会自动解析。\r\n     * @param\tpath\t\t位图字体文件的路径。\r\n     * @param\tcomplete\t加载并解析完成的回调。\r\n     */\r\n    loadFont(path: string, complete: Handler): void {\r\n        this._path = path;\r\n        this._complete = complete;\r\n\r\n        if (!path || path.indexOf(\".fnt\") === -1) {\r\n            console.error('Bitmap font configuration information must be a \".fnt\" file');\r\n            return;\r\n        }\r\n        ILaya.loader.load([{ url: path, type: ILaya.Loader.XML }, { url: path.replace(\".fnt\", \".png\"), type: ILaya.Loader.IMAGE }], Handler.create(this, this._onLoaded));\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private _onLoaded(): void {\r\n        this.parseFont(ILaya.Loader.getRes(this._path), ILaya.Loader.getRes(this._path.replace(\".fnt\", \".png\")));\r\n        this._complete && this._complete.run();\r\n    }\r\n\r\n    /**\r\n     * 解析字体文件。\r\n     * @param\txml\t\t\t字体文件XML。\r\n     * @param\ttexture\t\t字体的纹理。\r\n     */\r\n    parseFont(xml: XMLDocument, texture: Texture): void {\r\n        if (xml == null || texture == null) return;\r\n        this._texture = texture;\r\n        var tX: number = 0;\r\n        var tScale: number = 1;\r\n\r\n        var tInfo: any = xml.getElementsByTagName(\"info\");\r\n        if (!tInfo[0].getAttributeNode) {\r\n            return this.parseFont2(xml, texture);\r\n        }\r\n        this.fontSize = parseInt(tInfo[0].getAttributeNode(\"size\").nodeValue);\r\n\r\n        var tPadding: string = tInfo[0].getAttributeNode(\"padding\").nodeValue;\r\n        var tPaddingArray: any[] = tPadding.split(\",\");\r\n        this._padding = [parseInt(tPaddingArray[0]), parseInt(tPaddingArray[1]), parseInt(tPaddingArray[2]), parseInt(tPaddingArray[3])];\r\n\r\n        var chars = xml.getElementsByTagName(\"char\");\r\n        var i: number = 0;\r\n        for (i = 0; i < chars.length; i++) {\r\n            var tAttribute: any = chars[i];\r\n            var tId: number = parseInt(tAttribute.getAttributeNode(\"id\").nodeValue);\r\n\r\n            var xOffset: number = parseInt(tAttribute.getAttributeNode(\"xoffset\").nodeValue) / tScale;\r\n            var yOffset: number = parseInt(tAttribute.getAttributeNode(\"yoffset\").nodeValue) / tScale;\r\n            var xAdvance: number = parseInt(tAttribute.getAttributeNode(\"xadvance\").nodeValue) / tScale;\r\n\r\n            var region: Rectangle = new Rectangle();\r\n            region.x = parseInt(tAttribute.getAttributeNode(\"x\").nodeValue);\r\n            region.y = parseInt(tAttribute.getAttributeNode(\"y\").nodeValue);\r\n            region.width = parseInt(tAttribute.getAttributeNode(\"width\").nodeValue);\r\n            region.height = parseInt(tAttribute.getAttributeNode(\"height\").nodeValue);\r\n\r\n            var tTexture: Texture = Texture.create(texture, region.x, region.y, region.width, region.height, xOffset, yOffset);\r\n            this._maxWidth = Math.max(this._maxWidth, xAdvance + this.letterSpacing);\r\n            this._fontCharDic[tId] = tTexture;\r\n            this._fontWidthMap[tId] = xAdvance;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 解析字体文件。\r\n     * @param\txml\t\t\t字体文件XML。\r\n     * @param\ttexture\t\t字体的纹理。\r\n     */\r\n    parseFont2(xml: XMLDocument, texture: Texture): void {\r\n        if (xml == null || texture == null) return;\r\n        this._texture = texture;\r\n        var tX: number = 0;\r\n        var tScale: number = 1;\r\n\r\n        var tInfo: any = xml.getElementsByTagName(\"info\");\r\n        this.fontSize = parseInt(tInfo[0].attributes[\"size\"].nodeValue);\r\n\r\n        var tPadding: string = tInfo[0].attributes[\"padding\"].nodeValue;\r\n        var tPaddingArray: any[] = tPadding.split(\",\");\r\n        this._padding = [parseInt(tPaddingArray[0]), parseInt(tPaddingArray[1]), parseInt(tPaddingArray[2]), parseInt(tPaddingArray[3])];\r\n\r\n        var chars = xml.getElementsByTagName(\"char\");\r\n        var i: number = 0;\r\n        for (i = 0; i < chars.length; i++) {\r\n            var tAttribute = chars[i].attributes;\r\n            var tId: number = parseInt(tAttribute[\"id\"].nodeValue);\r\n\r\n            var xOffset: number = parseInt(tAttribute[\"xoffset\"].nodeValue) / tScale;\r\n            var yOffset: number = parseInt(tAttribute[\"yoffset\"].nodeValue) / tScale;\r\n\r\n            var xAdvance: number = parseInt(tAttribute[\"xadvance\"].nodeValue) / tScale;\r\n\r\n            var region: Rectangle = new Rectangle();\r\n            region.x = parseInt(tAttribute[\"x\"].nodeValue);\r\n            region.y = parseInt(tAttribute[\"y\"].nodeValue);\r\n            region.width = parseInt(tAttribute[\"width\"].nodeValue);\r\n            region.height = parseInt(tAttribute[\"height\"].nodeValue);\r\n\r\n            var tTexture: Texture = Texture.create(texture, region.x, region.y, region.width, region.height, xOffset, yOffset);\r\n            this._maxWidth = Math.max(this._maxWidth, xAdvance + this.letterSpacing);\r\n            this._fontCharDic[tId] = tTexture;\r\n            this._fontWidthMap[tId] = xAdvance;\r\n        }\r\n    }\r\n    /**\r\n     * 获取指定字符的字体纹理对象。\r\n     * @param\tchar 字符。\r\n     * @return 指定的字体纹理对象。\r\n     */\r\n    getCharTexture(char: string): Texture {\r\n        return this._fontCharDic[char.charCodeAt(0)];\r\n    }\r\n\r\n    /**\r\n     * 销毁位图字体，调用Text.unregisterBitmapFont 时，默认会销毁。\r\n     */\r\n    destroy(): void {\r\n        if (this._texture) {\r\n            for (var p in this._fontCharDic) {\r\n                var tTexture: Texture = this._fontCharDic[p];\r\n                if (tTexture) tTexture.destroy();\r\n            }\r\n            this._texture.destroy();\r\n            this._fontCharDic = null;\r\n            this._fontWidthMap = null;\r\n            this._texture = null;\r\n            this._complete = null;\r\n            this._padding = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置空格的宽（如果字体库有空格，这里就可以不用设置了）。\r\n     * @param\tspaceWidth 宽度，单位为像素。\r\n     */\r\n    setSpaceWidth(spaceWidth: number): void {\r\n        this._spaceWidth = spaceWidth;\r\n    }\r\n\r\n    /**\r\n     * 获取指定字符的宽度。\r\n     * @param\tchar 字符。\r\n     * @return  宽度。\r\n     */\r\n    getCharWidth(char: string): number {\r\n        var code: number = char.charCodeAt(0);\r\n        if (this._fontWidthMap[code]) return this._fontWidthMap[code] + this.letterSpacing;\r\n        if (char === \" \") return this._spaceWidth + this.letterSpacing;\r\n        return 0;\r\n    }\r\n\r\n    /**\r\n     * 获取指定文本内容的宽度。\r\n     * @param\ttext 文本内容。\r\n     * @return  宽度。\r\n     */\r\n    getTextWidth(text: string): number {\r\n        var tWidth: number = 0;\r\n        for (var i: number = 0, n: number = text.length; i < n; i++) {\r\n            tWidth += this.getCharWidth(text.charAt(i));\r\n        }\r\n        return tWidth;\r\n    }\r\n\r\n    /**\r\n     * 获取最大字符宽度。\r\n     */\r\n    getMaxWidth(): number {\r\n        return this._maxWidth;\r\n    }\r\n\r\n    /**\r\n     * 获取最大字符高度。\r\n     */\r\n    getMaxHeight(): number {\r\n        return this.fontSize;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 将指定的文本绘制到指定的显示对象上。\r\n     */\r\n    _drawText(text: string, sprite: Sprite, drawX: number, drawY: number, align: string, width: number): void {\r\n        var tWidth: number = this.getTextWidth(text);\r\n        var tTexture: Texture;\r\n        var dx: number = 0;\r\n        align === \"center\" && (dx = (width - tWidth) / 2);\r\n        align === \"right\" && (dx = (width - tWidth));\r\n        var tx: number = 0;\r\n        for (var i: number = 0, n: number = text.length; i < n; i++) {\r\n            tTexture = this.getCharTexture(text.charAt(i));\r\n            if (tTexture) {\r\n                sprite.graphics.drawImage(tTexture, drawX + tx + dx, drawY);\r\n                tx += this.getCharWidth(text.charAt(i));\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nClassUtils.regClass(\"laya.display.BitmapFont\", BitmapFont);\r\nClassUtils.regClass(\"Laya.BitmapFont\", BitmapFont);","import { URL } from \"./URL\";\r\nimport { Event } from \"../events/Event\"\r\nimport { EventDispatcher } from \"../events/EventDispatcher\"\r\nimport { Utils } from \"../utils/Utils\"\r\nimport { Browser } from \"../utils/Browser\";\r\n\r\n/**\r\n * 请求进度改变时调度。\r\n * @eventType Event.PROGRESS\r\n * */\r\n/*[Event(name = \"progress\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 请求结束后调度。\r\n * @eventType Event.COMPLETE\r\n * */\r\n/*[Event(name = \"complete\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 请求出错时调度。\r\n * @eventType Event.ERROR\r\n * */\r\n/*[Event(name = \"error\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * <p> <code>HttpRequest</code> 通过封装 HTML <code>XMLHttpRequest</code> 对象提供了对 HTTP 协议的完全的访问，包括做出 POST 和 HEAD 请求以及普通的 GET 请求的能力。 <code>HttpRequest</code> 只提供以异步的形式返回 Web 服务器的响应，并且能够以文本或者二进制的形式返回内容。</p>\r\n * <p><b>注意：</b>建议每次请求都使用新的 <code>HttpRequest</code> 对象，因为每次调用该对象的send方法时，都会清空之前设置的数据，并重置 HTTP 请求的状态，这会导致之前还未返回响应的请求被重置，从而得不到之前请求的响应结果。</p>\r\n */\r\nexport class HttpRequest extends EventDispatcher {\r\n    /**@private */\r\n    protected _http = new XMLHttpRequest();\r\n    /**@private */\r\n    private static _urlEncode:Function = encodeURI;\r\n    /**@private */\r\n    protected _responseType: string;\r\n    /**@private */\r\n    protected _data: any;\r\n    /**@private */\r\n    protected _url: string;\r\n\r\n    /**\r\n     * 发送 HTTP 请求。\r\n     * @param\turl\t\t\t\t请求的地址。大多数浏览器实施了一个同源安全策略，并且要求这个 URL 与包含脚本的文本具有相同的主机名和端口。\r\n     * @param\tdata\t\t\t(default = null)发送的数据。\r\n     * @param\tmethod\t\t\t(default = \"get\")用于请求的 HTTP 方法。值包括 \"get\"、\"post\"、\"head\"。\r\n     * @param\tresponseType\t(default = \"text\")Web 服务器的响应类型，可设置为 \"text\"、\"json\"、\"xml\"、\"arraybuffer\"。\r\n     * @param\theaders\t\t\t(default = null) HTTP 请求的头部信息。参数形如key-value数组：key是头部的名称，不应该包括空白、冒号或换行；value是头部的值，不应该包括换行。比如[\"Content-Type\", \"application/json\"]。\r\n     */\r\n    send(url: string, data: any = null, method: string = \"get\", responseType: string = \"text\", headers: any[]|null = null): void {\r\n        this._responseType = responseType;\r\n        this._data = null;\r\n\r\n        if (Browser.onVVMiniGame || Browser.onQGMiniGame || Browser.onQQMiniGame || Browser.onAlipayMiniGame || Browser.onBLMiniGame || Browser.onHWMiniGame || Browser.onTTMiniGame) {\r\n            url = HttpRequest._urlEncode(url);\r\n        }\r\n        this._url = url;\r\n        var _this: HttpRequest = this;\r\n        var http = this._http;\r\n        //临时，因为微信不支持以下文件格式\r\n        url = URL.getAdptedFilePath(url);\r\n\t\thttp.open(method, url, true);\r\n\t\tlet isJson = false;\r\n        if (headers) {\r\n            for (var i: number = 0; i < headers.length; i++) {\r\n                http.setRequestHeader(headers[i++], headers[i]);\r\n            }\r\n        } else if (!(((<any>window)).conch)) {\r\n            if (!data || typeof (data) == 'string') http.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n\t\t\telse{ \r\n\t\t\t\thttp.setRequestHeader(\"Content-Type\", \"application/json\");\r\n\t\t\t\tisJson=true;\r\n\t\t\t}\r\n        }\r\n        let restype: XMLHttpRequestResponseType = responseType !== \"arraybuffer\" ? \"text\" : \"arraybuffer\";\r\n        http.responseType = restype;\r\n        if ((http as any).dataType) {//for Ali\r\n            (http as any).dataType = restype;\r\n        }\r\n        http.onerror = function (e: any): void {\r\n            _this._onError(e);\r\n        }\r\n        http.onabort = function (e: any): void {\r\n            _this._onAbort(e);\r\n        }\r\n        http.onprogress = function (e: any): void {\r\n            _this._onProgress(e);\r\n        }\r\n        http.onload = function (e: any): void {\r\n            _this._onLoad(e);\r\n        }\r\n        if(Browser.onBLMiniGame&&Browser.onAndroid&&!data)data={};\r\n        http.send( isJson?JSON.stringify(data):data);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 请求进度的侦听处理函数。\r\n     * @param\te 事件对象。\r\n     */\r\n    protected _onProgress(e: any): void {\r\n        if (e && e.lengthComputable) this.event(Event.PROGRESS, e.loaded / e.total);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 请求中断的侦听处理函数。\r\n     * @param\te 事件对象。\r\n     */\r\n    protected _onAbort(e: any): void {\r\n        this.error(\"Request was aborted by user\");\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 请求出错侦的听处理函数。\r\n     * @param\te 事件对象。\r\n     */\r\n    protected _onError(e: any): void {\r\n        this.error(\"Request failed Status:\" + this._http.status + \" text:\" + this._http.statusText);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 请求消息返回的侦听处理函数。\r\n     * @param\te 事件对象。\r\n     */\r\n    protected _onLoad(e: any): void {\r\n        var http: any = this._http;\r\n        var status: number = http.status !== undefined ? http.status : 200;\r\n\r\n        if (status === 200 || status === 204 || status === 0) {\r\n            this.complete();\r\n        } else {\r\n            this.error(\"[\" + http.status + \"]\" + http.statusText + \":\" + http.responseURL);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 请求错误的处理函数。\r\n     * @param\tmessage 错误信息。\r\n     */\r\n    protected error(message: string): void {\r\n        this.clear();\r\n        console.warn(this.url, message);\r\n        this.event(Event.ERROR, message);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 请求成功完成的处理函数。\r\n     */\r\n    protected complete(): void {\r\n        this.clear();\r\n        var flag: boolean = true;\r\n        try {\r\n            if (this._responseType === \"json\") {\r\n                this._data = JSON.parse(this._http.responseText);\r\n            } else if (this._responseType === \"xml\") {\r\n                this._data = Utils.parseXMLFromString(this._http.responseText);\r\n            } else {\r\n                this._data = this._http.response || this._http.responseText;\r\n            }\r\n        } catch (e) {\r\n            flag = false;\r\n            this.error(e.message);\r\n        }\r\n        flag && this.event(Event.COMPLETE, this._data instanceof Array ? [this._data] : this._data);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 清除当前请求。\r\n     */\r\n    protected clear(): void {\r\n        var http: any = this._http;\r\n        http.onerror = http.onabort = http.onprogress = http.onload = null;\r\n    }\r\n\r\n    /** 请求的地址。*/\r\n    get url(): string {\r\n        return this._url;\r\n    }\r\n\r\n    /** 返回的数据。*/\r\n    get data(): any {\r\n        return this._data;\r\n    }\r\n\r\n    /**\r\n     * 本对象所封装的原生 XMLHttpRequest 引用。\r\n     */\r\n    get http(): any {\r\n        return this._http;\r\n    }\r\n}\r\n\r\n","import { ILaya } from \"../../ILaya\";\r\nimport { Prefab } from \"../components/Prefab\";\r\nimport { Text } from \"../display/Text\";\r\nimport { Event } from \"../events/Event\";\r\nimport { EventDispatcher } from \"../events/EventDispatcher\";\r\nimport { Sound } from \"../media/Sound\";\r\nimport { SoundManager } from \"../media/SoundManager\";\r\nimport { BaseTexture } from \"../resource/BaseTexture\";\r\nimport { Texture } from \"../resource/Texture\";\r\nimport { Texture2D } from \"../resource/Texture2D\";\r\nimport { Browser } from \"../utils/Browser\";\r\nimport { Byte } from \"../utils/Byte\";\r\nimport { Handler } from \"../utils/Handler\";\r\nimport { Utils } from \"../utils/Utils\";\r\nimport { BitmapFont } from \"./../display/BitmapFont\";\r\nimport { HttpRequest } from \"./HttpRequest\";\r\nimport { TTFLoader } from \"./TTFLoader\";\r\nimport { URL } from \"./URL\";\r\nimport { TextureFormat } from \"../resource/TextureFormat\";\r\nimport { WarpMode } from \"../resource/WrapMode\";\r\n\r\n/**\r\n * 加载进度发生改变时调度。\r\n * @eventType Event.PROGRESS\r\n * */\r\n/*[Event(name = \"progress\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 加载完成后调度。\r\n * @eventType Event.COMPLETE\r\n * */\r\n/*[Event(name = \"complete\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 加载出错时调度。\r\n * @eventType Event.ERROR\r\n * */\r\n/*[Event(name = \"error\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * <code>Loader</code> 类可用来加载文本、JSON、XML、二进制、图像等资源。\r\n */\r\nexport class Loader extends EventDispatcher {\r\n\t/**文本类型，加载完成后返回文本。*/\r\n\tstatic TEXT = \"text\";\r\n\t/**JSON 类型，加载完成后返回json数据。*/\r\n\tstatic JSON = \"json\";\r\n\t/**prefab 类型，加载完成后返回Prefab实例。*/\r\n\tstatic PREFAB = \"prefab\";\r\n\t/**XML 类型，加载完成后返回domXML。*/\r\n\tstatic XML = \"xml\";\r\n\t/**二进制类型，加载完成后返回arraybuffer二进制数据。*/\r\n\tstatic BUFFER = \"arraybuffer\";\r\n\t/**纹理类型，加载完成后返回Texture。*/\r\n\tstatic IMAGE = \"image\";\r\n\t/**声音类型，加载完成后返回sound。*/\r\n\tstatic SOUND = \"sound\";\r\n\t/**图集类型，加载完成后返回图集json信息(并创建图集内小图Texture)。*/\r\n\tstatic ATLAS = \"atlas\";\r\n\t/**位图字体类型，加载完成后返回BitmapFont，加载后，会根据文件名自动注册为位图字体。*/\r\n\tstatic FONT = \"font\";\r\n\t/** TTF字体类型，加载完成后返回null。*/\r\n\tstatic TTF = \"ttf\";\r\n\t/** 预加载文件类型，加载完成后自动解析到preLoadedMap。*/\r\n\tstatic PLF = \"plf\";\r\n\t/** 二进制预加载文件类型，加载完成后自动解析到preLoadedMap。*/\r\n\tstatic PLFB = \"plfb\";\r\n\t/**Hierarchy资源。*/\r\n\tstatic HIERARCHY = \"HIERARCHY\";\r\n\t/**Mesh资源。*/\r\n\tstatic MESH = \"MESH\";\r\n\t/**Material资源。*/\r\n\tstatic MATERIAL = \"MATERIAL\";\r\n\t/**Texture2D资源。*/\r\n\tstatic TEXTURE2D = \"TEXTURE2D\";\r\n\t/**TextureCube资源。*/\r\n\tstatic TEXTURECUBE = \"TEXTURECUBE\";\r\n\t/**AnimationClip资源。*/\r\n\tstatic ANIMATIONCLIP = \"ANIMATIONCLIP\";\r\n\t/**Avatar资源。*/\r\n\tstatic AVATAR = \"AVATAR\";\r\n\t/**Terrain资源。*/\r\n\tstatic TERRAINHEIGHTDATA = \"TERRAINHEIGHTDATA\";\r\n\t/**Terrain资源。*/\r\n\tstatic TERRAINRES = \"TERRAIN\";\r\n\r\n\t/**文件后缀和类型对应表。*/\r\n\tstatic typeMap: { [key: string]: string } = { \"ttf\": \"ttf\", \"png\": \"image\", \"jpg\": \"image\", \"jpeg\": \"image\", \"ktx\": \"image\", \"pvr\": \"image\", \"txt\": \"text\", \"json\": \"json\", \"prefab\": \"prefab\", \"xml\": \"xml\", \"als\": \"atlas\", \"atlas\": \"atlas\", \"mp3\": \"sound\", \"ogg\": \"sound\", \"wav\": \"sound\", \"part\": \"json\", \"fnt\": \"font\", \"plf\": \"plf\", \"plfb\": \"plfb\", \"scene\": \"json\", \"ani\": \"json\", \"sk\": \"arraybuffer\" };\r\n\t/**资源解析函数对应表，用来扩展更多类型的资源加载解析。*/\r\n\tstatic parserMap: any = {};\r\n\t/**每帧加载完成回调使用的最大超时时间，如果超时，则下帧再处理，防止帧卡顿。*/\r\n\tstatic maxTimeOut: number = 100;\r\n\t/**资源分组对应表。*/\r\n\tstatic groupMap: { [key: string]: string[] } = {};\r\n\t/**已加载的资源池。*/\r\n\tstatic loadedMap: { [key: string]: any } = {};\r\n\t/**已加载的图集资源池。*/\r\n\tstatic atlasMap: { [key: string]: any[] } = {};\r\n\t/**已加载的纹理资源池。*/\r\n\tstatic textureMap: { [key: string]: Texture } = {};\r\n\t/** @private 已加载的数据文件。*/\r\n\tstatic preLoadedMap: { [key: string]: ArrayBuffer } = {};\r\n\t/**@private 引用image对象，防止垃圾回收*/\r\n\tprotected static _imgCache: { [key: string]: HTMLImageElement } = {};\r\n\t/**@private */\r\n\tprotected static _loaders: Loader[] = [];\r\n\t/**@private */\r\n\tprotected static _isWorking = false;\r\n\t/**@private */\r\n\tprotected static _startIndex: number = 0;\r\n\r\n\t/**\r\n\t * 获取指定资源地址的数据类型。\r\n\t * @param\turl 资源地址。\r\n\t * @return 数据类型。\r\n\t */\r\n\tstatic getTypeFromUrl(url: string): string {\r\n\t\tvar type = Utils.getFileExtension(url);\r\n\t\tif (type) return Loader.typeMap[type];\r\n\t\tconsole.warn(\"Not recognize the resources suffix\", url);\r\n\t\treturn \"text\";\r\n\t}\r\n\r\n\t/**@internal 加载后的数据对象，只读*/\r\n\t_data: any;\r\n\t/**@private */\r\n\tprotected _url: string;\r\n\t/**@private */\r\n\tprotected _type: string;\r\n\t/**@internal */\r\n\t_cache: boolean;\r\n\t/**@private */\r\n\tprotected _http: HttpRequest;\r\n\t/**@private */\r\n\tprotected _useWorkerLoader: boolean;\r\n\t/**@internal 自定义解析不派发complete事件，但会派发loaded事件，手动调用endLoad方法再派发complete事件*/\r\n\t_customParse = false;\r\n\t/**@internal */\r\n\t_constructParams: any[] | null;\r\n\t/**@internal */\r\n\t_propertyParams: any;\r\n\t/**@internal */\r\n\t_createCache: boolean;\r\n\t/**@internal 原始加载类型 */\r\n\t_originType:string;\r\n\r\n\t/**\r\n\t * 加载资源。加载错误会派发 Event.ERROR 事件，参数为错误信息。\r\n\t * @param\turl\t\t\t资源地址。\r\n\t * @param\ttype\t\t(default = null)资源类型。可选值为：Loader.TEXT、Loader.JSON、Loader.XML、Loader.BUFFER、Loader.IMAGE、Loader.SOUND、Loader.ATLAS、Loader.FONT。如果为null，则根据文件后缀分析类型。\r\n\t * @param\tcache\t\t(default = true)是否缓存数据。\r\n\t * @param\tgroup\t\t(default = null)分组名称。\r\n\t * @param\tignoreCache (default = false)是否忽略缓存，强制重新加载。\r\n\t * @param\tuseWorkerLoader(default = false)是否使用worker加载（只针对IMAGE类型和ATLAS类型，并且浏览器支持的情况下生效）\r\n\t */\r\n\tload(url: string, type: string | null = null, cache: boolean = true, group: string | null = null, ignoreCache: boolean = false, useWorkerLoader: boolean = ILaya.WorkerLoader.enable): void {\r\n\t\tif (!url) {\r\n\t\t\tthis.onLoaded(null);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tLoader.setGroup(url, \"666\");\r\n\t\tthis._url = url;\r\n\t\tif (url.indexOf(\"data:image\") === 0) type = Loader.IMAGE;\r\n\t\telse url = URL.formatURL(url);\r\n\t\tthis._type = type || (type = Loader.getTypeFromUrl(this._url));\r\n\t\tthis._cache = cache;\r\n\t\tthis._useWorkerLoader = useWorkerLoader;\r\n\t\tthis._data = null;\r\n\t\tif (useWorkerLoader)\r\n\t\t\tILaya.WorkerLoader.enableWorkerLoader();\r\n\r\n\t\tvar cacheRes: any;\r\n\t\tif (type == Loader.IMAGE)\r\n\t\t\tcacheRes = Loader.textureMap[url];\r\n\t\telse\r\n\t\t\tcacheRes = Loader.loadedMap[url];\r\n\t\tif (!ignoreCache && cacheRes) {\r\n\t\t\tthis._data = cacheRes;\r\n\t\t\tthis.event(Event.PROGRESS, 1);\r\n\t\t\tthis.event(Event.COMPLETE, this._data);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (group)\r\n\t\t\tLoader.setGroup(url, group);\r\n\t\t//如果自定义了解析器，则自己解析，自定义解析不派发complete事件，但会派发loaded事件，手动调用endLoad方法再派发complete事件\r\n\t\tif (Loader.parserMap[type] != null) {\r\n\t\t\tthis._customParse = true;\r\n\t\t\tif (Loader.parserMap[type] instanceof Handler) Loader.parserMap[type].runWith(this);\r\n\t\t\telse Loader.parserMap[type].call(null, this);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._loadResourceFilter(type, url);\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_loadResourceFilter(type: string, url: string): void {\r\n\t\tthis._loadResource(type, url);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprivate _loadResource(type: string, url: string): void {\r\n\t\tswitch (type) {\r\n\t\t\tcase Loader.IMAGE:\r\n\t\t\tcase \"htmlimage\": //内部类型\r\n\t\t\tcase \"nativeimage\": //内部类型\r\n\t\t\t\tthis._loadImage(url);\r\n\t\t\t\tbreak;\r\n\t\t\tcase Loader.SOUND:\r\n\t\t\t\tthis._loadSound(url);\r\n\t\t\t\tbreak;\r\n\t\t\tcase Loader.TTF:\r\n\t\t\t\tthis._loadTTF(url);\r\n\t\t\t\tbreak;\r\n\t\t\tcase Loader.ATLAS:\r\n\t\t\tcase Loader.PREFAB:\r\n\t\t\tcase Loader.PLF:\r\n\t\t\t\tthis._loadHttpRequestWhat(url, Loader.JSON);\r\n\t\t\t\tbreak;\r\n\t\t\tcase Loader.FONT:\r\n\t\t\t\tthis._loadHttpRequestWhat(url, Loader.XML);\r\n\t\t\t\tbreak;\r\n\t\t\tcase Loader.PLFB:\r\n\t\t\t\tthis._loadHttpRequestWhat(url, Loader.BUFFER);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthis._loadHttpRequestWhat(url, type);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t * onload、onprocess、onerror必须写在本类\r\n\t */\r\n\tprivate _loadHttpRequest(url: string, contentType: string, onLoadCaller: Object, onLoad: Function | null, onProcessCaller: any, onProcess: Function | null, onErrorCaller: any, onError: Function): void {\r\n\t\tif (Browser.onVVMiniGame||Browser.onHWMiniGame) {\r\n\t\t\tthis._http = new HttpRequest();//临时修复vivo复用xmlhttprequest的bug\r\n\t\t} else {\r\n\t\t\tif (!this._http)\r\n\t\t\t\tthis._http = new HttpRequest();\r\n\t\t}\r\n\t\tonProcess && this._http.on(Event.PROGRESS, onProcessCaller, onProcess);\r\n\t\tonLoad && this._http.on(Event.COMPLETE, onLoadCaller, onLoad);\r\n\t\tthis._http.on(Event.ERROR, onErrorCaller, onError);\r\n\t\tthis._http.send(url, null, \"get\", contentType);\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tprivate _loadHtmlImage(url: string, onLoadCaller: any, onLoad: Function, onErrorCaller: any, onError: Function): void {\r\n\t\tvar image: any;\r\n\t\tfunction clear(): void {\r\n\t\t\tvar img: any = image;\r\n\t\t\timg.onload = null;\r\n\t\t\timg.onerror = null;\r\n\t\t\tdelete Loader._imgCache[url];\r\n\t\t}\r\n\t\tvar onerror: Function = function (): void {\r\n\t\t\tclear();\r\n\t\t\tonError.call(onErrorCaller);\r\n\t\t}\r\n\r\n\t\tvar onload: Function = function (): void {\r\n\t\t\tclear();\r\n\t\t\tonLoad.call(onLoadCaller, image);\r\n\t\t};\r\n\t\timage = new Browser.window.Image();\r\n\t\timage.crossOrigin = \"\";\r\n\t\timage.onload = onload;\r\n\t\timage.onerror = onerror;\r\n\t\timage.src = url;\r\n\t\tLoader._imgCache[url] = image;//增加引用，防止垃圾回收\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_loadHttpRequestWhat(url: string, contentType: string): void {\r\n\t\tif (Loader.preLoadedMap[url])\r\n\t\t\tthis.onLoaded(Loader.preLoadedMap[url]);\r\n\t\telse\r\n\t\t\tthis._loadHttpRequest(url, contentType, this, this.onLoaded, this, this.onProgress, this, this.onError);\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t * 加载TTF资源。\r\n\t * @param\turl 资源地址。\r\n\t */\r\n\tprotected _loadTTF(url: string): void {\r\n\t\turl = URL.formatURL(url);\r\n\t\tvar ttfLoader: TTFLoader = new ILaya.TTFLoader();\r\n\t\tttfLoader.complete = Handler.create(this, this.onLoaded);\r\n\t\tttfLoader.load(url);\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tprotected _loadImage(url: string,isformatURL:boolean = true): void {\r\n\t\tvar _this = this;\r\n\t\tif(isformatURL)\r\n\t\t\turl = URL.formatURL(url);\r\n\t\tvar onError: Function = function (): void {\r\n\t\t\t_this.event(Event.ERROR, \"Load image failed\");\r\n\t\t}\r\n\t\tif (this._type === \"nativeimage\") {\r\n\t\t\tthis._loadHtmlImage(url, this, this.onLoaded, this, onError);\r\n\t\t} else {\r\n\t\t\t\r\n\t\t\t var ext: string = Utils.getFileExtension(url);\r\n\t\t\t if (ext === \"ktx\" || ext === \"pvr\") \r\n\t\t\t\tthis._loadHttpRequest(url, Loader.BUFFER, this, this.onLoaded, this, this.onProgress, this, this.onError);\r\n\t\t\telse\r\n\t\t\t\tthis._loadHtmlImage(url, this, this.onLoaded, this, onError);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t * 加载声音资源。\r\n\t * @param\turl 资源地址。\r\n\t */\r\n\t_loadSound(url: string): void {\r\n\t\tvar sound: Sound = (<Sound>(new SoundManager._soundClass()));\r\n\t\tvar _this: Loader = this;\r\n\r\n\t\tsound.on(Event.COMPLETE, this, soundOnload);\r\n\t\tsound.on(Event.ERROR, this, soundOnErr);\r\n\t\tsound.load(url);\r\n\r\n\t\tfunction soundOnload(): void {\r\n\t\t\tclear();\r\n\t\t\t_this.onLoaded(sound);\r\n\t\t}\r\n\t\tfunction soundOnErr(): void {\r\n\t\t\tclear();\r\n\t\t\tsound.dispose();\r\n\t\t\t_this.event(Event.ERROR, \"Load sound failed\");\r\n\t\t}\r\n\t\tfunction clear(): void {\r\n\t\t\tsound.offAll();\r\n\t\t}\r\n\t}\r\n\r\n\t/**@private */\r\n\tprotected onProgress(value: number): void {\r\n\t\tif (this._type === Loader.ATLAS) this.event(Event.PROGRESS, value * 0.3);\r\n\t\telse if(this._originType == Loader.HIERARCHY) this.event(Event.PROGRESS,value /3);\r\n\t\telse this.event(Event.PROGRESS, value);\r\n\t}\r\n\r\n\t/**@private */\r\n\tprotected onError(message: string): void {\r\n\t\tthis.event(Event.ERROR, message);\r\n\t}\r\n\r\n\t/**\r\n\t * 资源加载完成的处理函数。\r\n\t * @param\tdata 数据。\r\n\t */\r\n\tprotected onLoaded(data: any = null): void {\r\n\t\tvar type = this._type;\r\n\t\tif (type == Loader.PLFB) {\r\n\t\t\tthis.parsePLFBData(data);\r\n\t\t\tthis.complete(data);\r\n\t\t} else if (type == Loader.PLF) {\r\n\t\t\tthis.parsePLFData(data);\r\n\t\t\tthis.complete(data);\r\n\t\t} else if (type === Loader.IMAGE) {\r\n\t\t\tlet tex:Texture2D;\r\n\t\t\t//可能有另外一种情况\r\n\t\t\tif (data instanceof ArrayBuffer) {\r\n\t\t\t\tvar ext: string = Utils.getFileExtension(this._url);\r\n\t\t\t\tlet format: TextureFormat;\r\n\t\t\t\tswitch (ext) {\r\n\t\t\t\t\tcase \"ktx\":\r\n\t\t\t\t\t\tformat = TextureFormat.ETC1RGB;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"pvr\":\r\n\t\t\t\t\t\tformat = TextureFormat.PVRTCRGBA_4BPPV;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: {\r\n\t\t\t\t\t\tconsole.error('unknown format', ext);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ttex = new Texture2D(0, 0, format, false, false);\r\n\t\t\t\ttex.wrapModeU = WarpMode.Clamp;\r\n\t\t\t\ttex.wrapModeV = WarpMode.Clamp;\r\n\t\t\t\ttex.setCompressData(data);\r\n\t\t\t\ttex._setCreateURL(this.url);\r\n\t\t\t} else if(!(data instanceof Texture2D)){\r\n\t\t\t\ttex = new Texture2D(data.width, data.height, 1, false, false);\r\n\t\t\t\ttex.wrapModeU = WarpMode.Clamp;\r\n\t\t\t\ttex.wrapModeV = WarpMode.Clamp;\r\n\t\t\t\ttex.loadImageSource(data, true);\r\n\t\t\t\ttex._setCreateURL(data.src);\r\n\t\t\t}else{\r\n\t\t\t\ttex = data;\r\n\t\t\t}\r\n\t\t\tvar texture: Texture = new Texture(tex);\r\n\t\t\ttexture.url = this._url;\r\n\t\t\tthis.complete(texture);\r\n\t\t\r\n\t\t} else if (type === Loader.SOUND || type === \"nativeimage\") {\r\n\t\t\tthis.complete(data);\r\n\t\t} else if(type === \"htmlimage\" ){\r\n\t\t\tlet tex: Texture2D = new Texture2D(data.width, data.height, 1, false, false);\r\n\t\t\ttex.wrapModeU = WarpMode.Clamp;\r\n\t\t\ttex.wrapModeV = WarpMode.Clamp;\r\n\t\t\ttex.loadImageSource(data, true);\r\n\t\t\ttex._setCreateURL(data.src);\r\n\t\t\tthis.complete(tex);\r\n\t\t}\r\n\t\t else if (type === Loader.ATLAS) {\r\n\t\t\t//处理图集\r\n\t\t\tif (data.frames) {\r\n\t\t\t\tvar toloadPics: string[] = [];\r\n\t\t\t\tif (!this._data) {\r\n\t\t\t\t\tthis._data = data;\r\n\t\t\t\t\t//let cdt = data as Texture2D;\r\n\t\t\t\t\t//构造加载图片信息\r\n\t\t\t\t\tif (data.meta && data.meta.image) {\r\n\t\t\t\t\t\t//带图片信息的类型\r\n\t\t\t\t\t\ttoloadPics = data.meta.image.split(\",\");\r\n\t\t\t\t\t\tvar split: string = this._url.indexOf(\"/\") >= 0 ? \"/\" : \"\\\\\";\r\n\t\t\t\t\t\tvar idx: number = this._url.lastIndexOf(split);\r\n\t\t\t\t\t\tvar folderPath: string = idx >= 0 ? this._url.substr(0, idx + 1) : \"\";\r\n\t\t\t\t\t\tvar changeType: string | null = null;\r\n\r\n\t\t\t\t\t\tif (Browser.onAndroid && data.meta.compressTextureAndroid) {\r\n\t\t\t\t\t\t\tchangeType = \".ktx\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (Browser.onIOS && data.meta.compressTextureIOS) {\r\n\t\t\t\t\t\t\tchangeType = \".pvr\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//idx = _url.indexOf(\"?\");\r\n\t\t\t\t\t\t//var ver:String;\r\n\t\t\t\t\t\t//ver = idx >= 0 ? _url.substr(idx) : \"\";\r\n\t\t\t\t\t\tfor (var i = 0, len = toloadPics.length; i < len; i++) {\r\n\t\t\t\t\t\t\tif (changeType) {\r\n\t\t\t\t\t\t\t\ttoloadPics[i] = folderPath + toloadPics[i].replace(\".png\", changeType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttoloadPics[i] = folderPath + toloadPics[i];\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t//不带图片信息\r\n\t\t\t\t\t\ttoloadPics = [this._url.replace(\".json\", \".png\")];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//保证图集的正序加载\r\n\t\t\t\t\ttoloadPics.reverse();\r\n\t\t\t\t\tdata.toLoads = toloadPics;\r\n\t\t\t\t\tdata.pics = [];\r\n\t\t\t\t}\r\n\t\t\t\tthis.event(Event.PROGRESS, 0.3 + 1 / toloadPics.length * 0.6);\r\n\t\t\t\treturn this._loadResourceFilter(Loader.IMAGE, URL.formatURL(toloadPics.pop() as string));\r\n\t\t\t} else {\r\n\t\t\t\tif(!(data instanceof Texture2D))\r\n\t\t\t\t{\r\n\t\t\t\t\tlet tex: Texture2D = new Texture2D(data.width, data.height, 1, false, false);\r\n\t\t\t\t\ttex.wrapModeU = BaseTexture.WARPMODE_CLAMP;\r\n\t\t\t\t\ttex.wrapModeV = BaseTexture.WARPMODE_CLAMP;\r\n\t\t\t\t\ttex.loadImageSource(data, true);\r\n\t\t\t\t\ttex._setCreateURL(data.src);\r\n\t\t\t\t\tdata = tex;\r\n\t\t\t\t}\r\n\t\t\t\tthis._data.pics.push(data);\r\n\t\t\t\tif (this._data.toLoads.length > 0) {\r\n\t\t\t\t\tthis.event(Event.PROGRESS, 0.3 + 1 / this._data.toLoads.length * 0.6);\r\n\t\t\t\t\t//有图片未加载\r\n\t\t\t\t\treturn this._loadResourceFilter(Loader.IMAGE, this._data.toLoads.pop());\r\n\t\t\t\t}\r\n\t\t\t\tvar frames: any = this._data.frames;\r\n\t\t\t\tvar cleanUrl: string = this._url.split(\"?\")[0];\r\n\t\t\t\tvar directory: string = (this._data.meta && this._data.meta.prefix) ? this._data.meta.prefix : cleanUrl.substring(0, cleanUrl.lastIndexOf(\".\")) + \"/\";\r\n\t\t\t\tvar pics: any[] = this._data.pics;\r\n\t\t\t\tvar atlasURL = URL.formatURL(this._url);\r\n\t\t\t\tvar map: any[] = Loader.atlasMap[atlasURL] || (Loader.atlasMap[atlasURL] = []);\r\n\t\t\t\t((<any>map)).dir = directory;\r\n\t\t\t\tvar scaleRate: number = 1;\r\n\t\t\t\tif (this._data.meta && this._data.meta.scale && this._data.meta.scale != 1) {\r\n\t\t\t\t\tscaleRate = parseFloat(this._data.meta.scale);\r\n\t\t\t\t\tfor (var name in frames) {\r\n\t\t\t\t\t\tvar obj: any = frames[name];//取对应的图\r\n\t\t\t\t\t\tvar tPic: Texture2D = pics[obj.frame.idx ? obj.frame.idx : 0];//是否释放\r\n\t\t\t\t\t\tvar url = URL.formatURL(directory + name);\r\n\t\t\t\t\t\t((<any>tPic)).scaleRate = scaleRate;\r\n\t\t\t\t\t\tvar tTexture: Texture;\r\n\t\t\t\t\t\ttTexture = Texture._create(tPic, obj.frame.x, obj.frame.y, obj.frame.w, obj.frame.h, obj.spriteSourceSize.x, obj.spriteSourceSize.y, obj.sourceSize.w, obj.sourceSize.h, Loader.getRes(url));\r\n\t\t\t\t\t\tLoader.cacheTexture(url, tTexture);\r\n\t\t\t\t\t\ttTexture.url = url;\r\n\t\t\t\t\t\tmap.push(url);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (name in frames) {\r\n\t\t\t\t\t\tobj = frames[name];//取对应的图\r\n\t\t\t\t\t\ttPic = pics[obj.frame.idx ? obj.frame.idx : 0];//是否释放\r\n\t\t\t\t\t\turl = URL.formatURL(directory + name);\r\n\t\t\t\t\t\ttTexture = Texture._create(tPic, obj.frame.x, obj.frame.y, obj.frame.w, obj.frame.h, obj.spriteSourceSize.x, obj.spriteSourceSize.y, obj.sourceSize.w, obj.sourceSize.h, Loader.getRes(url));\r\n\t\t\t\t\t\tLoader.cacheTexture(url, tTexture);\r\n\t\t\t\t\t\ttTexture.url = url;\r\n\t\t\t\t\t\tmap.push(url);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdelete this._data.pics;\r\n\t\t\t\tthis.complete(this._data);\r\n\t\t\t}\r\n\t\t} else if (type === Loader.FONT) {\r\n\t\t\t//处理位图字体\r\n\t\t\tif (!data._source) {\r\n\t\t\t\tthis._data = data;\r\n\t\t\t\tthis.event(Event.PROGRESS, 0.5);\r\n\t\t\t\treturn this._loadResourceFilter(Loader.IMAGE,this._url.replace(\".fnt\", \".png\"));\r\n\t\t\t} else {\r\n\t\t\t\tvar bFont = new BitmapFont();\r\n\t\t\t\tbFont.parseFont(this._data, new Texture(data));\r\n\t\t\t\tvar tArr: any[] = this._url.split(\".fnt\")[0].split(\"/\");\r\n\t\t\t\tvar fontName = tArr[tArr.length - 1];\r\n\t\t\t\tText.registerBitmapFont(fontName, bFont);\r\n\t\t\t\tthis._data = bFont;\r\n\t\t\t\tthis.complete(this._data);\r\n\t\t\t}\r\n\t\t} else if (type === Loader.PREFAB) {\r\n\t\t\tvar prefab = new Prefab();\r\n\t\t\tprefab.json = data;\r\n\t\t\tthis.complete(prefab);\r\n\t\t} else {\r\n\t\t\tthis.complete(data);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate parsePLFData(plfData: any): void {\r\n\t\tvar type: string;\r\n\t\tvar filePath: string;\r\n\t\tvar fileDic: any;\r\n\t\tfor (type in plfData) {\r\n\t\t\tfileDic = plfData[type];\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase \"json\":\r\n\t\t\t\tcase \"text\":\r\n\t\t\t\t\tfor (filePath in fileDic) {\r\n\t\t\t\t\t\tLoader.preLoadedMap[URL.formatURL(filePath)] = fileDic[filePath]\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tfor (filePath in fileDic) {\r\n\t\t\t\t\t\tLoader.preLoadedMap[URL.formatURL(filePath)] = fileDic[filePath]\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprivate parsePLFBData(plfData: ArrayBuffer): void {\r\n\t\tvar byte: Byte;\r\n\t\tbyte = new Byte(plfData);\r\n\t\tvar i: number, len: number;\r\n\t\tlen = byte.getInt32();\r\n\t\tfor (i = 0; i < len; i++) {\r\n\t\t\tthis.parseOnePLFBFile(byte);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate parseOnePLFBFile(byte: Byte): void {\r\n\t\tvar fileLen: number;\r\n\t\tvar fileName: string;\r\n\t\tvar fileData: ArrayBuffer;\r\n\t\tfileName = byte.getUTFString();\r\n\t\tfileLen = byte.getInt32();\r\n\t\tfileData = byte.readArrayBuffer(fileLen);\r\n\t\tLoader.preLoadedMap[URL.formatURL(fileName)] = fileData;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 加载完成。\r\n\t * @param\tdata 加载的数据。\r\n\t */\r\n\tprotected complete(data: any): void {\r\n\t\tthis._data = data;\r\n\t\tif (this._customParse) {\r\n\t\t\tthis.event(Event.LOADED, data instanceof Array ? [data] : data);\r\n\t\t} else {\r\n\t\t\tLoader._loaders.push(this);\r\n\t\t\tif (!Loader._isWorking) Loader.checkNext();\r\n\t\t}\r\n\t}\r\n\r\n\t/**@private */\r\n\tprivate static checkNext(): void {\r\n\t\tLoader._isWorking = true;\r\n\t\tvar startTimer: number = Browser.now();\r\n\t\twhile (Loader._startIndex < Loader._loaders.length) {\r\n\t\t\tLoader._loaders[Loader._startIndex].endLoad();\r\n\t\t\tLoader._startIndex++;\r\n\t\t\tif (Browser.now() - startTimer > Loader.maxTimeOut) {\r\n\t\t\t\tconsole.warn(\"loader callback cost a long time:\" + (Browser.now() - startTimer) + \" url=\" + Loader._loaders[Loader._startIndex - 1].url);\r\n\t\t\t\tILaya.systemTimer.frameOnce(1, null, Loader.checkNext);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tLoader._loaders.length = 0;\r\n\t\tLoader._startIndex = 0;\r\n\t\tLoader._isWorking = false;\r\n\t}\r\n\r\n\t/**\r\n\t * 结束加载，处理是否缓存及派发完成事件 <code>Event.COMPLETE</code> 。\r\n\t * @param\tcontent 加载后的数据\r\n\t */\r\n\tendLoad(content: any = null): void {\r\n\t\tcontent && (this._data = content);\r\n\t\tif (this._cache) Loader.cacheRes(this._url, this._data);\r\n\t\tthis.event(Event.PROGRESS, 1);\r\n\t\tthis.event(Event.COMPLETE, this.data instanceof Array ? [this.data] : this.data);\r\n\t}\r\n\r\n\t/**加载地址。*/\r\n\tget url(): string {\r\n\t\treturn this._url;\r\n\t}\r\n\r\n\t/**加载类型。*/\r\n\tget type(): string {\r\n\t\treturn this._type;\r\n\t}\r\n\r\n\t/**是否缓存。*/\r\n\tget cache(): boolean {\r\n\t\treturn this._cache;\r\n\t}\r\n\r\n\t/**返回的数据。*/\r\n\tget data(): any {\r\n\t\treturn this._data;\r\n\t}\r\n\r\n    /**\r\n     * 清理指定资源地址的缓存。 \r\n     * @param url 资源地址。\r\n     */\r\n    static clearRes(url: string): void {\r\n\t\turl = URL.formatURL(url);\r\n\t\t//删除图集\r\n\t\tvar arr = Loader.getAtlas(url);\r\n\t\tif (arr) {\r\n\t\t\tfor (var i= 0, n = arr.length; i < n; i++) {\r\n\t\t\t\tvar resUrl = arr[i];\r\n\t\t\t\tvar tex: Texture = Loader.getRes(resUrl);\r\n\t\t\t\tdelete Loader.textureMap[resUrl];\r\n\t\t\t\tif (tex) tex.destroy();\r\n\t\t\t}\r\n\t\t\tarr.length = 0;\r\n\t\t\tdelete Loader.atlasMap[url];\r\n\t\t}\r\n\t\tvar texture = Loader.textureMap[url];\r\n\t\tif (texture) {\r\n\t\t\ttexture.destroy();\r\n\t\t\tdelete Loader.textureMap[url]\r\n\t\t}\r\n\t\tvar res= Loader.loadedMap[url];\r\n\t\t(res) && (delete Loader.loadedMap[url])\r\n\t}\r\n\r\n\t/**\r\n\t * 销毁Texture使用的图片资源，保留texture壳，如果下次渲染的时候，发现texture使用的图片资源不存在，则会自动恢复\r\n\t * 相比clearRes，clearTextureRes只是清理texture里面使用的图片资源，并不销毁texture，再次使用到的时候会自动恢复图片资源\r\n\t * 而clearRes会彻底销毁texture，导致不能再使用；clearTextureRes能确保立即销毁图片资源，并且不用担心销毁错误，clearRes则采用引用计数方式销毁\r\n\t * 【注意】如果图片本身在自动合集里面（默认图片小于512*512），内存是不能被销毁的，此图片被大图合集管理器管理\r\n\t * @param\turl\t图集地址或者texture地址，比如 Loader.clearTextureRes(\"res/atlas/comp.atlas\"); Loader.clearTextureRes(\"hall/bg.jpg\");\r\n\t */\r\n\tstatic clearTextureRes(url: string): void {\r\n\t\turl = URL.formatURL(url);\r\n\t\t//删除图集\r\n\t\tvar arr: any[] = Loader.getAtlas(url);\r\n\t\tif (arr && arr.length > 0) {\r\n\t\t\tarr.forEach(function (t: string): void {\r\n\t\t\t\tvar tex: any = Loader.getRes(t);\r\n\t\t\t\tif (tex instanceof Texture) {\r\n\t\t\t\t\t((<Texture>tex)).disposeBitmap();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tvar t: any = Loader.getRes(url);\r\n\t\t\tif (t instanceof Texture) {\r\n\t\t\t\t((<Texture>t)).disposeBitmap();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 获取指定资源地址的资源或纹理。\r\n\t * @param\turl 资源地址。\r\n\t * @return\t返回资源。\r\n\t */\r\n\tstatic getRes(url: string): any {\r\n\t\tvar res = Loader.textureMap[URL.formatURL(url)];\r\n\t\tif (res)\r\n\t\t\treturn res;\r\n\t\telse\r\n\t\t\treturn Loader.loadedMap[URL.formatURL(url)];\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * 获取指定资源地址的图集地址列表。\r\n\t * @param\turl 图集地址。\r\n\t * @return\t返回地址集合。\r\n\t */\r\n\tstatic getAtlas(url: string) {\r\n\t\treturn Loader.atlasMap[URL.formatURL(url)];\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * 缓存资源。\r\n\t * @param\turl 资源地址。\r\n\t * @param\tdata 要缓存的内容。\r\n\t */\r\n\tstatic cacheRes(url: string, data: any): void {\r\n\t\turl = URL.formatURL(url);\r\n\t\tif (Loader.loadedMap[url] != null) {\r\n\t\t\tconsole.warn(\"Resources already exist,is repeated loading:\", url);\r\n\t\t} else {\r\n\t\t\tif (data instanceof Texture) {\r\n\t\t\t\tLoader.loadedMap[url] = data.bitmap;\r\n\t\t\t\tLoader.textureMap[url] = data;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tLoader.loadedMap[url] = data;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * 缓存Teture。\r\n\t * @param\turl 资源地址。\r\n\t * @param\tdata 要缓存的Texture。\r\n\t */\r\n\tstatic cacheTexture(url: string, data: Texture): void {\r\n\t\turl = URL.formatURL(url);\r\n\t\tif (Loader.textureMap[url] != null) {\r\n\t\t\tconsole.warn(\"Resources already exist,is repeated loading:\", url);\r\n\t\t} else {\r\n\t\t\tLoader.textureMap[url] = data;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 设置资源分组。\r\n\t * @param url 资源地址。\r\n\t * @param group 分组名。\r\n\t */\r\n\tstatic setGroup(url: string, group: string): void {\r\n\t\tif (!Loader.groupMap[group]) Loader.groupMap[group] = [];\r\n\t\tLoader.groupMap[group].push(url);\r\n\t}\r\n\r\n\t/**\r\n\t * 根据分组清理资源。\r\n\t * @param group 分组名。\r\n\t */\r\n\tstatic clearResByGroup(group: string): void {\r\n\t\tif (!Loader.groupMap[group]) return;\r\n\t\tvar arr: any[] = Loader.groupMap[group], i: number, len: number = arr.length;\r\n\t\tfor (i = 0; i < len; i++) {\r\n\t\t\tLoader.clearRes(arr[i]);\r\n\t\t}\r\n\t\tarr.length = 0;\r\n\t}\r\n}\r\n\r\n","import { Handler } from \"../utils/Handler\";\r\nimport { ILaya } from \"./../../ILaya\";\r\nimport { Loader } from \"./Loader\";\r\n\r\n/**\r\n * @private\r\n */\r\nexport class AtlasInfoManager {\r\n\r\n\tprivate static _fileLoadDic: any = {};\r\n\r\n\tstatic enable(infoFile: string, callback: Handler|null = null): void {\r\n\t\tILaya.loader.load(infoFile, Handler.create(null, AtlasInfoManager._onInfoLoaded, [callback]), null, Loader.JSON);\r\n\t}\r\n\r\n\t/**@private */\r\n\tprivate static _onInfoLoaded(callback: Handler, data: any): void {\r\n\t\tvar tKey: string;\r\n\t\tvar tPrefix: string;\r\n\t\tvar tArr: any[];\r\n\t\tvar i: number, len: number;\r\n\r\n\t\tfor (tKey in data) {\r\n\t\t\ttArr = data[tKey];\r\n\t\t\ttPrefix = tArr[0];\r\n\t\t\ttArr = tArr[1];\r\n\t\t\tlen = tArr.length;\r\n\t\t\tfor (i = 0; i < len; i++) {\r\n\t\t\t\tAtlasInfoManager._fileLoadDic[tPrefix + tArr[i]] = tKey;\r\n\t\t\t}\r\n\t\t}\r\n\t\tcallback && callback.run();\r\n\t}\r\n\r\n\tstatic getFileLoadPath(file: string): string {\r\n\t\treturn AtlasInfoManager._fileLoadDic[file] || file;\r\n\t}\r\n}\r\n\r\n\r\n","import { ILaya } from \"../../ILaya\";\r\nimport { Event } from \"../events/Event\";\r\nimport { EventDispatcher } from \"../events/EventDispatcher\";\r\nimport { URL } from \"../net/URL\";\r\nimport { ICreateResource } from \"../resource/ICreateResource\";\r\nimport { Resource } from \"../resource/Resource\";\r\nimport { Texture } from \"../resource/Texture\";\r\nimport { Handler } from \"../utils/Handler\";\r\nimport { Utils } from \"../utils/Utils\";\r\nimport { AtlasInfoManager } from \"./AtlasInfoManager\";\r\nimport { Loader } from \"./Loader\";\r\n\r\n/**\r\n * 所有资源加载完成时调度。\r\n * @eventType Event.COMPLETE\r\n * */\r\n/*[Event(name = \"complete\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * 任何资源加载出错时调度。\r\n * @eventType Event.ERROR\r\n * */\r\n/*[Event(name = \"error\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * <p> <code>LoaderManager</code> 类用于用于批量加载资源。此类是单例，不要手动实例化此类，请通过Laya.loader访问。</p>\r\n * <p>全部队列加载完成，会派发 Event.COMPLETE 事件；如果队列中任意一个加载失败，会派发 Event.ERROR 事件，事件回调参数值为加载出错的资源地址。</p>\r\n * <p> <code>LoaderManager</code> 类提供了以下几种功能：<br/>\r\n * 多线程：默认5个加载线程，可以通过maxLoader属性修改线程数量；<br/>\r\n * 多优先级：有0-4共5个优先级，优先级高的优先加载。0最高，4最低；<br/>\r\n * 重复过滤：自动过滤重复加载（不会有多个相同地址的资源同时加载）以及复用缓存资源，防止重复加载；<br/>\r\n * 错误重试：资源加载失败后，会重试加载（以最低优先级插入加载队列），retryNum设定加载失败后重试次数，retryDelay设定加载重试的时间间隔。</p>\r\n * @see laya.net.Loader\r\n */\r\nexport class LoaderManager extends EventDispatcher {\r\n    /**@private */\r\n    private static _resMap: {[key:string]:ResInfo} = {};\r\n    /**@private */\r\n    static createMap: any = { atlas: [null, Loader.ATLAS] };\r\n\r\n    /** 加载出错后的重试次数，默认重试一次*/\r\n    retryNum: number = 1;\r\n    /** 延迟时间多久再进行错误重试，默认立即重试*/\r\n    retryDelay: number = 0;\r\n    /** 最大下载线程，默认为5个*/\r\n    maxLoader: number = 5;\r\n\r\n    /**@private */\r\n    private _loaders: any[] = [];\r\n    /**@private */\r\n    private _loaderCount: number = 0;\r\n    /**@private */\r\n    private _resInfos: ResInfo[][] = [];\r\n\r\n    /**@private */\r\n    private _infoPool: any[] = [];\r\n    /**@private */\r\n    private _maxPriority: number = 5;\r\n    /**@private */\r\n    private _failRes: any = {};\r\n    /**@private */\r\n    private _statInfo: any = { count: 1, loaded: 1 };\r\n\r\n    /**@private */\r\n    getProgress(): number {\r\n        return this._statInfo.loaded / this._statInfo.count;\r\n    }\r\n\r\n    /**@private */\r\n    resetProgress(): void {\r\n        this._statInfo.count = this._statInfo.loaded = 1;\r\n    }\r\n\r\n    /**\r\n     * <p>创建一个新的 <code>LoaderManager</code> 实例。</p>\r\n     * <p><b>注意：</b>请使用Laya.loader加载资源，这是一个单例，不要手动实例化此类，否则会导致不可预料的问题。</p>\r\n     */\r\n    constructor() {\r\n        super();\r\n        for (var i = 0; i < this._maxPriority; i++) this._resInfos[i] = [];\r\n    }\r\n\r\n    /**\r\n     * <p>根据clas类型创建一个未初始化资源的对象，随后进行异步加载，资源加载完成后，初始化对象的资源，并通过此对象派发 Event.LOADED 事件，事件回调参数值为此对象本身。套嵌资源的子资源会保留资源路径\"?\"后的部分。</p>\r\n     * <p>如果url为数组，返回true；否则返回指定的资源类对象，可以通过侦听此对象的 Event.LOADED 事件来判断资源是否已经加载完毕。</p>\r\n     * <p><b>注意：</b>cache参数只能对文件后缀为atlas的资源进行缓存控制，其他资源会忽略缓存，强制重新加载。</p>\r\n     * @param\turl\t\t\t资源地址或者数组。如果url和clas同时指定了资源类型，优先使用url指定的资源类型。参数形如：[{url:xx,clas:xx,priority:xx,params:xx},{url:xx,clas:xx,priority:xx,params:xx}]。\r\n     * @param\tcomplete\t加载结束回调。根据url类型不同分为2种情况：1. url为String类型，也就是单个资源地址，如果加载成功，则回调参数值为加载完成的资源，否则为null；2. url为数组类型，指定了一组要加载的资源，如果全部加载成功，则回调参数值为true，否则为false。\r\n     * @param\tprogress\t资源加载进度回调，回调参数值为当前资源加载的进度信息(0-1)。\r\n     * @param\ttype\t资源类型。\r\n     * @param\tconstructParams\t\t资源构造函数参数。\r\n     * @param\tpropertyParams\t\t资源属性参数。\r\n     * @param\tpriority\t(default = 1)加载的优先级，优先级高的优先加载。有0-4共5个优先级，0最高，4最低。\r\n     * @param\tcache\t\t是否缓存加载的资源。\r\n     * @return\t如果url为数组，返回true；否则返回指定的资源类对象。\r\n     */\r\n    create(url: any, complete: Handler|null = null, progress: Handler|null = null, type: string|null = null, constructParams: any[]|null = null, propertyParams: any = null, priority: number = 1, cache: boolean = true): void {\r\n        this._create(url, true, complete, progress, type, constructParams, propertyParams, priority, cache);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _create(url: any, mainResou: boolean, complete: Handler|null = null, progress: Handler|null = null, type: string|null = null, constructParams: any[]|null = null, propertyParams: any = null, priority: number = 1, cache: boolean = true): void {\r\n        if (url instanceof Array) {\r\n            var allScuess: boolean = true;\r\n            var items: any[] = (<any[]>url);\r\n            var itemCount: number = items.length;\r\n            var loadedCount: number = 0;\r\n            if (progress) {\r\n                var progress2: Handler = Handler.create(progress.caller, progress?progress.method:null, progress.args, false);\r\n            }\r\n\r\n            for (var i: number = 0; i < itemCount; i++) {\r\n                var item: any = items[i];\r\n                if (typeof (item) == 'string')\r\n                    item = items[i] = { url: item };\r\n                item.progress = 0;\r\n            }\r\n            for (i = 0; i < itemCount; i++) {\r\n                item = items[i];\r\n                var progressHandler = progress ? Handler.create(null, function (item: any, value: number): void {\r\n                    item.progress = value;\r\n                    var num: number = 0;\r\n                    for (var j: number = 0; j < itemCount; j++) {\r\n                        var item1: any = items[j];\r\n                        num += item1.progress;\r\n                    }\r\n                    var v: number = num / itemCount;\r\n                    progress2.runWith(v);\r\n                }, [item], false) : null;\r\n                var completeHandler = (progress || complete) ? Handler.create(null, function (item: any, content: any = null): void {\r\n                    loadedCount++;\r\n                    item.progress = 1;\r\n                    content || (allScuess = false);//资源加载失败\r\n                    if (loadedCount === itemCount && complete) {\r\n                        complete.runWith(allScuess);\r\n                    }\r\n                }, [item]) : null;\r\n                this._createOne(item.url, mainResou, completeHandler, progressHandler, item.type || type, item.constructParams || constructParams, item.propertyParams || propertyParams, item.priority || priority, cache);\r\n            }\r\n\r\n\r\n\r\n        } else {\r\n            this._createOne(url, mainResou, complete, progress, type, constructParams, propertyParams, priority, cache);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private _createOne(url: string, mainResou: boolean, complete: Handler|null = null, progress: Handler|null = null, type: string|null = null, constructParams: any[]|null = null, propertyParams: any = null, priority: number = 1, cache: boolean = true): void {\r\n        var item: any = this.getRes(url);\r\n        if (!item) {\r\n            var extension: string =(LoaderManager.createMap[Utils.getFilecompatibleExtension(url)])?Utils.getFilecompatibleExtension(url):Utils.getFileExtension(url);\r\n            \r\n            (type) || (type = LoaderManager.createMap[extension] ? LoaderManager.createMap[extension][0] : null);\r\n\r\n            if (!type) {\r\n                this.load(url, complete, progress, type, priority, cache);\r\n                return;\r\n            }\r\n            var parserMap: any = Loader.parserMap;\r\n            if (!parserMap[type]) {//not custom parse type\r\n                this.load(url, complete, progress, type, priority, cache);\r\n                return;\r\n            }\r\n            this._createLoad(url, Handler.create(null, function (createRes: ICreateResource): void {//加载失败createRes为空\r\n                if (createRes) {\r\n                    if (!mainResou && createRes instanceof Resource)\r\n                        ((<Resource>createRes))._addReference();\r\n                    createRes._setCreateURL(url);\r\n                }\r\n                complete && complete.runWith(createRes);\r\n                ILaya.loader.event(url);\r\n            }), progress, type, constructParams, propertyParams, priority, cache, true);\r\n        } else {\r\n            if (!mainResou && item instanceof Resource)\r\n                item._addReference();\r\n            progress && progress.runWith(1);\r\n            complete && complete.runWith(item);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * <p>加载资源。资源加载错误时，本对象会派发 Event.ERROR 事件，事件回调参数值为加载出错的资源地址。</p>\r\n     * <p>因为返回值为 LoaderManager 对象本身，所以可以使用如下语法：loaderManager.load(...).load(...);</p>\r\n     * @param\turl\t\t\t要加载的单个资源地址或资源信息数组。比如：简单数组：[\"a.png\",\"b.png\"]；复杂数组[{url:\"a.png\",type:Loader.IMAGE,size:100,priority:1},{url:\"b.json\",type:Loader.JSON,size:50,priority:1}]。\r\n     * @param\tcomplete\t加载结束回调。根据url类型不同分为2种情况：1. url为String类型，也就是单个资源地址，如果加载成功，则回调参数值为加载完成的资源，否则为null；2. url为数组类型，指定了一组要加载的资源，如果全部加载成功，则回调参数值为true，否则为false。\r\n     * @param\tprogress\t加载进度回调。回调参数值为当前资源的加载进度信息(0-1)。\r\n     * @param\ttype\t\t资源类型。比如：Loader.IMAGE。\r\n     * @param\tpriority\t(default = 1)加载的优先级，优先级高的优先加载。有0-4共5个优先级，0最高，4最低。\r\n     * @param\tcache\t\t是否缓存加载结果。\r\n     * @param\tgroup\t\t分组，方便对资源进行管理。\r\n     * @param\tignoreCache\t是否忽略缓存，强制重新加载。\r\n     * @param\tuseWorkerLoader(default = false)是否使用worker加载（只针对IMAGE类型和ATLAS类型，并且浏览器支持的情况下生效）\r\n     * @return 此 LoaderManager 对象本身。\r\n     */\r\n    load(url: string|string[]|loadItem[], complete: Handler|null = null, progress: Handler|null = null, type: string|null = null, priority: number = 1, cache: boolean = true, group: string|null = null, ignoreCache: boolean = false, useWorkerLoader: boolean = ILaya.WorkerLoader.enable): LoaderManager {\r\n        if (url instanceof Array) {\r\n            return this._loadAssets(url, complete, progress, type, priority, cache, group);\r\n        }\r\n\r\n        var content: any;\r\n        if (type === Loader.IMAGE)\r\n            content = Loader.textureMap[URL.formatURL(url)];\r\n        else\r\n            content = Loader.loadedMap[URL.formatURL(url)];\r\n\r\n        if (!ignoreCache && content != null) {\r\n            //增加延迟回掉，防止快速回掉导致执行顺序错误\r\n            ILaya.systemTimer.callLater(this, function (this:LoaderManager): void {\r\n                progress && progress.runWith(1);\r\n                complete && complete.runWith(content instanceof Array ? [content] : content);\r\n                //判断是否全部加载，如果是则抛出complete事件\r\n                this._loaderCount|| this.event(Event.COMPLETE);\r\n            });\r\n        } else {\r\n            var original: string|null;\r\n            original = url;\r\n            url = AtlasInfoManager.getFileLoadPath(url);\r\n            if (url != original && type !== \"nativeimage\") {\r\n                type = Loader.ATLAS;\r\n            } else {\r\n                original = null;\r\n            }\r\n            var info: ResInfo = LoaderManager._resMap[url];\r\n            if (!info) {\r\n                info = this._infoPool.length ? this._infoPool.pop() : new ResInfo();\r\n                info.url = url;\r\n                info.type = type;\r\n                info.cache = cache;\r\n                info.group = group;\r\n                info.ignoreCache = ignoreCache;\r\n                info.useWorkerLoader = useWorkerLoader;\r\n                info.originalUrl = original;\r\n                complete && info.on(Event.COMPLETE, complete.caller, complete.method, complete.args);\r\n                progress && info.on(Event.PROGRESS, progress.caller, progress.method, progress.args);\r\n                LoaderManager._resMap[url] = info;\r\n                priority = priority < this._maxPriority ? priority : this._maxPriority - 1;\r\n                this._resInfos[priority].push(info);\r\n                this._statInfo.count++;\r\n                this.event(Event.PROGRESS, this.getProgress());\r\n                this._next();\r\n            } else {\r\n                if (complete) {\r\n                    if (original) {\r\n                        complete && info._createListener(Event.COMPLETE, this, this._resInfoLoaded, [original, complete], false, false);\r\n                    } else {\r\n                        complete && info._createListener(Event.COMPLETE, complete.caller, complete.method, complete.args, false, false);\r\n                    }\r\n                }\r\n                progress && info._createListener(Event.PROGRESS, progress.caller, progress.method, progress.args, false, false);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    private _resInfoLoaded(original: string, complete: Handler): void {\r\n        complete.runWith(Loader.getRes(original));\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _createLoad(url: any, complete: Handler|null = null, progress: Handler|null = null, type: string|null = null, constructParams: any[]|null = null, propertyParams: any = null, priority: number = 1, cache: boolean = true, ignoreCache: boolean = false): LoaderManager {\r\n        if (url instanceof Array) return this._loadAssets((<any[]>url), complete, progress, type, priority, cache);\r\n        var content: any = Loader.getRes(url);\r\n        if (content != null) {\r\n            //增加延迟回掉\r\n            ILaya.systemTimer.frameOnce(1, this, function (this:LoaderManager): void {\r\n                progress && progress.runWith(1);\r\n                complete && complete.runWith(content);\r\n                //判断是否全部加载，如果是则抛出complete事件\r\n                this._loaderCount || this.event(Event.COMPLETE);\r\n            });\r\n        } else {\r\n            var info: ResInfo = LoaderManager._resMap[url];\r\n            if (!info) {\r\n                info = this._infoPool.length ? this._infoPool.pop() : new ResInfo();\r\n                info.url = url;\r\n                info.type = type;\r\n                info.cache = false;\r\n                info.ignoreCache = ignoreCache;\r\n                info.originalUrl = null;\r\n                info.group = null;\r\n                info.createCache = cache;\r\n                info.createConstructParams = constructParams;\r\n                info.createPropertyParams = propertyParams;\r\n                complete && info.on(Event.COMPLETE, complete.caller, complete.method, complete.args);\r\n                progress && info.on(Event.PROGRESS, progress.caller, progress.method, progress.args);\r\n                LoaderManager._resMap[url] = info;\r\n                priority = priority < this._maxPriority ? priority : this._maxPriority - 1;\r\n                this._resInfos[priority].push(info);\r\n                this._statInfo.count++;\r\n                this.event(Event.PROGRESS, this.getProgress());\r\n                this._next();\r\n            } else {\r\n                complete && info._createListener(Event.COMPLETE, complete.caller, complete.method, complete.args, false, false);\r\n                progress && info._createListener(Event.PROGRESS, progress.caller, progress.method, progress.args, false, false);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    private _next(): void {\r\n        if (this._loaderCount >= this.maxLoader) return;\r\n        for (var i: number = 0; i < this._maxPriority; i++) {\r\n            var infos: any[] = this._resInfos[i];\r\n            while (infos.length > 0) {\r\n                var info: ResInfo = infos.shift();\r\n                if (info) return this._doLoad(info);\r\n            }\r\n        }\r\n        this._loaderCount || this.event(Event.COMPLETE);\r\n    }\r\n\r\n    private _doLoad(resInfo: ResInfo): void {\r\n        this._loaderCount++;\r\n        var loader: Loader = this._loaders.length ? this._loaders.pop() : new Loader();\r\n        loader.on(Event.COMPLETE, null, onLoaded);\r\n        loader.on(Event.PROGRESS, null, function (num: number): void {\r\n            resInfo.event(Event.PROGRESS, num);\r\n        });\r\n        loader.on(Event.ERROR, null, function (msg: any): void {\r\n            onLoaded(null);\r\n        });\r\n\r\n        var _me: LoaderManager = this;\r\n        function onLoaded(data: any = null): void {\r\n            loader.offAll();\r\n            loader._data = null;\r\n            loader._customParse = false;\r\n            _me._loaders.push(loader);\r\n            _me._endLoad(resInfo, data instanceof Array ? [data] : data);\r\n            _me._loaderCount--;\r\n            _me._next();\r\n        }\r\n\r\n        loader._constructParams = resInfo.createConstructParams;\r\n        loader._propertyParams = resInfo.createPropertyParams;\r\n        loader._createCache = resInfo.createCache;\r\n        loader.load(resInfo.url, resInfo.type, resInfo.cache, resInfo.group, resInfo.ignoreCache, resInfo.useWorkerLoader);\r\n    }\r\n\r\n    private _endLoad(resInfo: ResInfo, content: any): void {\r\n        //如果加载后为空，放入队列末尾重试\r\n        var url: string = resInfo.url;\r\n        if (content == null) {\r\n            var errorCount: number = this._failRes[url] || 0;\r\n            if (errorCount < this.retryNum) {\r\n                console.warn(\"[warn]Retry to load:\", url);\r\n                this._failRes[url] = errorCount + 1;\r\n                ILaya.systemTimer.once(this.retryDelay, this, this._addReTry, [resInfo], false);\r\n                return;\r\n            } else {\r\n                Loader.clearRes(url);//使用create加载失败需要清除资源\r\n                console.warn(\"[error]Failed to load:\", url);\r\n                this.event(Event.ERROR, url);\r\n            }\r\n        }\r\n        if (this._failRes[url]) this._failRes[url] = 0;\r\n        delete LoaderManager._resMap[url];\r\n        if (resInfo.originalUrl) {\r\n            content = Loader.getRes(resInfo.originalUrl);\r\n        }\r\n        resInfo.event(Event.COMPLETE, content);\r\n        resInfo.offAll();\r\n        this._infoPool.push(resInfo);\r\n        this._statInfo.loaded++;\r\n        this.event(Event.PROGRESS, this.getProgress());\r\n    }\r\n\r\n    private _addReTry(resInfo: ResInfo): void {\r\n        this._resInfos[this._maxPriority - 1].push(resInfo);\r\n        this._next();\r\n    }\r\n\r\n    /**\r\n     * 清理指定资源地址缓存。\r\n     * @param\turl 资源地址。\r\n     */\r\n    clearRes(url: string): void {\r\n        Loader.clearRes(url);\r\n    }\r\n\r\n    /**\r\n     * 销毁Texture使用的图片资源，保留texture壳，如果下次渲染的时候，发现texture使用的图片资源不存在，则会自动恢复\r\n     * 相比clearRes，clearTextureRes只是清理texture里面使用的图片资源，并不销毁texture，再次使用到的时候会自动恢复图片资源\r\n     * 而clearRes会彻底销毁texture，导致不能再使用；clearTextureRes能确保立即销毁图片资源，并且不用担心销毁错误，clearRes则采用引用计数方式销毁\r\n     * 【注意】如果图片本身在自动合集里面（默认图片小于512*512），内存是不能被销毁的，此图片被大图合集管理器管理\r\n     * @param\turl\t图集地址或者texture地址，比如 Loader.clearTextureRes(\"res/atlas/comp.atlas\"); Loader.clearTextureRes(\"hall/bg.jpg\");\r\n     */\r\n    clearTextureRes(url: string): void {\r\n        Loader.clearTextureRes(url);\r\n    }\r\n\r\n    /**\r\n     * 获取指定资源地址的资源。\r\n     * @param\turl 资源地址。\r\n     * @return\t返回资源。\r\n     */\r\n    getRes(url: string): any {\r\n        return Loader.getRes(url);\r\n    }\r\n\r\n    /**\r\n     * 缓存资源。\r\n     * @param\turl 资源地址。\r\n     * @param\tdata 要缓存的内容。\r\n     */\r\n    cacheRes(url: string, data: any): void {\r\n        Loader.cacheRes(url, data);\r\n    }\r\n\r\n    /**\r\n     * 设置资源分组。\r\n     * @param url 资源地址。\r\n     * @param group 分组名\r\n     */\r\n    setGroup(url: string, group: string): void {\r\n        Loader.setGroup(url, group);\r\n    }\r\n\r\n    /**\r\n     * 根据分组清理资源。\r\n     * @param group 分组名\r\n     */\r\n    clearResByGroup(group: string): void {\r\n        Loader.clearResByGroup(group);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 缓存资源。\r\n     * @param\turl 资源地址。\r\n     * @param\tdata 要缓存的内容。\r\n     */\r\n    static cacheRes(url: string, data: any): void {\r\n        Loader.cacheRes(url, data);\r\n    }\r\n\r\n    /** 清理当前未完成的加载，所有未加载的内容全部停止加载。*/\r\n    clearUnLoaded(): void {\r\n        //回收Handler\r\n        for (var i: number = 0; i < this._maxPriority; i++) {\r\n            var infos: any[] = this._resInfos[i];\r\n            for (var j: number = infos.length - 1; j > -1; j--) {\r\n                var info: ResInfo = infos[j];\r\n                if (info) {\r\n                    info.offAll();\r\n                    this._infoPool.push(info);\r\n                }\r\n            }\r\n            infos.length = 0;\r\n        }\r\n        this._loaderCount = 0;\r\n        LoaderManager._resMap = {};\r\n    }\r\n\r\n    /**\r\n     * 根据地址集合清理掉未加载的内容\r\n     * @param\turls 资源地址集合\r\n     */\r\n    cancelLoadByUrls(urls: any[]): void {\r\n        if (!urls) return;\r\n        for (var i: number = 0, n: number = urls.length; i < n; i++) {\r\n            this.cancelLoadByUrl(urls[i]);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 根据地址清理掉未加载的内容\r\n     * @param\turl 资源地址\r\n     */\r\n    cancelLoadByUrl(url: string): void {\r\n        for (var i: number = 0; i < this._maxPriority; i++) {\r\n            var infos: any[] = this._resInfos[i];\r\n            for (var j: number = infos.length - 1; j > -1; j--) {\r\n                var info: ResInfo = infos[j];\r\n                if (info && info.url === url) {\r\n                    infos[j] = null;\r\n                    info.offAll();\r\n                    this._infoPool.push(info);\r\n                }\r\n            }\r\n        }\r\n        if (LoaderManager._resMap[url]) delete LoaderManager._resMap[url];\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 加载数组里面的资源。\r\n     * @param arr 简单：[\"a.png\",\"b.png\"]，复杂[{url:\"a.png\",type:Loader.IMAGE,size:100,priority:1,useWorkerLoader:true},{url:\"b.json\",type:Loader.JSON,size:50,priority:1}]*/\r\n    private _loadAssets(arr:string[]|loadItem[], complete: Handler|null = null, progress: Handler|null = null, type: string|null = null, priority: number = 1, cache: boolean = true, group: string|null = null): LoaderManager {\r\n        var itemCount = arr.length;\r\n        var loadedCount = 0;\r\n        var totalSize = 0;\r\n        var items: loadItem[] = [];\r\n        var success = true;\r\n        for (var i = 0; i < itemCount; i++) {\r\n            let url = arr[i];\r\n            let item:loadItem;\r\n            if (typeof (url) == 'string') item = { url: url, type: type, size: 1, priority: priority };\r\n            else\r\n                item = url;\r\n            if (!item.size) item.size = 1;\r\n            item.progress = 0;\r\n            totalSize += item.size;\r\n            items.push(item);\r\n            var progressHandler = progress ? Handler.create(null, loadProgress, [item], false) : null;\r\n            var completeHandler = (complete || progress) ? Handler.create(null, loadComplete, [item]) : null;\r\n            this.load(item.url, completeHandler, progressHandler, item.type, item.priority || 1, cache, item.group || group, false, item.useWorkerLoader);\r\n        }\r\n\r\n        function loadComplete(item: loadItem, content: any = null): void {\r\n            loadedCount++;\r\n            item.progress = 1;\r\n            if (!content) success = false;\r\n            if (loadedCount === itemCount && complete) {\r\n                complete.runWith(success);\r\n            }\r\n        }\r\n\r\n        function loadProgress(item: loadItem, value: number): void {\r\n            if (progress != null) {\r\n                item.progress = value;\r\n                var num = 0;\r\n                for (var j = 0; j < items.length; j++) {\r\n\t\t\t\t\tvar item1 = items[j];\r\n\t\t\t\t\tif(item1){\r\n                    \tlet prog = item1.progress==undefined?0:item1.progress;\r\n\t\t\t\t\t\tnum += item1.size==undefined?0:item1.size * prog;\r\n\t\t\t\t\t}\r\n                }\r\n                var v = num / totalSize;\r\n                progress.runWith(v);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 解码Texture或者图集\r\n     * @param\turls texture地址或者图集地址集合\r\n     */\r\n    //TODO:TESTs\r\n    decodeBitmaps(urls: any[]): void {\r\n        var i: number, len: number = urls.length;\r\n        var ctx: any;\r\n        //ctx = Browser.context;\r\n        ctx = ILaya.Render._context;\r\n        //经测试需要画到主画布上才能只解码一次\r\n        //当前用法下webgl模式会报错\r\n        for (i = 0; i < len; i++) {\r\n            var atlas: any[];\r\n            atlas = Loader.getAtlas(urls[i]);\r\n            if (atlas) {\r\n                this._decodeTexture(atlas[0], ctx);\r\n            } else {\r\n                var tex: Texture;\r\n                tex = this.getRes(urls[i]);\r\n                if (tex && tex instanceof Texture) {\r\n                    this._decodeTexture(tex, ctx);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private _decodeTexture(tex: Texture, ctx: any): void {\r\n        var bitmap: any = tex.bitmap;\r\n        if (!tex || !bitmap) return;\r\n        var tImg: any = bitmap.source || bitmap.image;\r\n        if (!tImg) return;\r\n        if (tImg instanceof HTMLImageElement) {\r\n            ctx.drawImage(tImg, 0, 0, 1, 1);\r\n            var info: any = ctx.getImageData(0, 0, 1, 1);\r\n        }\r\n    }\r\n}\r\n\r\nclass ResInfo extends EventDispatcher {\r\n    url: string;\r\n    type: string|null;\r\n    cache: boolean;\r\n    group: string|null;\r\n    ignoreCache: boolean;\r\n    useWorkerLoader: boolean;\r\n    originalUrl: string|null;\r\n\r\n    createCache: boolean;\r\n    createConstructParams: any[]|null;\r\n    createPropertyParams: any;\r\n}\r\n\r\nexport interface loadItem{\r\n    url:string;\r\n    type?:string;\r\n    size?:number;\r\n    priority?:number;\r\n    useWorkerLoader?:boolean;\r\n    progress?:number;\r\n    group?:string;\r\n}","/**\r\n\t * <p> <code>LocalStorage</code> 类用于没有时间限制的数据存储。</p>\r\n\t */\r\nexport class LocalStorage {\r\n\r\n    /**@ 基础类*/\r\n    static _baseClass: any;\r\n    /**\r\n     *  数据列表。\r\n     */\r\n    static items: any;\r\n    /**\r\n     * 表示是否支持  <code>LocalStorage</code>。\r\n     */\r\n    static support: boolean = false;\r\n    /**@internal */\r\n    static __init__(): boolean {\r\n        if (!LocalStorage._baseClass) {\r\n            LocalStorage._baseClass = Storage;\r\n            Storage.init();\r\n        }\r\n        LocalStorage.items = LocalStorage._baseClass.items;\r\n        LocalStorage.support = LocalStorage._baseClass.support;\r\n        return LocalStorage.support;\r\n    }\r\n\r\n    /**\r\n     * 存储指定键名和键值，字符串类型。\r\n     * @param key 键名。\r\n     * @param value 键值。\r\n     */\r\n    static setItem(key: string, value: string): void {\r\n        LocalStorage._baseClass.setItem(key, value);\r\n    }\r\n\r\n    /**\r\n     * 获取指定键名的值。\r\n     * @param key 键名。\r\n     * @return 字符串型值。\r\n     */\r\n    static getItem(key: string): string {\r\n        return LocalStorage._baseClass.getItem(key);\r\n    }\r\n\r\n    /**\r\n     * 存储指定键名及其对应的 <code>Object</code> 类型值。\r\n     * @param key 键名。\r\n     * @param value 键值。是 <code>Object</code> 类型，此致会被转化为 JSON 字符串存储。\r\n     */\r\n    static setJSON(key: string, value: any): void {\r\n        LocalStorage._baseClass.setJSON(key, value);\r\n    }\r\n\r\n    /**\r\n     * 获取指定键名对应的 <code>Object</code> 类型值。\r\n     * @param key 键名。\r\n     * @return <code>Object</code> 类型值\r\n     */\r\n    static getJSON(key: string): any {\r\n        return LocalStorage._baseClass.getJSON(key);\r\n    }\r\n\r\n    /**\r\n     * 删除指定键名的信息。\r\n     * @param key 键名。\r\n     */\r\n    static removeItem(key: string): void {\r\n        LocalStorage._baseClass.removeItem(key);\r\n    }\r\n\r\n    /**\r\n     * 清除本地存储信息。\r\n     */\r\n    static clear(): void {\r\n        LocalStorage._baseClass.clear();\r\n    }\r\n}\r\n\r\n\r\n\r\nclass Storage {\r\n\r\n\t/**\r\n\t *  数据列表。\r\n\t */\r\n    static items: any;\r\n\t/**\r\n\t * 表示是否支持  <code>LocalStorage</code>。\r\n\t */\r\n    static support: boolean = false;\r\n\r\n    static init(): void {\r\n        try { Storage.support = true; Storage.items = window.localStorage; Storage.setItem('laya', '1'); Storage.removeItem('laya'); } catch (e) { Storage.support = false; } if (!Storage.support) console.log('LocalStorage is not supprot or browser is private mode.');\r\n    }\r\n\r\n\t/**\r\n\t * 存储指定键名和键值，字符串类型。\r\n\t * @param key 键名。\r\n\t * @param value 键值。\r\n\t */\r\n    static setItem(key: string, value: string): void {\r\n        try {\r\n            Storage.support && Storage.items.setItem(key, value);\r\n        } catch (e) {\r\n            console.warn(\"set localStorage failed\", e);\r\n        }\r\n    }\r\n\r\n\t/**\r\n\t * 获取指定键名的值。\r\n\t * @param key 键名。\r\n\t * @return 字符串型值。\r\n\t */\r\n    static getItem(key: string): string {\r\n        return Storage.support ? Storage.items.getItem(key) : null;\r\n    }\r\n\r\n\t/**\r\n\t * 存储指定键名和它的 <code>Object</code> 类型值。\r\n\t * @param key 键名。\r\n\t * @param value 键值。是 <code>Object</code> 类型，此致会被转化为 JSON 字符串存储。\r\n\t */\r\n    static setJSON(key: string, value: any): void {\r\n        try {\r\n            Storage.support && Storage.items.setItem(key, JSON.stringify(value));\r\n        } catch (e) {\r\n            console.warn(\"set localStorage failed\", e);\r\n        }\r\n    }\r\n\r\n\t/**\r\n\t * 获取指定键名的 <code>Object</code> 类型值。\r\n\t * @param key 键名。\r\n\t * @return <code>Object</code> 类型值\r\n\t */\r\n    static getJSON(key: string): any {\r\n        try{\r\n            let obj = JSON.parse(Storage.support ? Storage.items.getItem(key) : null);\r\n            return obj;\r\n        }catch(err){\r\n            return Storage.items.getItem(key);\r\n        }\r\n    }\r\n\r\n\t/**\r\n\t * 删除指定键名的信息。\r\n\t * @param key 键名。\r\n\t */\r\n    static removeItem(key: string): void {\r\n        Storage.support && Storage.items.removeItem(key);\r\n    }\r\n\r\n\t/**\r\n\t * 清除本地存储信息。\r\n\t */\r\n    static clear(): void {\r\n        Storage.support && Storage.items.clear();\r\n    }\r\n\r\n}\r\n","import { ILaya } from \"../../ILaya\";\r\nimport { Event } from \"../events/Event\";\r\nimport { Browser } from \"../utils/Browser\";\r\nimport { Handler } from \"../utils/Handler\";\r\nimport { HttpRequest } from \"./HttpRequest\";\r\nimport { Loader } from \"./Loader\";\r\n\r\n/**\r\n * @private\r\n */\r\nexport class TTFLoader {\r\n    private static _testString: string = \"LayaTTFFont\";\r\n    fontName: string;\r\n    complete: Handler|null;\r\n    err: Handler|null;\r\n    private _fontTxt: string;\r\n    private _url: string;\r\n    private _div: any;\r\n    private _txtWidth: number;\r\n    private _http: HttpRequest|null;\r\n\r\n    //TODO:coverage\r\n    load(fontPath: string): void {\r\n        this._url = fontPath;\r\n        var tArr: any[] = fontPath.split(\".ttf\")[0].split(\"/\");\r\n        this.fontName = tArr[tArr.length - 1];\r\n        if (ILaya.Render.isConchApp) {\r\n            this._loadConch();\r\n        } else\r\n            if ((window as any).FontFace) {\r\n                this._loadWithFontFace()\r\n            }\r\n            else {\r\n                this._loadWithCSS();\r\n            }\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _loadConch(): void {\r\n        this._http = new HttpRequest();\r\n        this._http.on(Event.ERROR, this, this._onErr);\r\n        this._http.on(Event.COMPLETE, this, this._onHttpLoaded);\r\n        this._http.send(this._url, null, \"get\", Loader.BUFFER);\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _onHttpLoaded(data: any = null): void {\r\n        window[\"conchTextCanvas\"].setFontFaceFromBuffer(this.fontName, data);\r\n        this._clearHttp();\r\n        this._complete();\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _clearHttp(): void {\r\n        if (this._http) {\r\n            this._http.off(Event.ERROR, this, this._onErr);\r\n            this._http.off(Event.COMPLETE, this, this._onHttpLoaded);\r\n            this._http = null;\r\n        }\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _onErr(): void {\r\n        this._clearHttp();\r\n        if (this.err) {\r\n            this.err.runWith(\"fail:\" + this._url);\r\n            this.err = null;\r\n        }\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _complete(): void {\r\n        ILaya.systemTimer.clear(this, this._complete);\r\n        ILaya.systemTimer.clear(this, this._checkComplete);\r\n        if (this._div && this._div.parentNode) {\r\n\r\n            this._div.parentNode.removeChild(this._div);\r\n            this._div = null;\r\n        }\r\n        if (this.complete) {\r\n            this.complete.runWith(this);\r\n            this.complete = null;\r\n        }\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _checkComplete(): void {\r\n        if (ILaya.Browser.measureText(TTFLoader._testString, this._fontTxt).width != this._txtWidth) {\r\n            this._complete();\r\n        }\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _loadWithFontFace(): void {\r\n\r\n        var fontFace: any = new (window as any).FontFace(this.fontName, \"url('\" + this._url + \"')\");\r\n        (document as any).fonts.add(fontFace);\r\n        var self: TTFLoader = this;\r\n        fontFace.loaded.then((function (): void {\r\n            self._complete()\r\n        }));\r\n        //_createDiv();\r\n        fontFace.load();\r\n\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _createDiv(): void {\r\n        this._div = Browser.createElement(\"div\");\r\n        this._div.innerHTML = \"laya\";\r\n        var _style: any = this._div.style;\r\n        _style.fontFamily = this.fontName;\r\n        _style.position = \"absolute\";\r\n        _style.left = \"-100px\";\r\n        _style.top = \"-100px\";\r\n        document.body.appendChild(this._div);\r\n    }\r\n\r\n    //TODO:coverage\r\n    private _loadWithCSS(): void {\r\n\r\n        var fontStyle: any = Browser.createElement(\"style\");\r\n        fontStyle.type = \"text/css\";\r\n        document.body.appendChild(fontStyle);\r\n        fontStyle.textContent = \"@font-face { font-family:'\" + this.fontName + \"'; src:url('\" + this._url + \"');}\";\r\n        this._fontTxt = \"40px \" + this.fontName;\r\n        this._txtWidth = Browser.measureText(TTFLoader._testString, this._fontTxt).width;\r\n\r\n        var self: TTFLoader = this;\r\n        fontStyle.onload = function (): void {\r\n            ILaya.systemTimer.once(10000, self, self._complete);\r\n        };\r\n        ILaya.systemTimer.loop(20, this, this._checkComplete);\r\n\r\n        this._createDiv();\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n","/**\r\n\t * <code>Ease</code> 类定义了缓动函数，以便实现 <code>Tween</code> 动画的缓动效果。\r\n\t */\r\nexport class Ease {\r\n\t/**@private */\r\n\tprivate static HALF_PI: number = Math.PI * 0.5;\r\n\t/**@private */\r\n\tprivate static PI2: number =   Math.PI * 2;\r\n\r\n\t/**\r\n\t * 定义无加速持续运动。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic linearNone(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c * t / d + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 定义无加速持续运动。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic linearIn(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c * t / d + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 定义无加速持续运动。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic linearInOut(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c * t / d + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 定义无加速持续运动。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic linearOut(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c * t / d + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 方法以零速率开始运动，然后在执行时加快运动速度。\r\n\t * 它的运动是类似一个球落向地板又弹起后，几次逐渐减小的回弹运动。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic bounceIn(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c - Ease.bounceOut(d - t, 0, c, d) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 开始运动时速率为零，先对运动进行加速，再减速直到速率为零。\r\n\t * 它的运动是类似一个球落向地板又弹起后，几次逐渐减小的回弹运动。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic bounceInOut(t: number, b: number, c: number, d: number): number {\r\n\t\tif (t < d * 0.5) return Ease.bounceIn(t * 2, 0, c, d) * .5 + b;\r\n\t\telse return Ease.bounceOut(t * 2 - d, 0, c, d) * .5 + c * .5 + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 以较快速度开始运动，然后在执行时减慢运动速度，直至速率为零。\r\n\t * 它的运动是类似一个球落向地板又弹起后，几次逐渐减小的回弹运动。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic bounceOut(t: number, b: number, c: number, d: number): number {\r\n\t\tif ((t /= d) < (1 / 2.75)) return c * (7.5625 * t * t) + b;\r\n\t\telse if (t < (2 / 2.75)) return c * (7.5625 * (t -= (1.5 / 2.75)) * t + .75) + b;\r\n\t\telse if (t < (2.5 / 2.75)) return c * (7.5625 * (t -= (2.25 / 2.75)) * t + .9375) + b;\r\n\t\telse return c * (7.5625 * (t -= (2.625 / 2.75)) * t + .984375) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 开始时往后运动，然后反向朝目标移动。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @param\ts 指定过冲量，此处数值越大，过冲越大。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic backIn(t: number, b: number, c: number, d: number, s: number = 1.70158): number {\r\n\t\treturn c * (t /= d) * t * ((s + 1) * t - s) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 开始运动时是向后跟踪，再倒转方向并朝目标移动，稍微过冲目标，然后再次倒转方向，回来朝目标移动。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @param\ts 指定过冲量，此处数值越大，过冲越大。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic backInOut(t: number, b: number, c: number, d: number, s: number = 1.70158): number {\r\n\t\tif ((t /= d * 0.5) < 1) return c * 0.5 * (t * t * (((s *= (1.525)) + 1) * t - s)) + b;\r\n\t\treturn c / 2 * ((t -= 2) * t * (((s *= (1.525)) + 1) * t + s) + 2) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 开始运动时是朝目标移动，稍微过冲，再倒转方向回来朝着目标。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @param\ts 指定过冲量，此处数值越大，过冲越大。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic backOut(t: number, b: number, c: number, d: number, s: number = 1.70158): number {\r\n\t\treturn c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 方法以零速率开始运动，然后在执行时加快运动速度。\r\n\t * 其中的运动由按照指数方式衰减的正弦波来定义。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @param\ta 指定正弦波的幅度。\r\n\t * @param\tp 指定正弦波的周期。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic elasticIn(t: number, b: number, c: number, d: number, a: number = 0, p: number = 0): number {\r\n\r\n\t\tvar s: number;\r\n\t\tif (t == 0) return b;\r\n\t\tif ((t /= d) == 1) return b + c;\r\n\t\tif (!p) p = d * .3;\r\n\t\tif (!a || (c > 0 && a < c) || (c < 0 && a < -c)) {\r\n\t\t\ta = c;\r\n\t\t\ts = p / 4;\r\n\t\t} else s = p / Ease.PI2 * Math.asin(c / a);\r\n\t\treturn -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * Ease.PI2 / p)) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 开始运动时速率为零，先对运动进行加速，再减速直到速率为零。\r\n\t * 其中的运动由按照指数方式衰减的正弦波来定义。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @param\ta 指定正弦波的幅度。\r\n\t * @param\tp 指定正弦波的周期。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic elasticInOut(t: number, b: number, c: number, d: number, a: number = 0, p: number = 0): number {\r\n\r\n\t\tvar s: number;\r\n\t\tif (t == 0) return b;\r\n\t\tif ((t /= d * 0.5) == 2) return b + c;\r\n\t\tif (!p) p = d * (.3 * 1.5);\r\n\t\tif (!a || (c > 0 && a < c) || (c < 0 && a < -c)) {\r\n\t\t\ta = c;\r\n\t\t\ts = p / 4;\r\n\t\t} else s = p / Ease.PI2 * Math.asin(c / a);\r\n\t\tif (t < 1) return -.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * Ease.PI2 / p)) + b;\r\n\t\treturn a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * d - s) * Ease.PI2 / p) * .5 + c + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 以较快速度开始运动，然后在执行时减慢运动速度，直至速率为零。\r\n\t * 其中的运动由按照指数方式衰减的正弦波来定义。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @param\ta 指定正弦波的幅度。\r\n\t * @param\tp 指定正弦波的周期。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic elasticOut(t: number, b: number, c: number, d: number, a: number = 0, p: number = 0): number {\r\n\r\n\t\tvar s: number;\r\n\t\tif (t == 0) return b;\r\n\t\tif ((t /= d) == 1) return b + c;\r\n\t\tif (!p) p = d * .3;\r\n\t\tif (!a || (c > 0 && a < c) || (c < 0 && a < -c)) {\r\n\t\t\ta = c;\r\n\t\t\ts = p / 4;\r\n\t\t} else s = p / Ease.PI2 * Math.asin(c / a);\r\n\t\treturn (a * Math.pow(2, -10 * t) * Math.sin((t * d - s) * Ease.PI2 / p) + c + b);\r\n\t}\r\n\r\n\t/**\r\n\t * 以零速率开始运动，然后在执行时加快运动速度。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic strongIn(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c * (t /= d) * t * t * t * t + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 开始运动时速率为零，先对运动进行加速，再减速直到速率为零。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic strongInOut(t: number, b: number, c: number, d: number): number {\r\n\t\tif ((t /= d * 0.5) < 1) return c * 0.5 * t * t * t * t * t + b;\r\n\t\treturn c * 0.5 * ((t -= 2) * t * t * t * t + 2) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 以较快速度开始运动，然后在执行时减慢运动速度，直至速率为零。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic strongOut(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c * ((t = t / d - 1) * t * t * t * t + 1) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 开始运动时速率为零，先对运动进行加速，再减速直到速率为零。\r\n\t * Sine 缓动方程中的运动加速度小于 Quad 方程中的运动加速度。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic sineInOut(t: number, b: number, c: number, d: number): number {\r\n\t\treturn -c * 0.5 * (Math.cos(Math.PI * t / d) - 1) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 以零速率开始运动，然后在执行时加快运动速度。\r\n\t * Sine 缓动方程中的运动加速度小于 Quad 方程中的运动加速度。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic sineIn(t: number, b: number, c: number, d: number): number {\r\n\t\treturn -c * Math.cos(t / d * Ease.HALF_PI) + c + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 以较快速度开始运动，然后在执行时减慢运动速度，直至速率为零。\r\n\t * Sine 缓动方程中的运动加速度小于 Quad 方程中的运动加速度。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic sineOut(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c * Math.sin(t / d * Ease.HALF_PI) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 以零速率开始运动，然后在执行时加快运动速度。\r\n\t * Quint 缓动方程的运动加速大于 Quart 缓动方程。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic quintIn(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c * (t /= d) * t * t * t * t + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 开始运动时速率为零，先对运动进行加速，再减速直到速率为零。\r\n\t * Quint 缓动方程的运动加速大于 Quart 缓动方程。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic quintInOut(t: number, b: number, c: number, d: number): number {\r\n\t\tif ((t /= d * 0.5) < 1) return c * 0.5 * t * t * t * t * t + b;\r\n\t\treturn c * 0.5 * ((t -= 2) * t * t * t * t + 2) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 以较快速度开始运动，然后在执行时减慢运动速度，直至速率为零。\r\n\t * Quint 缓动方程的运动加速大于 Quart 缓动方程。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic quintOut(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c * ((t = t / d - 1) * t * t * t * t + 1) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 方法以零速率开始运动，然后在执行时加快运动速度。\r\n\t * Quart 缓动方程的运动加速大于 Cubic 缓动方程。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic quartIn(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c * (t /= d) * t * t * t + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 开始运动时速率为零，先对运动进行加速，再减速直到速率为零。\r\n\t * Quart 缓动方程的运动加速大于 Cubic 缓动方程。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic quartInOut(t: number, b: number, c: number, d: number): number {\r\n\t\tif ((t /= d * 0.5) < 1) return c * 0.5 * t * t * t * t + b;\r\n\t\treturn -c * 0.5 * ((t -= 2) * t * t * t - 2) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 以较快速度开始运动，然后在执行时减慢运动速度，直至速率为零。\r\n\t * Quart 缓动方程的运动加速大于 Cubic 缓动方程。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic quartOut(t: number, b: number, c: number, d: number): number {\r\n\t\treturn -c * ((t = t / d - 1) * t * t * t - 1) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 方法以零速率开始运动，然后在执行时加快运动速度。\r\n\t * Cubic 缓动方程的运动加速大于 Quad 缓动方程。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic cubicIn(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c * (t /= d) * t * t + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 开始运动时速率为零，先对运动进行加速，再减速直到速率为零。\r\n\t * Cubic 缓动方程的运动加速大于 Quad 缓动方程。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic cubicInOut(t: number, b: number, c: number, d: number): number {\r\n\t\tif ((t /= d * 0.5) < 1) return c * 0.5 * t * t * t + b;\r\n\t\treturn c * 0.5 * ((t -= 2) * t * t + 2) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 以较快速度开始运动，然后在执行时减慢运动速度，直至速率为零。\r\n\t * Cubic 缓动方程的运动加速大于 Quad 缓动方程。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic cubicOut(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c * ((t = t / d - 1) * t * t + 1) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 方法以零速率开始运动，然后在执行时加快运动速度。\r\n\t * Quad 缓动方程中的运动加速度等于 100% 缓动的时间轴补间的运动加速度，并且显著小于 Cubic 缓动方程中的运动加速度。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic quadIn(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c * (t /= d) * t + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 开始运动时速率为零，先对运动进行加速，再减速直到速率为零。\r\n\t * Quad 缓动方程中的运动加速度等于 100% 缓动的时间轴补间的运动加速度，并且显著小于 Cubic 缓动方程中的运动加速度。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic quadInOut(t: number, b: number, c: number, d: number): number {\r\n\t\tif ((t /= d * 0.5) < 1) return c * 0.5 * t * t + b;\r\n\t\treturn -c * 0.5 * ((--t) * (t - 2) - 1) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 以较快速度开始运动，然后在执行时减慢运动速度，直至速率为零。\r\n\t * Quad 缓动方程中的运动加速度等于 100% 缓动的时间轴补间的运动加速度，并且显著小于 Cubic 缓动方程中的运动加速度。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic quadOut(t: number, b: number, c: number, d: number): number {\r\n\t\treturn -c * (t /= d) * (t - 2) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 方法以零速率开始运动，然后在执行时加快运动速度。\r\n\t * 其中每个时间间隔是剩余距离减去一个固定比例部分。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic expoIn(t: number, b: number, c: number, d: number): number {\r\n\t\treturn (t == 0) ? b : c * Math.pow(2, 10 * (t / d - 1)) + b - c * 0.001;\r\n\t}\r\n\r\n\t/**\r\n\t * 开始运动时速率为零，先对运动进行加速，再减速直到速率为零。\r\n\t * 其中每个时间间隔是剩余距离减去一个固定比例部分。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic expoInOut(t: number, b: number, c: number, d: number): number {\r\n\t\tif (t == 0) return b;\r\n\t\tif (t == d) return b + c;\r\n\t\tif ((t /= d * 0.5) < 1) return c * 0.5 * Math.pow(2, 10 * (t - 1)) + b;\r\n\t\treturn c * 0.5 * (-Math.pow(2, -10 * --t) + 2) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 以较快速度开始运动，然后在执行时减慢运动速度，直至速率为零。\r\n\t * 其中每个时间间隔是剩余距离减去一个固定比例部分。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic expoOut(t: number, b: number, c: number, d: number): number {\r\n\t\treturn (t == d) ? b + c : c * (-Math.pow(2, -10 * t / d) + 1) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 方法以零速率开始运动，然后在执行时加快运动速度。\r\n\t * 缓动方程的运动加速会产生突然的速率变化。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic circIn(t: number, b: number, c: number, d: number): number {\r\n\t\treturn -c * (Math.sqrt(1 - (t /= d) * t) - 1) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 开始运动时速率为零，先对运动进行加速，再减速直到速率为零。\r\n\t * 缓动方程的运动加速会产生突然的速率变化。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic circInOut(t: number, b: number, c: number, d: number): number {\r\n\t\tif ((t /= d * 0.5) < 1) return -c * 0.5 * (Math.sqrt(1 - t * t) - 1) + b;\r\n\t\treturn c * 0.5 * (Math.sqrt(1 - (t -= 2) * t) + 1) + b;\r\n\t}\r\n\r\n\t/**\r\n\t * 以较快速度开始运动，然后在执行时减慢运动速度，直至速率为零。\r\n\t * 缓动方程的运动加速会产生突然的速率变化。\r\n\t * @param\tt 指定当前时间，介于 0 和持续时间之间（包括二者）。\r\n\t * @param\tb 指定动画属性的初始值。\r\n\t * @param\tc 指定动画属性的更改总计。\r\n\t * @param\td 指定运动的持续时间。\r\n\t * @return 指定时间的插补属性的值。\r\n\t */\r\n\tstatic circOut(t: number, b: number, c: number, d: number): number {\r\n\t\treturn c * Math.sqrt(1 - (t = t / d - 1) * t) + b;\r\n\t}\r\n\r\n}\r\n\r\n","import { Handler } from \"./Handler\";\r\nimport { Pool } from \"./Pool\";\r\nimport { Browser } from \"./Browser\";\r\nimport { Utils } from \"./Utils\";\r\nimport { ILaya } from \"./../../ILaya\";\r\n/**\r\n\t * <code>Tween</code>  是一个缓动类。使用此类能够实现对目标对象属性的渐变。\r\n\t */\r\nexport class Tween {\r\n\r\n\r\n    /**@private */\r\n    private static tweenMap: any[] = [];\r\n    /**@private */\r\n    private _complete: Handler;\r\n    /**@private */\r\n    private _target: any;\r\n    /**@private */\r\n    private _ease: Function;\r\n    /**@private */\r\n    private _props: any[];\r\n    /**@private */\r\n    private _duration: number;\r\n    /**@private */\r\n    private _delay: number;\r\n    /**@private */\r\n    private _startTimer: number;\r\n    /**@private */\r\n    private _usedTimer: number;\r\n    /**@private */\r\n    private _usedPool: boolean;\r\n    /**@private */\r\n    private _delayParam: any[];\r\n    /**@private 唯一标识，TimeLintLite用到*/\r\n    gid: number = 0;\r\n    /**更新回调，缓动数值发生变化时，回调变化的值*/\r\n    update: Handler;\r\n    /**重播次数，如果repeat=0，则表示无限循环播放*/\r\n    repeat: number = 1;\r\n    /**当前播放次数*/\r\n    private _count: number = 0;\r\n\r\n    /**\r\n     * 缓动对象的props属性到目标值。\r\n     * @param\ttarget 目标对象(即将更改属性值的对象)。\r\n     * @param\tprops 变化的属性列表，比如{x:100,y:20,ease:Ease.backOut,complete:Handler.create(this,onComplete),update:new Handler(this,onComplete)}。\r\n     * @param\tduration 花费的时间，单位毫秒。\r\n     * @param\tease 缓动类型，默认为匀速运动。\r\n     * @param\tcomplete 结束回调函数。\r\n     * @param\tdelay 延迟执行时间。\r\n     * @param\tcoverBefore 是否覆盖之前的缓动。\r\n     * @param\tautoRecover 是否自动回收，默认为true，缓动结束之后自动回收到对象池。\r\n     * @return\t返回Tween对象。\r\n     */\r\n    static to(target: any, props: any, duration: number, ease: Function = null, complete: Handler = null, delay: number = 0, coverBefore: boolean = false, autoRecover: boolean = true): Tween {\r\n        return Pool.getItemByClass(\"tween\", Tween)._create(target, props, duration, ease, complete, delay, coverBefore, true, autoRecover, true);\r\n    }\r\n\r\n    /**\r\n     * 从props属性，缓动到当前状态。\r\n     * @param\ttarget 目标对象(即将更改属性值的对象)。\r\n     * @param\tprops 变化的属性列表，比如{x:100,y:20,ease:Ease.backOut,complete:Handler.create(this,onComplete),update:new Handler(this,onComplete)}。\r\n     * @param\tduration 花费的时间，单位毫秒。\r\n     * @param\tease 缓动类型，默认为匀速运动。\r\n     * @param\tcomplete 结束回调函数。\r\n     * @param\tdelay 延迟执行时间。\r\n     * @param\tcoverBefore 是否覆盖之前的缓动。\r\n     * @param\tautoRecover 是否自动回收，默认为true，缓动结束之后自动回收到对象池。\r\n     * @return\t返回Tween对象。\r\n     */\r\n    static from(target: any, props: any, duration: number, ease: Function = null, complete: Handler = null, delay: number = 0, coverBefore: boolean = false, autoRecover: boolean = true): Tween {\r\n        return Pool.getItemByClass(\"tween\", Tween)._create(target, props, duration, ease, complete, delay, coverBefore, false, autoRecover, true);\r\n    }\r\n\r\n    /**\r\n     * 缓动对象的props属性到目标值。\r\n     * @param\ttarget 目标对象(即将更改属性值的对象)。\r\n     * @param\tprops 变化的属性列表，比如{x:100,y:20,ease:Ease.backOut,complete:Handler.create(this,onComplete),update:new Handler(this,onComplete)}。\r\n     * @param\tduration 花费的时间，单位毫秒。\r\n     * @param\tease 缓动类型，默认为匀速运动。\r\n     * @param\tcomplete 结束回调函数。\r\n     * @param\tdelay 延迟执行时间。\r\n     * @param\tcoverBefore 是否覆盖之前的缓动。\r\n     * @return\t返回Tween对象。\r\n     */\r\n    to(target: any, props: any, duration: number, ease: Function = null, complete: Handler = null, delay: number = 0, coverBefore: boolean = false): Tween {\r\n        return this._create(target, props, duration, ease, complete, delay, coverBefore, true, false, true);\r\n    }\r\n\r\n    /**\r\n     * 从props属性，缓动到当前状态。\r\n     * @param\ttarget 目标对象(即将更改属性值的对象)。\r\n     * @param\tprops 变化的属性列表，比如{x:100,y:20,ease:Ease.backOut,complete:Handler.create(this,onComplete),update:new Handler(this,onComplete)}。\r\n     * @param\tduration 花费的时间，单位毫秒。\r\n     * @param\tease 缓动类型，默认为匀速运动。\r\n     * @param\tcomplete 结束回调函数。\r\n     * @param\tdelay 延迟执行时间。\r\n     * @param\tcoverBefore 是否覆盖之前的缓动。\r\n     * @return\t返回Tween对象。\r\n     */\r\n    from(target: any, props: any, duration: number, ease: Function = null, complete: Handler = null, delay: number = 0, coverBefore: boolean = false): Tween {\r\n        return this._create(target, props, duration, ease, complete, delay, coverBefore, false, false, true);\r\n    }\r\n\r\n    /** @internal */\r\n    _create(target: any, props: any, duration: number, ease: Function, complete: Handler, delay: number, coverBefore: boolean, isTo: boolean, usePool: boolean, runNow: boolean): Tween {\r\n        if (!target) throw new Error(\"Tween:target is null\");\r\n        this._target = target;\r\n        this._duration = duration;\r\n        this._ease = ease || props.ease || Tween.easeNone;\r\n        this._complete = complete || props.complete;\r\n        this._delay = delay;\r\n        this._props = [];\r\n        this._usedTimer = 0;\r\n        this._startTimer = Browser.now();\r\n        this._usedPool = usePool;\r\n        this._delayParam = null;\r\n        this.update = props.update;\r\n\r\n        //判断是否覆盖\t\t\t\r\n        var gid: number = (target.$_GID || (target.$_GID = Utils.getGID()));\r\n        if (!Tween.tweenMap[gid]) {\r\n            Tween.tweenMap[gid] = [this];\r\n        } else {\r\n            if (coverBefore) Tween.clearTween(target);\r\n            Tween.tweenMap[gid].push(this);\r\n        }\r\n\r\n        if (runNow) {\r\n            if (delay <= 0) this.firstStart(target, props, isTo);\r\n            else {\r\n                this._delayParam = [target, props, isTo];\r\n                ILaya.timer.once(delay, this, this.firstStart, this._delayParam);\r\n            }\r\n        } else {\r\n            this._initProps(target, props, isTo);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    private firstStart(target: any, props: any, isTo: boolean): void {\r\n        this._delayParam = null;\r\n        if (target.destroyed) {\r\n            this.clear();\r\n            return;\r\n        }\r\n        this._initProps(target, props, isTo);\r\n        this._beginLoop();\r\n    }\r\n\r\n    private _initProps(target: any, props: any, isTo: boolean): void {\r\n        //初始化属性\r\n        for (var p in props) {\r\n            if (typeof (target[p]) == 'number') {\r\n                var start: number = isTo ? target[p] : props[p];\r\n                var end: number = isTo ? props[p] : target[p];\r\n                this._props.push([p, start, end - start]);\r\n                if (!isTo) target[p] = start;\r\n            }\r\n        }\r\n    }\r\n\r\n    private _beginLoop(): void {\r\n        ILaya.timer.frameLoop(1, this, this._doEase);\r\n    }\r\n\r\n    /**执行缓动**/\r\n    private _doEase(): void {\r\n        this._updateEase(Browser.now());\r\n    }\r\n\r\n    /**@internal */\r\n    _updateEase(time: number): void {\r\n        var target: any = this._target;\r\n        if (!target) return;\r\n\r\n        //如果对象被销毁，则立即停止缓动\r\n        if (target.destroyed) return Tween.clearTween(target);\r\n\r\n        var usedTimer: number = this._usedTimer = time - this._startTimer - this._delay;\r\n        if (usedTimer < 0) return;\r\n        if (usedTimer >= this._duration) return this.complete();\r\n\r\n        var ratio: number = usedTimer > 0 ? this._ease(usedTimer, 0, 1, this._duration) : 0;\r\n        var props: any[] = this._props;\r\n        for (var i: number = 0, n: number = props.length; i < n; i++) {\r\n            var prop: any[] = props[i];\r\n            target[prop[0]] = prop[1] + (ratio * prop[2]);\r\n        }\r\n        if (this.update) this.update.run();\r\n    }\r\n\r\n    /**设置当前执行比例**/\r\n    set progress(v: number) {\r\n        var uTime: number = v * this._duration;\r\n        this._startTimer = Browser.now() - this._delay - uTime;\r\n    }\r\n\r\n    /**\r\n     * 立即结束缓动并到终点。\r\n     */\r\n    complete(): void {\r\n        if (!this._target) return;\r\n\r\n        //立即执行初始化\r\n        ILaya.timer.runTimer(this, this.firstStart);\r\n\r\n        //缓存当前属性\r\n        var target: any = this._target;\r\n        var props: any = this._props;\r\n        var handler: Handler = this._complete;\r\n        //设置终点属性\r\n        for (var i: number = 0, n: number = props.length; i < n; i++) {\r\n            var prop: any[] = props[i];\r\n            target[prop[0]] = prop[1] + prop[2];\r\n        }\r\n        if (this.update) this.update.run();\r\n\r\n        this._count++;\r\n        if (this.repeat != 0 && this._count >= this.repeat) {\r\n            //清理\r\n            this.clear();\r\n            //回调\r\n            handler && handler.run();\r\n        } else {\r\n            this.restart();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 暂停缓动，可以通过resume或restart重新开始。\r\n     */\r\n    pause(): void {\r\n        ILaya.timer.clear(this, this._beginLoop);\r\n        ILaya.timer.clear(this, this._doEase);\r\n        ILaya.timer.clear(this, this.firstStart);\r\n        var time: number = Browser.now();\r\n        var dTime: number;\r\n        dTime = time - this._startTimer - this._delay;\r\n        if (dTime < 0) {\r\n            this._usedTimer = dTime;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置开始时间。\r\n     * @param\tstartTime 开始时间。\r\n     */\r\n    setStartTime(startTime: number): void {\r\n        this._startTimer = startTime;\r\n    }\r\n\r\n    /**\r\n     * 清理指定目标对象上的所有缓动。\r\n     * @param\ttarget 目标对象。\r\n     */\r\n    static clearAll(target: any): void {\r\n        if (!target || !target.$_GID) return;\r\n        var tweens: any[] = Tween.tweenMap[target.$_GID];\r\n        if (tweens) {\r\n            for (var i: number = 0, n: number = tweens.length; i < n; i++) {\r\n                tweens[i]._clear();\r\n            }\r\n            tweens.length = 0;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 清理某个缓动。\r\n     * @param\ttween 缓动对象。\r\n     */\r\n    static clear(tween: Tween): void {\r\n        tween.clear();\r\n    }\r\n\r\n    /**@private 同clearAll，废弃掉，尽量别用。*/\r\n    static clearTween(target: any): void {\r\n        Tween.clearAll(target);\r\n    }\r\n\r\n    /**\r\n     * 停止并清理当前缓动。\r\n     */\r\n    clear(): void {\r\n        if (this._target) {\r\n            this._remove();\r\n            this._clear();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    _clear(): void {\r\n        this.pause();\r\n        ILaya.timer.clear(this, this.firstStart);\r\n        this._complete = null;\r\n        this._target = null;\r\n        this._ease = null;\r\n        this._props = null;\r\n        this._delayParam = null;\r\n\tthis.repeat = 1;\r\n\r\n        if (this._usedPool) {\r\n            this.update = null;\r\n            Pool.recover(\"tween\", this);\r\n        }\r\n    }\r\n\r\n    /** 回收到对象池。*/\r\n    recover(): void {\r\n        this._usedPool = true;\r\n        this._clear();\r\n    }\r\n\r\n    private _remove(): void {\r\n        var tweens: any[] = Tween.tweenMap[this._target.$_GID];\r\n        if (tweens) {\r\n            for (var i: number = 0, n: number = tweens.length; i < n; i++) {\r\n                if (tweens[i] === this) {\r\n                    tweens.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 重新开始暂停的缓动。\r\n     */\r\n    restart(): void {\r\n        this.pause();\r\n        this._usedTimer = 0;\r\n        this._startTimer = Browser.now();\r\n        if (this._delayParam) {\r\n            ILaya.timer.once(this._delay, this, this.firstStart, this._delayParam);\r\n            return;\r\n        }\r\n        var props: any[] = this._props;\r\n        for (var i: number = 0, n: number = props.length; i < n; i++) {\r\n            var prop: any[] = props[i];\r\n            this._target[prop[0]] = prop[1];\r\n        }\r\n        ILaya.timer.once(this._delay, this, this._beginLoop);\r\n    }\r\n\r\n    /**\r\n     * 恢复暂停的缓动。\r\n     */\r\n    resume(): void {\r\n        if (this._usedTimer >= this._duration) return;\r\n        this._startTimer = Browser.now() - this._usedTimer - this._delay;\r\n        if (this._delayParam) {\r\n            if (this._usedTimer < 0) {\r\n                ILaya.timer.once(-this._usedTimer, this, this.firstStart, this._delayParam);\r\n            } else {\r\n                this.firstStart.apply(this, this._delayParam);\r\n            }\r\n        } else {\r\n            this._beginLoop();\r\n        }\r\n    }\r\n\r\n    private static easeNone(t: number, b: number, c: number, d: number): number {\r\n        return c * t / d + b;\r\n    }\r\n}\r\n\r\n","import { Sprite } from \"../display/Sprite\";\r\nimport { Event } from \"../events/Event\";\r\nimport { MouseManager } from \"../events/MouseManager\";\r\nimport { Point } from \"../maths/Point\";\r\nimport { Rectangle } from \"../maths/Rectangle\";\r\nimport { ILaya } from \"./../../ILaya\";\r\nimport { Ease } from \"./Ease\";\r\nimport { Handler } from \"./Handler\";\r\nimport { Tween } from \"./Tween\";\r\n\r\n/**\r\n * @private\r\n * <code>Dragging</code> 类是触摸滑动控件。\r\n */\r\nexport class Dragging {\r\n\r\n\r\n\t/** 被拖动的对象。*/\r\n\ttarget: Sprite;\r\n\t/** 缓动衰减系数。*/\r\n\tratio: number = 0.92;\r\n\t/** 单帧最大偏移量。*/\r\n\tmaxOffset: number = 60;\r\n\t/** 滑动范围。*/\r\n\tarea: Rectangle;\r\n\t/** 表示拖动是否有惯性。*/\r\n\thasInertia: boolean;\r\n\t/** 橡皮筋最大值。*/\r\n\telasticDistance: number;\r\n\t/** 橡皮筋回弹时间，单位为毫秒。*/\r\n\telasticBackTime: number;\r\n\t/** 事件携带数据。*/\r\n\tdata: any;\r\n\r\n\tprivate _dragging: boolean = false;\r\n\tprivate _clickOnly: boolean = true;\r\n\tprivate _elasticRateX: number;\r\n\tprivate _elasticRateY: number;\r\n\tprivate _lastX: number;\r\n\tprivate _lastY: number;\r\n\tprivate _offsetX: number;\r\n\tprivate _offsetY: number;\r\n\tprivate _offsets: any[];\r\n\tprivate _disableMouseEvent: boolean;\r\n\tprivate _tween: Tween;\r\n\tprivate _parent: Sprite;\r\n\r\n\t/**\r\n\t * 开始拖拽。\r\n\t * @param\ttarget 待拖拽的 <code>Sprite</code> 对象。\r\n\t * @param\tarea 滑动范围。\r\n\t * @param\thasInertia 拖动是否有惯性。\r\n\t * @param\telasticDistance 橡皮筋最大值。\r\n\t * @param\telasticBackTime 橡皮筋回弹时间，单位为毫秒。\r\n\t * @param\tdata 事件携带数据。\r\n\t * @param\tdisableMouseEvent 鼠标事件是否有效。\r\n\t * @param\tratio 惯性阻尼系数\r\n\t */\r\n\tstart(target: Sprite, area: Rectangle, hasInertia: boolean, elasticDistance: number, elasticBackTime: number, data: any, disableMouseEvent: boolean, ratio: number = 0.92): void {\r\n\t\tthis.clearTimer();\r\n\r\n\t\tthis.target = target;\r\n\t\tthis.area = area;\r\n\t\tthis.hasInertia = hasInertia;\r\n\t\tthis.elasticDistance = area ? elasticDistance : 0;\r\n\t\tthis.elasticBackTime = elasticBackTime;\r\n\t\tthis.data = data;\r\n\t\tthis._disableMouseEvent = disableMouseEvent;\r\n\t\tthis.ratio = ratio;\r\n\r\n\t\tthis._parent = (target.parent as Sprite);\r\n\r\n\t\tthis._clickOnly = true;\r\n\t\tthis._dragging = true;\r\n\t\tthis._elasticRateX = this._elasticRateY = 1;\r\n\t\tthis._lastX = this._parent.mouseX;\r\n\t\tthis._lastY = this._parent.mouseY;\r\n\r\n\t\tILaya.stage.on(Event.MOUSE_UP, this, this.onStageMouseUp);\r\n\t\tILaya.stage.on(Event.MOUSE_OUT, this, this.onStageMouseUp);\r\n\t\t//Laya.stage.on(Event.MOUSE_MOVE, this, onStageMouseMove);\r\n\t\tILaya.systemTimer.frameLoop(1, this, this.loop);\r\n\t}\r\n\r\n\t/**\r\n\t * 清除计时器。\r\n\t */\r\n\tprivate clearTimer(): void {\r\n\t\tILaya.systemTimer.clear(this, this.loop);\r\n\t\tILaya.systemTimer.clear(this, this.tweenMove);\r\n\t\tif (this._tween) {\r\n\t\t\tthis._tween.recover();\r\n\t\t\tthis._tween = null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 停止拖拽。\r\n\t */\r\n\tstop(): void {\r\n\t\tif (this._dragging) {\r\n\t\t\tMouseManager.instance.disableMouseEvent = false;\r\n\t\t\tILaya.stage.off(Event.MOUSE_UP, this, this.onStageMouseUp);\r\n\t\t\tILaya.stage.off(Event.MOUSE_OUT, this, this.onStageMouseUp);\r\n\t\t\tthis._dragging = false;\r\n\t\t\tthis.target && this.area && this.backToArea();\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 拖拽的循环处理函数。\r\n\t */\r\n\tprivate loop(): void {\r\n\t\tvar point: Point = this._parent.getMousePoint();\r\n\t\tvar mouseX: number = point.x;\r\n\t\tvar mouseY: number = point.y;\r\n\t\tvar offsetX: number = mouseX - this._lastX;\r\n\t\tvar offsetY: number = mouseY - this._lastY;\r\n\r\n\t\tif (this._clickOnly) {\r\n\t\t\tif (Math.abs(offsetX * ILaya.stage._canvasTransform.getScaleX()) > 1 || Math.abs(offsetY * ILaya.stage._canvasTransform.getScaleY()) > 1) {\r\n\t\t\t\tthis._clickOnly = false;\r\n\t\t\t\tthis._offsets || (this._offsets = []);\r\n\t\t\t\tthis._offsets.length = 0;\r\n\t\t\t\tthis.target.event(Event.DRAG_START, this.data);\r\n\t\t\t\tMouseManager.instance.disableMouseEvent = this._disableMouseEvent;\r\n\t\t\t\t//TODO:\r\n\t\t\t\t//target._set$P(\"$_MOUSEDOWN\", false);\r\n\t\t\t} else return;\r\n\t\t} else {\r\n\t\t\tthis._offsets.push(offsetX, offsetY);\r\n\t\t}\r\n\t\tif (offsetX === 0 && offsetY === 0) return;\r\n\r\n\t\tthis._lastX = mouseX;\r\n\t\tthis._lastY = mouseY;\r\n\t\tthis.target.x += offsetX * this._elasticRateX;\r\n\t\tthis.target.y += offsetY * this._elasticRateY;\r\n\r\n\t\tthis.area && this.checkArea();\r\n\r\n\t\tthis.target.event(Event.DRAG_MOVE, this.data);\r\n\t}\r\n\r\n\t/**\r\n\t * 拖拽区域检测。\r\n\t */\r\n\tprivate checkArea(): void {\r\n\t\tif (this.elasticDistance <= 0) {\r\n\t\t\tthis.backToArea();\r\n\t\t} else {\r\n\t\t\tif (this.target._x < this.area.x) {\r\n\t\t\t\tvar offsetX: number = this.area.x - this.target._x;\r\n\t\t\t} else if (this.target._x > this.area.x + this.area.width) {\r\n\t\t\t\toffsetX = this.target._x - this.area.x - this.area.width;\r\n\t\t\t} else {\r\n\t\t\t\toffsetX = 0;\r\n\t\t\t}\r\n\t\t\tthis._elasticRateX = Math.max(0, 1 - (offsetX / this.elasticDistance));\r\n\r\n\t\t\tif (this.target._y < this.area.y) {\r\n\t\t\t\tvar offsetY: number = this.area.y - this.target.y;\r\n\t\t\t} else if (this.target._y > this.area.y + this.area.height) {\r\n\t\t\t\toffsetY = this.target._y - this.area.y - this.area.height;\r\n\t\t\t} else {\r\n\t\t\t\toffsetY = 0;\r\n\t\t\t}\r\n\t\t\tthis._elasticRateY = Math.max(0, 1 - (offsetY / this.elasticDistance));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 移动至设定的拖拽区域。\r\n\t */\r\n\tprivate backToArea(): void {\r\n\t\tthis.target.x = Math.min(Math.max(this.target._x, this.area.x), this.area.x + this.area.width);\r\n\t\tthis.target.y = Math.min(Math.max(this.target._y, this.area.y), this.area.y + this.area.height);\r\n\t}\r\n\r\n\t/**\r\n\t * 舞台的抬起事件侦听函数。\r\n\t * @param\te Event 对象。\r\n\t */\r\n\tprivate onStageMouseUp(e: Event): void {\r\n\t\tMouseManager.instance.disableMouseEvent = false;\r\n\t\tILaya.stage.off(Event.MOUSE_UP, this, this.onStageMouseUp);\r\n\t\tILaya.stage.off(Event.MOUSE_OUT, this, this.onStageMouseUp);\r\n\t\t//Laya.stage.off(Event.MOUSE_MOVE, this, onStageMouseMove);\r\n\t\tILaya.systemTimer.clear(this, this.loop);\r\n\r\n\t\tif (this._clickOnly || !this.target) return;\r\n\t\t//target.mouseEnabled = true;\r\n\r\n\t\tif (this.hasInertia) {\r\n\t\t\t//计算平均值\r\n\t\t\tif (this._offsets.length < 1) {\r\n\t\t\t\tthis._offsets.push(this._parent.mouseX - this._lastX, this._parent.mouseY - this._lastY);\r\n\t\t\t}\r\n\r\n\t\t\tthis._offsetX = this._offsetY = 0;\r\n\t\t\tvar len: number = this._offsets.length;\r\n\t\t\tvar n: number = Math.min(len, 6);\r\n\t\t\tvar m: number = this._offsets.length - n;\r\n\t\t\tfor (var i: number = len - 1; i > m; i--) {\r\n\t\t\t\tthis._offsetY += this._offsets[i--];\r\n\t\t\t\tthis._offsetX += this._offsets[i];\r\n\t\t\t}\r\n\r\n\t\t\tthis._offsetX = this._offsetX / n * 2;\r\n\t\t\tthis._offsetY = this._offsetY / n * 2;\r\n\r\n\t\t\tif (Math.abs(this._offsetX) > this.maxOffset) this._offsetX = this._offsetX > 0 ? this.maxOffset : -this.maxOffset;\r\n\t\t\tif (Math.abs(this._offsetY) > this.maxOffset) this._offsetY = this._offsetY > 0 ? this.maxOffset : -this.maxOffset;\r\n\t\t\tILaya.systemTimer.frameLoop(1, this, this.tweenMove);\r\n\t\t} else if (this.elasticDistance > 0) {\r\n\t\t\tthis.checkElastic();\r\n\t\t} else {\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 橡皮筋效果检测。\r\n\t */\r\n\tprivate checkElastic(): void {\r\n\t\tvar tx: number = NaN;\r\n\t\tvar ty: number = NaN;\r\n\t\tif (this.target.x < this.area.x) tx = this.area.x;\r\n\t\telse if (this.target._x > this.area.x + this.area.width) tx = this.area.x + this.area.width;\r\n\r\n\t\tif (this.target.y < this.area.y) ty = this.area.y;\r\n\t\telse if (this.target._y > this.area.y + this.area.height) ty = this.area.y + this.area.height;\r\n\r\n\t\tif (!isNaN(tx) || !isNaN(ty)) {\r\n\t\t\tvar obj: any = {};\r\n\t\t\tif (!isNaN(tx)) obj.x = tx;\r\n\t\t\tif (!isNaN(ty)) obj.y = ty;\r\n\t\t\tthis._tween = Tween.to(this.target, obj, this.elasticBackTime, Ease.sineOut, Handler.create(this, this.clear), 0, false, false);\r\n\t\t} else {\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 移动。\r\n\t */\r\n\tprivate tweenMove(): void {\r\n\t\tthis._offsetX *= this.ratio * this._elasticRateX;\r\n\t\tthis._offsetY *= this.ratio * this._elasticRateY;\r\n\r\n\t\tthis.target.x += this._offsetX;\r\n\t\tthis.target.y += this._offsetY;\r\n\r\n\t\tthis.area && this.checkArea();\r\n\r\n\t\tthis.target.event(Event.DRAG_MOVE, this.data);\r\n\r\n\t\tif ((Math.abs(this._offsetX) < 1 && Math.abs(this._offsetY) < 1) || this._elasticRateX < 0.5 || this._elasticRateY < 0.5) {\r\n\t\t\tILaya.systemTimer.clear(this, this.tweenMove);\r\n\t\t\tif (this.elasticDistance > 0) this.checkElastic();\r\n\t\t\telse this.clear();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 结束拖拽。\r\n\t */\r\n\tprivate clear(): void {\r\n\t\tif (this.target) {\r\n\t\t\tthis.clearTimer();\r\n\t\t\tvar sp = this.target;\r\n\t\t\tthis.target = null;\r\n\t\t\tthis._parent = null;\r\n\t\t\tsp.event(Event.DRAG_END, this.data);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n","import { Node } from \"../display/Node\"\r\nimport { IDestroy } from \"../resource/IDestroy\"\r\nimport { ISingletonElement } from \"../resource/ISingletonElement\"\r\nimport { Pool } from \"../utils/Pool\"\r\nimport { Utils } from \"../utils/Utils\";\r\n\r\n/**\r\n * <code>Component</code> 类用于创建组件的基类。\r\n */\r\nexport class Component implements ISingletonElement, IDestroy {\r\n\t/** @internal [实现IListPool接口]*/\r\n\tprivate _indexInList: number;\r\n\r\n\t/** @internal [实现IListPool接口]*/\r\n\t_destroyed: boolean;\r\n\t/** @internal */\r\n\t_id: number;\r\n\t/** @internal */\r\n\t_enabled: boolean;\r\n\t/** @internal */\r\n\t_awaked: boolean;\r\n\r\n\t/**\r\n\t * [只读]获取所属Node节点。\r\n\t * @readonly\r\n\t */\r\n\towner: Node;\r\n\r\n\t/**\r\n\t * 创建一个新的 <code>Component</code> 实例。\r\n\t */\r\n\tconstructor() {\r\n\t\tthis._id = Utils.getGID();\r\n\t\tthis._resetComp();\r\n\t}\r\n\r\n\t/**\r\n\t * 唯一标识ID。\r\n\t */\r\n\tget id(): number {\r\n\t\treturn this._id;\r\n\t}\r\n\r\n\t/**\r\n\t * 是否启用组件。\r\n\t */\r\n\tget enabled(): boolean {\r\n\t\treturn this._enabled;\r\n\t}\r\n\r\n\tset enabled(value: boolean) {\r\n\t\tif (this._enabled != value) {\r\n\t\t\tthis._enabled = value;\r\n\t\t\tif (this.owner) {\r\n\t\t\t\tif (value)\r\n\t\t\t\t\tthis.owner.activeInHierarchy && this._onEnable();\r\n\t\t\t\telse\r\n\t\t\t\t\tthis.owner.activeInHierarchy && this._onDisable();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 是否为单实例组件。\r\n\t */\r\n\tget isSingleton(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * 是否已经销毁 。\r\n\t */\r\n\tget destroyed(): boolean {\r\n\t\t//[实现IListPool接口]\r\n\t\treturn this._destroyed;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_isScript(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprivate _resetComp(): void {\r\n\t\tthis._indexInList = -1;\r\n\t\tthis._enabled = true;\r\n\t\tthis._awaked = false;\r\n\t\tthis.owner = null;\r\n\t}\r\n\r\n\t/**\r\n\t * [实现IListPool接口]\r\n\t */\r\n\t_getIndexInList(): number {\r\n\t\treturn this._indexInList;\r\n\t}\r\n\r\n\t/**\r\n\t * [实现IListPool接口]\r\n\t */\r\n\t_setIndexInList(index: number): void {\r\n\t\tthis._indexInList = index;\r\n\t}\r\n\r\n\t/**\r\n\t * 被添加到节点后调用，可根据需要重写此方法\r\n\t * @internal\r\n\t */\r\n\t_onAdded(): void {\r\n\t\t//override it.\r\n\t}\r\n\r\n\t/**\r\n\t * 被激活后调用，可根据需要重写此方法\r\n\t * @internal\r\n\t */\r\n\t_onAwake(): void {\r\n\t\t//override it.\r\n\t}\r\n\r\n\t/**\r\n\t * 被激活后调用，可根据需要重写此方法\r\n\t * @internal\r\n\t */\r\n\t_onEnable(): void {\r\n\t\t//override it.\r\n\t}\r\n\r\n\t/**\r\n\t * 被禁用时调用，可根据需要重写此方法\r\n\t * @internal\r\n\t */\r\n\tprotected _onDisable(): void {\r\n\t\t//override it.\r\n\t}\r\n\r\n\t/**\r\n\t * 被销毁时调用，可根据需要重写此方法\r\n\t * @internal\r\n\t */\r\n\tprotected _onDestroy(): void {\r\n\t\t//override it.\r\n\t}\r\n\r\n\t/**\r\n\t * 重置组件参数到默认值，如果实现了这个函数，则组件会被重置并且自动回收到对象池，方便下次复用\r\n\t * 如果没有重置，则不进行回收复用\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonReset(): void {\r\n\t\t//override it.\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_parse(data: any,interactMap:any = null): void {\r\n\t\t//override it.\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_parseInteractive(data:any = null,spriteMap:any = null){\r\n\t\t//override it.\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_cloneTo(dest: Component): void {\r\n\t\t//override it.\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_setActive(value: boolean): void {\r\n\t\tif (value) {\r\n\t\t\tif (!this._awaked) {\r\n\t\t\t\tthis._awaked = true;\r\n\t\t\t\tthis._onAwake();\r\n\t\t\t}\r\n\t\t\tthis._enabled && this._onEnable();\r\n\t\t} else {\r\n\t\t\tthis._enabled && this._onDisable();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 销毁组件\r\n\t */\r\n\tdestroy(): void {\r\n\t\tif (this.owner) this.owner._destroyComponent(this);\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_destroy(): void {\r\n\t\tif (this.owner.activeInHierarchy && this._enabled)\r\n\t\t\tthis._setActive(false);\r\n\r\n\t\tthis._onDestroy();\r\n\t\tthis._destroyed = true;\r\n\t\tif (this.onReset !== Component.prototype.onReset) {\r\n\t\t\tthis.onReset();\r\n\t\t\tthis._resetComp();\r\n\t\t\tPool.recoverByClass(this);\r\n\t\t} else {\r\n\t\t\tthis._resetComp();\r\n\t\t}\r\n\t}\r\n}\r\n\r\n","import { Sprite } from \"./Sprite\";\r\nimport { Config } from \"./../../Config\";\r\nimport { Const } from \"../Const\"\r\nimport { Event } from \"../events/Event\"\r\nimport { ClassUtils } from \"../utils/ClassUtils\";\r\n\r\n/**\r\n * 动画播放完毕后调度。\r\n * @eventType Event.COMPLETE\r\n */\r\n/*[Event(name = \"complete\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * 播放到某标签后调度。\r\n * @eventType Event.LABEL\r\n */\r\n/*[Event(name = \"label\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * <p>动画基类，提供了基础的动画播放控制方法和帧标签事件相关功能。</p>\r\n * <p>可以继承此类，但不要直接实例化此类，因为有些方法需要由子类实现。</p>\r\n */\r\nexport class AnimationBase extends Sprite {\r\n    /**动画播放顺序类型：正序播放。 */\r\n    static WRAP_POSITIVE: number = 0;\r\n    /**动画播放顺序类型：逆序播放。 */\r\n    static WRAP_REVERSE: number = 1;\r\n    /**动画播放顺序类型：pingpong播放(当按指定顺序播放完结尾后，如果继续播放，则会改变播放顺序)。 */\r\n    static WRAP_PINGPONG: number = 2;\r\n\r\n    /**是否循环播放，调用play(...)方法时，会将此值设置为指定的参数值。*/\r\n    loop: boolean;\r\n    /**播放顺序类型：AnimationBase.WRAP_POSITIVE为正序播放(默认值)，AnimationBase.WRAP_REVERSE为倒序播放，AnimationBase.WRAP_PINGPONG为pingpong播放(当按指定顺序播放完结尾后，如果继续播发，则会改变播放顺序)。*/\r\n    wrapMode: number = 0;\r\n    /**@private 播放间隔(单位：毫秒)。*/\r\n    protected _interval: number = Config.animationInterval;\r\n    /**@private */\r\n    protected _index: number;\r\n    /**@private */\r\n    protected _count: number;\r\n    /**@private */\r\n    protected _isPlaying: boolean;\r\n    /**@private */\r\n    protected _labels: any;\r\n    /**是否是逆序播放*/\r\n    protected _isReverse: boolean = false;\r\n    /**@private */\r\n    protected _frameRateChanged: boolean = false;\r\n    /**@private */\r\n    protected _actionName: string;\r\n    /**@private */\r\n    private _controlNode: Sprite;\r\n\r\n    /**\r\n     * 可以继承此类，但不要直接实例化此类，因为有些方法需要由子类实现。\r\n     */\r\n    constructor() {\r\n        super();\r\n        this._setBitUp(Const.DISPLAY);\r\n    }\r\n\r\n    /**\r\n     * <p>开始播放动画。play(...)方法被设计为在创建实例后的任何时候都可以被调用，当相应的资源加载完毕、调用动画帧填充方法(set frames)或者将实例显示在舞台上时，会判断是否正在播放中，如果是，则进行播放。</p>\r\n     * <p>配合wrapMode属性，可设置动画播放顺序类型。</p>\r\n     * @param\tstart\t（可选）指定动画播放开始的索引(int)或帧标签(String)。帧标签可以通过addLabel(...)和removeLabel(...)进行添加和删除。\r\n     * @param\tloop\t（可选）是否循环播放。\r\n     * @param\tname\t（可选）动画名称。\r\n     */\r\n    play(start: any = 0, loop: boolean = true, name: string = \"\"): void {\r\n        this._isPlaying = true;\r\n        this._actionName = name;\r\n        this.index = (typeof (start) == 'string') ? this._getFrameByLabel(<string>start) : start;\r\n        this.loop = loop;\r\n        this._isReverse = this.wrapMode === AnimationBase.WRAP_REVERSE;\r\n        if (this.index == 0 && this._isReverse) {\r\n            this.index = this.count - 1;\r\n        }\r\n        if (this.interval > 0) this.timerLoop(this.interval, this, this._frameLoop, null, true, true);\r\n    }\r\n\r\n    /**\r\n     * <p>动画播放的帧间隔时间(单位：毫秒)。默认值依赖于Config.animationInterval=50，通过Config.animationInterval可以修改默认帧间隔时间。</p>\r\n     * <p>要想为某动画设置独立的帧间隔时间，可以使用set interval，注意：如果动画正在播放，设置后会重置帧循环定时器的起始时间为当前时间，也就是说，如果频繁设置interval，会导致动画帧更新的时间间隔会比预想的要慢，甚至不更新。</p>\r\n     */\r\n    get interval(): number {\r\n        return this._interval;\r\n    }\r\n\r\n    set interval(value: number) {\r\n        if (this._interval != value) {\r\n            this._frameRateChanged = true;\r\n            this._interval = value;\r\n            if (this._isPlaying && value > 0) {\r\n                this.timerLoop(value, this, this._frameLoop, null, true, true);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    protected _getFrameByLabel(label: string): number {\r\n        for (var i: number = 0; i < this._count; i++) {\r\n            var item: any = this._labels[i];\r\n            if (item && ((<any[]>item)).indexOf(label) > -1) return i;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    /**@private */\r\n    protected _frameLoop(): void {\r\n        if (this._isReverse) {\r\n            this._index--;\r\n            if (this._index < 0) {\r\n                if (this.loop) {\r\n                    if (this.wrapMode == AnimationBase.WRAP_PINGPONG) {\r\n                        this._index = this._count > 0 ? 1 : 0;\r\n                        this._isReverse = false;\r\n                    } else {\r\n                        this._index = this._count - 1;\r\n                    }\r\n                    this.event(Event.COMPLETE);\r\n                } else {\r\n                    this._index = 0;\r\n                    this.stop();\r\n                    this.event(Event.COMPLETE);\r\n                    return;\r\n                }\r\n            }\r\n        } else {\r\n            this._index++;\r\n            if (this._index >= this._count) {\r\n                if (this.loop) {\r\n                    if (this.wrapMode == AnimationBase.WRAP_PINGPONG) {\r\n                        this._index = this._count - 2 >= 0 ? this._count - 2 : 0;\r\n                        this._isReverse = true;\r\n                    } else {\r\n                        this._index = 0;\r\n                    }\r\n                    this.event(Event.COMPLETE);\r\n                } else {\r\n                    this._index--;\r\n                    this.stop();\r\n                    this.event(Event.COMPLETE);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        this.index = this._index;\r\n    }\r\n\r\n    /**@internal */\r\n    _setControlNode(node: Sprite): void {\r\n        if (this._controlNode) {\r\n            this._controlNode.off(Event.DISPLAY, this, this._resumePlay);\r\n            this._controlNode.off(Event.UNDISPLAY, this, this._resumePlay);\r\n        }\r\n        this._controlNode = node;\r\n        if (node && node != this) {\r\n            node.on(Event.DISPLAY, this, this._resumePlay);\r\n            node.on(Event.UNDISPLAY, this, this._resumePlay);\r\n        }\r\n    }\r\n\r\n    /**@internal \r\n     * @override\r\n    */\r\n    _setDisplay(value: boolean): void {\r\n        super._setDisplay(value);\r\n        this._resumePlay();\r\n    }\r\n\r\n    /**@private */\r\n    protected _resumePlay(): void {\r\n        if (this._isPlaying) {\r\n            if (this._controlNode.displayedInStage) this.play(this._index, this.loop, this._actionName);\r\n            else this.clearTimer(this, this._frameLoop);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 停止动画播放。\r\n     */\r\n    stop(): void {\r\n        this._isPlaying = false;\r\n        this.clearTimer(this, this._frameLoop);\r\n    }\r\n\r\n    /**\r\n     * 是否正在播放中。\r\n     */\r\n    get isPlaying(): boolean {\r\n        return this._isPlaying;\r\n    }\r\n\r\n    /**\r\n     * 增加一个帧标签到指定索引的帧上。当动画播放到此索引的帧时会派发Event.LABEL事件，派发事件是在完成当前帧画面更新之后。\r\n     * @param\tlabel\t帧标签名称\r\n     * @param\tindex\t帧索引\r\n     */\r\n    addLabel(label: string, index: number): void {\r\n        if (!this._labels) this._labels = {};\r\n        if (!this._labels[index]) this._labels[index] = [];\r\n        this._labels[index].push(label);\r\n    }\r\n\r\n    /**\r\n     * 删除指定的帧标签。\r\n     * @param\tlabel 帧标签名称。注意：如果为空，则删除所有帧标签！\r\n     */\r\n    removeLabel(label: string): void {\r\n        if (!label) this._labels = null;\r\n        else if (this._labels) {\r\n            for (var name in this._labels) {\r\n                this._removeLabelFromList(this._labels[name], label);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    private _removeLabelFromList(list: any[], label: string): void {\r\n        if (!list) return;\r\n        for (var i: number = list.length - 1; i >= 0; i--) {\r\n            if (list[i] == label) {\r\n                list.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 将动画切换到指定帧并停在那里。\r\n     * @param\tposition 帧索引或帧标签\r\n     */\r\n    gotoAndStop(position: any): void {\r\n        this.index = (typeof (position) == 'string') ? this._getFrameByLabel(<string>position) : position;\r\n        this.stop();\r\n    }\r\n\r\n    /**\r\n     * 动画当前帧的索引。\r\n     */\r\n    get index(): number {\r\n        return this._index;\r\n    }\r\n\r\n    set index(value: number) {\r\n        this._index = value;\r\n        this._displayToIndex(value);\r\n        if (this._labels && this._labels[value]) {\r\n            var tArr: any[] = this._labels[value];\r\n            for (var i: number = 0, len: number = tArr.length; i < len; i++) {\r\n                this.event(Event.LABEL, tArr[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 显示到某帧\r\n     * @param value 帧索引\r\n     */\r\n    protected _displayToIndex(value: number): void {\r\n    }\r\n\r\n    /**\r\n     * 当前动画中帧的总数。\r\n     */\r\n    get count(): number {\r\n        return this._count;\r\n    }\r\n\r\n    /**\r\n     * 停止动画播放，并清理对象属性。之后可存入对象池，方便对象复用。\r\n     * @return 返回对象本身\r\n     */\r\n    clear(): AnimationBase {\r\n        this.stop();\r\n        this._labels = null;\r\n        return this;\r\n    }\r\n}\r\n\r\n\r\nClassUtils.regClass(\"laya.display.AnimationBase\", AnimationBase);\r\nClassUtils.regClass(\"Laya.AnimationBase\", AnimationBase);","/**\r\n\t * @private\r\n\t * <code>MathUtil</code> 是一个数据处理工具类。\r\n\t */\r\nexport class MathUtil {\r\n\r\n    static subtractVector3(l: Float32Array, r: Float32Array, o: Float32Array): void {\r\n        o[0] = l[0] - r[0];\r\n        o[1] = l[1] - r[1];\r\n        o[2] = l[2] - r[2];\r\n    }\r\n\r\n    static lerp(left: number, right: number, amount: number): number {\r\n        return left * (1 - amount) + right * amount;\r\n    }\r\n\r\n    static scaleVector3(f: Float32Array, b: number, e: Float32Array): void {\r\n        e[0] = f[0] * b;\r\n        e[1] = f[1] * b;\r\n        e[2] = f[2] * b;\r\n    }\r\n\r\n    static lerpVector3(l: Float32Array, r: Float32Array, t: number, o: Float32Array): void {\r\n        var ax: number = l[0], ay: number = l[1], az: number = l[2];\r\n        o[0] = ax + t * (r[0] - ax);\r\n        o[1] = ay + t * (r[1] - ay);\r\n        o[2] = az + t * (r[2] - az);\r\n    }\r\n\r\n    static lerpVector4(l: Float32Array, r: Float32Array, t: number, o: Float32Array): void {\r\n        var ax: number = l[0], ay: number = l[1], az: number = l[2], aw: number = l[3];\r\n        o[0] = ax + t * (r[0] - ax);\r\n        o[1] = ay + t * (r[1] - ay);\r\n        o[2] = az + t * (r[2] - az);\r\n        o[3] = aw + t * (r[3] - aw);\r\n    }\r\n\r\n    static slerpQuaternionArray(a: Float32Array, Offset1: number, b: Float32Array, Offset2: number, t: number, out: Float32Array, Offset3: number): Float32Array {\r\n\r\n        var ax: number = a[Offset1 + 0], ay: number = a[Offset1 + 1], az: number = a[Offset1 + 2], aw: number = a[Offset1 + 3], bx: number = b[Offset2 + 0], by: number = b[Offset2 + 1], bz: number = b[Offset2 + 2], bw: number = b[Offset2 + 3];\r\n\r\n        var omega: number, cosom: number, sinom: number, scale0: number, scale1: number;\r\n\r\n        // calc cosine \r\n        cosom = ax * bx + ay * by + az * bz + aw * bw;\r\n        // adjust signs (if necessary) \r\n        if (cosom < 0.0) {\r\n            cosom = -cosom;\r\n            bx = -bx;\r\n            by = -by;\r\n            bz = -bz;\r\n            bw = -bw;\r\n        }\r\n        // calculate coefficients \r\n        if ((1.0 - cosom) > 0.000001) {\r\n            // standard case (slerp) \r\n            omega = Math.acos(cosom);\r\n            sinom = Math.sin(omega);\r\n            scale0 = Math.sin((1.0 - t) * omega) / sinom;\r\n            scale1 = Math.sin(t * omega) / sinom;\r\n        } else {\r\n            // \"from\" and \"to\" quaternions are very close  \r\n            //  ... so we can do a linear interpolation \r\n            scale0 = 1.0 - t;\r\n            scale1 = t;\r\n        }\r\n        // calculate final values \r\n        out[Offset3 + 0] = scale0 * ax + scale1 * bx;\r\n        out[Offset3 + 1] = scale0 * ay + scale1 * by;\r\n        out[Offset3 + 2] = scale0 * az + scale1 * bz;\r\n        out[Offset3 + 3] = scale0 * aw + scale1 * bw;\r\n\r\n        return out;\r\n\r\n    }\r\n\r\n    /**\r\n     * 获取指定的两个点组成的线段的角度值。\r\n     * @param\tx0 点一的 X 轴坐标值。\r\n     * @param\ty0 点一的 Y 轴坐标值。\r\n     * @param\tx1 点二的 X 轴坐标值。\r\n     * @param\ty1 点二的 Y 轴坐标值。\r\n     * @return 角度值。\r\n     */\r\n    static getRotation(x0: number, y0: number, x1: number, y1: number): number {\r\n        return Math.atan2(y1 - y0, x1 - x0) / Math.PI * 180;\r\n    }\r\n\r\n    /**\r\n     * 一个用来确定数组元素排序顺序的比较函数。\r\n     * @param\ta 待比较数字。\r\n     * @param\tb 待比较数字。\r\n     * @return 如果a等于b 则值为0；如果b>a则值为1；如果b<则值为-1。\r\n     */\r\n    static sortBigFirst(a: number, b: number): number {\r\n        if (a == b) return 0;\r\n        return b > a ? 1 : -1;\r\n    }\r\n\r\n    /**\r\n     * 一个用来确定数组元素排序顺序的比较函数。\r\n     * @param\ta 待比较数字。\r\n     * @param\tb 待比较数字。\r\n     * @return 如果a等于b 则值为0；如果b>a则值为-1；如果b<则值为1。\r\n     */\r\n    static sortSmallFirst(a: number, b: number): number {\r\n        if (a == b) return 0;\r\n        return b > a ? -1 : 1;\r\n    }\r\n\r\n    /**\r\n     * 将指定的元素转为数字进行比较。\r\n     * @param\ta 待比较元素。\r\n     * @param\tb 待比较元素。\r\n     * @return b、a转化成数字的差值 (b-a)。\r\n     */\r\n    static sortNumBigFirst(a: any, b: any): number {\r\n        return parseFloat(b) - parseFloat(a);\r\n    }\r\n\r\n    /**\r\n     * 将指定的元素转为数字进行比较。\r\n     * @param\ta 待比较元素。\r\n     * @param\tb 待比较元素。\r\n     * @return a、b转化成数字的差值 (a-b)。\r\n     */\r\n    static sortNumSmallFirst(a: any, b: any): number {\r\n        return parseFloat(a) - parseFloat(b);\r\n    }\r\n\r\n    /**\r\n     * 返回根据对象指定的属性进行排序的比较函数。\r\n     * @param\tkey 排序要依据的元素属性名。\r\n     * @param\tbigFirst 如果值为true，则按照由大到小的顺序进行排序，否则按照由小到大的顺序进行排序。\r\n     * @param\tforceNum 如果值为true，则将排序的元素转为数字进行比较。\r\n     * @return 排序函数。\r\n     */\r\n    static sortByKey(key: string, bigFirst: boolean = false, forceNum: boolean = true): (a: any, b: any) => number {\r\n        var _sortFun: Function;\r\n        if (bigFirst) {\r\n            _sortFun = forceNum ? MathUtil.sortNumBigFirst : MathUtil.sortBigFirst;\r\n        } else {\r\n            _sortFun = forceNum ? MathUtil.sortNumSmallFirst : MathUtil.sortSmallFirst;\r\n        }\r\n        return function (a: any, b: any): number {\r\n            return _sortFun(a[key], b[key]);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n","import { AnimationBase } from \"./AnimationBase\";\r\nimport { MathUtil } from \"../maths/MathUtil\"\r\nimport { Ease } from \"../utils/Ease\"\r\nimport { ClassUtils } from \"../utils/ClassUtils\";\r\n\r\n/**\r\n * 动画播放完毕后调度。\r\n * @eventType Event.COMPLETE\r\n */\r\n/*[Event(name = \"complete\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * 播放到某标签后调度。\r\n * @eventType Event.LABEL\r\n */\r\n/*[Event(name = \"label\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 节点关键帧动画播放类。解析播放IDE内制作的节点动画。\r\n */\r\nexport class FrameAnimation extends AnimationBase {\r\n\r\n    /**@private */\r\n    private static _sortIndexFun(objpre: any, objnext: any) {\r\n        return objpre.index - objnext.index\r\n    }\r\n\r\n    /**@internal id对象表*/\r\n    _targetDic: any;\r\n    /**@internal 动画数据*/\r\n    _animationData: any;\r\n    /**@private */\r\n    protected _usedFrames: any[];\r\n\r\n    constructor() {\r\n        super();\r\n        if (FrameAnimation._sortIndexFun === undefined) {\r\n            FrameAnimation._sortIndexFun = MathUtil.sortByKey(\"index\", false, true);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 初始化动画数据\r\n     * @param targetDic 节点ID索引\r\n     * @param animationData 动画数据\r\n     */\r\n    _setUp(targetDic: any, animationData: any): void {\r\n        this._targetDic = targetDic;\r\n        this._animationData = animationData;\r\n        this.interval = 1000 / animationData.frameRate;\r\n        if (animationData.parsed) {\r\n            this._count = animationData.count;\r\n            this._labels = animationData.labels;\r\n            this._usedFrames = animationData.animationNewFrames;\r\n        } else {\r\n            this._usedFrames = [];\r\n            this._calculateDatas();\r\n\r\n            animationData.parsed = true;\r\n            animationData.labels = this._labels;\r\n            animationData.count = this._count;\r\n            animationData.animationNewFrames = this._usedFrames;\r\n        }\r\n    }\r\n\r\n    /**@inheritDoc \r\n     * @override\r\n    */\r\n    clear(): AnimationBase {\r\n        super.clear();\r\n        this._targetDic = null;\r\n        this._animationData = null;\r\n        return this;\r\n    }\r\n\r\n    /**@inheritDoc \r\n     * @override\r\n    */\r\n    protected _displayToIndex(value: number): void {\r\n        if (!this._animationData) return;\r\n        if (value < 0) value = 0;\r\n        if (value > this._count) value = this._count;\r\n        var nodes: any[] = this._animationData.nodes, i: number, len: number = nodes.length;\r\n        for (i = 0; i < len; i++) {\r\n            this._displayNodeToFrame(nodes[i], value);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 将节点设置到某一帧的状态\r\n     * @param node 节点ID\r\n     * @param frame\r\n     * @param targetDic 节点表\r\n     */\r\n    protected _displayNodeToFrame(node: any, frame: number, targetDic: any = null): void {\r\n        if (!targetDic) targetDic = this._targetDic;\r\n        var target: any = targetDic[node.target];\r\n        if (!target) {\r\n            //trace(\"loseTarget:\",node.target);\r\n            return;\r\n        }\r\n        var frames: any = node.frames, key: string, propFrames: any[], value: any;\r\n        var keys: any[] = node.keys, i: number, len: number = keys.length;\r\n        for (i = 0; i < len; i++) {\r\n            key = keys[i];\r\n            propFrames = frames[key];\r\n            if (propFrames.length > frame) {\r\n                value = propFrames[frame];\r\n            } else {\r\n                value = propFrames[propFrames.length - 1];\r\n            }\r\n            target[key] = value;\r\n        }\r\n        var funkeys: any[] = node.funkeys;\r\n        len = funkeys.length;\r\n        var funFrames: any;\r\n        if (len == 0) return;\r\n        for (i = 0; i < len; i++) {\r\n            key = funkeys[i];\r\n            funFrames = frames[key];\r\n            if (funFrames[frame] !== undefined) {\r\n                target[key] && target[key].apply(target, funFrames[frame]);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 计算帧数据\r\n     */\r\n    private _calculateDatas(): void {\r\n        if (!this._animationData) return;\r\n        var nodes: any[] = this._animationData.nodes, i: number, len: number = nodes.length, tNode: any;\r\n        this._count = 0;\r\n        for (i = 0; i < len; i++) {\r\n            tNode = nodes[i];\r\n            this._calculateKeyFrames(tNode);\r\n        }\r\n        this._count += 1;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 计算某个节点的帧数据\r\n     */\r\n    protected _calculateKeyFrames(node: any): void {\r\n        var keyFrames: any = node.keyframes, key: string, tKeyFrames: any[], target: number = node.target;\r\n        if (!node.frames) node.frames = {};\r\n        if (!node.keys) node.keys = [];\r\n        else node.keys.length = 0;\r\n\r\n        if (!node.funkeys) node.funkeys = [];\r\n        else node.funkeys.length = 0;\r\n\r\n        if (!node.initValues) node.initValues = {};\r\n        for (key in keyFrames) {\r\n            var isFun: boolean = key.indexOf(\"()\") != -1;\r\n            tKeyFrames = keyFrames[key];\r\n            if (isFun) key = key.substr(0, key.length - 2);\r\n            if (!node.frames[key]) {\r\n                node.frames[key] = [];\r\n            }\r\n            if (!isFun) {\r\n                if (this._targetDic && this._targetDic[target]) {\r\n                    node.initValues[key] = this._targetDic[target][key];\r\n                }\r\n\r\n                tKeyFrames.sort(FrameAnimation._sortIndexFun);\r\n                node.keys.push(key);\r\n                this._calculateNodePropFrames(tKeyFrames, node.frames[key], key, target);\r\n            }\r\n            else {\r\n                node.funkeys.push(key);\r\n                var map: any[] = node.frames[key];\r\n                for (var i: number = 0; i < tKeyFrames.length; i++) {\r\n                    var temp: any = tKeyFrames[i];\r\n                    map[temp.index] = temp.value;\r\n                    if (temp.index > this._count) this._count = temp.index;\r\n                }\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 重置节点，使节点恢复到动画之前的状态，方便其他动画控制\r\n     */\r\n    resetNodes(): void {\r\n        if (!this._targetDic) return;\r\n        if (!this._animationData) return;\r\n        var nodes: any[] = this._animationData.nodes, i: number, len: number = nodes.length;\r\n        var tNode: any;\r\n        var initValues: any;\r\n        for (i = 0; i < len; i++) {\r\n            tNode = nodes[i];\r\n            initValues = tNode.initValues;\r\n            if (!initValues) continue;\r\n            var target: any = this._targetDic[tNode.target];\r\n            if (!target) continue;\r\n            var key: string;\r\n            for (key in initValues) {\r\n                target[key] = initValues[key];\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 计算节点某个属性的帧数据\r\n     */\r\n    private _calculateNodePropFrames(keyframes: any[], frames: any[], key: string, target: number): void {\r\n        var i: number, len: number = keyframes.length - 1;\r\n        frames.length = keyframes[len].index + 1;\r\n        for (i = 0; i < len; i++) {\r\n            this._dealKeyFrame(keyframes[i]);\r\n            this._calculateFrameValues(keyframes[i], keyframes[i + 1], frames);\r\n        }\r\n        if (len == 0) {\r\n            frames[0] = keyframes[0].value;\r\n            if (this._usedFrames) this._usedFrames[keyframes[0].index] = true;\r\n        }\r\n        this._dealKeyFrame(keyframes[i]);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private _dealKeyFrame(keyFrame: any): void {\r\n        if (keyFrame.label && keyFrame.label != \"\") this.addLabel(keyFrame.label, keyFrame.index);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 计算两个关键帧直接的帧数据\r\n     */\r\n    private _calculateFrameValues(startFrame: any, endFrame: any, result: any[]): void {\r\n        var i: number, easeFun: Function;\r\n        var start: number = startFrame.index, end: number = endFrame.index;\r\n        var startValue: number = startFrame.value;\r\n        var dValue: number = endFrame.value - startFrame.value;\r\n        var dLen: number = end - start;\r\n        var frames: any[] = this._usedFrames;\r\n        if (end > this._count) this._count = end;\r\n        if (startFrame.tween) {\r\n            easeFun = Ease[startFrame.tweenMethod];\r\n            if (easeFun == null) easeFun = Ease.linearNone;\r\n            for (i = start; i < end; i++) {\r\n                result[i] = easeFun(i - start, startValue, dValue, dLen);\r\n                if (frames) frames[i] = true;\r\n            }\r\n        } else {\r\n            for (i = start; i < end; i++) {\r\n                result[i] = startValue;\r\n            }\r\n        }\r\n        if (frames) {\r\n            frames[startFrame.index] = true;\r\n            frames[endFrame.index] = true;\r\n        }\r\n        result[endFrame.index] = endFrame.value;\r\n    }\r\n}\r\n\r\n\r\nClassUtils.regClass(\"laya.display.FrameAnimation\", FrameAnimation);\r\nClassUtils.regClass(\"Laya.FrameAnimation\", FrameAnimation);","import { Utils } from \"./Utils\";\r\nimport { ILaya } from \"../../ILaya\";\r\n\r\n/**\r\n\t * 封装弱引用WeakMap\r\n\t * 如果支持WeakMap，则使用WeakMap，如果不支持，则用Object代替\r\n\t * 注意：如果采用Object，为了防止内存泄漏，则采用定时清理缓存策略\r\n\t * \r\n\t * 这里的设计是错误的，为了兼容，先不删掉这个类，直接采用Object\r\n\t */\r\nexport class WeakObject {\r\n    /**是否支持WeakMap*/\r\n    static supportWeakMap = false;\r\n    /**如果不支持WeakMap，则多少时间清理一次缓存，默认10分钟清理一次*/\r\n    static delInterval = 10 * 60 * 1000;\r\n    /**全局WeakObject单例*/\r\n    static I: WeakObject;\r\n    /**@private */\r\n    private static _maps: any[] = [];\r\n    /**@internal */\r\n    _obj: any;\r\n\r\n    /**@internal */\r\n    static __init__(): void {\r\n        WeakObject.I = new WeakObject();\r\n        //WeakObject.supportWeakMap = Browser.window.WeakMap != null;\r\n        //如果不支持，10分钟回收一次\r\n        if (!WeakObject.supportWeakMap) ILaya.systemTimer.loop(WeakObject.delInterval, null, WeakObject.clearCache);\r\n    }\r\n\r\n    /**清理缓存，回收内存*/\r\n    static clearCache(): void {\r\n        for (var i = 0, n = WeakObject._maps.length; i < n; i++) {\r\n            var obj = WeakObject._maps[i];\r\n            obj._obj = {};\r\n        }\r\n    }\r\n\r\n    constructor() {\r\n        this._obj = {};\r\n        WeakObject._maps.push(this);\r\n    }\r\n\r\n\t/**\r\n\t * 设置缓存\r\n\t * @param\tkey kye对象，可被回收\r\n\t * @param\tvalue object对象，可被回收\r\n\t */\r\n    set(key: any, value: any): void {\r\n        if (key == null) return;\r\n        if (WeakObject.supportWeakMap) {\r\n        } else {\r\n            if (typeof (key) == 'string' || typeof (key) == 'number') {\r\n                this._obj[key as any] = value;\r\n            } else {\r\n                key.$_GID || (key.$_GID = Utils.getGID());\r\n                this._obj[key.$_GID] = value;\r\n            }\r\n        }\r\n    }\r\n\r\n\t/**\r\n\t * 获取缓存\r\n\t * @param\tkey kye对象，可被回收\r\n\t */\r\n    get(key: any): any {\r\n        if (key == null) return null;\r\n        if (WeakObject.supportWeakMap) {\r\n        } else {\r\n            if (typeof (key) == 'string' || typeof (key) == 'number') return this._obj[key as any];\r\n            return this._obj[key.$_GID];\r\n        }\r\n    }\r\n\r\n\t/**\r\n\t * 删除缓存\r\n\t */\r\n    del(key: any): void {\r\n        if (key == null) return;\r\n        if (WeakObject.supportWeakMap) {\r\n        } else {\r\n            if (typeof (key) == 'string' || typeof (key) == 'number') delete this._obj[key as any];\r\n            else delete this._obj[this._obj.$_GID];\r\n        }\r\n    }\r\n\r\n\t/**\r\n\t * 是否有缓存\r\n\t */\r\n    has(key: any): boolean {\r\n        if (key == null) return false;\r\n        if (WeakObject.supportWeakMap) {\r\n        } else {\r\n            if (typeof (key) == 'string' || typeof (key) == 'number') return this._obj[key as any] != null;\r\n            return this._obj[this._obj.$_GID] != null;\r\n        }\r\n    }\r\n}\r\n\r\n//WeakObject.__init__();","import { Pool } from \"./Pool\";\r\nimport { Const } from \"../Const\"\r\nimport { Component } from \"../components/Component\"\r\nimport { FrameAnimation } from \"../display/FrameAnimation\"\r\nimport { Node } from \"../display/Node\"\r\n//import { ClassUtils } from \"./ClassUtils\"\r\nimport { WeakObject } from './WeakObject'\r\n/**\r\n * @private 场景辅助类\r\n */\r\nexport class SceneUtils {\r\n    /**@private */\r\n    private static _funMap: WeakObject;\r\n    /**@private */\r\n    private static _parseWatchData: RegExp = /\\${(.*?)}/g;\r\n    /**@private */\r\n    private static _parseKeyWord: RegExp = /[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g;\r\n    /**@internal */\r\n    static _sheet: any;\r\n\r\n\r\n    static __init(): void {\r\n        SceneUtils._funMap = new WeakObject();\r\n    }\r\n\r\n    /**\r\n     * @private 根据字符串，返回函数表达式\r\n     */\r\n    //TODO:coverage\r\n    static getBindFun(value: string): Function {\r\n        var fun: Function = SceneUtils._funMap.get(value);\r\n        if (fun == null) {\r\n            var temp: string = \"\\\"\" + value + \"\\\"\";\r\n            temp = temp.replace(/^\"\\${|}\"$/g, \"\").replace(/\\${/g, \"\\\"+\").replace(/}/g, \"+\\\"\");\r\n            var str: string = \"(function(data){if(data==null)return;with(data){try{\\nreturn \" + temp + \"\\n}catch(e){}}})\";\r\n            fun = (window as any).Laya._runScript(str);\r\n            SceneUtils._funMap.set(value, fun);\r\n        }\r\n        return fun;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 通过视图数据创建视图。\r\n     * @param uiView 视图数据信息。\r\n     */\r\n    //TODO:coverage\r\n    static createByData(root: any, uiView: any): any {\r\n        var tInitTool: InitTool = InitTool.create();\r\n\r\n        //递归创建节点\r\n        root = SceneUtils.createComp(uiView, root, root, null, tInitTool);\r\n        root._setBit(Const.NOT_READY, true);\r\n        if (\"_idMap\" in root) {\r\n            root[\"_idMap\"] = tInitTool._idMap;\r\n        }\r\n\r\n        //处理动画信息\r\n        if (uiView.animations) {\r\n            var anilist: any[] = [];\r\n            var animations: any[] = uiView.animations;\r\n            var i: number, len: number = animations.length;\r\n            var tAni: FrameAnimation;\r\n            var tAniO: any;\r\n            for (i = 0; i < len; i++) {\r\n                tAni = new FrameAnimation();\r\n                tAniO = animations[i];\r\n                tAni._setUp(tInitTool._idMap, tAniO);\r\n                root[tAniO.name] = tAni;\r\n                tAni._setControlNode(root);\r\n                switch (tAniO.action) {\r\n                    case 1:\r\n                        tAni.play(0, false);\r\n                        break;\r\n                    case 2:\r\n                        tAni.play(0, true);\r\n                        break;\r\n                }\r\n                anilist.push(tAni);\r\n            }\r\n            root._aniList = anilist;\r\n        }\r\n\r\n        //设置页面穿透\r\n        if (root._$componentType === \"Scene\" && root._width > 0 && uiView.props.hitTestPrior == null && !root.mouseThrough)\r\n            root.hitTestPrior = true;\r\n\r\n        //设置组件\r\n        tInitTool.beginLoad(root);\r\n        return root;\r\n    }\r\n\r\n\r\n    static createInitTool(): InitTool {\r\n        return InitTool.create();\r\n    }\r\n\r\n    /**\r\n     * 根据UI数据实例化组件。\r\n     * @param uiView UI数据。\r\n     * @param comp 组件本体，如果为空，会新创建一个。\r\n     * @param view 组件所在的视图实例，用来注册var全局变量，如果值为空则不注册。\r\n     * @return 一个 Component 对象。\r\n     */\r\n    static createComp(uiView: any, comp: any = null, view: any = null, dataMap: any[] = null, initTool: InitTool = null): any {\r\n        if (uiView.type == \"Scene3D\" || uiView.type == \"Sprite3D\") {\r\n            var outBatchSprits: any[] = [];\r\n            var scene3D: any = ILaya.Laya[\"Utils3D\"]._createSceneByJsonForMaker(uiView, outBatchSprits, initTool);\r\n            if (uiView.type == \"Sprite3D\")\r\n                ILaya.Laya[\"StaticBatchManager\"].combine(scene3D, outBatchSprits);\r\n            else\r\n                ILaya.Laya[\"StaticBatchManager\"].combine(null, outBatchSprits);\r\n            return scene3D;\r\n        }\r\n\r\n        comp = comp || SceneUtils.getCompInstance(uiView);\r\n        if (!comp) {\r\n            if (uiView.props && uiView.props.runtime)\r\n                console.warn(\"runtime not found:\" + uiView.props.runtime);\r\n            else\r\n                console.warn(\"can not create:\" + uiView.type);\r\n            return null;\r\n        }\r\n\r\n        var child: any[] = uiView.child;\r\n        if (child) {\r\n            var isList: boolean = comp[\"_$componentType\"] == \"List\";\r\n            for (var i: number = 0, n: number = child.length; i < n; i++) {\r\n                var node: any = child[i];\r\n                if ('itemRender' in comp && (node.props.name == \"render\" || node.props.renderType === \"render\")) {\r\n                    //如果list的itemRender\r\n                    comp[\"itemRender\"] = node;\r\n                } else if (node.type == \"Graphic\") {\r\n                    //绘制矢量图\r\n                    ILaya.ClassUtils._addGraphicsToSprite(node, comp);\r\n                } else if (ILaya.ClassUtils._isDrawType(node.type)) {\r\n                    ILaya.ClassUtils._addGraphicToSprite(node, comp, true);\r\n                } else {\r\n                    if (isList) {\r\n                        //收集数据绑定信息\r\n                        var arr: any[] = [];\r\n                        var tChild: any = SceneUtils.createComp(node, null, view, arr, initTool);\r\n                        if (arr.length)\r\n                            tChild[\"_$bindData\"] = arr;\r\n                    } else {\r\n                        tChild = SceneUtils.createComp(node, null, view, dataMap, initTool);\r\n                    }\r\n\r\n                    //处理脚本\r\n                    if (node.type == \"Script\") {\r\n                        if (tChild instanceof Component) {\r\n                            comp._addComponentInstance(tChild);\r\n                        } else {\r\n                            //兼容老版本\r\n                            if (\"owner\" in tChild) {\r\n                                tChild[\"owner\"] = comp;\r\n                            } else if (\"target\" in tChild) {\r\n                                tChild[\"target\"] = comp;\r\n                            }\r\n                        }\r\n                    } else if (node.props.renderType == \"mask\" || node.props.name == \"mask\") {\r\n                        comp.mask = tChild;\r\n                    } else {\r\n                        tChild instanceof Node && comp.addChild(tChild);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        var props: any = uiView.props;\r\n        for (var prop in props) {\r\n            var value: any = props[prop];\r\n            if (typeof (value) == 'string' && (value.indexOf(\"@node:\") >= 0 || value.indexOf(\"@Prefab:\") >= 0)) {\r\n                if (initTool) {\r\n                    initTool.addNodeRef(comp, prop, <string>value);\r\n                }\r\n            } else\r\n                SceneUtils.setCompValue(comp, prop, value, view, dataMap);\r\n        }\r\n\r\n        if (comp._afterInited) {\r\n            //if (initTool) {\r\n            //initTool.addInitItem(comp);\r\n            //} else {\r\n            comp._afterInited();\r\n            //}\r\n        }\r\n\r\n        if (uiView.compId && initTool && initTool._idMap) {\r\n            initTool._idMap[uiView.compId] = comp;\r\n        }\r\n\r\n        return comp;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 设置组件的属性值。\r\n     * @param comp 组件实例。\r\n     * @param prop 属性名称。\r\n     * @param value 属性值。\r\n     * @param view 组件所在的视图实例，用来注册var全局变量，如果值为空则不注册。\r\n     */\r\n    private static setCompValue(comp: any, prop: string, value: any, view: any = null, dataMap: any[] = null): void {\r\n        //处理数据绑定\r\n        if (typeof (value) == 'string' && value.indexOf(\"${\") > -1) {\r\n            SceneUtils._sheet || (SceneUtils._sheet = ILaya.ClassUtils.getClass(\"laya.data.Table\"));\r\n            if (!SceneUtils._sheet) {\r\n                console.warn(\"Can not find class Sheet\");\r\n                return;\r\n            }\r\n            //list的item处理\r\n            if (dataMap) {\r\n                dataMap.push(comp, prop, value);\r\n            } else if (view) {\r\n                if (value.indexOf(\"].\") == -1) {\r\n                    //TODO\r\n                    value = value.replace(\".\", \"[0].\");\r\n                }\r\n                var watcher: DataWatcher = new DataWatcher(comp, prop, value);\r\n\r\n                //执行第一次数据赋值\r\n                watcher.exe(view);\r\n                var one: any[], temp: any[];\r\n                var str: string = value.replace(/\\[.*?\\]\\./g, \".\");\r\n                while ((one = SceneUtils._parseWatchData.exec(str)) != null) {\r\n                    var key1: string = one[1];\r\n                    while ((temp = SceneUtils._parseKeyWord.exec(key1)) != null) {\r\n                        var key2: string = temp[0];\r\n                        var arr: any[] = (view._watchMap[key2] || (view._watchMap[key2] = []));\r\n                        arr.push(watcher);\r\n                        //监听数据变化\r\n                        SceneUtils._sheet.I.notifer.on(key2, view, view.changeData, [key2]);\r\n                    }\r\n                    //TODO\r\n                    arr = (view._watchMap[key1] || (view._watchMap[key1] = []));\r\n                    arr.push(watcher);\r\n                    SceneUtils._sheet.I.notifer.on(key1, view, view.changeData, [key1]);\r\n                }\r\n                //trace(view._watchMap);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (prop === \"var\" && view) {\r\n            view[value] = comp;\r\n        } else {\r\n            comp[prop] = (value === \"true\" ? true : (value === \"false\" ? false : value));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 通过组建UI数据，获取组件实例。\r\n     * @param json UI数据。\r\n     * @return Component 对象。\r\n     */\r\n    static getCompInstance(json: any): any {\r\n        if (json.type == \"UIView\") {\r\n            if (json.props && json.props.pageData) {\r\n                return SceneUtils.createByData(null, json.props.pageData);\r\n            }\r\n        }\r\n        var runtime: string = (json.props && json.props.runtime) || json.type;\r\n        var compClass: new () => any = ILaya.ClassUtils.getClass(runtime);\r\n        if (!compClass) throw \"Can not find class \" + runtime;\r\n        if (json.type === \"Script\" && compClass.prototype._doAwake) {\r\n            var comp: any = Pool.createByClass(compClass);\r\n            comp._destroyed = false;\r\n            return comp;\r\n        }\r\n        if (json.props && \"renderType\" in json.props && json.props[\"renderType\"] == \"instance\") {\r\n            if (!compClass[\"instance\"]) compClass[\"instance\"] = new compClass();\r\n            return compClass[\"instance\"];\r\n        }\r\n\r\n        return new compClass();\r\n    }\r\n}\r\n\r\n\r\n\r\nimport { Prefab } from \"../components/Prefab\"\r\nimport { Scene } from \"../display/Scene\"\r\nimport { Loader } from \"../net/Loader\"\r\nimport { Handler } from \"./Handler\"\r\nimport { LoaderManager } from \"../net/LoaderManager\";\r\nimport { ILaya } from \"../../ILaya\";\r\n\r\n/**\r\n * @private 场景辅助类\r\n */\r\nclass DataWatcher {\r\n    comp: any;\r\n    prop: string;\r\n    value: string;\r\n\r\n    //TODO:coverage\r\n    constructor(comp: any, prop: string, value: string) {\r\n        this.comp = comp;\r\n        this.prop = prop;\r\n        this.value = value;\r\n    }\r\n\r\n    exe(view: any): void {\r\n        var fun: Function = SceneUtils.getBindFun(this.value);\r\n        this.comp[this.prop] = fun.call(this, view);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * @private 场景辅助类\r\n */\r\nclass InitTool {\r\n    /**@private */\r\n    private _nodeRefList: any[];\r\n    /**@private */\r\n    private _initList: any[];\r\n    private _loadList: any[];\r\n    /**@internal */\r\n    _idMap: any[];\r\n    /**@internal */\r\n    _scene: Scene;\r\n\r\n    //TODO:coverage\r\n    reset(): void {\r\n        this._nodeRefList = null;\r\n        this._initList = null;\r\n        this._idMap = null;\r\n        this._loadList = null;\r\n        this._scene = null;\r\n    }\r\n\r\n    //TODO:coverage\r\n    recover(): void {\r\n        this.reset();\r\n        Pool.recover(\"InitTool\", this);\r\n    }\r\n\r\n    static create(): InitTool {\r\n        var tool: InitTool = Pool.getItemByClass(\"InitTool\", InitTool);\r\n        tool._idMap = [];\r\n        return tool;\r\n    }\r\n\r\n    //TODO:coverage\r\n    addLoadRes(url: string, type: string = null): void {\r\n        if (!this._loadList) this._loadList = [];\r\n        if (ILaya.loader.getRes(url)) {\r\n            return;\r\n        }\r\n        if (!type) {\r\n            this._loadList.push(url);\r\n        } else {\r\n            this._loadList.push({ url: url, type: type });\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    //TODO:coverage\r\n    addNodeRef(node: any, prop: string, referStr: string): void {\r\n        if (!this._nodeRefList) this._nodeRefList = [];\r\n        this._nodeRefList.push([node, prop, referStr]);\r\n        if (referStr.indexOf(\"@Prefab:\") >= 0) {\r\n            this.addLoadRes(referStr.replace(\"@Prefab:\", \"\"), Loader.PREFAB);\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    //TODO:coverage\r\n    setNodeRef(): void {\r\n        if (!this._nodeRefList) return;\r\n        if (!this._idMap) {\r\n            this._nodeRefList = null;\r\n            return;\r\n        }\r\n        var i: number, len: number;\r\n        len = this._nodeRefList.length;\r\n        var tRefInfo: any[];\r\n        for (i = 0; i < len; i++) {\r\n            tRefInfo = this._nodeRefList[i];\r\n            tRefInfo[0][tRefInfo[1]] = this.getReferData(tRefInfo[2]);\r\n        }\r\n        this._nodeRefList = null;\r\n    }\r\n\r\n    /**@private */\r\n    //TODO:coverage\r\n    getReferData(referStr: string): any {\r\n        if (referStr.indexOf(\"@Prefab:\") >= 0) {\r\n            var prefab: Prefab;\r\n            prefab = Loader.getRes(referStr.replace(\"@Prefab:\", \"\"));\r\n            return prefab;\r\n        } else if (referStr.indexOf(\"@arr:\") >= 0) {\r\n            referStr = referStr.replace(\"@arr:\", \"\");\r\n            var list: any[];\r\n            list = referStr.split(\",\");\r\n            var i: number, len: number;\r\n            var tStr: string;\r\n            len = list.length;\r\n            for (i = 0; i < len; i++) {\r\n                tStr = list[i];\r\n                if (tStr) {\r\n                    list[i] = this._idMap[tStr.replace(\"@node:\", \"\")];\r\n                } else {\r\n                    list[i] = null;\r\n                }\r\n            }\r\n            return list;\r\n        } else {\r\n            return this._idMap[referStr.replace(\"@node:\", \"\")];\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    //TODO:coverage\r\n    addInitItem(item: any): void {\r\n        if (!this._initList) this._initList = [];\r\n        this._initList.push(item);\r\n    }\r\n\r\n    /**@private */\r\n    //TODO:coverage\r\n    doInits(): void {\r\n        if (!this._initList) return;\r\n        this._initList = null;\r\n    }\r\n\r\n    /**@private */\r\n    //TODO:coverage\r\n    finish(): void {\r\n        this.setNodeRef();\r\n        this.doInits();\r\n        this._scene._setBit(Const.NOT_READY, false);\r\n        if (this._scene.parent && this._scene.parent.activeInHierarchy && this._scene.active) this._scene._processActive();\r\n        this._scene.event(\"onViewCreated\");\r\n        this.recover();\r\n    }\r\n\r\n    /**@private */\r\n    //TODO:coverage\r\n    beginLoad(scene: Scene): void {\r\n        this._scene = scene;\r\n        if (!this._loadList || this._loadList.length < 1) {\r\n            this.finish();\r\n        } else {\r\n            ILaya.loader.load(this._loadList, Handler.create(this, this.finish));\r\n        }\r\n    }\r\n}\r\n","/**\r\n\t * @author laya\r\n\t */\r\nexport class IStatRender {\r\n    /**\r\n     * 显示性能统计信息。\r\n     * @param\tx X轴显示位置。\r\n     * @param\ty Y轴显示位置。\r\n     */\r\n    show(x: number = 0, y: number = 0): void {\r\n    }\r\n\r\n    /**激活性能统计*/\r\n    enable(): void {\r\n    }\r\n\r\n    /**\r\n     * 隐藏性能统计信息。\r\n     */\r\n    hide(): void {\r\n    }\r\n\r\n    /**\r\n     * 点击性能统计显示区域的处理函数。\r\n     */\r\n    set_onclick(fn: Function): void {\r\n    }\r\n\r\n    isCanvasRender(): boolean {\r\n        return true;\r\n    }\r\n    // 非canvas模式的渲染\r\n    renderNotCanvas(ctx: any, x: number, y: number) { }\r\n\r\n}\r\n\r\n","import { IStatRender } from \"./IStatRender\";\r\nimport { Browser } from \"./Browser\";\r\n//import { Laya } from \"./../../Laya\";\r\nimport { Sprite } from \"../display/Sprite\"\r\nimport { Text } from \"../display/Text\"\r\nimport { Render } from \"../renders/Render\"\r\nimport { Context } from \"../resource/Context\"\r\nimport { HTMLCanvas } from \"../resource/HTMLCanvas\"\r\nimport { Resource } from \"../resource/Resource\"\r\nimport { Stat } from \"./Stat\";\r\nimport { ILaya } from \"../../ILaya\";\r\n/**\r\n * 显示Stat的结果。由于stat会引入很多的循环引用，所以把显示部分拆开\r\n * @author laya\r\n */\r\nexport class StatUI extends IStatRender {\r\n\tprivate static _fontSize: number = 12;\r\n\tprivate _txt: Text;\r\n\tprivate _leftText: Text;\r\n\t/**@internal */\r\n\t_sp: Sprite;\r\n\t/**@internal */\r\n\t_titleSp: Sprite;\r\n\t/**@internal */\r\n\t_bgSp: Sprite;\r\n\t/**@internal */\r\n\t_show: boolean = false;\r\n\t/**@internal */\r\n\t_useCanvas: boolean = false;\r\n\tprivate _canvas: HTMLCanvas;\r\n\tprivate _ctx: Context;\r\n\tprivate _first: boolean;\r\n\tprivate _vx: number;\r\n\tprivate _width: number;\r\n\tprivate _height: number = 100;\r\n\tprivate _view: any[] = [];\r\n\r\n\r\n\t/**\r\n\t * @override\r\n\t * 显示性能统计信息。\r\n\t * @param\tx X轴显示位置。\r\n\t * @param\ty Y轴显示位置。\r\n\t */\r\n\tshow(x: number = 0, y: number = 0): void {\r\n\t\tvar dt: any = Stat;\r\n\t\tif (!Browser.onMiniGame && !ILaya.Render.isConchApp && !Browser.onBDMiniGame && !Browser.onKGMiniGame && !Browser.onQGMiniGame && !Browser.onQQMiniGame && !Browser.onAlipayMiniGame && !Browser.onBLMiniGame && !Browser.onTTMiniGame && !Browser.onHWMiniGame) this._useCanvas = true;\r\n\t\tthis._show = true;\r\n\t\tStat._fpsData.length = 60;\r\n\t\tthis._view[0] = { title: \"FPS(WebGL)\", value: \"_fpsStr\", color: \"yellow\", units: \"int\" };\r\n\t\tthis._view[1] = { title: \"Sprite\", value: \"_spriteStr\", color: \"white\", units: \"int\" };\r\n\t\tthis._view[2] = { title: \"RenderBatches\", value: \"renderBatches\", color: \"white\", units: \"int\" };\r\n\t\tthis._view[3] = { title: \"SavedRenderBatches\", value: \"savedRenderBatches\", color: \"white\", units: \"int\" };\r\n\t\tthis._view[4] = { title: \"CPUMemory\", value: \"cpuMemory\", color: \"yellow\", units: \"M\" };\r\n\t\tthis._view[5] = { title: \"GPUMemory\", value: \"gpuMemory\", color: \"yellow\", units: \"M\" };\r\n\t\tthis._view[6] = { title: \"Shader\", value: \"shaderCall\", color: \"white\", units: \"int\" };\r\n\t\tthis._view[7] = { title: \"Canvas\", value: \"_canvasStr\", color: \"white\", units: \"int\" };\r\n\t\tif (Render.is3DMode) {\r\n\t\t\t\tthis._view[0].title = \"FPS(3D)\";\r\n\t\t\t\tthis._view[8] = { title: \"TriFaces\", value: \"trianglesFaces\", color: \"white\", units: \"int\" };\r\n\t\t\t\tthis._view[9] = { title: \"FrustumCulling\", value: \"frustumCulling\", color: \"white\", units: \"int\" };\r\n\t\t\t\tthis._view[10] = { title: \"OctreeNodeCulling\", value: \"octreeNodeCulling\", color: \"white\", units: \"int\" };\r\n\t\t\t}\r\n\t\t\tif (this._useCanvas) {\r\n\t\t\t\tthis.createUIPre(x, y);\r\n\t\t\t} else\r\n\t\t\t\tthis.createUI(x, y);\r\n\r\n\t\t\tthis.enable();\r\n\t\t}\r\n\r\n\tprivate createUIPre(x: number, y: number): void {\r\n\t\tvar pixel: number = Browser.pixelRatio;\r\n\t\tthis._width = pixel * 180;\r\n\t\tthis._vx = pixel * 120;\r\n\t\tthis._height = pixel * (this._view.length * 12 + 3 * pixel) + 4;\r\n\t\tStatUI._fontSize = 12 * pixel;\r\n\t\tfor (var i: number = 0; i < this._view.length; i++) {\r\n\t\t\tthis._view[i].x = 4;\r\n\t\t\tthis._view[i].y = i * StatUI._fontSize + 2 * pixel;\r\n\t\t}\r\n\t\tif (!this._canvas) {\r\n\t\t\tthis._canvas = new HTMLCanvas(true);\r\n\t\t\tthis._canvas.size(this._width, this._height);\r\n\t\t\tthis._ctx = this._canvas.getContext('2d') as Context;\r\n\t\t\tthis._ctx.textBaseline = \"top\";\r\n\t\t\tthis._ctx.font = StatUI._fontSize + \"px Arial\";\r\n\r\n\t\t\tthis._canvas.source.style.cssText = \"pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:\" + x + \"px;top:\" + y + \"px;width:\" + (this._width / pixel) + \"px;height:\" + (this._height / pixel) + \"px;\";\r\n\t\t}\r\n\t\tif (!Browser.onKGMiniGame) {\r\n\t\t\tBrowser.container.appendChild(this._canvas.source);\r\n\t\t}\r\n\r\n\t\tthis._first = true;\r\n\t\tthis.loop();\r\n\t\tthis._first = false;\r\n\t}\r\n\r\n\tprivate createUI(x: number, y: number): void {\r\n\t\tvar stat: Sprite = this._sp;\r\n\t\tvar pixel: number = Browser.pixelRatio;\r\n\t\tif (!stat) {\r\n\t\t\tstat = new Sprite();\r\n\t\t\tthis._leftText = new Text();\r\n\t\t\tthis._leftText.pos(5, 5);\r\n\t\t\tthis._leftText.color = \"#ffffff\";\r\n\t\t\tstat.addChild(this._leftText);\r\n\r\n\t\t\tthis._txt = new Text();\r\n\t\t\tthis._txt.pos(130 * pixel, 5);\r\n\t\t\tthis._txt.color = \"#ffffff\";\r\n\t\t\tstat.addChild(this._txt);\r\n\t\t\tthis._sp = stat;\r\n\t\t}\r\n\r\n\t\tstat.pos(x, y);\r\n\r\n\t\tvar text: string = \"\";\r\n\t\tfor (var i: number = 0; i < this._view.length; i++) {\r\n\t\t\tvar one: any = this._view[i];\r\n\t\t\ttext += one.title + \"\\n\";\r\n\t\t}\r\n\t\tthis._leftText.text = text;\r\n\r\n\t\t//调整为合适大小和字体\t\t\t\r\n\t\tvar width: number = pixel * 138;\r\n\t\tvar height: number = pixel * (this._view.length * 12 + 3 * pixel) + 4;\r\n\t\tthis._txt.fontSize = StatUI._fontSize * pixel;\r\n\t\tthis._leftText.fontSize = StatUI._fontSize * pixel;\r\n\r\n\t\tstat.size(width, height);\r\n\t\tstat.graphics.clear();\r\n\t\tstat.graphics.alpha(0.5);\r\n\t\tstat.graphics.drawRect(0, 0, width + 110, height + 30, \"#999999\");\r\n\t\tstat.graphics.alpha(2);\r\n\t\tthis.loop();\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * 激活性能统计\r\n\t * */\r\n\tenable(): void {\r\n\t\tILaya.systemTimer.frameLoop(1, this, this.loop);\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * 隐藏性能统计信息。\r\n\t */\r\n\thide(): void {\r\n\t\tthis._show = false;\r\n\t\tILaya.systemTimer.clear(this, this.loop);\r\n\t\tif (this._canvas) {\r\n\t\t\tBrowser.removeElement(this._canvas.source);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * 点击性能统计显示区域的处理函数。\r\n\t */\r\n\tset_onclick(fn: (this: GlobalEventHandlers, ev: MouseEvent) => any): void {\r\n\t\tif (this._sp) {\r\n\t\t\tthis._sp.on(\"click\", this._sp, fn);\r\n\t\t}\r\n\t\tif (this._canvas) {\r\n\t\t\tthis._canvas.source.onclick = fn;\r\n\t\t\tthis._canvas.source.style.pointerEvents = '';\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t * 性能统计参数计算循环处理函数。\r\n\t */\r\n\tloop(): void {\r\n\t\tStat._count++;\r\n\t\tvar timer: number = Browser.now();\r\n\t\tif (timer - Stat._timer < 1000) return;\r\n\r\n\t\tvar count: number = Stat._count;\r\n\t\t//计算更精确的FPS值\r\n\t\tStat.FPS = Math.round((count * 1000) / (timer - Stat._timer));\r\n\t\tif (this._show) {\r\n\t\t\t//计算平均值\r\n\t\t\tStat.trianglesFaces = Math.round(Stat.trianglesFaces / count);\r\n\r\n\t\t\tif (!this._useCanvas) {\r\n\t\t\t\tStat.renderBatches = Math.round(Stat.renderBatches / count) - 1;\r\n\t\t\t} else {\r\n\t\t\t\tStat.renderBatches = Math.round(Stat.renderBatches / count);\r\n\t\t\t}\r\n\t\t\tStat.savedRenderBatches = Math.round(Stat.savedRenderBatches / count);\r\n\t\t\tStat.shaderCall = Math.round(Stat.shaderCall / count);\r\n\t\t\tStat.spriteRenderUseCacheCount = Math.round(Stat.spriteRenderUseCacheCount / count);\r\n\t\t\tStat.canvasNormal = Math.round(Stat.canvasNormal / count);\r\n\t\t\tStat.canvasBitmap = Math.round(Stat.canvasBitmap / count);\r\n\t\t\tStat.canvasReCache = Math.ceil(Stat.canvasReCache / count);\r\n\t\t\tStat.frustumCulling = Math.round(Stat.frustumCulling / count);\r\n\t\t\tStat.octreeNodeCulling = Math.round(Stat.octreeNodeCulling / count);\r\n\r\n\t\t\tvar delay: string = Stat.FPS > 0 ? Math.floor(1000 / Stat.FPS).toString() : \" \";\r\n\t\t\tStat._fpsStr = Stat.FPS + (Stat.renderSlow ? \" slow\" : \"\") + \" \" + delay;\r\n\r\n\t\t\t// if (this._useCanvas)\r\n\t\t\t// Stat._spriteStr = (Stat.spriteCount - 1) + (Stat.spriteRenderUseCacheCount ? (\"/\" + Stat.spriteRenderUseCacheCount) : '');\r\n\t\t\t// else\r\n\t\t\tStat._spriteStr = Stat.spriteCount + (Stat.spriteRenderUseCacheCount ? (\"/\" + Stat.spriteRenderUseCacheCount) : '');\r\n\r\n\t\t\tStat._canvasStr = Stat.canvasReCache + \"/\" + Stat.canvasNormal + \"/\" + Stat.canvasBitmap;\r\n\t\t\tStat.cpuMemory = Resource.cpuMemory;\r\n\t\t\tStat.gpuMemory = Resource.gpuMemory;\r\n\t\t\tif (this._useCanvas) {\r\n\t\t\t\tthis.renderInfoPre();\r\n\t\t\t} else\r\n\t\t\t\tthis.renderInfo();\r\n\t\t\tStat.clear();\r\n\t\t}\r\n\r\n\t\tStat._count = 0;\r\n\t\tStat._timer = timer;\r\n\t}\r\n\r\n\tprivate renderInfoPre(): void {\r\n\t\tvar i: number = 0;\r\n\t\tvar one: any;\r\n\t\tvar value: any;\r\n\t\tif (this._canvas) {\r\n\t\t\tvar ctx: any = this._ctx;\r\n\t\t\tctx.clearRect(this._first ? 0 : this._vx, 0, this._width, this._height);\r\n\t\t\tfor (i = 0; i < this._view.length; i++) {\r\n\t\t\t\tone = this._view[i];\r\n\t\t\t\t//只有第一次才渲染标题文字，减少文字渲染次数\r\n\t\t\t\tif (this._first) {\r\n\t\t\t\t\tctx.fillStyle = \"white\";\r\n\t\t\t\t\tctx.fillText(one.title, one.x, one.y);\r\n\t\t\t\t}\r\n\t\t\t\tctx.fillStyle = one.color;\r\n\t\t\t\tvalue = Stat[one.value];\r\n\t\t\t\t(one.units == \"M\") && (value = Math.floor(value / (1024 * 1024) * 100) / 100 + \" M\");\r\n\t\t\t\tctx.fillText(value + \"\", one.x + this._vx, one.y);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate renderInfo(): void {\r\n\t\tvar text: string = \"\";\r\n\t\tfor (var i: number = 0; i < this._view.length; i++) {\r\n\t\t\tvar one: any = this._view[i];\r\n\t\t\tvar value: any = Stat[one.value];\r\n\t\t\t(one.units == \"M\") && (value = Math.floor(value / (1024 * 1024) * 100) / 100 + \" M\");\r\n\t\t\t(one.units == \"K\") && (value = Math.floor(value / (1024) * 100) / 100 + \" K\");\r\n\t\t\ttext += value + \"\\n\";\r\n\t\t}\r\n\t\tthis._txt.text = text;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisCanvasRender(): boolean {\r\n\t\treturn this._useCanvas;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * 非canvas模式的渲染\r\n\t * */\r\n\trenderNotCanvas(ctx: any, x: number, y: number) {\r\n\t\tthis._show && this._sp && this._sp.render(ctx, 0, 0);\r\n\t}\r\n\r\n}\r\n\r\n","import { CallLater } from \"./CallLater\";\r\nimport { ILaya } from \"../../ILaya\";\r\n/**\r\n\t * <code>Timer</code> 是时钟管理类。它是一个单例，不要手动实例化此类，应该通过 Laya.timer 访问。\r\n\t */\r\nexport class Timer {\r\n    /**@private */\r\n    static gSysTimer: Timer = null;\r\n\r\n    /**@private */\r\n    private static _pool: any[] = [];\r\n    /**@private */\r\n    static _mid: number = 1;\r\n\r\n\r\n    /** 时针缩放。*/\r\n    scale: number = 1;\r\n    /** 当前帧开始的时间。*/\r\n    currTimer: number = Date.now();\r\n    /** 当前的帧数。*/\r\n    currFrame: number = 0;\r\n    /**@internal 两帧之间的时间间隔,单位毫秒。*/\r\n    _delta: number = 0;\r\n    /**@internal */\r\n    _lastTimer: number = Date.now();\r\n    /**@private */\r\n    private _map: any[] = [];\r\n    /**@private */\r\n    private _handlers: any[] = [];\r\n    /**@private */\r\n    private _temp: any[] = [];\r\n    /**@private */\r\n    private _count: number = 0;\r\n\r\n    /**\r\n     * 创建 <code>Timer</code> 类的一个实例。\r\n     */\r\n    constructor(autoActive: boolean = true) {\r\n        autoActive && Timer.gSysTimer && Timer.gSysTimer.frameLoop(1, this, this._update);\r\n    }\r\n\r\n    /**两帧之间的时间间隔,单位毫秒。*/\r\n    get delta(): number {\r\n        return this._delta;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 帧循环处理函数。\r\n     */\r\n    _update(): void {\r\n        if (this.scale <= 0) {\r\n            this._lastTimer = Date.now();\r\n            this._delta = 0;\r\n            return;\r\n        }\r\n        var frame: number = this.currFrame = this.currFrame + this.scale;\r\n        var now: number = Date.now();\r\n        var awake: boolean = (now - this._lastTimer) > 30000;\r\n        this._delta = (now - this._lastTimer) * this.scale;\r\n        var timer: number = this.currTimer = this.currTimer + this._delta;\r\n        this._lastTimer = now;\r\n\r\n        //处理handler\r\n        var handlers: any[] = this._handlers;\r\n        this._count = 0;\r\n        for (var i: number = 0, n: number = handlers.length; i < n; i++) {\r\n            var handler: TimerHandler = handlers[i];\r\n            if (handler.method !== null) {\r\n                var t: number = handler.userFrame ? frame : timer;\r\n                if (t >= handler.exeTime) {\r\n                    if (handler.repeat) {\r\n                        if (!handler.jumpFrame || awake) {\r\n                            handler.exeTime += handler.delay;\r\n                            handler.run(false);\r\n                            if (t > handler.exeTime) {\r\n                                //如果执行一次后还能再执行，做跳出处理，如果想用多次执行，需要设置jumpFrame=true\r\n                                handler.exeTime += Math.ceil((t - handler.exeTime) / handler.delay) * handler.delay;\r\n                            }\r\n                        } else {\r\n                            while (t >= handler.exeTime) {\r\n                                handler.exeTime += handler.delay;\r\n                                handler.run(false);\r\n                            }\r\n                        }\r\n                    } else {\r\n                        handler.run(true);\r\n                    }\r\n                }\r\n            } else {\r\n                this._count++;\r\n            }\r\n        }\r\n\r\n        if (this._count > 30 || frame % 200 === 0) this._clearHandlers();\r\n    }\r\n\r\n    /** @private */\r\n    private _clearHandlers(): void {\r\n        var handlers: any[] = this._handlers;\r\n        for (var i: number = 0, n: number = handlers.length; i < n; i++) {\r\n            var handler: TimerHandler = handlers[i];\r\n            if (handler.method !== null) this._temp.push(handler);\r\n            else this._recoverHandler(handler);\r\n        }\r\n        this._handlers = this._temp;\r\n        handlers.length = 0;\r\n        this._temp = handlers;\r\n    }\r\n\r\n    /** @private */\r\n    private _recoverHandler(handler: TimerHandler): void {\r\n        if (this._map[handler.key] == handler) this._map[handler.key] = null;\r\n        handler.clear();\r\n        Timer._pool.push(handler);\r\n    }\r\n\r\n    /** @internal */\r\n    _create(useFrame: boolean, repeat: boolean, delay: number, caller: any, method: Function, args: any[], coverBefore: boolean): TimerHandler {\r\n        //如果延迟为0，则立即执行\r\n        if (!delay) {\r\n            method.apply(caller, args);\r\n            return null;\r\n        }\r\n\r\n        //先覆盖相同函数的计时\r\n        if (coverBefore) {\r\n            var handler: TimerHandler = this._getHandler(caller, method);\r\n            if (handler) {\r\n                handler.repeat = repeat;\r\n                handler.userFrame = useFrame;\r\n                handler.delay = delay;\r\n                handler.caller = caller;\r\n                handler.method = method;\r\n                handler.args = args;\r\n                handler.exeTime = delay + (useFrame ? this.currFrame : this.currTimer + Date.now() - this._lastTimer);\r\n                return handler;\r\n            }\r\n        }\r\n\r\n        //找到一个空闲的timerHandler\r\n        handler = Timer._pool.length > 0 ? Timer._pool.pop() : new TimerHandler();\r\n        handler.repeat = repeat;\r\n        handler.userFrame = useFrame;\r\n        handler.delay = delay;\r\n        handler.caller = caller;\r\n        handler.method = method;\r\n        handler.args = args;\r\n        handler.exeTime = delay + (useFrame ? this.currFrame : this.currTimer + Date.now() - this._lastTimer);\r\n\r\n        //索引handler\r\n        this._indexHandler(handler);\r\n\r\n        //插入数组\r\n        this._handlers.push(handler);\r\n\r\n        return handler;\r\n    }\r\n\r\n    /** @private */\r\n    private _indexHandler(handler: TimerHandler): void {\r\n        var caller: any = handler.caller;\r\n        var method: any = handler.method;\r\n        var cid: number = caller ? caller.$_GID || (caller.$_GID = ILaya.Utils.getGID()) : 0;\r\n        var mid: number = method.$_TID || (method.$_TID = (Timer._mid++) * 100000);\r\n        handler.key = cid + mid;\r\n        this._map[handler.key] = handler;\r\n    }\r\n\r\n    /**\r\n     * 定时执行一次。\r\n     * @param\tdelay\t延迟时间(单位为毫秒)。\r\n     * @param\tcaller\t执行域(this)。\r\n     * @param\tmethod\t定时器回调函数。\r\n     * @param\targs\t回调参数。\r\n     * @param\tcoverBefore\t是否覆盖之前的延迟执行，默认为 true 。\r\n     */\r\n    once(delay: number, caller: any, method: Function, args: any[] = null, coverBefore: boolean = true): void {\r\n        this._create(false, false, delay, caller, method, args, coverBefore);\r\n    }\r\n\r\n    /**\r\n     * 定时重复执行。\r\n     * @param\tdelay\t间隔时间(单位毫秒)。\r\n     * @param\tcaller\t执行域(this)。\r\n     * @param\tmethod\t定时器回调函数。\r\n     * @param\targs\t回调参数。\r\n     * @param\tcoverBefore\t是否覆盖之前的延迟执行，默认为 true 。\r\n     * @param\tjumpFrame 时钟是否跳帧。基于时间的循环回调，单位时间间隔内，如能执行多次回调，出于性能考虑，引擎默认只执行一次，设置jumpFrame=true后，则回调会连续执行多次\r\n     */\r\n    loop(delay: number, caller: any, method: Function, args: any[] = null, coverBefore: boolean = true, jumpFrame: boolean = false): void {\r\n        var handler: TimerHandler = this._create(false, true, delay, caller, method, args, coverBefore);\r\n        if (handler) handler.jumpFrame = jumpFrame;\r\n    }\r\n\r\n    /**\r\n     * 定时执行一次(基于帧率)。\r\n     * @param\tdelay\t延迟几帧(单位为帧)。\r\n     * @param\tcaller\t执行域(this)。\r\n     * @param\tmethod\t定时器回调函数。\r\n     * @param\targs\t回调参数。\r\n     * @param\tcoverBefore\t是否覆盖之前的延迟执行，默认为 true 。\r\n     */\r\n    frameOnce(delay: number, caller: any, method: Function, args: any[] = null, coverBefore: boolean = true): void {\r\n        this._create(true, false, delay, caller, method, args, coverBefore);\r\n    }\r\n\r\n    /**\r\n     * 定时重复执行(基于帧率)。\r\n     * @param\tdelay\t间隔几帧(单位为帧)。\r\n     * @param\tcaller\t执行域(this)。\r\n     * @param\tmethod\t定时器回调函数。\r\n     * @param\targs\t回调参数。\r\n     * @param\tcoverBefore\t是否覆盖之前的延迟执行，默认为 true 。\r\n     */\r\n    frameLoop(delay: number, caller: any, method: Function, args: any[] = null, coverBefore: boolean = true): void {\r\n        this._create(true, true, delay, caller, method, args, coverBefore);\r\n    }\r\n\r\n    /** 返回统计信息。*/\r\n    toString(): string {\r\n        return \" handlers:\" + this._handlers.length + \" pool:\" + Timer._pool.length;\r\n    }\r\n\r\n    /**\r\n     * 清理定时器。\r\n     * @param\tcaller 执行域(this)。\r\n     * @param\tmethod 定时器回调函数。\r\n     */\r\n    clear(caller: any, method: Function): void {\r\n        var handler: TimerHandler = this._getHandler(caller, method);\r\n        if (handler) {\r\n            this._map[handler.key] = null;\r\n            handler.key = 0;\r\n            handler.clear();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 清理对象身上的所有定时器。\r\n     * @param\tcaller 执行域(this)。\r\n     */\r\n    clearAll(caller: any): void {\r\n        if (!caller) return;\r\n        for (var i: number = 0, n: number = this._handlers.length; i < n; i++) {\r\n            var handler: TimerHandler = this._handlers[i];\r\n            if (handler.caller === caller) {\r\n                this._map[handler.key] = null;\r\n                handler.key = 0;\r\n                handler.clear();\r\n            }\r\n        }\r\n    }\r\n\r\n    /** @private */\r\n    private _getHandler(caller: any, method: any): TimerHandler {\r\n        var cid: number = caller ? caller.$_GID || (caller.$_GID = ILaya.Utils.getGID()) : 0;\r\n        var mid: number = method.$_TID || (method.$_TID = (Timer._mid++) * 100000);\r\n        return this._map[cid + mid];\r\n    }\r\n\r\n    /**\r\n     * 延迟执行。\r\n     * @param\tcaller 执行域(this)。\r\n     * @param\tmethod 定时器回调函数。\r\n     * @param\targs 回调参数。\r\n     */\r\n    callLater(caller: any, method: Function, args: any[] = null): void {\r\n        CallLater.I.callLater(caller, method, args);\r\n    }\r\n\r\n    /**\r\n     * 立即执行 callLater 。\r\n     * @param\tcaller 执行域(this)。\r\n     * @param\tmethod 定时器回调函数。\r\n     */\r\n    runCallLater(caller: any, method: Function): void {\r\n        CallLater.I.runCallLater(caller, method);\r\n    }\r\n\r\n    /**\r\n     * 立即提前执行定时器，执行之后从队列中删除\r\n     * @param\tcaller 执行域(this)。\r\n     * @param\tmethod 定时器回调函数。\r\n     */\r\n    runTimer(caller: any, method: Function): void {\r\n        var handler: TimerHandler = this._getHandler(caller, method);\r\n        if (handler && handler.method != null) {\r\n            this._map[handler.key] = null;\r\n            handler.run(true);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 暂停时钟\r\n     */\r\n    pause(): void {\r\n        this.scale = 0;\r\n    }\r\n\r\n    /**\r\n     * 恢复时钟\r\n     */\r\n    resume(): void {\r\n        this.scale = 1;\r\n    }\r\n}\r\n\r\n\r\n\r\n/** @private */\r\nclass TimerHandler {\r\n    key: number;\r\n    repeat: boolean;\r\n    delay: number;\r\n    userFrame: boolean;\r\n    exeTime: number;\r\n    caller: any\r\n    method: Function;\r\n    args: any[];\r\n    jumpFrame: boolean;\r\n\r\n    clear(): void {\r\n        this.caller = null;\r\n        this.method = null;\r\n        this.args = null;\r\n    }\r\n\r\n    run(withClear: boolean): void {\r\n        var caller: any = this.caller;\r\n        if (caller && caller.destroyed) return this.clear();\r\n        var method: Function = this.method;\r\n        var args: any[] = this.args;\r\n        withClear && this.clear();\r\n        if (method == null) return;\r\n        args ? method.apply(caller, args) : method.call(caller);\r\n    }\r\n}\r\n","import { ShaderDefines2D } from \"../ShaderDefines2D\"\r\nimport { Value2D } from \"../value/Value2D\"\r\nimport { CONST3D2D } from \"../../../utils/CONST3D2D\"\r\nimport { WebGLContext } from \"../../../WebGLContext\";\r\nexport class SkinSV extends Value2D {\r\n\ttexcoord: any;\r\n\tposition: any;\r\n\toffsetX: number = 300;\r\n\toffsetY: number = 0;\r\n\r\n\t//TODO:coverage\r\n\tconstructor(type: any) {\r\n\t\tsuper(ShaderDefines2D.SKINMESH, 0);\r\n\t\tvar gl: WebGLRenderingContext = WebGLContext.mainContext;\r\n\t\tvar _vlen: number = 8 * CONST3D2D.BYTES_PE;\r\n\t\tthis.position = [2, gl.FLOAT, false, _vlen, 0];\r\n\t\tthis.texcoord = [2, gl.FLOAT, false, _vlen, 2 * CONST3D2D.BYTES_PE];\r\n\t\tthis.color = [4, gl.FLOAT, false, _vlen, 4 * CONST3D2D.BYTES_PE];\r\n\t}\r\n\r\n}\r\n\r\n\r\n","import { Value2D } from \"./Value2D\";\r\nimport { ShaderDefines2D } from \"../ShaderDefines2D\"\r\n\r\nexport class PrimitiveSV extends Value2D{\t\r\n    constructor(args:any){\r\n        super(ShaderDefines2D.PRIMITIVE,0);\r\n        this._attribLocation = ['position', 0, 'attribColor', 1];// , 'clipDir', 2, 'clipRect', 3];\r\n    }\r\n}\r\n\r\n","import { Value2D } from \"./Value2D\";\r\nimport { WebGL } from \"../../../WebGL\"\r\n\timport { ShaderDefines2D } from \"../ShaderDefines2D\"\r\n\t\r\n\texport class TextureSV extends Value2D\r\n\t{\r\n\t\t u_colorMatrix:any[];\r\n\t\t strength : number = 0;\r\n\t\t blurInfo:any[] = null;\r\n\t\t colorMat : Float32Array = null;\r\n\t\t colorAlpha : Float32Array = null;\r\n\t\tconstructor(subID:number=0){\r\n\t\t\tsuper(ShaderDefines2D.TEXTURE2D, subID);\r\n\t\t\tthis._attribLocation = ['posuv', 0, 'attribColor', 1, 'attribFlags', 2];// , 'clipDir', 3, 'clipRect', 4];\r\n\t\t}\r\n\t\t/**\r\n\t\t * @override\r\n\t\t */\r\n\t\t  clear():void\r\n\t\t{\r\n\t\t\tthis.texture = null;\r\n\t\t\tthis.shader = null;\r\n\t\t\tthis.defines._value=this.subID;\r\n\t\t\t//defines.setValue(0);\r\n\t\t}\r\n    }\r\n\r\n    // 放在这里容易导致这个文件被排除\r\n    //Value2D._initone(ShaderDefines2D.TEXTURE2D, TextureSV);\r\n    //Value2D._initone(ShaderDefines2D.TEXTURE2D | ShaderDefines2D.FILTERGLOW, TextureSV);\r\n","import { ILaya } from \"../../../ILaya\";\r\n\r\n//import { ShaderCompile } from \"./ShaderCompile\";\r\nexport class InlcudeFile {\r\n    script: string;\r\n    codes: any = {};\r\n    funs: any = {};\r\n    curUseID: number = -1;\r\n    funnames: string = \"\";\r\n\r\n    constructor(txt: string) {\r\n        this.script = txt;\r\n        var begin: number = 0, ofs: number, end: number;\r\n        while (true) {\r\n            begin = txt.indexOf(\"#begin\", begin);\r\n            if (begin < 0) break;\r\n\r\n            end = begin + 5;\r\n            while (true) {\r\n                end = txt.indexOf(\"#end\", end);\r\n                if (end < 0) break;\r\n                if (txt.charAt(end + 4) === 'i')\r\n                    end += 5;\r\n                else break;\r\n            }\r\n\r\n            if (end < 0) {\r\n                throw \"add include err,no #end:\" + txt;\r\n            }\r\n\r\n            ofs = txt.indexOf('\\n', begin);\r\n            var words: any[] = ILaya.ShaderCompile.splitToWords(txt.substr(begin, ofs - begin), null);\r\n            if (words[1] == 'code') {\r\n                this.codes[words[2]] = txt.substr(ofs + 1, end - ofs - 1);\r\n            } else if (words[1] == 'function')//#begin function void test()\r\n            {\r\n                ofs = txt.indexOf(\"function\", begin);\r\n                ofs += \"function\".length;\r\n                this.funs[words[3]] = txt.substr(ofs + 1, end - ofs - 1);\r\n                this.funnames += words[3] + \";\";\r\n            }\r\n\r\n            begin = end + 1;\r\n        }\r\n    }\r\n\r\n    getWith(name: string = null): string {\r\n        var r: string = name ? this.codes[name] : this.script;\r\n        if (!r) {\r\n            throw \"get with error:\" + name;\r\n        }\r\n        return r;\r\n    }\r\n\r\n    getFunsScript(funsdef: string): string {\r\n        var r: string = \"\";\r\n        for (var i in this.funs) {\r\n            if (funsdef.indexOf(i + \";\") >= 0) {\r\n                r += this.funs[i];\r\n            }\r\n        }\r\n        return r;\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { ILaya } from \"../../../ILaya\";\r\n\r\n//\timport { ShaderCompile } from \"./ShaderCompile\"\r\n\r\nexport class ShaderNode {\r\n    private static __id: number = 1;\r\n\r\n    childs: any[] = [];\r\n    text: string = \"\";\r\n    parent: ShaderNode;\r\n    name: string;\r\n    noCompile: boolean;\r\n    includefiles: any[];\r\n    condition: any;\r\n    conditionType: number;\r\n    useFuns: string = \"\";\r\n    z: number = 0;\r\n    src: string;\r\n\r\n    constructor(includefiles: any[]) {\r\n        this.includefiles = includefiles;\r\n    }\r\n\r\n    setParent(parent: ShaderNode): void {\r\n        parent.childs.push(this);\r\n        this.z = parent.z + 1;\r\n        this.parent = parent;\r\n    }\r\n\r\n    setCondition(condition: string, type: number): void {\r\n        if (condition) {\r\n            this.conditionType = type;\r\n            condition = condition.replace(/(\\s*$)/g, \"\");\r\n            this.condition = function (): boolean {\r\n                return this[condition];\r\n            }\r\n            this.condition.__condition = condition;\r\n        }\r\n    }\r\n\r\n    toscript(def: any, out: any[]): any[] {\r\n        return this._toscript(def, out, ++ShaderNode.__id);\r\n    }\r\n\r\n    private _toscript(def: any, out: any[], id: number): any[] {\r\n        if (this.childs.length < 1 && !this.text) return out;\r\n        var outIndex: number = out.length;\r\n        if (this.condition) {\r\n            var ifdef: boolean = !!this.condition.call(def);\r\n            this.conditionType === ILaya.ShaderCompile.IFDEF_ELSE && (ifdef = !ifdef);\r\n            if (!ifdef) return out;\r\n        }\r\n\r\n        this.text && out.push(this.text);\r\n        this.childs.length > 0 && this.childs.forEach(function (o: ShaderNode, index: number, arr: ShaderNode[]): void {\r\n            o._toscript(def, out, id);\r\n        });\r\n\r\n        if (this.includefiles.length > 0 && this.useFuns.length > 0) {\r\n            var funsCode: string;\r\n            for (var i: number = 0, n: number = this.includefiles.length; i < n; i++) {\r\n                //如果已经加入了，就不要再加\r\n                if (this.includefiles[i].curUseID == id) {\r\n                    continue;\r\n                }\r\n                funsCode = this.includefiles[i].file.getFunsScript(this.useFuns);\r\n                if (funsCode.length > 0) {\r\n                    this.includefiles[i].curUseID = id;\r\n                    out[0] = funsCode + out[0];\r\n                }\r\n            }\r\n        }\r\n\r\n        return out;\r\n    }\r\n}\r\n\r\n\r\n","import { LayaGL } from \"../../layagl/LayaGL\";\r\nimport { Shader } from \"../shader/Shader\";\r\nimport { InlcudeFile } from \"./InlcudeFile\";\r\nimport { ShaderNode } from \"./ShaderNode\";\r\n\r\n/**\r\n * @private\r\n * <code>ShaderCompile</code> 类用于实现Shader编译。\r\n */\r\nexport class ShaderCompile {\r\n\r\n\r\n\tstatic IFDEF_NO: number = 0;\r\n\tstatic IFDEF_YES: number = 1;\r\n\tstatic IFDEF_ELSE: number = 2;\r\n\tstatic IFDEF_PARENT: number = 3;\r\n\r\n\tstatic _removeAnnotation: RegExp = new RegExp(\"(/\\\\*([^*]|[\\\\r\\\\\\n]|(\\\\*+([^*/]|[\\\\r\\\\n])))*\\\\*+/)|(//.*)\", \"g\");\r\n\tstatic _reg: RegExp = new RegExp(\"(\\\".*\\\")|('.*')|([#\\\\w\\\\*-\\\\.+/()=<>{}\\\\\\\\]+)|([,;:\\\\\\\\])\", \"g\");\r\n\tstatic _splitToWordExps: RegExp = new RegExp(\"[(\\\".*\\\")]+|[('.*')]+|([ \\\\t=\\\\+\\\\-*/&%!<>!%\\(\\),;])\", \"g\");\r\n\r\n\tstatic includes: any = {};\r\n\tstatic shaderParamsMap: any;\r\n\r\n\tprivate _nameMap: any;\r\n\tprotected _VS: ShaderNode;\r\n\tprotected _PS: ShaderNode;\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tstatic __init__(): void {\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tShaderCompile.shaderParamsMap = { \"float\": gl.FLOAT, \"int\": gl.INT, \"bool\": gl.BOOL, \"vec2\": gl.FLOAT_VEC2, \"vec3\": gl.FLOAT_VEC3, \"vec4\": gl.FLOAT_VEC4, \"ivec2\": gl.INT_VEC2, \"ivec3\": gl.INT_VEC3, \"ivec4\": gl.INT_VEC4, \"bvec2\": gl.BOOL_VEC2, \"bvec3\": gl.BOOL_VEC3, \"bvec4\": gl.BOOL_VEC4, \"mat2\": gl.FLOAT_MAT2, \"mat3\": gl.FLOAT_MAT3, \"mat4\": gl.FLOAT_MAT4, \"sampler2D\": gl.SAMPLER_2D, \"samplerCube\": gl.SAMPLER_CUBE };\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\tprivate static _parseOne(attributes: any[], uniforms: any[], words: any[], i: number, word: string, b: boolean): number {\r\n\t\tvar one: any = { type: ShaderCompile.shaderParamsMap[words[i + 1]], name: words[i + 2], size: isNaN(parseInt(words[i + 3])) ? 1 : parseInt(words[i + 3]) };\r\n\t\tif (b) {\r\n\t\t\tif (word == \"attribute\") {\r\n\t\t\t\tattributes.push(one);\r\n\t\t\t} else {\r\n\t\t\t\tuniforms.push(one);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (words[i + 3] == ':') {\r\n\t\t\tone.type = words[i + 4];\r\n\t\t\ti += 2;\r\n\t\t}\r\n\t\ti += 2;\r\n\t\treturn i;\r\n\t}\r\n\r\n\tstatic addInclude(fileName: string, txt: string): void {\r\n\t\tif (!txt || txt.length === 0)\r\n\t\t\tthrow new Error(\"add shader include file err:\" + fileName);\r\n\t\tif (ShaderCompile.includes[fileName])\r\n\t\t\tthrow new Error(\"add shader include file err, has add:\" + fileName);\r\n\t\tShaderCompile.includes[fileName] = new InlcudeFile(txt);\r\n\t}\r\n\r\n\t//TODO:coverage\r\n\tstatic preGetParams(vs: string, ps: string): any {\r\n\t\tvar text: any[] = [vs, ps];\r\n\t\tvar result: any = {};\r\n\t\tvar attributes: any[] = [];\r\n\t\tvar uniforms: any[] = [];\r\n\t\tvar definesInfo: any = {};\r\n\t\tvar definesName: any[] = [];\r\n\r\n\t\tresult.attributes = attributes;\r\n\t\tresult.uniforms = uniforms;\r\n\t\tresult.defines = definesInfo;\r\n\r\n\t\tvar i: number, n: number, one: any;\r\n\t\tfor (var s: number = 0; s < 2; s++) {\r\n\t\t\ttext[s] = text[s].replace(ShaderCompile._removeAnnotation, \"\");\r\n\r\n\t\t\tvar words: any[] = text[s].match(ShaderCompile._reg);\r\n\t\t\tvar tempelse: string;\r\n\t\t\tfor (i = 0, n = words.length; i < n; i++) {\r\n\t\t\t\tvar word: string = words[i];\r\n\t\t\t\tif (word != \"attribute\" && word != \"uniform\") {\r\n\t\t\t\t\tif (word == \"#define\") {\r\n\t\t\t\t\t\tword = words[++i];\r\n\t\t\t\t\t\tdefinesName[word] = 1;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t} else if (word == \"#ifdef\") {\r\n\t\t\t\t\t\ttempelse = words[++i]\r\n\t\t\t\t\t\tvar def: any[] = definesInfo[tempelse] = definesInfo[tempelse] || [];\r\n\t\t\t\t\t\tfor (i++; i < n; i++) {\r\n\t\t\t\t\t\t\tword = words[i];\r\n\t\t\t\t\t\t\tif (word != \"attribute\" && word != \"uniform\") {\r\n\t\t\t\t\t\t\t\tif (word == \"#else\") {\r\n\t\t\t\t\t\t\t\t\tfor (i++; i < n; i++) {\r\n\t\t\t\t\t\t\t\t\t\tword = words[i];\r\n\t\t\t\t\t\t\t\t\t\tif (word != \"attribute\" && word != \"uniform\") {\r\n\t\t\t\t\t\t\t\t\t\t\tif (word == \"#endif\") {\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\ti = ShaderCompile._parseOne(attributes, uniforms, words, i, word, !definesName[tempelse]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ti = ShaderCompile._parseOne(attributes, uniforms, words, i, word, definesName[tempelse]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\ti = ShaderCompile._parseOne(attributes, uniforms, words, i, word, true);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tstatic splitToWords(str: string, block: ShaderNode): any[]//这里要修改\r\n\t{\r\n\t\tvar out: any[] = [];\r\n\t\t/*\r\n\t\t   var words:Array = str.split(_splitToWordExps);\r\n\t\t   trace(str);\r\n\t\t   trace(words);\r\n\t\t */\r\n\t\tvar c: string;\r\n\t\tvar ofs: number = -1;\r\n\t\tvar word: string;\r\n\t\tfor (var i: number = 0, n: number = str.length; i < n; i++) {\r\n\t\t\tc = str.charAt(i);\r\n\t\t\tif (\" \\t=+-*/&%!<>()'\\\",;\".indexOf(c) >= 0) {\r\n\t\t\t\tif (ofs >= 0 && (i - ofs) > 1) {\r\n\t\t\t\t\tword = str.substr(ofs, i - ofs);\r\n\t\t\t\t\tout.push(word);\r\n\t\t\t\t}\r\n\t\t\t\tif (c == '\"' || c == \"'\") {\r\n\t\t\t\t\tvar ofs2: number = str.indexOf(c, i + 1);\r\n\t\t\t\t\tif (ofs2 < 0) {\r\n\t\t\t\t\t\tthrow \"Sharder err:\" + str;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tout.push(str.substr(i + 1, ofs2 - i - 1));\r\n\t\t\t\t\ti = ofs2;\r\n\t\t\t\t\tofs = -1;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (c == '(' && block && out.length > 0) {\r\n\t\t\t\t\tword = out[out.length - 1] + \";\";\r\n\t\t\t\t\tif (\"vec4;main;\".indexOf(word) < 0)\r\n\t\t\t\t\t\tblock.useFuns += word;\r\n\t\t\t\t}\r\n\t\t\t\tofs = -1;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (ofs < 0) ofs = i;\r\n\t\t}\r\n\t\tif (ofs < n && (n - ofs) > 1) {\r\n\t\t\tword = str.substr(ofs, n - ofs);\r\n\t\t\tout.push(word);\r\n\t\t}\r\n\t\treturn out;\r\n\t}\r\n\r\n\tstatic _clearCR: RegExp = new RegExp(\"\\r\", \"g\");\r\n\tpublic defs: Object = {};\r\n\r\n\tconstructor(vs: string, ps: string, nameMap: any) {\r\n\t\tlet _this = this;\r\n\t\tfunction _compile(script: string): ShaderNode {\r\n\t\t\tscript = script.replace(ShaderCompile._clearCR, \"\");//CRLF风格需要先去掉“\\r\",否则切分字符会出错导致宏定义编译错误等\r\n\t\t\tvar includefiles: any[] = [];\r\n\t\t\tvar top: ShaderNode = new ShaderNode(includefiles);\r\n\t\t\t_this._compileToTree(top, script.split('\\n'), 0, includefiles, _this.defs);\r\n\t\t\treturn top;\r\n\t\t}\r\n\r\n\t\t//先要去掉注释,还没有完成\r\n\t\tvar startTime: number = Date.now();\r\n\t\tthis._VS = _compile(vs);\r\n\t\tthis._PS = _compile(ps);\r\n\t\tthis._nameMap = nameMap;\r\n\t\tif ((Date.now() - startTime) > 2)\r\n\t\t\tconsole.log(\"ShaderCompile use time:\" + (Date.now() - startTime) + \"  size:\" + vs.length + \"/\" + ps.length);\r\n\t}\r\n\r\n\tstatic _splitToWordExps3: RegExp = new RegExp(\"[ \\\\t=\\\\+\\\\-*/&%!<>!%\\(\\),;\\\\|]\", \"g\");\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tprotected _compileToTree(parent: ShaderNode, lines: any[], start: number, includefiles: any[], defs: any): void {\r\n\t\tvar node: ShaderNode, preNode: ShaderNode;\r\n\t\tvar text: string, name: string, fname: string;\r\n\t\tvar ofs: number, words: any[], noUseNode: ShaderNode;\r\n\t\tvar i: number, n: number, j: number;\r\n\t\tfor (i = start; i < lines.length; i++) {\r\n\t\t\ttext = lines[i];\r\n\t\t\tif (text.length < 1) continue;\r\n\t\t\tofs = text.indexOf(\"//\");\r\n\t\t\tif (ofs === 0) continue;\r\n\t\t\tif (ofs >= 0) text = text.substr(0, ofs);\r\n\r\n\t\t\tnode = noUseNode || new ShaderNode(includefiles);\r\n\t\t\tnoUseNode = null;\r\n\t\t\tnode.text = text;\r\n\t\t\tnode.noCompile = true;\r\n\r\n\t\t\tif ((ofs = text.indexOf(\"#\")) >= 0) {\r\n\t\t\t\tname = \"#\";\r\n\t\t\t\tfor (j = ofs + 1, n = text.length; j < n; j++) {\r\n\t\t\t\t\tvar c: string = text.charAt(j);\r\n\t\t\t\t\tif (c === ' ' || c === '\\t' || c === '?') break;\r\n\t\t\t\t\tname += c;\r\n\t\t\t\t}\r\n\t\t\t\tnode.name = name;\r\n\t\t\t\tswitch (name) {\r\n\t\t\t\t\tcase \"#ifdef\":\r\n\t\t\t\t\tcase \"#ifndef\":\r\n\t\t\t\t\t\tnode.src = text;\r\n\t\t\t\t\t\tnode.noCompile = text.match(/[!&|()=<>]/) != null;\r\n\t\t\t\t\t\tif (!node.noCompile) {\r\n\t\t\t\t\t\t\twords = text.replace(/^\\s*/, '').split(/\\s+/);\r\n\t\t\t\t\t\t\tnode.setCondition(words[1], name === \"#ifdef\" ? ShaderCompile.IFDEF_YES : ShaderCompile.IFDEF_ELSE);\r\n\t\t\t\t\t\t\tnode.text = \"//\" + node.text;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.log(\"function():Boolean{return \" + text.substr(ofs + node.name.length) + \"}\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnode.setParent(parent);\r\n\t\t\t\t\t\tparent = node;\r\n\t\t\t\t\t\tif (defs) {\r\n\t\t\t\t\t\t\twords = text.substr(j).split(ShaderCompile._splitToWordExps3);\r\n\t\t\t\t\t\t\tfor (j = 0; j < words.length; j++) {\r\n\t\t\t\t\t\t\t\ttext = words[j];\r\n\t\t\t\t\t\t\t\ttext.length && (defs[text] = true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\tcase \"#if\":\r\n\t\t\t\t\t\tnode.src = text;\r\n\t\t\t\t\t\tnode.noCompile = true;\r\n\t\t\t\t\t\tnode.setParent(parent);\r\n\t\t\t\t\t\tparent = node;\r\n\t\t\t\t\t\tif (defs) {\r\n\t\t\t\t\t\t\twords = text.substr(j).split(ShaderCompile._splitToWordExps3);\r\n\t\t\t\t\t\t\tfor (j = 0; j < words.length; j++) {\r\n\t\t\t\t\t\t\t\ttext = words[j];\r\n\t\t\t\t\t\t\t\ttext.length && text != \"defined\" && (defs[text] = true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\tcase \"#else\":\r\n\t\t\t\t\t\tnode.src = text;\r\n\t\t\t\t\t\tparent = parent.parent;\r\n\t\t\t\t\t\tpreNode = parent.childs[parent.childs.length - 1];\r\n\t\t\t\t\t\tnode.noCompile = preNode.noCompile;\r\n\t\t\t\t\t\tif (!node.noCompile) {\r\n\t\t\t\t\t\t\tnode.condition = preNode.condition;\r\n\t\t\t\t\t\t\tnode.conditionType = preNode.conditionType == ShaderCompile.IFDEF_YES ? ShaderCompile.IFDEF_ELSE : ShaderCompile.IFDEF_YES;\r\n\t\t\t\t\t\t\tnode.text = \"//\" + node.text + \" \" + preNode.text + \" \" + node.conditionType;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnode.setParent(parent);\r\n\t\t\t\t\t\tparent = node;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\tcase \"#endif\":\r\n\t\t\t\t\t\tparent = parent.parent;\r\n\t\t\t\t\t\tpreNode = parent.childs[parent.childs.length - 1];\r\n\t\t\t\t\t\tnode.noCompile = preNode.noCompile;\r\n\t\t\t\t\t\tif (!node.noCompile) {\r\n\t\t\t\t\t\t\tnode.text = \"//\" + node.text;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnode.setParent(parent);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\tcase \"#include\"://这里有问题,主要是空格\r\n\t\t\t\t\t\twords = ShaderCompile.splitToWords(text, null);\r\n\t\t\t\t\t\tvar inlcudeFile: InlcudeFile = ShaderCompile.includes[words[1]];\r\n\t\t\t\t\t\tif (!inlcudeFile) {\r\n\t\t\t\t\t\t\tthrow \"ShaderCompile error no this include file:\" + words[1];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ((ofs = words[0].indexOf(\"?\")) < 0) {\r\n\t\t\t\t\t\t\tnode.setParent(parent);\r\n\t\t\t\t\t\t\ttext = inlcudeFile.getWith(words[2] == 'with' ? words[3] : null);\r\n\t\t\t\t\t\t\tthis._compileToTree(node, text.split('\\n'), 0, includefiles, defs);\r\n\t\t\t\t\t\t\tnode.text = \"\";\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnode.setCondition(words[0].substr(ofs + 1), ShaderCompile.IFDEF_YES);\r\n\t\t\t\t\t\tnode.text = inlcudeFile.getWith(words[2] == 'with' ? words[3] : null);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"#import\":\r\n\t\t\t\t\t\twords = ShaderCompile.splitToWords(text, null);\r\n\t\t\t\t\t\tfname = words[1];\r\n\t\t\t\t\t\tincludefiles.push({ node: node, file: ShaderCompile.includes[fname], ofs: node.text.length });\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tpreNode = parent.childs[parent.childs.length - 1];\r\n\t\t\t\tif (preNode && !preNode.name) {\r\n\t\t\t\t\tincludefiles.length > 0 && ShaderCompile.splitToWords(text, preNode);\r\n\t\t\t\t\tnoUseNode = node;\r\n\t\t\t\t\tpreNode.text += \"\\n\" + text;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tincludefiles.length > 0 && ShaderCompile.splitToWords(text, node);\r\n\t\t\t}\r\n\t\t\tnode.setParent(parent);\r\n\t\t}\r\n\t}\r\n\r\n\tcreateShader(define: any, shaderName: any, createShader: Function, bindAttrib: any[]): Shader {\r\n\t\tvar defMap: any = {};\r\n\t\tvar defineStr: string = \"\";\r\n\t\tif (define) {\r\n\t\t\tfor (var i in define) {\r\n\t\t\t\tdefineStr += \"#define \" + i + \"\\n\";\r\n\t\t\t\tdefMap[i] = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar vs: any[] = this._VS.toscript(defMap, []);\r\n\t\tvar ps: any[] = this._PS.toscript(defMap, []);\r\n\t\treturn ((<Function>createShader) || (<Function>Shader.create))(defineStr + vs.join('\\n'), defineStr + ps.join('\\n'), shaderName, this._nameMap, bindAttrib);\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\n","import { Loader } from \"./Loader\";\r\nimport { URL } from \"./URL\";\r\nimport { EventDispatcher } from \"../events/EventDispatcher\"\r\nimport { Texture2D } from \"../resource/Texture2D\"\r\n\r\n/**\r\n * @private\r\n * Worker Image加载器\r\n */\r\nexport class WorkerLoader extends EventDispatcher {\r\n\r\n    /**单例*/\r\n    static I: WorkerLoader;\r\n    /**worker.js的路径 */\r\n    static workerPath: string = \"libs/workerloader.js\";\r\n\r\n    /**@private */\r\n    private static _preLoadFun: Function;\r\n    /**@private */\r\n    private static _enable: boolean = false;\r\n    /**@private */\r\n    private static _tryEnabled: boolean = false;\r\n\r\n    /**使用的Worker对象。*/\r\n    worker: Worker;\r\n    /**@private */\r\n    protected _useWorkerLoader: boolean;\r\n\r\n    constructor() {\r\n        super();\r\n        this.worker = new Worker(WorkerLoader.workerPath);\r\n        let me = this;\r\n        this.worker.onmessage = function (evt: any): void {\r\n            //接收worker传过来的数据函数\r\n            me.workerMessage(evt.data);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * 尝试使用Work加载Image\r\n     * @return 是否启动成功\r\n     */\r\n    static __init__(): boolean {\r\n        if (WorkerLoader._preLoadFun != null) return false;\r\n        if (!Worker) return false;\r\n        WorkerLoader._preLoadFun = Loader[\"prototype\"][\"_loadImage\"];\r\n        Loader[\"prototype\"][\"_loadImage\"] = WorkerLoader[\"prototype\"][\"_loadImage\"];\r\n        if (!WorkerLoader.I) WorkerLoader.I = new WorkerLoader();\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * 是否支持worker\r\n     * @return 是否支持worker\r\n     */\r\n    static workerSupported(): boolean {\r\n        return Worker ? true : false;\r\n    }\r\n\r\n    /**\r\n     * 尝试启用WorkerLoader,只有第一次调用有效\r\n     */\r\n    static enableWorkerLoader(): void {\r\n        if (!WorkerLoader._tryEnabled) {\r\n            WorkerLoader.enable = true;\r\n            WorkerLoader._tryEnabled = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 是否启用。\r\n     */\r\n    static set enable(value: boolean) {\r\n        if (WorkerLoader._enable != value) {\r\n            WorkerLoader._enable = value;\r\n            if (value && WorkerLoader._preLoadFun == null) WorkerLoader._enable = WorkerLoader.__init__();\r\n        }\r\n    }\r\n\r\n    static get enable(): boolean {\r\n        return WorkerLoader._enable;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private workerMessage(data: any): void {\r\n        if (data) {\r\n            switch (data.type) {\r\n                case \"Image\":\r\n                    this.imageLoaded(data);\r\n                    break;\r\n                case \"Disable\":\r\n                    WorkerLoader.enable = false;\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    private imageLoaded(data: any): void {\r\n        if (!data.dataType || data.dataType != \"imageBitmap\") {\r\n            this.event(data.url, null);\r\n            return;\r\n        }\r\n\r\n        var imageData: ImageBitmap = data.imageBitmap;// imageBitmap\r\n        console.log(\"load:\", data.url);\r\n        //canvas = tex;\r\n        this.event(data.url, imageData);\r\n\r\n    }\r\n\r\n    /**\r\n     * 加载图片\r\n     * @param\turl 图片地址\r\n     */\r\n    loadImage(url: string): void {\r\n        this.worker.postMessage(url);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 加载图片资源。\r\n     * @param\turl 资源地址。\r\n     */\r\n    protected _loadImage(url: string): void {\r\n        var _this: Loader = (<Loader>(this as any));\r\n        let type = _this.type;\r\n        if (!this._useWorkerLoader || !WorkerLoader._enable) {\r\n            WorkerLoader._preLoadFun.call(_this, url);\r\n            return;\r\n        }\r\n        url = URL.formatURL(url);\r\n        function clear(): void {\r\n            WorkerLoader.I.off(url, _this, onload);\r\n        }\r\n\r\n        var onload: Function = function (imageData: any): void {\r\n            clear();\r\n            if (imageData) {\r\n                var image:any = imageData;\r\n                if (type !== \"nativeimage\") {\r\n                    image = new Texture2D();\r\n                    image.loadImageSource(imageData);\r\n                }\r\n                \r\n                _this[\"onLoaded\"](image);\r\n            } else {\r\n                //失败之后使用原版的加载函数加载重试\r\n                WorkerLoader._preLoadFun.call(_this, url);\r\n            }\r\n        };\r\n        WorkerLoader.I.on(url, _this, onload);\r\n        WorkerLoader.I.loadImage(url);\r\n    }\r\n}\r\n\r\n","import { Browser } from \"./Browser\";\r\n/**\r\n\t * <code>Mouse</code> 类用于控制鼠标光标样式。\r\n\t */\r\nexport class Mouse {\r\n    /**@private */\r\n    private static _style: any;\r\n    /**@private */\r\n    private static _preCursor: string;\r\n\r\n    /**\r\n     * 设置鼠标样式\r\n     * @param cursorStr\r\n     * 例如auto move no-drop col-resize\r\n     * all-scroll pointer not-allowed row-resize\r\n     * crosshair progress e-resize ne-resize\r\n     * default text n-resize nw-resize\r\n     * help vertical-text s-resize se-resize\r\n     * inherit wait w-resize sw-resize\r\n     */\r\n    static set cursor(cursorStr: string) {\r\n        Mouse._style.cursor = cursorStr;\r\n    }\r\n\r\n    static get cursor(): string {\r\n        return Mouse._style.cursor;\r\n    }\r\n\r\n    /**@internal */\r\n    static __init__(): any {\r\n        Mouse._style = Browser.document.body.style;\r\n    }\r\n\r\n    /**\r\n     * 隐藏鼠标\r\n     */\r\n    static hide(): void {\r\n        if (Mouse.cursor != \"none\") {\r\n            Mouse._preCursor = Mouse.cursor;\r\n            Mouse.cursor = \"none\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 显示鼠标\r\n     */\r\n    static show(): void {\r\n        if (Mouse.cursor == \"none\") {\r\n            if (Mouse._preCursor) {\r\n                Mouse.cursor = Mouse._preCursor;\r\n            } else {\r\n                Mouse.cursor = \"auto\";\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n","import { Mesh2D } from \"./Mesh2D\";\r\nimport { LayaGL } from \"../../layagl/LayaGL\";\r\n/**\r\n * drawImage，fillRect等会用到的简单的mesh。每次添加必然是一个四边形。\r\n */\r\nexport class MeshParticle2D extends Mesh2D {\r\n    static const_stride: number = 116;\r\n    private static _fixattriInfo: any[];\r\n    private static _POOL: any[] = [];\r\n\r\n    static __init__(): void {\r\n        var gl: WebGLRenderingContext = LayaGL.instance;\r\n        MeshParticle2D._fixattriInfo = [gl.FLOAT, 4, 0,\t//CornerTextureCoordinate\r\n        gl.FLOAT, 3, 16,//pos\r\n        gl.FLOAT, 3, 28,//vel\r\n        gl.FLOAT, 4, 40,//start color\r\n        gl.FLOAT, 4, 56,//end color\r\n        gl.FLOAT, 3, 72,//size,rot\r\n        gl.FLOAT, 2, 84,//radius\r\n        gl.FLOAT, 4, 92,//radian\r\n        gl.FLOAT, 1, 108,//AgeAddScale\r\n        gl.FLOAT, 1, 112];\r\n    }\r\n\r\n    //TODO:coverage\r\n    constructor(maxNum: number) {\r\n        super(MeshParticle2D.const_stride, maxNum * 4 * MeshParticle2D.const_stride, 4);\t\t//ib 先4\r\n        this.canReuse = true;\r\n        this.setAttributes(MeshParticle2D._fixattriInfo);\r\n        this.createQuadIB(maxNum);\r\n        this._quadNum = maxNum;\r\n    }\r\n\r\n    setMaxParticleNum(maxNum: number): void {\r\n        this._vb._resizeBuffer(maxNum * 4 * MeshParticle2D.const_stride, false);\r\n        this.createQuadIB(maxNum);\r\n    }\r\n\r\n\t/**\r\n\t * \r\n\t */\r\n    //TODO:coverage\r\n    static getAMesh(maxNum: number): MeshParticle2D {\r\n        //console.log('getmesh');\r\n        if (MeshParticle2D._POOL.length) {\r\n            var ret: MeshParticle2D = MeshParticle2D._POOL.pop();\r\n            ret.setMaxParticleNum(maxNum);\r\n            return ret;\r\n        }\r\n        return new MeshParticle2D(maxNum);\r\n    }\r\n\r\n\t\t/**\r\n\t\t * 把本对象放到回收池中，以便getMesh能用。\r\n\t\t * @override\r\n\t\t */\r\n\t\t//TODO:coverage\r\n\t\t /*override*/ releaseMesh(): void {\r\n        ;\r\n        this._vb.setByteLength(0);\r\n        this.vertNum = 0;\r\n        this.indexNum = 0;\r\n        //_applied = false;\r\n        MeshParticle2D._POOL.push(this);\r\n    }\r\n\r\n\t\t//TODO:coverage\r\n\t\t/**\r\n\t\t * @override\r\n\t\t */\r\n\t\t /*override*/ destroy(): void {\r\n        this._ib.destroy();\r\n        this._vb.destroy();\r\n        this._vb.deleteBuffer();\r\n        //ib用deletebuffer么\r\n    }\r\n}\r\n\r\n","import { Bitmap } from \"./Bitmap\";\r\nimport { Texture2D } from \"./Texture2D\";\r\nimport { BaseTexture } from \"./BaseTexture\";\r\nimport { WarpMode } from \"./WrapMode\";\r\n\r\n/**\r\n * @private\r\n * <p> <code>HTMLImage</code> 用于创建 HTML Image 元素。</p>\r\n * <p>请使用 <code>HTMLImage.create()<code>获取新实例，不要直接使用 <code>new HTMLImage<code> 。</p>\r\n */\r\nexport class HTMLImage extends Bitmap {\r\n\r\n    /**\r\n     * <p><b>不支持canvas了，所以备Texture2D替换了</p>\r\n     * <p>创建一个 <code>HTMLImage</code> 实例。</p>\r\n     * <p>请使用 <code>HTMLImage.create()<code>创建实例，不要直接使用 <code>new HTMLImage<code> 。</p>\r\n     *\r\n     */\r\n    static create: Function = function (width: number, height: number, format: number): Bitmap {\r\n        var tex: Texture2D = new Texture2D(width, height, format, false, false);\r\n        tex.wrapModeU = WarpMode.Clamp;\r\n        tex.wrapModeV = WarpMode.Clamp;\r\n        return tex;\r\n    }\r\n}\r\n\r\n","﻿import { ILaya } from \"./ILaya\";\r\nimport { Graphics } from \"./laya/display/Graphics\";\r\nimport { GraphicsBounds } from \"./laya/display/GraphicsBounds\";\r\nimport { Input } from \"./laya/display/Input\";\r\nimport { Node } from \"./laya/display/Node\";\r\nimport { Sprite } from \"./laya/display/Sprite\";\r\nimport { Stage } from \"./laya/display/Stage\";\r\nimport { Text } from \"./laya/display/Text\";\r\nimport { KeyBoardManager } from \"./laya/events/KeyBoardManager\";\r\nimport { MouseManager } from \"./laya/events/MouseManager\";\r\nimport { LayaGL } from \"./laya/layagl/LayaGL\";\r\nimport { LayaGLRunner } from \"./laya/layagl/LayaGLRunner\";\r\nimport { AudioSound } from \"./laya/media/h5audio/AudioSound\";\r\nimport { SoundManager } from \"./laya/media/SoundManager\";\r\nimport { WebAudioSound } from \"./laya/media/webaudio/WebAudioSound\";\r\nimport { Loader } from \"./laya/net/Loader\";\r\nimport { LoaderManager } from \"./laya/net/LoaderManager\";\r\nimport { LocalStorage } from \"./laya/net/LocalStorage\";\r\nimport { TTFLoader } from \"./laya/net/TTFLoader\";\r\nimport { URL } from \"./laya/net/URL\";\r\nimport { Render } from \"./laya/renders/Render\";\r\nimport { RenderSprite } from \"./laya/renders/RenderSprite\";\r\nimport { Context } from \"./laya/resource/Context\";\r\nimport { HTMLCanvas } from \"./laya/resource/HTMLCanvas\";\r\nimport { RenderTexture2D } from \"./laya/resource/RenderTexture2D\";\r\nimport { Resource } from \"./laya/resource/Resource\";\r\nimport { Texture } from \"./laya/resource/Texture\";\r\nimport { Browser } from \"./laya/utils/Browser\";\r\nimport { CacheManger } from \"./laya/utils/CacheManger\";\r\nimport { ClassUtils } from \"./laya/utils/ClassUtils\";\r\nimport { ColorUtils } from \"./laya/utils/ColorUtils\";\r\nimport { Dragging } from \"./laya/utils/Dragging\";\r\nimport { Pool } from \"./laya/utils/Pool\";\r\nimport { SceneUtils } from \"./laya/utils/SceneUtils\";\r\nimport { Stat } from \"./laya/utils/Stat\";\r\nimport { StatUI } from \"./laya/utils/StatUI\";\r\nimport { Timer } from \"./laya/utils/Timer\";\r\nimport { Utils } from \"./laya/utils/Utils\";\r\nimport { WeakObject } from \"./laya/utils/WeakObject\";\r\nimport { ShaderDefines2D } from \"./laya/webgl/shader/d2/ShaderDefines2D\";\r\nimport { SkinSV } from \"./laya/webgl/shader/d2/skinAnishader/SkinSV\";\r\nimport { PrimitiveSV } from \"./laya/webgl/shader/d2/value/PrimitiveSV\";\r\nimport { TextureSV } from \"./laya/webgl/shader/d2/value/TextureSV\";\r\nimport { Value2D } from \"./laya/webgl/shader/d2/value/Value2D\";\r\nimport { Shader } from \"./laya/webgl/shader/Shader\";\r\nimport { Submit } from \"./laya/webgl/submit/Submit\";\r\nimport { TextRender } from \"./laya/webgl/text/TextRender\";\r\nimport { RenderState2D } from \"./laya/webgl/utils/RenderState2D\";\r\nimport { ShaderCompile } from \"./laya/webgl/utils/ShaderCompile\";\r\nimport { WebGL } from \"./laya/webgl/WebGL\";\r\nimport { WebGLContext } from \"./laya/webgl/WebGLContext\";\r\nimport { WorkerLoader } from \"./laya/net/WorkerLoader\";\r\nimport { Mouse } from \"./laya/utils/Mouse\";\r\nimport { MeshVG } from \"./laya/webgl/utils/MeshVG\";\r\nimport { MeshParticle2D } from \"./laya/webgl/utils/MeshParticle2D\";\r\nimport { MeshQuadTexture } from \"./laya/webgl/utils/MeshQuadTexture\";\r\nimport { MeshTexture } from \"./laya/webgl/utils/MeshTexture\";\r\nimport { SoundChannel } from \"./laya/media/SoundChannel\";\r\nimport { EventDispatcher } from \"./laya/events/EventDispatcher\";\r\nimport { Handler } from \"./laya/utils/Handler\";\r\nimport { RunDriver } from \"./laya/utils/RunDriver\";\r\nimport { Matrix } from \"./laya/maths/Matrix\";\r\nimport { HTMLImage } from \"./laya/resource/HTMLImage\";\r\nimport { Event } from \"./laya/events/Event\";\r\nimport { Config } from \"./Config\";\r\n\r\n/**\r\n * <code>Laya</code> 是全局对象的引用入口集。\r\n * Laya类引用了一些常用的全局对象，比如Laya.stage：舞台，Laya.timer：时间管理器，Laya.loader：加载管理器，使用时注意大小写。\r\n */\r\nexport class Laya {\r\n\t/*[COMPILER OPTIONS:normal]*/\r\n\t/** 舞台对象的引用。*/\r\n\tstatic stage: Stage = null;\r\n\r\n\t/**@private 系统时钟管理器，引擎内部使用*/\r\n\tstatic systemTimer: Timer = null;\r\n\t/**@private 组件的start时钟管理器*/\r\n\tstatic startTimer: Timer = null;\r\n\t/**@private 组件的物理时钟管理器*/\r\n\tstatic physicsTimer: Timer = null;\r\n\t/**@private 组件的update时钟管理器*/\r\n\tstatic updateTimer: Timer = null;\r\n\t/**@private 组件的lateUpdate时钟管理器*/\r\n\tstatic lateTimer: Timer = null;\r\n\t/**游戏主时针，同时也是管理场景，动画，缓动等效果时钟，通过控制本时针缩放，达到快进慢播效果*/\r\n\tstatic timer: Timer = null;\r\n\t/** 加载管理器的引用。*/\r\n\tstatic loader: LoaderManager = null;\r\n\t/** 当前引擎版本。*/\r\n\r\n\tstatic version: string = \"2.7.1\";\r\n\r\n\t/**@private Render 类的引用。*/\r\n\tstatic render: Render;\r\n\t/**@internal */\r\n\tprivate static _isinit: boolean = false;\r\n\t/**是否是微信小游戏子域，默认为false**/\r\n\tstatic isWXOpenDataContext: boolean = false;\r\n\t/**微信小游戏是否需要在主域中自动将加载的文本数据自动传递到子域，默认 false**/\r\n\tstatic isWXPosMsg: boolean = false;\r\n\r\n\t/**@internal*/\r\n\tstatic __classmap: Object = null;\r\n\r\n\t/**@internal*/\r\n\tstatic Config = Config;    //这种写法是为了防止被混淆掉，不能用其他技巧，例如 assin({Config,Stage,...})\r\n\t/**@internal*/\r\n\tstatic TextRender = TextRender;\r\n\t/**@internal*/\r\n\tstatic EventDispatcher = EventDispatcher;\r\n\t/**@internal*/\r\n\tstatic SoundChannel = SoundChannel;\r\n\t/**@internal*/\r\n\tstatic Stage = Stage;\r\n\t/**@internal*/\r\n\tstatic Render = Render;\r\n\t/**@internal*/\r\n\tstatic Browser = Browser;\r\n\t/**@internal*/\r\n\tstatic Sprite = Sprite;\r\n\t/**@internal*/\r\n\tstatic Node = Node;\r\n\t/**@internal*/\r\n\tstatic Context = Context;\r\n\t/**@internal*/\r\n\tstatic WebGL = WebGL;\r\n\t/**@internal*/\r\n\tstatic Handler = Handler;\r\n\t/**@internal*/\r\n\tstatic RunDriver = RunDriver;\r\n\t/**@internal*/\r\n\tstatic Utils = Utils;\r\n\t/**@internal*/\r\n\tstatic Input = Input;\r\n\t/**@internal*/\r\n\tstatic Loader = Loader;\r\n\t/**@internal*/\r\n\tstatic LocalStorage = LocalStorage;\r\n\t/**@internal*/\r\n\tstatic SoundManager = SoundManager;\r\n\t/**@internal*/\r\n\tstatic URL = URL;\r\n\t/**@internal*/\r\n\tstatic Event = Event;\r\n\t/**@internal*/\r\n\tstatic Matrix = Matrix;\r\n\t/**@internal*/\r\n\tstatic HTMLImage = HTMLImage;\r\n\t/**@internal*/\r\n\tstatic Laya = Laya;\r\n\r\n\t/**\r\n\t * 兼容as3编译工具 \r\n\t */\r\n\tstatic __init(_classs: any[]): void {\r\n\t\t_classs.forEach(function (o) { o.__init$ && o.__init$(); });\r\n\t}\r\n\r\n\t/**\r\n\t * 初始化引擎。使用引擎需要先初始化引擎，否则可能会报错。\r\n\t * @param\twidth 初始化的游戏窗口宽度，又称设计宽度。\r\n\t * @param\theight\t初始化的游戏窗口高度，又称设计高度。\r\n\t * @param\tplugins 插件列表，比如 WebGL（使用WebGL方式渲染）。\r\n\t * @return\t返回原生canvas引用，方便对canvas属性进行修改\r\n\t */\r\n\tstatic init(width: number, height: number, ...plugins): any {\r\n\t\tif (Laya._isinit) return;\r\n\t\tLaya._isinit = true;\r\n\t\tArrayBuffer.prototype.slice || (ArrayBuffer.prototype.slice = Laya._arrayBufferSlice);\r\n\t\tBrowser.__init__();\r\n\r\n\t\t// 创建主画布\r\n\t\t//这个其实在Render中感觉更合理，但是runtime要求第一个canvas是主画布，所以必须在下面的那个离线画布之前\r\n\t\tvar mainCanv = Browser.mainCanvas = new HTMLCanvas(true);\r\n\t\t//Render._mainCanvas = mainCanv;\r\n\t\tvar style: any = mainCanv.source.style;\r\n\t\tstyle.position = 'absolute';\r\n\t\tstyle.top = style.left = \"0px\";\r\n\t\tstyle.background = \"#000000\";\r\n\r\n\t\tif (!Browser.onKGMiniGame && !Browser.onAlipayMiniGame) {\r\n\t\t\tBrowser.container.appendChild(mainCanv.source);//xiaosong add\r\n\t\t}\r\n\r\n\t\t// 创建离屏画布\r\n\t\t//创建离线画布\r\n\t\tBrowser.canvas = new HTMLCanvas(true);\r\n\t\tBrowser.context = <CanvasRenderingContext2D>(Browser.canvas.getContext('2d') as any);\r\n\r\n\t\tBrowser.supportWebAudio = SoundManager.__init__();;\r\n\t\tBrowser.supportLocalStorage = LocalStorage.__init__();\r\n\r\n\t\t//temp TODO 以后分包\r\n\t\tLaya.systemTimer = new Timer(false);\r\n\t\tsystemTimer = Timer.gSysTimer = Laya.systemTimer;\r\n\t\tLaya.startTimer = new Timer(false);\r\n\t\tLaya.physicsTimer = new Timer(false);\r\n\t\tLaya.updateTimer = new Timer(false);\r\n\t\tLaya.lateTimer = new Timer(false);\r\n\t\tLaya.timer = new Timer(false);\r\n\r\n\t\tstartTimer = ILaya.startTimer = Laya.startTimer;\r\n\t\tlateTimer = ILaya.lateTimer = Laya.lateTimer;\r\n\t\tupdateTimer = ILaya.updateTimer = Laya.updateTimer;\r\n\t\tILaya.systemTimer = Laya.systemTimer;\r\n\t\ttimer = ILaya.timer = Laya.timer;\r\n\t\tphysicsTimer = ILaya.physicsTimer = Laya.physicsTimer;\r\n\r\n\t\tLaya.loader = new LoaderManager();\r\n\t\tILaya.Laya = Laya;\r\n\t\tloader = ILaya.loader = Laya.loader;\r\n\r\n\t\tWeakObject.__init__();\r\n\t\tSceneUtils.__init();\r\n\t\tMouse.__init__();\r\n\r\n\t\tWebGL.inner_enable();\r\n\t\tif (plugins) {\r\n\t\t\tfor (var i = 0, n = plugins.length; i < n; i++) {\r\n\t\t\t\tif (plugins[i] && plugins[i].enable) {\r\n\t\t\t\t\tplugins[i].enable();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (ILaya.Render.isConchApp) {\r\n\t\t\tLaya.enableNative();\r\n\t\t}\r\n\t\tLaya.enableWebGLPlus();\r\n\t\tCacheManger.beginCheck();\r\n\t\tstage = Laya.stage = new Stage();\r\n\t\tILaya.stage = Laya.stage;\r\n\t\tUtils.gStage = Laya.stage;\r\n\t\tURL.rootPath = URL._basePath = Laya._getUrlPath();\r\n\t\tMeshQuadTexture.__int__();\r\n\t\tMeshVG.__init__();\r\n\t\tMeshTexture.__init__();\r\n\t\tLaya.render = new Render(0, 0, Browser.mainCanvas);\r\n\t\trender = Laya.render;\r\n\t\tLaya.stage.size(width, height);\r\n\t\t((<any>window)).stage = Laya.stage;\r\n\r\n\t\tWebGLContext.__init__();\r\n\t\tMeshParticle2D.__init__();\r\n\t\tShaderCompile.__init__();\r\n\t\tRenderSprite.__init__();\r\n\t\tKeyBoardManager.__init__();\r\n\t\tMouseManager.instance.__init__(Laya.stage, Render.canvas);\r\n\t\tInput.__init__();\r\n\t\tSoundManager.autoStopMusic = true;\r\n\t\tStat._StatRender = new StatUI();\r\n\r\n\t\tValue2D._initone(ShaderDefines2D.TEXTURE2D, TextureSV);\r\n\t\tValue2D._initone(ShaderDefines2D.TEXTURE2D | ShaderDefines2D.FILTERGLOW, TextureSV);\r\n\t\tValue2D._initone(ShaderDefines2D.PRIMITIVE, PrimitiveSV);\r\n\t\tValue2D._initone(ShaderDefines2D.SKINMESH, SkinSV);\r\n\r\n\t\treturn Render.canvas;\r\n\t}\r\n\r\n\t/**@internal */\r\n\tstatic _getUrlPath(): string {//不再需要特殊处理file的路径\r\n\t\treturn URL.getPath(location.protocol + \"//\" + location.host + location.pathname);\r\n\t}\r\n\r\n\t/**@internal */\r\n\tstatic _arrayBufferSlice(start: number, end: number): ArrayBuffer {\r\n\t\tvar arr: any = this;\r\n\t\tvar arrU8List: Uint8Array = new Uint8Array(arr, start, end - start);\r\n\t\tvar newU8List: Uint8Array = new Uint8Array(arrU8List.length);\r\n\t\tnewU8List.set(arrU8List);\r\n\t\treturn newU8List.buffer;\r\n\t}\r\n\r\n\t/**\r\n\t * 表示是否捕获全局错误并弹出提示。默认为false。\r\n\t * 适用于移动设备等不方便调试的时候，设置为true后，如有未知错误，可以弹窗抛出详细错误堆栈。\r\n\t */\r\n\tstatic alertGlobalError(value: boolean) {\r\n\t\tvar erralert: number = 0;\r\n\t\tif (value) {\r\n\t\t\tBrowser.window.onerror = function (msg: string, url: string, line: string, column: string, detail: any): void {\r\n\t\t\t\tif (erralert++ < 5 && detail)\r\n\t\t\t\t\tthis.alert(\"出错啦，请把此信息截图给研发商\\n\" + msg + \"\\n\" + detail.stack);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tBrowser.window.onerror = null;\r\n\t\t}\r\n\t}\r\n\t/**@internal */\r\n\tprivate static _evcode: string = \"eva\" + \"l\";\r\n\r\n\t/**@internal */\r\n\tstatic _runScript(script: string): any {\r\n\t\treturn Browser.window[Laya._evcode](script);\r\n\t}\r\n\r\n\t/**\r\n\t * 开启DebugPanel\r\n\t * @param\tdebugJsPath laya.debugtool.js文件路径\r\n\t */\r\n\tstatic enableDebugPanel(debugJsPath: string = \"libs/laya.debugtool.js\"): void {\r\n\t\tif (!window['Laya'][\"DebugPanel\"]) {\r\n\t\t\tvar script: any = Browser.createElement(\"script\");\r\n\t\t\tscript.onload = function (): void {\r\n\t\t\t\twindow['Laya'][\"DebugPanel\"].enable();\r\n\t\t\t}\r\n\t\t\tscript.src = debugJsPath;\r\n\t\t\tBrowser.document.body.appendChild(script);\r\n\t\t} else {\r\n\t\t\twindow['Laya'][\"DebugPanel\"].enable();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static isNativeRender_enable: boolean = false;\r\n\t/**@private */\r\n\tprivate static enableWebGLPlus(): void {\r\n\t\tWebGLContext.__init_native();\r\n\t}\r\n\t/**@private */\r\n\tprivate static enableNative(): void {\r\n\t\tif (Laya.isNativeRender_enable)\r\n\t\t\treturn;\r\n\t\tLaya.isNativeRender_enable = true;\r\n\t\tif (Render.supportWebGLPlusRendering) {\r\n\t\t\tShader.prototype.uploadTexture2D = function (value: any): void {\r\n\t\t\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\t\t\tgl.bindTexture(gl.TEXTURE_2D, (<WebGLTexture>value));\r\n\t\t\t}\r\n\t\t}\r\n\t\tRenderState2D.width = Browser.window.innerWidth;\r\n\t\tRenderState2D.height = Browser.window.innerHeight;\r\n\t\tBrowser.measureText = function (txt: string, font: string): any {\r\n\t\t\twindow[\"conchTextCanvas\"].font = font;\r\n\t\t\treturn window[\"conchTextCanvas\"].measureText(txt);\r\n\t\t}\r\n\r\n\t\tStage.clear = function (color: string): void {\r\n\t\t\tContext.set2DRenderConfig();//渲染2D前要还原2D状态,否则可能受3D影响\r\n\t\t\tvar c: any[] = ColorUtils.create(color).arrColor;\r\n\t\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\t\tif (c) gl.clearColor(c[0], c[1], c[2], c[3]);\r\n\t\t\tgl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT | gl.STENCIL_BUFFER_BIT);\r\n\t\t\tRenderState2D.clear();\r\n\t\t}\r\n\t\tSprite.drawToCanvas = Sprite.drawToTexture = function (sprite: Sprite, _renderType: number, canvasWidth: number, canvasHeight: number, offsetX: number, offsetY: number): any {\r\n\t\t\toffsetX -= sprite.x;\r\n\t\t\toffsetY -= sprite.y;\r\n\t\t\toffsetX |= 0;\r\n\t\t\toffsetY |= 0;\r\n\t\t\tcanvasWidth |= 0;\r\n\t\t\tcanvasHeight |= 0;\r\n\r\n\t\t\tvar canv: HTMLCanvas = new HTMLCanvas(false);\r\n\t\t\tvar ctx: Context = canv.getContext('2d') as Context;\r\n\t\t\tcanv.size(canvasWidth, canvasHeight);\r\n\r\n\t\t\tctx.asBitmap = true;\r\n\t\t\tctx._targets.start();\r\n\t\t\tRenderSprite.renders[_renderType]._fun(sprite, ctx, offsetX, offsetY);\r\n\t\t\tctx.flush();\r\n\t\t\tctx._targets.end();\r\n\t\t\tctx._targets.restore();\r\n\t\t\treturn canv;\r\n\t\t}\r\n\t\t//RenderTexture2D.prototype._uv = RenderTexture2D.flipyuv;\r\n\t\tObject[\"defineProperty\"](RenderTexture2D.prototype, \"uv\", {\r\n\t\t\t\"get\": function (): any {\r\n\t\t\t\treturn this._uv;\r\n\t\t\t},\r\n\t\t\t\"set\": function (v: any): void {\r\n\t\t\t\tthis._uv = v;\r\n\t\t\t}\r\n\t\t}\r\n\t\t);\r\n\t\tHTMLCanvas.prototype.getTexture = function (): Texture {\r\n\t\t\tif (!this._texture) {\r\n\t\t\t\tthis._texture = this.context._targets;\r\n\t\t\t\tthis._texture.uv = RenderTexture2D.flipyuv;\r\n\t\t\t\tthis._texture.bitmap = this._texture;\r\n\t\t\t}\r\n\t\t\treturn this._texture;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nLaya.__classmap = ILaya.__classMap;\r\nILaya.Timer = Timer;\r\nILaya.Dragging = Dragging;\r\nILaya.GraphicsBounds = GraphicsBounds;\r\nILaya.Sprite = Sprite;\r\nILaya.TextRender = TextRender;\r\nILaya.Loader = Loader;\r\nILaya.TTFLoader = TTFLoader;\r\nILaya.WebAudioSound = WebAudioSound;\r\nILaya.SoundManager = SoundManager;\r\nILaya.ShaderCompile = ShaderCompile;\r\nILaya.ClassUtils = ClassUtils;\r\nILaya.SceneUtils = SceneUtils;\r\nILaya.Context = Context;\r\nILaya.Render = Render;\r\nILaya.MouseManager = MouseManager;\r\nILaya.Text = Text;\r\nILaya.Browser = Browser;\r\nILaya.WebGL = WebGL;\r\nILaya.AudioSound = AudioSound;\r\nILaya.Pool = Pool;\r\nILaya.Utils = Utils;\r\nILaya.Graphics = Graphics;\r\nILaya.Submit = Submit;\r\nILaya.Stage = Stage;\r\nILaya.Resource = Resource;\r\nILaya.WorkerLoader = WorkerLoader;\r\n\r\n\r\n//初始化引擎库\r\nvar libs: any[] = (window as any)._layalibs;\r\nif (libs) {\r\n\tlibs.sort(function (a: any, b: any): number {\r\n\t\treturn a.i - b.i;\r\n\t});\r\n\tfor (var j: number = 0; j < libs.length; j++) {\r\n\t\tlibs[j].f(window, window.document, Laya);\r\n\t}\r\n}\r\n\r\nlet win = window as any;\r\nif (win.Laya) {\r\n\twin.Laya.Laya = Laya;\r\n\tObject.assign(win.Laya, Laya);\r\n} else\r\n\twin.Laya = Laya;\r\n\r\n/**@internal */\r\nexport var __init = Laya.__init;\r\n/**@internal */\r\nexport var init = Laya.init;\r\n/**@internal */\r\nexport var stage: Stage;\r\n/**@internal */\r\nexport var systemTimer: Timer;\r\n/**@internal */\r\nexport var startTimer: Timer;\r\n/**@internal */\r\nexport var physicsTimer: Timer;\r\n/**@internal */\r\nexport var updateTimer: Timer;\r\n/**@internal */\r\nexport var lateTimer: Timer;\r\n/**@internal */\r\nexport var timer: Timer;\r\n/**@internal */\r\nexport var loader: LoaderManager;\r\n/**@internal */\r\nexport var version = Laya.version;\r\n/**@internal */\r\nexport var render: Render;\r\n/**@internal */\r\nexport var isWXOpenDataContext: boolean;\r\n/**@internal */\r\nexport var isWXPosMsg: boolean;\r\n/**@internal */\r\nexport var alertGlobalError = Laya.alertGlobalError;\r\n/**@internal */\r\nexport var enableDebugPanel = Laya.enableDebugPanel;\r\n\r\nexport function _static(_class: any, def: any) {\r\n\tfor (var i = 0, sz = def.length; i < sz; i += 2) {\r\n\t\tif (def[i] == 'length')\r\n\t\t\t_class.length = def[i + 1].call(_class);\r\n\t\telse {\r\n\t\t\tfunction tmp() {\r\n\t\t\t\tvar name = def[i];\r\n\t\t\t\tvar getfn = def[i + 1];\r\n\t\t\t\tObject.defineProperty(_class, name, {\r\n\t\t\t\t\tget: function () { delete this[name]; return this[name] = getfn.call(this); },\r\n\t\t\t\t\tset: function (v) { delete this[name]; this[name] = v; }, enumerable: true, configurable: true\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\ttmp();\r\n\t\t}\r\n\t}\r\n}\r\n","import { Component } from \"./Component\";\r\n/**\r\n * <code>CommonScript</code> 类用于创建公共脚本类。\r\n */\r\nexport class CommonScript extends Component {\r\n\r\n\t/**\r\n\t * @inheritDoc\r\n\t * @override\r\n\t */\r\n\tget isSingleton(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 创建后只执行一次\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonAwake(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 每次启动后执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonEnable(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 第一次执行update之前执行，只会执行一次\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonStart(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 每帧更新时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonUpdate(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 每帧更新时执行，在update之后执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonLateUpdate(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 禁用时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonDisable(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 销毁时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonDestroy(): void {\r\n\r\n\t}\r\n\r\n}\r\n\r\n\r\n","import { Component } from \"./Component\";\r\nimport { Event } from \"../events/Event\"\r\nimport { ILaya } from \"../../ILaya\";\r\n\r\n/**\r\n * <code>Script</code> 类用于创建脚本的父类，该类为抽象类，不允许实例。\r\n * 组件的生命周期\r\n */\r\nexport class Script extends Component {\r\n\t/**\r\n\t * @inheritDoc\r\n\t * @override\r\n\t */\r\n\tget isSingleton(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t * @inheritDoc\r\n\t * @override\r\n\t */\r\n\t_onAwake(): void {\r\n\t\tthis.onAwake();\r\n\t\tif (this.onStart !== Script.prototype.onStart) {\r\n\t\t\tILaya.startTimer.callLater(this, this.onStart);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t * @inheritDoc\r\n\t * @override\r\n\t */\r\n\t_onEnable(): void {\r\n\t\tvar proto: any = Script.prototype;\r\n\t\tif (this.onTriggerEnter !== proto.onTriggerEnter) {\r\n\t\t\tthis.owner.on(Event.TRIGGER_ENTER, this, this.onTriggerEnter);\r\n\t\t}\r\n\t\tif (this.onTriggerStay !== proto.onTriggerStay) {\r\n\t\t\tthis.owner.on(Event.TRIGGER_STAY, this, this.onTriggerStay);\r\n\t\t}\r\n\t\tif (this.onTriggerExit !== proto.onTriggerExit) {\r\n\t\t\tthis.owner.on(Event.TRIGGER_EXIT, this, this.onTriggerExit);\r\n\t\t}\r\n\r\n\t\tif (this.onMouseDown !== proto.onMouseDown) {\r\n\t\t\tthis.owner.on(Event.MOUSE_DOWN, this, this.onMouseDown);\r\n\t\t}\r\n\t\tif (this.onMouseUp !== proto.onMouseUp) {\r\n\t\t\tthis.owner.on(Event.MOUSE_UP, this, this.onMouseUp);\r\n\t\t}\r\n\t\tif (this.onClick !== proto.onClick) {\r\n\t\t\tthis.owner.on(Event.CLICK, this, this.onClick);\r\n\t\t}\r\n\t\tif (this.onStageMouseDown !== proto.onStageMouseDown) {\r\n\t\t\tILaya.stage.on(Event.MOUSE_DOWN, this, this.onStageMouseDown);\r\n\t\t}\r\n\t\tif (this.onStageMouseUp !== proto.onStageMouseUp) {\r\n\t\t\tILaya.stage.on(Event.MOUSE_UP, this, this.onStageMouseUp);\r\n\t\t}\r\n\t\tif (this.onStageClick !== proto.onStageClick) {\r\n\t\t\tILaya.stage.on(Event.CLICK, this, this.onStageClick);\r\n\t\t}\r\n\t\tif (this.onStageMouseMove !== proto.onStageMouseMove) {\r\n\t\t\tILaya.stage.on(Event.MOUSE_MOVE, this, this.onStageMouseMove);\r\n\t\t}\r\n\t\tif (this.onDoubleClick !== proto.onDoubleClick) {\r\n\t\t\tthis.owner.on(Event.DOUBLE_CLICK, this, this.onDoubleClick);\r\n\t\t}\r\n\t\tif (this.onRightClick !== proto.onRightClick) {\r\n\t\t\tthis.owner.on(Event.RIGHT_CLICK, this, this.onRightClick);\r\n\t\t}\r\n\t\tif (this.onMouseMove !== proto.onMouseMove) {\r\n\t\t\tthis.owner.on(Event.MOUSE_MOVE, this, this.onMouseMove);\r\n\t\t}\r\n\t\tif (this.onMouseOver !== proto.onMouseOver) {\r\n\t\t\tthis.owner.on(Event.MOUSE_OVER, this, this.onMouseOver);\r\n\t\t}\r\n\t\tif (this.onMouseOut !== proto.onMouseOut) {\r\n\t\t\tthis.owner.on(Event.MOUSE_OUT, this, this.onMouseOut);\r\n\t\t}\r\n\t\tif (this.onKeyDown !== proto.onKeyDown) {\r\n\t\t\tILaya.stage.on(Event.KEY_DOWN, this, this.onKeyDown);\r\n\t\t}\r\n\t\tif (this.onKeyPress !== proto.onKeyPress) {\r\n\t\t\tILaya.stage.on(Event.KEY_PRESS, this, this.onKeyPress);\r\n\t\t}\r\n\t\tif (this.onKeyUp !== proto.onKeyUp) {\r\n\t\t\tILaya.stage.on(Event.KEY_UP, this, this.onKeyUp);\r\n\t\t}\r\n\t\tif (this.onUpdate !== proto.onUpdate) {\r\n\t\t\tILaya.updateTimer.frameLoop(1, this, this.onUpdate);\r\n\t\t}\r\n\t\tif (this.onLateUpdate !== proto.onLateUpdate) {\r\n\t\t\tILaya.lateTimer.frameLoop(1, this, this.onLateUpdate);\r\n\t\t}\r\n\t\tif (this.onPreRender !== proto.onPreRender) {\r\n\t\t\tILaya.lateTimer.frameLoop(1, this, this.onPreRender);\r\n\t\t}\r\n\t\tthis.onEnable();\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t * @inheritDoc\r\n\t * @override\r\n\t */\r\n\tprotected _onDisable(): void {\r\n\t\tthis.owner.offAllCaller(this);\r\n\t\tILaya.stage.offAllCaller(this);\r\n\t\tILaya.startTimer.clearAll(this);\r\n\t\tILaya.updateTimer.clearAll(this);\r\n\t\tILaya.lateTimer.clearAll(this);\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t * @override\r\n\t */\r\n\t_isScript(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t * @inheritDoc\r\n\t * @override\r\n\t */\r\n\tprotected _onDestroy(): void {\r\n\t\tthis.onDestroy();\r\n\t}\r\n\r\n\t/**\r\n\t * 组件被激活后执行，此时所有节点和组件均已创建完毕，次方法只执行一次\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonAwake(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 组件被启用后执行，比如节点被添加到舞台后\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonEnable(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 第一次执行update之前执行，只会执行一次\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonStart(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 开始碰撞时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonTriggerEnter(other: any, self: any, contact: any): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 持续碰撞时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonTriggerStay(other: any, self: any, contact: any): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 结束碰撞时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonTriggerExit(other: any, self: any, contact: any): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 鼠标按下时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonMouseDown(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 鼠标抬起时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonMouseUp(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 鼠标点击时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonClick(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 鼠标在舞台按下时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonStageMouseDown(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 鼠标在舞台抬起时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonStageMouseUp(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 鼠标在舞台点击时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonStageClick(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 鼠标在舞台移动时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonStageMouseMove(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 鼠标双击时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonDoubleClick(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 鼠标右键点击时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonRightClick(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 鼠标移动时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonMouseMove(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 鼠标经过节点时触发\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonMouseOver(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 鼠标离开节点时触发\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonMouseOut(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 键盘按下时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonKeyDown(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 键盘产生一个字符时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonKeyPress(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 键盘抬起时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonKeyUp(e: Event): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 每帧更新时执行，尽量不要在这里写大循环逻辑或者使用getComponent方法\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonUpdate(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 每帧更新时执行，在update之后执行，尽量不要在这里写大循环逻辑或者使用getComponent方法\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonLateUpdate(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 渲染之前执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonPreRender(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 渲染之后执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonPostRender(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 组件被禁用时执行，比如从节点从舞台移除后\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonDisable(): void {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 手动调用节点销毁时执行\r\n\t * 此方法为虚方法，使用时重写覆盖即可\r\n\t */\r\n\tonDestroy(): void {\r\n\r\n\t}\r\n}\r\n\r\n","import { FrameAnimation } from \"../display/FrameAnimation\"\r\nimport { Graphics } from \"../display/Graphics\"\r\nimport { Matrix } from \"../maths/Matrix\"\r\nimport { Loader } from \"../net/Loader\"\r\nimport { Texture } from \"../resource/Texture\"\r\n\r\n/**\r\n * Graphics动画解析器\r\n * @private\r\n */\r\nexport class GraphicAnimation extends FrameAnimation {\r\n    /**@private */\r\n    animationList: any[];\r\n    /**@private */\r\n    animationDic: any;\r\n    /**@private */\r\n    protected _nodeList: any[];\r\n    /**@private */\r\n    protected _nodeDefaultProps: any;\r\n    /**@private */\r\n    protected _gList: any[];\r\n    /**@private */\r\n    protected _nodeIDAniDic: any = {};\r\n\r\n    /**@private */\r\n    protected static _drawTextureCmd: any[] = [[\"skin\", null], [\"x\", 0], [\"y\", 0], [\"width\", -1], [\"height\", -1], [\"pivotX\", 0], [\"pivotY\", 0], [\"scaleX\", 1], [\"scaleY\", 1], [\"rotation\", 0], [\"alpha\", 1], [\"skewX\", 0], [\"skewY\", 0], [\"anchorX\", 0], [\"anchorY\", 0]];\r\n    /**@private */\r\n    protected static _temParam: any[] = [];\r\n    /**@private */\r\n    private static _I: GraphicAnimation;\r\n    /**@private */\r\n    private static _rootMatrix: Matrix;\r\n    /**@private */\r\n    private _rootNode: any;\r\n    /**@private */\r\n    protected _nodeGDic: any;\r\n\r\n    /**@private */\r\n    private _parseNodeList(uiView: any): void {\r\n        if (!this._nodeList) this._nodeList = [];\r\n        this._nodeDefaultProps[uiView.compId] = uiView.props;\r\n        if (uiView.compId) this._nodeList.push(uiView.compId);\r\n        var childs: any[] = uiView.child;\r\n        if (childs) {\r\n            var i: number, len: number = childs.length;\r\n            for (i = 0; i < len; i++) {\r\n                this._parseNodeList(childs[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    private _calGraphicData(aniData: any): void {\r\n        this._setUp(null, aniData);\r\n        this._createGraphicData();\r\n        if (this._nodeIDAniDic) {\r\n            var key: string;\r\n            for (key in this._nodeIDAniDic) {\r\n                this._nodeIDAniDic[key] = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    private _createGraphicData(): void {\r\n        var gList: any[] = [];\r\n        var i: number, len: number = this.count;\r\n        var animationDataNew: any[] = this._usedFrames;\r\n        if (!animationDataNew) animationDataNew = [];\r\n        var preGraphic: Graphics;\r\n        for (i = 0; i < len; i++) {\r\n            if (animationDataNew[i] || !preGraphic) {\r\n                preGraphic = this._createFrameGraphic(i);\r\n            }\r\n            gList.push(preGraphic);\r\n        }\r\n        this._gList = gList;\r\n    }\r\n\r\n    /**@private */\r\n    protected _createFrameGraphic(frame: number): any {\r\n        var g: Graphics = new Graphics();\r\n        if (!GraphicAnimation._rootMatrix) GraphicAnimation._rootMatrix = new Matrix();\r\n        this._updateNodeGraphic(this._rootNode, frame, GraphicAnimation._rootMatrix, g);\r\n        //_updateNodeGraphic2(_rootNode, frame, g);\r\n        return g;\r\n    }\r\n\r\n    protected _updateNodeGraphic(node: any, frame: number, parentTransfrom: Matrix, g: Graphics, alpha: number = 1): void {\r\n        var tNodeG: GraphicNode;\r\n        tNodeG = this._nodeGDic[node.compId] = this._getNodeGraphicData(node.compId, frame, this._nodeGDic[node.compId]);\r\n        if (!tNodeG.resultTransform)\r\n            tNodeG.resultTransform = new Matrix();\r\n        var tResultTransform: Matrix;\r\n        tResultTransform = tNodeG.resultTransform;\r\n        Matrix.mul(tNodeG.transform, parentTransfrom, tResultTransform);\r\n        var tTex: Texture;\r\n        var tGraphicAlpha: number = tNodeG.alpha * alpha;\r\n        if (tGraphicAlpha < 0.01) return;\r\n        if (tNodeG.skin) {\r\n            tTex = this._getTextureByUrl(tNodeG.skin);\r\n            if (tTex) {\r\n                if (tResultTransform._checkTransform()) {\r\n                    g.drawTexture(tTex, 0, 0, tNodeG.width, tNodeG.height, tResultTransform, tGraphicAlpha);\r\n                    tNodeG.resultTransform = null;\r\n                } else {\r\n                    g.drawTexture(tTex, tResultTransform.tx, tResultTransform.ty, tNodeG.width, tNodeG.height, null, tGraphicAlpha);\r\n                }\r\n            }\r\n        }\r\n        var childs: any[] = node.child;\r\n        if (!childs) return;\r\n        var i: number, len: number;\r\n        len = childs.length;\r\n        for (i = 0; i < len; i++) {\r\n            this._updateNodeGraphic(childs[i], frame, tResultTransform, g, tGraphicAlpha);\r\n        }\r\n    }\r\n\r\n    protected _updateNoChilds(tNodeG: GraphicNode, g: Graphics): void {\r\n        if (!tNodeG.skin) return;\r\n        var tTex: Texture = this._getTextureByUrl(tNodeG.skin);\r\n        if (!tTex) return;\r\n        var tTransform: Matrix = tNodeG.transform;\r\n        tTransform._checkTransform();\r\n        var onlyTranslate: boolean;\r\n        onlyTranslate = !tTransform._bTransform;\r\n        if (!onlyTranslate) {\r\n            g.drawTexture(tTex, 0, 0, tNodeG.width, tNodeG.height, tTransform.clone(), tNodeG.alpha);\r\n        } else {\r\n            g.drawTexture(tTex, tTransform.tx, tTransform.ty, tNodeG.width, tNodeG.height, null, tNodeG.alpha);\r\n        }\r\n    }\r\n\r\n    protected _updateNodeGraphic2(node: any, frame: number, g: Graphics): void {\r\n        var tNodeG: GraphicNode;\r\n        tNodeG = this._nodeGDic[node.compId] = this._getNodeGraphicData(node.compId, frame, this._nodeGDic[node.compId]);\r\n        if (!node.child) {\r\n            this._updateNoChilds(tNodeG, g);\r\n            return;\r\n        }\r\n        var tTransform: Matrix = tNodeG.transform;\r\n        tTransform._checkTransform();\r\n        var onlyTranslate: boolean;\r\n        onlyTranslate = !tTransform._bTransform;\r\n        var hasTrans: boolean;\r\n        hasTrans = onlyTranslate && (tTransform.tx != 0 || tTransform.ty != 0);\r\n        var ifSave: boolean;\r\n        ifSave = (tTransform._bTransform) || tNodeG.alpha != 1;\r\n        if (ifSave) g.save();\r\n        if (tNodeG.alpha != 1) g.alpha(tNodeG.alpha);\r\n        if (!onlyTranslate) g.transform(tTransform.clone());\r\n        else if (hasTrans) g.translate(tTransform.tx, tTransform.ty);\r\n\r\n        var childs: any[] = node.child;\r\n        var tTex: Texture;\r\n        if (tNodeG.skin) {\r\n            tTex = this._getTextureByUrl(tNodeG.skin);\r\n            if (tTex) {\r\n                g.drawImage(tTex, 0, 0, tNodeG.width, tNodeG.height);\r\n            }\r\n        }\r\n\r\n        if (childs) {\r\n            var i: number, len: number;\r\n            len = childs.length;\r\n            for (i = 0; i < len; i++) {\r\n                this._updateNodeGraphic2(childs[i], frame, g);\r\n            }\r\n        }\r\n\r\n        if (ifSave) {\r\n            g.restore();\r\n        } else {\r\n            if (!onlyTranslate) {\r\n                g.transform(tTransform.clone().invert());\r\n            } else if (hasTrans) {\r\n                g.translate(-tTransform.tx, -tTransform.ty);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private \r\n     * @override\r\n    */\r\n    protected _calculateKeyFrames(node: any): void {\r\n        super._calculateKeyFrames(node);\r\n        this._nodeIDAniDic[node.target] = node;\r\n    }\r\n\r\n    /**@private */\r\n    protected getNodeDataByID(nodeID: number): any {\r\n        return this._nodeIDAniDic[nodeID];\r\n    }\r\n\r\n    /**@private */\r\n    protected _getParams(obj: any, params: any[], frame: number, obj2: any): any[] {\r\n        var rst: any[] = GraphicAnimation._temParam;\r\n        rst.length = params.length;\r\n        var i: number, len: number = params.length;\r\n        for (i = 0; i < len; i++) {\r\n            rst[i] = this._getObjVar(obj, params[i][0], frame, params[i][1], obj2);\r\n        }\r\n        return rst;\r\n    }\r\n\r\n    /**@private */\r\n    private _getObjVar(obj: any, key: string, frame: number, noValue: any, obj2: any): any {\r\n        if (key in obj) {\r\n            var vArr: any[] = obj[key];\r\n            if (frame >= vArr.length) frame = vArr.length - 1;\r\n            return obj[key][frame];\r\n        }\r\n        if (key in obj2) {\r\n            return obj2[key];\r\n        }\r\n        return noValue;\r\n    }\r\n\r\n    protected _getNodeGraphicData(nodeID: number, frame: number, rst: GraphicNode): GraphicNode {\r\n        if (!rst)\r\n            rst = new GraphicNode();\r\n        if (!rst.transform) {\r\n            rst.transform = new Matrix();\r\n        } else {\r\n            rst.transform.identity();\r\n        }\r\n\r\n        var node: any = this.getNodeDataByID(nodeID);\r\n        if (!node) return rst;\r\n        var frameData: any = node.frames;\r\n        var params: any[] = this._getParams(frameData, GraphicAnimation._drawTextureCmd, frame, this._nodeDefaultProps[nodeID]);\r\n        var url: string = params[0];\r\n        var width: number, height: number;\r\n        var px: number = params[5], py: number = params[6];\r\n        var aX: number = params[13], aY: number = params[14];\r\n        var sx: number = params[7], sy: number = params[8];\r\n        var rotate: number = params[9];\r\n        var skewX: number = params[11], skewY: number = params[12]\r\n        width = params[3];\r\n        height = params[4];\r\n        if (width == 0 || height == 0) url = null;\r\n        if (width == -1) width = 0;\r\n        if (height == -1) height = 0;\r\n        var tex: Texture;\r\n        rst.skin = url;\r\n        rst.width = width;\r\n        rst.height = height;\r\n        if (url) {\r\n            tex = this._getTextureByUrl(url);\r\n            if (tex) {\r\n                if (!width)\r\n                    width = tex.sourceWidth;\r\n                if (!height)\r\n                    height = tex.sourceHeight;\r\n            } else {\r\n                console.warn(\"lost skin:\", url, \",you may load pics first\");\r\n            }\r\n        }\r\n\r\n        rst.alpha = params[10];\r\n\r\n        var m: Matrix = rst.transform;\r\n        if (aX != 0) {\r\n            px = aX * width;\r\n        }\r\n        if (aY != 0) {\r\n            py = aY * height;\r\n        }\r\n        if (px != 0 || py != 0) {\r\n            m.translate(-px, -py);\r\n        }\r\n        var tm: Matrix = null;\r\n        if (rotate || sx !== 1 || sy !== 1 || skewX || skewY) {\r\n            tm = GraphicAnimation._tempMt;\r\n            tm.identity();\r\n            tm._bTransform = true;\r\n            var skx: number = (rotate - skewX) * 0.0174532922222222; //laya.CONST.PI180;\r\n            var sky: number = (rotate + skewY) * 0.0174532922222222;\r\n            var cx: number = Math.cos(sky);\r\n            var ssx: number = Math.sin(sky);\r\n            var cy: number = Math.sin(skx);\r\n            var ssy: number = Math.cos(skx);\r\n            tm.a = sx * cx;\r\n            tm.b = sx * ssx;\r\n            tm.c = -sy * cy;\r\n            tm.d = sy * ssy;\r\n            tm.tx = tm.ty = 0;\r\n        }\r\n        if (tm) {\r\n            m = Matrix.mul(m, tm, m);\r\n        }\r\n\r\n        m.translate(params[1], params[2]);\r\n\r\n        return rst;\r\n    }\r\n    private static _tempMt: Matrix = new Matrix();\r\n\r\n    /**@private */\r\n    protected _getTextureByUrl(url: string): any {\r\n        return Loader.getRes(url);\r\n    }\r\n\r\n    /**@private */\r\n    setAniData(uiView: any, aniName: string = null): void {\r\n        if (uiView.animations) {\r\n            this._nodeDefaultProps = {};\r\n            this._nodeGDic = {};\r\n            if (this._nodeList) this._nodeList.length = 0;\r\n            this._rootNode = uiView;\r\n            this._parseNodeList(uiView);\r\n            var aniDic: any = {};\r\n            var anilist: any[] = [];\r\n            var animations: any[] = uiView.animations;\r\n            var i: number, len: number = animations.length;\r\n            var tAniO: any;\r\n            for (i = 0; i < len; i++) {\r\n                tAniO = animations[i];\r\n                this._labels = null;\r\n                if (aniName && aniName != tAniO.name) {\r\n                    continue;\r\n                }\r\n                if (!tAniO)\r\n                    continue;\r\n                try {\r\n                    this._calGraphicData(tAniO);\r\n                } catch (e) {\r\n                    console.warn(\"parse animation fail:\" + tAniO.name + \",empty animation created\");\r\n                    this._gList = [];\r\n                }\r\n                var frameO: any = {};\r\n                frameO.interval = 1000 / tAniO[\"frameRate\"];\r\n                frameO.frames = this._gList;\r\n                frameO.labels = this._labels;\r\n                frameO.name = tAniO.name;\r\n                anilist.push(frameO);\r\n                aniDic[tAniO.name] = frameO;\r\n            }\r\n            this.animationList = anilist;\r\n            this.animationDic = aniDic;\r\n        }\r\n        GraphicAnimation._temParam.length = 0;\r\n\r\n    }\r\n\r\n    parseByData(aniData: any): any {\r\n        var rootNode: any, aniO: any;\r\n        rootNode = aniData.nodeRoot;\r\n        aniO = aniData.aniO;\r\n        delete aniData.nodeRoot;\r\n        delete aniData.aniO;\r\n        this._nodeDefaultProps = {};\r\n        this._nodeGDic = {};\r\n        if (this._nodeList) this._nodeList.length = 0;\r\n        this._rootNode = rootNode;\r\n        this._parseNodeList(rootNode);\r\n        this._labels = null;\r\n        try {\r\n            this._calGraphicData(aniO);\r\n        } catch (e) {\r\n            console.warn(\"parse animation fail:\" + aniO.name + \",empty animation created\");\r\n            this._gList = [];\r\n        }\r\n        var frameO: any = aniData;\r\n        frameO.interval = 1000 / aniO[\"frameRate\"];\r\n        frameO.frames = this._gList;\r\n        frameO.labels = this._labels;\r\n        frameO.name = aniO.name;\r\n        return frameO;\r\n    }\r\n\r\n    /**@private */\r\n    setUpAniData(uiView: any): void {\r\n        if (uiView.animations) {\r\n            var aniDic: any = {};\r\n            var anilist: any[] = [];\r\n            var animations: any[] = uiView.animations;\r\n            var i: number, len: number = animations.length;\r\n            var tAniO: any;\r\n            for (i = 0; i < len; i++) {\r\n                tAniO = animations[i];\r\n                if (!tAniO) continue;\r\n                var frameO: any = {};\r\n                frameO.name = tAniO.name;\r\n                frameO.aniO = tAniO;\r\n                frameO.nodeRoot = uiView;\r\n                anilist.push(frameO);\r\n                aniDic[tAniO.name] = frameO;\r\n            }\r\n            this.animationList = anilist;\r\n            this.animationDic = aniDic;\r\n        }\r\n    }\r\n\r\n    /**@private */\r\n    protected _clear(): void {\r\n        this.animationList = null;\r\n        this.animationDic = null;\r\n        this._gList = null;\r\n        this._nodeGDic = null;\r\n    }\r\n\r\n    static parseAnimationByData(animationObject: any): any {\r\n        if (!GraphicAnimation._I) GraphicAnimation._I = new GraphicAnimation();\r\n        var rst: any;\r\n        rst = GraphicAnimation._I.parseByData(animationObject);\r\n        GraphicAnimation._I._clear();\r\n        return rst;\r\n    }\r\n\r\n    static parseAnimationData(aniData: any): any {\r\n        if (!GraphicAnimation._I) GraphicAnimation._I = new GraphicAnimation();\r\n        GraphicAnimation._I.setUpAniData(aniData);\r\n        var rst: any;\r\n        rst = {};\r\n        rst.animationList = GraphicAnimation._I.animationList;\r\n        rst.animationDic = GraphicAnimation._I.animationDic;\r\n        GraphicAnimation._I._clear();\r\n        return rst;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\nclass GraphicNode {\r\n    skin: string;\r\n    transform: Matrix;\r\n    resultTransform: Matrix;\r\n    width: number;\r\n    height: number;\r\n    alpha: number = 1;\r\n}\r\n","import { AnimationBase } from \"./AnimationBase\";\r\nimport { Graphics } from \"./Graphics\";\r\nimport { Loader } from \"../net/Loader\"\r\nimport { GraphicAnimation } from \"../utils/GraphicAnimation\"\r\nimport { Handler } from \"../utils/Handler\"\r\nimport { Utils } from \"../utils/Utils\"\r\nimport { ILaya } from \"../../ILaya\";\r\nimport { ClassUtils } from \"../utils/ClassUtils\";\r\n\r\n/**\r\n * 动画播放完毕后调度。\r\n * @eventType Event.COMPLETE\r\n */\r\n/*[Event(name = \"complete\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * 播放到某标签后调度。\r\n * @eventType Event.LABEL\r\n */\r\n/*[Event(name = \"label\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * <p> <code>Animation</code> 是Graphics动画类。实现了基于Graphics的动画创建、播放、控制接口。</p>\r\n * <p>本类使用了动画模版缓存池，它以一定的内存开销来节省CPU开销，当相同的动画模版被多次使用时，相比于每次都创建新的动画模版，使用动画模版缓存池，只需创建一次，缓存之后多次复用，从而节省了动画模版创建的开销。</p>\r\n * <p>动画模版缓存池，以key-value键值对存储，key可以自定义，也可以从指定的配置文件中读取，value为对应的动画模版，是一个Graphics对象数组，每个Graphics对象对应一个帧图像，动画的播放实质就是定时切换Graphics对象。</p>\r\n * <p>使用set source、loadImages(...)、loadAtlas(...)、loadAnimation(...)方法可以创建动画模版。使用play(...)可以播放指定动画。</p>\r\n * @example <caption>以下示例代码，创建了一个 <code>Text</code> 实例。</caption>\r\n * package\r\n * {\r\n * \timport laya.display.Animation;\r\n * \timport laya.net.Loader;\r\n * \timport laya.utils.Handler;\r\n * \tpublic class Animation_Example\r\n * \t{\r\n * \t\tpublic function Animation_Example()\r\n * \t\t{\r\n * \t\t\tLaya.init(640, 800);//设置游戏画布宽高、渲染模式。\r\n * \t\t\tLaya.stage.bgColor = \"#efefef\";//设置画布的背景颜色。\r\n * \t\t\tinit();//初始化\r\n * \t\t}\r\n * \t\tprivate function init():void\r\n * \t\t{\r\n * \t\t\tvar animation:Animation = new Animation();//创建一个 Animation 类的实例对象 animation 。\r\n * \t\t\tanimation.loadAtlas(\"resource/ani/fighter.json\");//加载图集并播放\r\n * \t\t\tanimation.x = 200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。\r\n * \t\t\tanimation.y = 200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。\r\n * \t\t\tanimation.interval = 50;//设置 animation 对象的动画播放间隔时间，单位：毫秒。\r\n * \t\t\tanimation.play();//播放动画。\r\n * \t\t\tLaya.stage.addChild(animation);//将 animation 对象添加到显示列表。\r\n * \t\t}\r\n * \t}\r\n * }\r\n *\r\n * @example\r\n * Animation_Example();\r\n * function Animation_Example(){\r\n *     Laya.init(640, 800);//设置游戏画布宽高、渲染模式。\r\n *     Laya.stage.bgColor = \"#efefef\";//设置画布的背景颜色。\r\n *     init();//初始化\r\n * }\r\n * function init()\r\n * {\r\n *     var animation = new Laya.Animation();//创建一个 Animation 类的实例对象 animation 。\r\n *     animation.loadAtlas(\"resource/ani/fighter.json\");//加载图集并播放\r\n *     animation.x = 200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。\r\n *     animation.y = 200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。\r\n *     animation.interval = 50;//设置 animation 对象的动画播放间隔时间，单位：毫秒。\r\n *     animation.play();//播放动画。\r\n *     Laya.stage.addChild(animation);//将 animation 对象添加到显示列表。\r\n * }\r\n *\r\n * @example\r\n * import Animation = laya.display.Animation;\r\n * class Animation_Example {\r\n *     constructor() {\r\n *         Laya.init(640, 800);//设置游戏画布宽高、渲染模式。\r\n *         Laya.stage.bgColor = \"#efefef\";//设置画布的背景颜色。\r\n *         this.init();\r\n *     }\r\n *     private init(): void {\r\n *         var animation:Animation = new Laya.Animation();//创建一个 Animation 类的实例对象 animation 。\r\n *         animation.loadAtlas(\"resource/ani/fighter.json\");//加载图集并播放\r\n *         animation.x = 200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。\r\n *         animation.y = 200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。\r\n *         animation.interval = 50;//设置 animation 对象的动画播放间隔时间，单位：毫秒。\r\n *         animation.play();//播放动画。\r\n *         Laya.stage.addChild(animation);//将 animation 对象添加到显示列表。\r\n *     }\r\n * }\r\n * new Animation_Example();\r\n */\r\nexport class Animation extends AnimationBase {\r\n    /**\r\n     * <p>动画模版缓存池，以key-value键值对存储，key可以自定义，也可以从指定的配置文件中读取，value为对应的动画模版，是一个Graphics对象数组，每个Graphics对象对应一个帧图像，动画的播放实质就是定时切换Graphics对象。</p>\r\n     * <p>使用loadImages(...)、loadAtlas(...)、loadAnimation(...)、set source方法可以创建动画模版。使用play(...)可以播放指定动画。</p>\r\n     */\r\n    static framesMap: any = {};\r\n    /**@private */\r\n    protected _frames: any[];\r\n    /**@private */\r\n    protected _url: string;\r\n\r\n    /**\r\n     * 创建一个新的 <code>Animation</code> 实例。\r\n     */\r\n    constructor() {\r\n        super();\r\n        this._setControlNode(this);\r\n    }\r\n\r\n    /** @inheritDoc\r\n     *  @override\r\n     */\r\n    destroy(destroyChild: boolean = true): void {\r\n        this.stop();\r\n        super.destroy(destroyChild);\r\n        this._frames = null;\r\n        this._labels = null;\r\n    }\r\n\r\n    /**\r\n     * <p>开始播放动画。会在动画模版缓存池中查找key值为name的动画模版，存在则用此动画模版初始化当前序列帧， 如果不存在，则使用当前序列帧。</p>\r\n     * <p>play(...)方法被设计为在创建实例后的任何时候都可以被调用，调用后就处于播放状态，当相应的资源加载完毕、调用动画帧填充方法(set frames)或者将实例显示在舞台上时，会判断是否处于播放状态，如果是，则开始播放。</p>\r\n     * <p>配合wrapMode属性，可设置动画播放顺序类型。</p>\r\n     * @param\tstart\t（可选）指定动画播放开始的索引(int)或帧标签(String)。帧标签可以通过addLabel(...)和removeLabel(...)进行添加和删除。\r\n     * @param\tloop\t（可选）是否循环播放。\r\n     * @param\tname\t（可选）动画模板在动画模版缓存池中的key，也可认为是动画名称。如果name为空，则播放当前动画序列帧；如果不为空，则在动画模版缓存池中寻找key值为name的动画模版，如果存在则用此动画模版初始化当前序列帧并播放，如果不存在，则仍然播放当前动画序列帧；如果没有当前动画的帧数据，则不播放，但该实例仍然处于播放状态。\r\n     * @override\r\n     */\r\n    play(start: any = 0, loop: boolean = true, name: string = \"\"): void {\r\n        if (name) this._setFramesFromCache(name, true);\r\n        super.play(start, loop, name);\r\n    }\r\n\r\n    /**@private */\r\n    protected _setFramesFromCache(name: string, showWarn: boolean = false): boolean {\r\n        if (this._url) name = this._url + \"#\" + name;\r\n        if (name && Animation.framesMap[name]) {\r\n            var tAniO: any = Animation.framesMap[name];\r\n            if (tAniO instanceof Array) {\r\n                this._frames = Animation.framesMap[name];\r\n                this._count = this._frames.length;\r\n            } else {\r\n                if (tAniO.nodeRoot) {\r\n                    //如果动画数据未解析过,则先进行解析\r\n                    Animation.framesMap[name] = GraphicAnimation.parseAnimationByData(tAniO);\r\n                    tAniO = Animation.framesMap[name];\r\n                }\r\n                this._frames = tAniO.frames;\r\n                this._count = this._frames.length;\r\n                //如果读取的是动画配置信息，帧率按照动画设置的帧率播放\r\n                if (!this._frameRateChanged) this._interval = tAniO.interval;\r\n                this._labels = this._copyLabels(tAniO.labels);\r\n            }\r\n            return true;\r\n        } else {\r\n            if (showWarn) console.log(\"ani not found:\", name);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**@private */\r\n    private _copyLabels(labels: any): any {\r\n        if (!labels) return null;\r\n        var rst: any;\r\n        rst = {};\r\n        var key: string;\r\n        for (key in labels) {\r\n            rst[key] = Utils.copyArray([], labels[key]);\r\n        }\r\n        return rst;\r\n    }\r\n\r\n    /**@private \r\n    *  @override\r\n    */\r\n    protected _frameLoop(): void {\r\n        if (this._visible && this._style.alpha > 0.01 && this._frames) {\r\n            super._frameLoop();\r\n        }\r\n    }\r\n\r\n    /**@private \r\n     * @override\r\n    */\r\n    protected _displayToIndex(value: number): void {\r\n        if (this._frames) this.graphics = this._frames[value];\r\n    }\r\n\r\n    /**\r\n     * 当前动画的帧图像数组。本类中，每个帧图像是一个Graphics对象，而动画播放就是定时切换Graphics对象的过程。\r\n     */\r\n    get frames(): any[] {\r\n        return this._frames;\r\n    }\r\n\r\n    set frames(value: any[]) {\r\n        this._frames = value;\r\n        if (value) {\r\n            this._count = value.length;\r\n            //if (_isPlaying) play(_index, loop, _actionName);\r\n            if (this._actionName) this._setFramesFromCache(this._actionName, true);\r\n            this.index = this._index;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * <p>动画数据源。</p>\r\n     * <p>类型如下：<br/>\r\n     * 1. LayaAir IDE动画文件路径：使用此类型需要预加载所需的图集资源，否则会创建失败，如果不想预加载或者需要创建完毕的回调，请使用loadAnimation(...)方法；<br/>\r\n     * 2. 图集路径：使用此类型创建的动画模版不会被缓存到动画模版缓存池中，如果需要缓存或者创建完毕的回调，请使用loadAtlas(...)方法；<br/>\r\n     * 3. 图片路径集合：使用此类型创建的动画模版不会被缓存到动画模版缓存池中，如果需要缓存，请使用loadImages(...)方法。</p>\r\n     * @param value\t数据源。比如：图集：\"xx/a1.atlas\"；图片集合：\"a1.png,a2.png,a3.png\"；LayaAir IDE动画\"xx/a1.ani\"。\r\n     */\r\n    set source(value: string) {\r\n        if (value.indexOf(\".ani\") > -1) this.loadAnimation(value);\r\n        else if (value.indexOf(\".json\") > -1 || value.indexOf(\"als\") > -1 || value.indexOf(\"atlas\") > -1) this.loadAtlas(value);\r\n        else this.loadImages(value.split(\",\"));\r\n    }\r\n\r\n    /**\r\n     * 设置自动播放的动画名称，在LayaAir IDE中可以创建的多个动画组成的动画集合，选择其中一个动画名称进行播放。\r\n     */\r\n    set autoAnimation(value: string) {\r\n        this.play(0, true, value);\r\n    }\r\n\r\n    /**\r\n     * 是否自动播放，默认为false。如果设置为true，则动画被创建并添加到舞台后自动播放。\r\n     */\r\n    set autoPlay(value: boolean) {\r\n        if (value) this.play();\r\n        else this.stop();\r\n    }\r\n\r\n    /**\r\n     * 停止动画播放，并清理对象属性。之后可存入对象池，方便对象复用。\r\n     * @override\r\n     */\r\n    clear(): AnimationBase {\r\n        super.clear();\r\n        this.stop();\r\n        this.graphics = null;\r\n        this._frames = null;\r\n        this._labels = null;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * <p>根据指定的动画模版初始化当前动画序列帧。选择动画模版的过程如下：1. 动画模版缓存池中key为cacheName的动画模版；2. 如果不存在，则加载指定的图片集合并创建动画模版。注意：只有指定不为空的cacheName，才能将创建好的动画模版以此为key缓存到动画模版缓存池，否则不进行缓存。</p>\r\n     * <p>动画模版缓存池是以一定的内存开销来节省CPU开销，当相同的动画模版被多次使用时，相比于每次都创建新的动画模版，使用动画模版缓存池，只需创建一次，缓存之后多次复用，从而节省了动画模版创建的开销。</p>\r\n     * <p>因为返回值为Animation对象本身，所以可以使用如下语法：loadImages(...).loadImages(...).play(...);。</p>\r\n     * @param\turls\t\t图片路径集合。需要创建动画模版时，会以此为数据源。参数形如：[url1,url2,url3,...]。\r\n     * @param\tcacheName\t（可选）动画模板在动画模版缓存池中的key。如果此参数不为空，表示使用动画模版缓存池。如果动画模版缓存池中存在key为cacheName的动画模版，则使用此模版。否则，创建新的动画模版，如果cacheName不为空，则以cacheName为key缓存到动画模版缓存池中，如果cacheName为空，不进行缓存。\r\n     * @return \t返回Animation对象本身。\r\n     */\r\n    loadImages(urls: any[], cacheName: string = \"\"): Animation {\r\n        this._url = \"\";\r\n        if (!this._setFramesFromCache(cacheName)) {\r\n            this.frames = Animation.framesMap[cacheName] ? Animation.framesMap[cacheName] : Animation.createFrames(urls, cacheName);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * <p>根据指定的动画模版初始化当前动画序列帧。选择动画模版的过程如下：1. 动画模版缓存池中key为cacheName的动画模版；2. 如果不存在，则加载指定的图集并创建动画模版。</p>\r\n     * <p>注意：只有指定不为空的cacheName，才能将创建好的动画模版以此为key缓存到动画模版缓存池，否则不进行缓存。</p>\r\n     * <p>动画模版缓存池是以一定的内存开销来节省CPU开销，当相同的动画模版被多次使用时，相比于每次都创建新的动画模版，使用动画模版缓存池，只需创建一次，缓存之后多次复用，从而节省了动画模版创建的开销。</p>\r\n     * <p>因为返回值为Animation对象本身，所以可以使用如下语法：loadAtlas(...).loadAtlas(...).play(...);。</p>\r\n     * @param\turl\t\t\t图集路径。需要创建动画模版时，会以此为数据源。\r\n     * @param\tloaded\t\t（可选）使用指定图集初始化动画完毕的回调。\r\n     * @param\tcacheName\t（可选）动画模板在动画模版缓存池中的key。如果此参数不为空，表示使用动画模版缓存池。如果动画模版缓存池中存在key为cacheName的动画模版，则使用此模版。否则，创建新的动画模版，如果cacheName不为空，则以cacheName为key缓存到动画模版缓存池中，如果cacheName为空，不进行缓存。\r\n     * @return \t返回动画本身。\r\n     */\r\n    loadAtlas(url: string, loaded: Handler = null, cacheName: string = \"\"): Animation {\r\n        this._url = \"\";\r\n        var _this: Animation = this;\r\n        if (!_this._setFramesFromCache(cacheName)) {\r\n            function onLoaded(loadUrl: string): void {\r\n                if (url === loadUrl) {\r\n                    _this.frames = Animation.framesMap[cacheName] ? Animation.framesMap[cacheName] : Animation.createFrames(url, cacheName);\r\n                    if (loaded) loaded.run();\r\n                }\r\n            }\r\n            if (Loader.getAtlas(url)) onLoaded(url);\r\n            else ILaya.loader.load(url, Handler.create(null, onLoaded, [url]), null, Loader.ATLAS);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * <p>加载并解析由LayaAir IDE制作的动画文件，此文件中可能包含多个动画。默认帧率为在IDE中设计的帧率，如果调用过set interval，则使用此帧间隔对应的帧率。加载后创建动画模版，并缓存到动画模版缓存池，key \"url#动画名称\" 对应相应动画名称的动画模板，key \"url#\" 对应动画模版集合的默认动画模版。</p>\r\n     * <p>注意：如果调用本方法前，还没有预加载动画使用的图集，请将atlas参数指定为对应的图集路径，否则会导致动画创建失败。</p>\r\n     * <p>动画模版缓存池是以一定的内存开销来节省CPU开销，当相同的动画模版被多次使用时，相比于每次都创建新的动画模版，使用动画模版缓存池，只需创建一次，缓存之后多次复用，从而节省了动画模版创建的开销。</p>\r\n     * <p>因为返回值为Animation对象本身，所以可以使用如下语法：loadAnimation(...).loadAnimation(...).play(...);。</p>\r\n     * @param\turl \t动画文件路径。可由LayaAir IDE创建并发布。\r\n     * @param\tloaded\t（可选）使用指定动画资源初始化动画完毕的回调。\r\n     * @param\tatlas\t（可选）动画用到的图集地址（可选）。\r\n     * @return \t返回动画本身。\r\n     */\r\n    loadAnimation(url: string, loaded: Handler = null, atlas: string = null): Animation {\r\n        this._url = url;\r\n        var _this: Animation = this;\r\n        if (!this._actionName) this._actionName = \"\";\r\n        if (!_this._setFramesFromCache(this._actionName)) {\r\n            if (!atlas || Loader.getAtlas(atlas)) {\r\n                this._loadAnimationData(url, loaded, atlas);\r\n            } else {\r\n                ILaya.loader.load(atlas, Handler.create(this, this._loadAnimationData, [url, loaded, atlas]), null, Loader.ATLAS)\r\n            }\r\n        } else {\r\n            _this._setFramesFromCache(this._actionName, true);\r\n            this.index = 0;\r\n            if (loaded) loaded.run();\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**@private */\r\n    private _loadAnimationData(url: string, loaded: Handler = null, atlas: string = null): void {\r\n        if (atlas && !Loader.getAtlas(atlas)) {\r\n            console.warn(\"atlas load fail:\" + atlas);\r\n            return;\r\n        }\r\n        var _this: Animation = this;\r\n\r\n        function onLoaded(loadUrl: string): void {\r\n            if (!Loader.getRes(loadUrl)) {\r\n                // 如果getRes失败了，有可能是相同的文件已经被删掉了，因为下面在用完后会立即删除\r\n                // 这时候可以取frameMap中去找，如果找到了，走正常流程。--王伟\r\n                if (Animation.framesMap[url + \"#\"]) {\r\n                    _this._setFramesFromCache(_this._actionName, true);\r\n                    _this.index = 0;\r\n                    _this._resumePlay();\r\n                    if (loaded) loaded.run();\r\n                }\r\n                return;\r\n            }\r\n            if (url === loadUrl) {\r\n                var tAniO: any;\r\n                if (!Animation.framesMap[url + \"#\"]) {\r\n                    //此次解析仅返回动画数据，并不真正解析动画graphic数据\r\n                    var aniData: any = GraphicAnimation.parseAnimationData(Loader.getRes(url));\r\n                    if (!aniData) return;\r\n                    //缓存动画数据\r\n                    var aniList: any[] = aniData.animationList;\r\n                    var i: number, len: number = aniList.length;\r\n                    var defaultO: any;\r\n                    for (i = 0; i < len; i++) {\r\n                        tAniO = aniList[i];\r\n                        Animation.framesMap[url + \"#\" + tAniO.name] = tAniO;\r\n                        if (!defaultO) defaultO = tAniO;\r\n                    }\r\n                    if (defaultO) {\r\n                        Animation.framesMap[url + \"#\"] = defaultO;\r\n                        _this._setFramesFromCache(_this._actionName, true);\r\n                        _this.index = 0;\r\n                    }\r\n                    _this._resumePlay();\r\n                } else {\r\n                    _this._setFramesFromCache(_this._actionName, true);\r\n                    _this.index = 0;\r\n                    _this._resumePlay();\r\n                }\r\n                if (loaded) loaded.run();\r\n            }\r\n            //清理掉配置\r\n            Loader.clearRes(url);\r\n        }\r\n        if (Loader.getRes(url)) onLoaded(url);\r\n        else ILaya.loader.load(url, Handler.create(null, onLoaded, [url]), null, Loader.JSON);\r\n\r\n\r\n    }\r\n\r\n    /**\r\n     * <p>创建动画模板，多个动画可共享同一份动画模板，而不必每次都创建一份新的，从而节省创建Graphics集合的开销。</p>\r\n     * @param\turl\t\t\t图集路径或者图片路径数组。如果是图集路径，需要相应图集已经被预加载，如果没有预加载，会导致创建失败。\r\n     * @param\tname\t\t动画模板在动画模版缓存池中的key。如果不为空，则以此为key缓存动画模板，否则不缓存。\r\n     * @return\t动画模板。\r\n     */\r\n    static createFrames(url: string | string[], name: string): any[] {\r\n        var arr: any[];\r\n        if (typeof (url) == 'string') {\r\n            var atlas: any[] = Loader.getAtlas(<string>url);\r\n            if (atlas && atlas.length) {\r\n                arr = [];\r\n                for (var i: number = 0, n: number = atlas.length; i < n; i++) {\r\n                    var g: Graphics = new Graphics();\r\n                    g.drawImage(Loader.getRes(atlas[i]), 0, 0);\r\n                    arr.push(g);\r\n                }\r\n            }\r\n        } else if (url instanceof Array) {\r\n            arr = [];\r\n            for (i = 0, n = url.length; i < n; i++) {\r\n                g = new Graphics();\r\n                g.loadImage(url[i], 0, 0);\r\n                arr.push(g);\r\n            }\r\n        }\r\n        if (name) Animation.framesMap[name] = arr;\r\n        return arr;\r\n    }\r\n\r\n    /**\r\n     * <p>从动画模版缓存池中清除指定key值的动画数据。</p>\r\n     * <p>开发者在调用创建动画模版函数时，可以手动指定此值。而如果是由LayaAir IDE创建的动画集，解析后的key格式为：\"url#\"：表示动画集的默认动画模版，如果以此值为参数，会清除整个动画集数据；\"url#aniName\"：表示相应名称的动画模版。</p>\r\n     * @param key 动画模板在动画模版缓存池中的key。\r\n     */\r\n    static clearCache(key: string): void {\r\n        var cache: any = Animation.framesMap;\r\n        var val: string;\r\n        var key2: string = key + \"#\";\r\n        for (val in cache) {\r\n            if (val === key || val.indexOf(key2) === 0) {\r\n                delete Animation.framesMap[val];\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nILaya.regClass(Animation);\r\nClassUtils.regClass(\"laya.display.Animation\", Animation);\r\nClassUtils.regClass(\"Laya.Animation\", Animation);","import { FrameAnimation } from \"./FrameAnimation\";\r\nimport { ClassUtils } from \"../utils/ClassUtils\"\r\nimport { Ease } from \"../utils/Ease\"\r\n\r\n/**\r\n * <p> 动效模板。用于为指定目标对象添加动画效果。每个动效有唯一的目标对象，而同一个对象可以添加多个动效。 当一个动效开始播放时，其他动效会自动停止播放。</p>\r\n * <p> 可以通过LayaAir IDE创建。 </p>\r\n */\r\nexport class EffectAnimation extends FrameAnimation {\r\n    /**\r\n     * @private\r\n     * 动效开始事件。\r\n     */\r\n    private static EFFECT_BEGIN: string = \"effectbegin\";\r\n\r\n    /**@internal */\r\n    private _target: any;\r\n    /**@internal */\r\n    private _playEvent: string;\r\n    /**@internal */\r\n    private _initData: any = {};\r\n    /**@internal */\r\n    private _aniKeys: any[];\r\n    /**@internal */\r\n    private _effectClass: new () => any;\r\n\r\n    /**\r\n     * 本实例的目标对象。通过本实例控制目标对象的属性变化。\r\n     * @param v 指定的目标对象。\r\n     */\r\n    set target(v: any) {\r\n        if (this._target) this._target.off(EffectAnimation.EFFECT_BEGIN, this, this._onOtherBegin);\r\n        this._target = v;\r\n        if (this._target) this._target.on(EffectAnimation.EFFECT_BEGIN, this, this._onOtherBegin);\r\n        this._addEvent();\r\n    }\r\n\r\n    get target(): any {\r\n        return this._target;\r\n    }\r\n\r\n    /**@private */\r\n    private _onOtherBegin(effect: any): void {\r\n        if (effect === this) return;\r\n        this.stop();\r\n    }\r\n\r\n    /**\r\n     * 设置开始播放的事件。本实例会侦听目标对象的指定事件，触发后播放相应动画效果。\r\n     * @param event\r\n     */\r\n    set playEvent(event: string) {\r\n        this._playEvent = event;\r\n        if (!event) return;\r\n        this._addEvent();\r\n    }\r\n\r\n    /**@internal */\r\n    private _addEvent(): void {\r\n        if (!this._target || !this._playEvent) return;\r\n        this._setControlNode(this._target);\r\n        this._target.on(this._playEvent, this, this._onPlayAction);\r\n    }\r\n\r\n    /**@internal */\r\n    private _onPlayAction(): void {\r\n        this.play(0, false);\r\n    }\r\n    /**\r\n     * @param start \r\n     * @param loop \r\n     * @param name \r\n     * @override\r\n     */\r\n    play(start: any = 0, loop: boolean = true, name: string = \"\"): void {\r\n        if (!this._target)\r\n            return;\r\n        this._target.event(EffectAnimation.EFFECT_BEGIN, [this]);\r\n        this._recordInitData();\r\n        super.play(start, loop, name);\r\n    }\r\n\r\n    /**@private */\r\n    private _recordInitData(): void {\r\n        if (!this._aniKeys) return;\r\n        var i: number, len: number;\r\n        len = this._aniKeys.length;\r\n        var key: string;\r\n        for (i = 0; i < len; i++) {\r\n            key = this._aniKeys[i];\r\n            this._initData[key] = this._target[key];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置提供数据的类。\r\n     * @param classStr 类路径\r\n     */\r\n    set effectClass(classStr: string) {\r\n        this._effectClass = ClassUtils.getClass(classStr);\r\n        if (this._effectClass) {\r\n            var uiData: any = this._effectClass[\"uiView\"];\r\n            if (uiData) {\r\n                var aniData: any[] = uiData[\"animations\"];\r\n                if (aniData && aniData[0]) {\r\n                    var data: any = aniData[0];\r\n                    this._setUp({}, data);\r\n                    if (data.nodes && data.nodes[0]) {\r\n                        this._aniKeys = data.nodes[0].keys;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置动画数据。\r\n     * @param uiData\r\n     */\r\n    set effectData(uiData: any) {\r\n        if (uiData) {\r\n            var aniData: any[] = uiData[\"animations\"];\r\n            if (aniData && aniData[0]) {\r\n                var data: any = aniData[0];\r\n                this._setUp({}, data);\r\n                if (data.nodes && data.nodes[0]) {\r\n                    this._aniKeys = data.nodes[0].keys;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n    */\r\n    protected _displayToIndex(value: number): void {\r\n        if (!this._animationData) return;\r\n        if (value < 0) value = 0;\r\n        if (value > this._count) value = this._count;\r\n        var nodes: any[] = this._animationData.nodes, i: number, len: number = nodes.length;\r\n        len = len > 1 ? 1 : len;\r\n        for (i = 0; i < len; i++) {\r\n            this._displayNodeToFrame(nodes[i], value);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @override\r\n    */\r\n    protected _displayNodeToFrame(node: any, frame: number, targetDic: any = null): void {\r\n        if (!this._target) return;\r\n        var target: any = this._target;\r\n        var frames: any = node.frames, key: string, propFrames: any[], value: any;\r\n        var keys: any[] = node.keys, i: number, len: number = keys.length;\r\n        var secondFrames: any = node.secondFrames;\r\n        var tSecondFrame: number;\r\n        var easeFun: Function;\r\n        var tKeyFrames: any[];\r\n        var startFrame: any;\r\n        var endFrame: any;\r\n        for (i = 0; i < len; i++) {\r\n            key = keys[i];\r\n            propFrames = frames[key];\r\n            tSecondFrame = secondFrames[key];\r\n            if (tSecondFrame == -1) {\r\n                value = this._initData[key];\r\n            } else {\r\n                if (frame < tSecondFrame) {\r\n                    tKeyFrames = node.keyframes[key];\r\n                    startFrame = tKeyFrames[0];\r\n                    if (startFrame.tween) {\r\n                        easeFun = Ease[startFrame.tweenMethod];\r\n                        if (easeFun == null) easeFun = Ease.linearNone;\r\n                        endFrame = tKeyFrames[1];\r\n                        value = easeFun(frame, this._initData[key], endFrame.value - this._initData[key], endFrame.index);\r\n                    } else {\r\n                        value = this._initData[key];\r\n                    }\r\n\r\n                } else {\r\n                    if (propFrames.length > frame) value = propFrames[frame];\r\n                    else value = propFrames[propFrames.length - 1];\r\n                }\r\n            }\r\n            target[key] = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n    */\r\n    protected _calculateKeyFrames(node: any): void {\r\n        super._calculateKeyFrames(node);\r\n        var keyFrames: any = node.keyframes, key: string, tKeyFrames: any[], target: number = node.target;\r\n\r\n        var secondFrames: any = {};\r\n        node.secondFrames = secondFrames;\r\n        for (key in keyFrames) {\r\n            tKeyFrames = keyFrames[key];\r\n            if (tKeyFrames.length <= 1) secondFrames[key] = -1;\r\n            else secondFrames[key] = tKeyFrames[1].index;\r\n        }\r\n    }\r\n}\r\n\r\n\r\nClassUtils.regClass(\"laya.display.EffectAnimation\", EffectAnimation);\r\nClassUtils.regClass(\"Laya.EffectAnimation\", EffectAnimation);","import { Loader } from \"./Loader\";\r\nimport { ILaya } from \"./../../ILaya\";\r\nimport { AtlasInfoManager } from \"./AtlasInfoManager\";\r\nimport { LoaderManager } from \"./LoaderManager\";\r\nimport { Prefab } from \"../components/Prefab\"\r\nimport { Event } from \"../events/Event\"\r\n\r\nimport { EventDispatcher } from \"../events/EventDispatcher\"\r\nimport { Handler } from \"../utils/Handler\"\r\nimport { Utils } from \"../utils/Utils\"\r\n/**\r\n * @private\r\n * 场景资源加载器\r\n */\r\nexport class SceneLoader extends EventDispatcher {\r\n    static LoadableExtensions: any = { \"scene\": Loader.JSON, \"scene3d\": Loader.JSON, \"ani\": Loader.JSON, \"ui\": Loader.JSON, \"prefab\": Loader.PREFAB };\r\n    static No3dLoadTypes: any = { \"png\": true, \"jpg\": true, \"txt\": true };\r\n    totalCount: number;\r\n    private _completeHandler: Handler;\r\n    private _toLoadList: any[];\r\n    private _isLoading: boolean;\r\n    private _curUrl: string;\r\n\r\n    constructor() {\r\n        super();\r\n        this._completeHandler = new Handler(this, this.onOneLoadComplete);\r\n        this.reset();\r\n    }\r\n\r\n    reset(): void {\r\n        this._toLoadList = [];\r\n        this._isLoading = false;\r\n        this.totalCount = 0;\r\n    }\r\n\r\n    get leftCount(): number {\r\n        if (this._isLoading) return this._toLoadList.length + 1;\r\n        return this._toLoadList.length;\r\n    }\r\n\r\n    get loadedCount(): number {\r\n        return this.totalCount - this.leftCount;\r\n    }\r\n\r\n    load(url: any, is3D: boolean = false, ifCheck: boolean = true): void {\r\n        if (url instanceof Array) {\r\n            var i: number, len: number;\r\n            len = url.length;\r\n            for (i = 0; i < len; i++) {\r\n                this._addToLoadList(url[i], is3D);\r\n            }\r\n        } else {\r\n            this._addToLoadList(url, is3D);\r\n        }\r\n        if (ifCheck)\r\n            this._checkNext();\r\n    }\r\n\r\n    private _addToLoadList(url: string, is3D: boolean = false): void {\r\n        if (this._toLoadList.indexOf(url) >= 0) return;\r\n        if (Loader.getRes(url)) return;\r\n        if (is3D) {\r\n            this._toLoadList.push({ url: url });\r\n        } else\r\n            this._toLoadList.push(url);\r\n        this.totalCount++;\r\n    }\r\n\r\n    private _checkNext(): void {\r\n        if (!this._isLoading) {\r\n            if (this._toLoadList.length == 0) {\r\n                this.event(Event.COMPLETE);\r\n                return;\r\n            }\r\n            var tItem: any;\r\n            tItem = this._toLoadList.pop();\r\n            if (typeof (tItem) == 'string') {\r\n                this.loadOne(tItem);\r\n            } else {\r\n                this.loadOne(tItem.url, true);\r\n            }\r\n        }\r\n    }\r\n\r\n    private loadOne(url: any, is3D: boolean = false): void {\r\n        this._curUrl = url;\r\n        var type: string = Utils.getFileExtension(this._curUrl);\r\n        if (is3D) {\r\n            ILaya.loader.create(url, this._completeHandler);\r\n        } else\r\n            if (SceneLoader.LoadableExtensions[type]) {\r\n                ILaya.loader.load(url, this._completeHandler, null, SceneLoader.LoadableExtensions[type]);\r\n            } else if (url != AtlasInfoManager.getFileLoadPath(url) || SceneLoader.No3dLoadTypes[type] || !LoaderManager.createMap[type]) {\r\n                ILaya.loader.load(url, this._completeHandler);\r\n            } else {\r\n                ILaya.loader.create(url, this._completeHandler);\r\n            }\r\n    }\r\n\r\n    private onOneLoadComplete(): void {\r\n        this._isLoading = false;\r\n        if (!Loader.getRes(this._curUrl)) {\r\n            console.log(\"Fail to load:\", this._curUrl);\r\n        }\r\n        var type: string = Utils.getFileExtension(this._curUrl);\r\n        if (SceneLoader.LoadableExtensions[type]) {\r\n            var dataO: any;\r\n            dataO = Loader.getRes(this._curUrl);\r\n            if (dataO && (dataO instanceof Prefab)) {\r\n                dataO = dataO.json;\r\n            }\r\n            if (dataO) {\r\n                if (dataO.loadList) {\r\n                    this.load(dataO.loadList, false, false);\r\n                }\r\n                if (dataO.loadList3D) {\r\n                    this.load(dataO.loadList3D, true, false);\r\n                }\r\n            }\r\n        }\r\n        if (type == \"sk\") {\r\n            this.load(this._curUrl.replace(\".sk\", \".png\"), false, false);\r\n        }\r\n        this.event(Event.PROGRESS, this.getProgress());\r\n        this._checkNext();\r\n    }\r\n\r\n    getProgress(): number {\r\n        return this.loadedCount / this.totalCount;\r\n    }\r\n}\r\n\r\n\r\n","import { Node } from \"./Node\";\r\nimport { Const } from \"../Const\"\r\nimport { Sprite } from \"./Sprite\"\r\nimport { Event } from \"../events/Event\"\r\nimport { SceneLoader } from \"../net/SceneLoader\"\r\nimport { Resource } from \"../resource/Resource\"\r\nimport { Handler } from \"../utils/Handler\"\r\nimport { SceneUtils } from \"../utils/SceneUtils\"\r\nimport { Timer } from \"../utils/Timer\"\r\nimport { ILaya } from \"../../ILaya\";\r\nimport { ClassUtils } from \"../utils/ClassUtils\";\r\nimport { URL } from \"../net/URL\";\r\n\r\n/**\r\n * 场景类，负责场景创建，加载，销毁等功能\r\n * 场景被从节点移除后，并不会被自动垃圾机制回收，如果想回收，请调用destroy接口，可以通过unDestroyedScenes属性查看还未被销毁的场景列表\r\n */\r\nexport class Scene extends Sprite {\r\n    /**创建后，还未被销毁的场景列表，方便查看还未被销毁的场景列表，方便内存管理，本属性只读，请不要直接修改*/\r\n    static unDestroyedScenes: any[] = [];\r\n    /**获取根节点*/\r\n    private static _root: Sprite;\r\n    /**@private */\r\n    private static _loadPage: Scene;\r\n\r\n    /**场景被关闭后，是否自动销毁（销毁节点和使用到的资源），默认为false*/\r\n    autoDestroyAtClosed: boolean = false;\r\n    /**场景地址*/\r\n    url: string = null;\r\n\r\n    /**场景时钟*/\r\n    private _timer: Timer;\r\n    /**@private */\r\n    private _viewCreated: boolean = false;\r\n    /**@internal */\r\n    _idMap: any;\r\n    /**@internal */\r\n    _$componentType: string = \"Scene\";\r\n\r\n    constructor(createChildren = true) {\r\n        super();\r\n        //not ready状态变更修改为加载资源之前后\r\n        // this._setBit(Const.NOT_READY, true);\r\n        Scene.unDestroyedScenes.push(this);\r\n        this._scene = this;\r\n        if (createChildren)\r\n            this.createChildren();\r\n    }\r\n\r\n    /**\r\n     * @private 兼容老项目\r\n     */\r\n    protected createChildren(): void {\r\n    }\r\n    /**\r\n     * 兼容加载模式\r\n     * 加载模式设置uimap\r\n     * @param url uimapJosn的url\r\n     */\r\n    static setUIMap(url):void{\r\n        let uimap = ILaya.loader.getRes(url);\r\n        if(uimap){\r\n            for (let key in uimap) {\r\n                ILaya.Loader.loadedMap[URL.formatURL(key + \".scene\")] = uimap[key];\r\n            }\r\n        }else{\r\n            throw \"请提前加载uimap的json，再使用该接口设置！\";\r\n        }\r\n    }\r\n    /**\r\n     * @private 兼容老项目\r\n     * 装载场景视图。用于加载模式。\r\n     * @param path 场景地址。\r\n     */\r\n    loadScene(path: string): void {\r\n        var url: string = path.indexOf(\".\") > -1 ? path : path + \".scene\";\r\n        var view: any = ILaya.loader.getRes(url);\r\n        if (view) {\r\n            this.createView(view);\r\n        } else {\r\n            this._setBit(Const.NOT_READY, true);\r\n            ILaya.loader.resetProgress();\r\n            var loader: SceneLoader = new SceneLoader();\r\n            loader.on(Event.COMPLETE, this, this._onSceneLoaded, [url]);\r\n            loader.load(url);\r\n            //Laya.loader.load(url, Handler.create(this, createView), null, Loader.JSON);\r\n        }\r\n    }\r\n\r\n    private _onSceneLoaded(url: string): void {\r\n        this.createView(ILaya.Loader.getRes(url));\r\n    }\r\n\r\n    /**\r\n     * @private 兼容老项目\r\n     * 通过视图数据创建视图。\r\n     * @param uiView 视图数据信息。\r\n     */\r\n    createView(view: any): void {\r\n        if (view && !this._viewCreated) {\r\n            this._viewCreated = true;\r\n            SceneUtils.createByData(this, view);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 根据IDE内的节点id，获得节点实例\r\n     */\r\n    getNodeByID(id: number): any {\r\n        if (this._idMap) return this._idMap[id];\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * 打开场景。【注意】被关闭的场景，如果没有设置autoDestroyAtRemoved=true，则资源可能不能被回收，需要自己手动回收\r\n     * @param\tcloseOther\t是否关闭其他场景，默认为true（可选）\r\n     * @param\tparam\t\t打开页面的参数，会传递给onOpened方法（可选）\r\n     */\r\n    open(closeOther: boolean = true, param: any = null): void {\r\n        if (closeOther) Scene.closeAll();\r\n        Scene.root.addChild(this);\r\n        this.onOpened(param);\r\n    }\r\n\r\n    /**场景打开完成后，调用此方法（如果有弹出动画，则在动画完成后执行）*/\r\n    onOpened(param: any): void {\r\n        //trace(\"onOpened\");\r\n    }\r\n\r\n    /**\r\n     * 关闭场景\r\n     * 【注意】被关闭的场景，如果没有设置autoDestroyAtRemoved=true，则资源可能不能被回收，需要自己手动回收\r\n     * @param type 关闭的原因，会传递给onClosed函数\r\n     */\r\n    close(type: string = null): void {\r\n        this.onClosed(type);\r\n        if (this.autoDestroyAtClosed) this.destroy();\r\n        else this.removeSelf();\r\n    }\r\n\r\n    /**\r\n     * 关闭完成后，调用此方法（如果有关闭动画，则在动画完成后执行）\r\n     * @param type 如果是点击默认关闭按钮触发，则传入关闭按钮的名字(name)，否则为null。\r\n     */\r\n    onClosed(type: string = null): void {\r\n        //trace(\"onClosed\");\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n    destroy(destroyChild: boolean = true): void {\r\n        this._idMap = null;\r\n        super.destroy(destroyChild);\r\n        var list: any[] = Scene.unDestroyedScenes;\r\n        for (var i: number = list.length - 1; i > -1; i--) {\r\n            if (list[i] === this) {\r\n                list.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n    set scaleX(value: number) {\r\n        if (super.get_scaleX() == value) return;\r\n        super.set_scaleX(value);\r\n        this.event(Event.RESIZE);\r\n    }\r\n    /**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n    get scaleX() {\r\n        return super.scaleX;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n    set scaleY(value: number) {\r\n        if (super.get_scaleY() == value) return;\r\n        super.set_scaleY(value);\r\n        this.event(Event.RESIZE);\r\n    }\r\n    /**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n    get scaleY() {\r\n        return super.scaleY;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n    get width(): number {\r\n        if (this._width) return this._width;\r\n        var max: number = 0;\r\n        for (var i: number = this.numChildren - 1; i > -1; i--) {\r\n            var comp: Sprite = (<Sprite>this.getChildAt(i));\r\n            if (comp._visible) {\r\n                max = Math.max(comp._x + comp.width * comp.scaleX, max);\r\n            }\r\n        }\r\n        return max;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n    set width(value: number) {\r\n        if (super.get_width() == value) return;\r\n        super.set_width(value);\r\n        this.callLater(this._sizeChanged);\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n    get height(): number {\r\n        if (this._height) return this._height;\r\n        var max: number = 0;\r\n        for (var i: number = this.numChildren - 1; i > -1; i--) {\r\n            var comp: Sprite = (<Sprite>this.getChildAt(i));\r\n            if (comp._visible) {\r\n                max = Math.max(comp._y + comp.height * comp.scaleY, max);\r\n            }\r\n        }\r\n        return max;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc \r\n     * @override\r\n     */\r\n    set height(value: number) {\r\n        if (super.get_height() == value) return;\r\n        super.set_height(value);\r\n        this.callLater(this._sizeChanged);\r\n    }\r\n\r\n    /**@private */\r\n    protected _sizeChanged(): void {\r\n        this.event(Event.RESIZE);\r\n    }\r\n\r\n    //////////////////////////////////////静态方法//////////////////////////////////////////\r\n\r\n    /**获取场景根容器*/\r\n    static get root(): Sprite {\r\n        if (!Scene._root) {\r\n            Scene._root = (<Sprite>ILaya.stage.addChild(new Sprite()));\r\n            Scene._root.name = \"root\";\r\n            ILaya.stage.on(\"resize\", null, () => {\r\n                Scene._root.size(ILaya.stage.width, ILaya.stage.height);\r\n                Scene._root.event(Event.RESIZE);\r\n            });\r\n            Scene._root.size(ILaya.stage.width, ILaya.stage.height);\r\n            Scene._root.event(Event.RESIZE);\r\n        }\r\n        return Scene._root;\r\n    }\r\n\r\n    /**\r\n     * 场景时钟\r\n     * @override\r\n     */\r\n    get timer(): Timer {\r\n        return this._timer || ILaya.timer;\r\n    }\r\n\r\n    set timer(value: Timer) {\r\n        this._timer = value;\r\n    }\r\n\r\n    /**\r\n     * 加载场景及场景使用到的资源\r\n     * @param\turl\t\t\t场景地址\r\n     * @param\tcomplete\t加载完成回调，返回场景实例（可选）\r\n     * @param\tprogress\t加载进度回调（可选）\r\n     */\r\n    static load(url: string, complete: Handler = null, progress: Handler = null): void {\r\n        ILaya.loader.resetProgress();\r\n        var loader: SceneLoader = new SceneLoader();\r\n        loader.on(Event.PROGRESS, null, onProgress);\r\n        loader.once(Event.COMPLETE, null, create);\r\n        loader.load(url);\r\n\r\n        function onProgress(value: number): void {\r\n            if (Scene._loadPage) Scene._loadPage.event(\"progress\", value);\r\n            progress && progress.runWith(value);\r\n        }\r\n\r\n        function create(): void {\r\n            loader.off(Event.PROGRESS, null, onProgress);\r\n            var obj: any = ILaya.Loader.getRes(url);\r\n            if (!obj) throw \"Can not find scene:\" + url;\r\n            if (!obj.props) throw \"Scene data is error:\" + url;\r\n            var runtime: string = obj.props.runtime ? obj.props.runtime : obj.type;\r\n            var clas: any = ILaya.ClassUtils.getClass(runtime);\r\n            if (obj.props.renderType == \"instance\") {\r\n                var scene: Scene = clas.instance || (clas.instance = new clas());\r\n            } else {\r\n                scene = new clas();\r\n            }\r\n            if (scene && scene instanceof Node) {\r\n                scene.url = url;\r\n                if (scene._viewCreated) {\r\n                    complete && complete.runWith(scene);\r\n                } else {\r\n                    scene.on(\"onViewCreated\", null, function (): void {\r\n                        complete && complete.runWith(scene)\r\n                    })\r\n                    scene.createView(obj);\r\n                }\r\n                Scene.hideLoadingPage();\r\n            } else {\r\n                throw \"Can not find scene:\" + runtime;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 加载并打开场景\r\n     * @param\turl\t\t\t场景地址\r\n     * @param\tcloseOther\t是否关闭其他场景，默认为true（可选），【注意】被关闭的场景，如果没有设置autoDestroyAtRemoved=true，则资源可能不能被回收，需要自己手动回收\r\n     * @param\tparam\t\t打开页面的参数，会传递给onOpened方法（可选）\r\n     * @param\tcomplete\t打开完成回调，返回场景实例（可选）\r\n     * @param\tprogress\t加载进度回调（可选）\r\n     */\r\n    static open(url: string, closeOther: boolean = true, param: any = null, complete: Handler = null, progress: Handler = null): void {\r\n        //兼容处理\r\n        if (param instanceof Handler) {\r\n            var temp: any = complete;\r\n            complete = param;\r\n            param = temp;\r\n        }\r\n        Scene.showLoadingPage();\r\n        Scene.load(url, Handler.create(null, this._onSceneLoaded, [closeOther, complete, param]), progress);\r\n    }\r\n\r\n    /**@private */\r\n    private static _onSceneLoaded(closeOther: boolean, complete: Handler, param: any, scene: Scene): void {\r\n        scene.open(closeOther, param);\r\n        if (complete) complete.runWith(scene);\r\n    }\r\n\r\n    /**\r\n     * 根据地址，关闭场景（包括对话框）\r\n     * @param\turl\t\t场景地址\r\n     * @param\tname\t如果name不为空，name必须相同才能关闭\r\n     * @return\t返回是否关闭成功，如果url找不到，则不成功\r\n     */\r\n    static close(url: string, name: string = \"\"): boolean {\r\n        var flag: boolean = false;\r\n        var list: any[] = Scene.unDestroyedScenes;\r\n        for (var i: number = 0, n: number = list.length; i < n; i++) {\r\n            var scene: Scene = list[i];\r\n            if (scene && scene.parent && scene.url === url && scene.name == name) {\r\n                scene.close();\r\n                flag = true;\r\n            }\r\n        }\r\n        return flag;\r\n    }\r\n\r\n    /**\r\n     * 关闭所有场景，不包括对话框，如果关闭对话框，请使用Dialog.closeAll()\r\n     * 【注意】被关闭的场景，如果没有设置autoDestroyAtRemoved=true，则资源可能不能被回收，需要自己手动回收\r\n     */\r\n    static closeAll(): void {\r\n        var root: Sprite = Scene.root;\r\n        for (var i: number = 0, n: number = root.numChildren; i < n; i++) {\r\n            var scene: Node = root.getChildAt(0);\r\n            if (scene instanceof Scene) scene.close();\r\n            else scene.removeSelf();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 根据地址，销毁场景（包括对话框）\r\n     * @param\turl\t\t场景地址\r\n     * @param\tname\t如果name不为空，name必须相同才能关闭\r\n     * @return\t返回是否销毁成功，如果url找不到，则不成功\r\n     */\r\n    static destroy(url: string, name: string = \"\"): boolean {\r\n        var flag: boolean = false;\r\n        var list: any[] = [].concat(Scene.unDestroyedScenes);\r\n        for (var i: number = 0, n: number = list.length; i < n; i++) {\r\n            var scene: Scene = list[i];\r\n            if (scene.url === url && scene.name == name && !scene.destroyed) {\r\n                scene.destroy();\r\n                flag = true;\r\n            }\r\n        }\r\n        return flag;\r\n    }\r\n\r\n    /**\r\n     * 销毁当前没有被使用的资源,该函数会忽略lock=true的资源。\r\n     */\r\n    static gc(): void {\r\n        Resource.destroyUnusedResources();\r\n    }\r\n\r\n    /**\r\n     * 设置loading界面，引擎会在调用open方法后，延迟打开loading界面，在页面添加到舞台之后，关闭loading界面\r\n     * @param\tloadPage \tload界面实例\r\n     */\r\n    static setLoadingPage(loadPage: Scene): void {\r\n        if (Scene._loadPage != loadPage) {\r\n            Scene._loadPage = loadPage;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 显示loading界面\r\n     * @param\tparam 打开参数，如果是scene，则会传递给onOpened方法\r\n     * @param\tdelay 延迟打开时间，默认500毫秒\r\n     */\r\n    static showLoadingPage(param: any = null, delay: number = 500): void {\r\n        if (Scene._loadPage) {\r\n            ILaya.systemTimer.clear(null, Scene._showLoading);\r\n            ILaya.systemTimer.clear(null, Scene._hideLoading);\r\n            ILaya.systemTimer.once(delay, null, Scene._showLoading, [param], false);\r\n        }\r\n    }\r\n\r\n    private static _showLoading(param: any): void {\r\n        ILaya.stage.addChild(Scene._loadPage);\r\n        Scene._loadPage.onOpened(param);\r\n    }\r\n\r\n    private static _hideLoading(): void {\r\n        Scene._loadPage.close();\r\n    }\r\n\r\n    /**\r\n     * 隐藏loading界面\r\n     * @param\tdelay 延迟关闭时间，默认500毫秒\r\n     */\r\n    static hideLoadingPage(delay: number = 500): void {\r\n        if (Scene._loadPage) {\r\n            ILaya.systemTimer.clear(null, Scene._showLoading);\r\n            ILaya.systemTimer.clear(null, Scene._hideLoading);\r\n            ILaya.systemTimer.once(delay, null, Scene._hideLoading);\r\n        }\r\n    }\r\n}\r\n\r\nILaya.regClass(Scene);\r\nClassUtils.regClass(\"laya.display.Scene\", Scene);\r\nClassUtils.regClass(\"Laya.Scene\", Scene);","import { Context } from \"../../resource/Context\"\r\nimport { Pool } from \"../../utils/Pool\"\r\n\r\n/**\r\n * 绘制粒子\r\n * @private\r\n */\r\nexport class DrawParticleCmd {\r\n    static ID: string = \"DrawParticleCmd\";\r\n\r\n    private _templ: any;\r\n\r\n    /**@private */\r\n    static create(_temp: any): DrawParticleCmd {\r\n        var cmd: DrawParticleCmd = Pool.getItemByClass(\"DrawParticleCmd\", DrawParticleCmd);\r\n        cmd._templ = _temp;\r\n        return cmd;\r\n    }\r\n\r\n    /**\r\n     * 回收到对象池\r\n     */\r\n    recover(): void {\r\n        this._templ = null;\r\n        Pool.recover(\"DrawParticleCmd\", this);\r\n    }\r\n\r\n    /**@private */\r\n    run(context: Context, gx: number, gy: number): void {\r\n        //这个只有webgl在用\r\n        context.drawParticle(gx, gy, this._templ);\r\n    }\r\n\r\n    /**@private */\r\n    get cmdID(): string {\r\n        return DrawParticleCmd.ID;\r\n    }\r\n}\r\n\r\n","import { Laya } from \"../../Laya\";\r\nimport { Sprite } from \"../display/Sprite\";\r\nimport { Utils } from \"../utils/Utils\";\r\n\r\n/**\r\n * ...\r\n * @author ww\r\n */\r\nexport class FilterSetterBase {\r\n\t_filter: any;\r\n\tconstructor() {\r\n\r\n\t}\r\n\r\n\tparamChanged(): void {\r\n\t\tLaya.systemTimer.callLater(this, this.buildFilter);\r\n\t}\r\n\r\n\tprotected buildFilter(): void {\r\n\t\tif (this._target) {\r\n\t\t\tthis.addFilter(this._target);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected addFilter(sprite: Sprite): void {\r\n\t\tif (!sprite) return;\r\n\r\n\t\tif (!sprite.filters) {\r\n\t\t\tsprite.filters = [this._filter];\r\n\t\t} else {\r\n\r\n\t\t\tvar preFilters: any[];\r\n\t\t\tpreFilters = sprite.filters;\r\n\t\t\tif (preFilters.indexOf(this._filter) < 0) {\r\n\r\n\t\t\t\tpreFilters.push(this._filter);\r\n\t\t\t\tsprite.filters = Utils.copyArray([], preFilters);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected removeFilter(sprite: Sprite): void {\r\n\t\tif (!sprite) return;\r\n\t\tsprite.filters = null;\r\n\t}\r\n\r\n\tprivate _target: any;\r\n\tset target(value: any) {\r\n\t\tif (this._target != value) {\r\n\t\t\t//removeFilter(_target as Sprite);\r\n\t\t\t//addFilter(value as Sprite);\r\n\t\t\tthis._target = value;\r\n\t\t\tthis.paramChanged();\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\n\r\n","import { Filter } from \"./Filter\";\r\nimport { Matrix } from \"../maths/Matrix\"\r\nimport { Context } from \"../resource/Context\"\r\nimport { RenderTexture2D } from \"../resource/RenderTexture2D\"\r\nimport { ShaderDefines2D } from \"../webgl/shader/d2/ShaderDefines2D\"\r\nimport { Value2D } from \"../webgl/shader/d2/value/Value2D\"\r\nimport { BlurFilter } from \"./BlurFilter\";\r\n/**\r\n * @private\r\n */\r\nexport class BlurFilterGLRender {\r\n    private static blurinfo: any[] = new Array(2);\r\n    render(rt: RenderTexture2D, ctx: Context, width: number, height: number, filter: BlurFilter): void {\r\n        var shaderValue: Value2D = Value2D.create(ShaderDefines2D.TEXTURE2D, 0);\r\n        this.setShaderInfo(shaderValue, filter, rt.width, rt.height);\r\n        ctx.drawTarget(rt, 0, 0, width, height, Matrix.EMPTY.identity(), shaderValue);\r\n    }\r\n\r\n    setShaderInfo(shader: Value2D, filter: BlurFilter, w: number, h: number): void {\r\n        shader.defines.add(Filter.BLUR);\r\n        var sv: any = (<any>shader);\r\n        BlurFilterGLRender.blurinfo[0] = w; BlurFilterGLRender.blurinfo[1] = h;\r\n        sv.blurInfo = BlurFilterGLRender.blurinfo;\r\n        var sigma: number = filter.strength / 3.0;//3σ以外影响很小。即当σ=1的时候，半径为3;\r\n        var sigma2: number = sigma * sigma;\r\n        filter.strength_sig2_2sig2_gauss1[0] = filter.strength;\r\n        filter.strength_sig2_2sig2_gauss1[1] = sigma2;\t\t\t//做一些预计算传给shader，提高效率\r\n        filter.strength_sig2_2sig2_gauss1[2] = 2.0 * sigma2;\r\n        filter.strength_sig2_2sig2_gauss1[3] = 1.0 / (2.0 * Math.PI * sigma2);\r\n        sv.strength_sig2_2sig2_gauss1 = filter.strength_sig2_2sig2_gauss1;\r\n    }\r\n}\r\n\r\n","import { Filter } from \"./Filter\";\r\nimport { BlurFilterGLRender } from \"./BlurFilterGLRender\";\r\n/**\r\n * 模糊滤镜\r\n */\r\nexport class BlurFilter extends Filter {\r\n\r\n    /**模糊滤镜的强度(值越大，越不清晰 */\r\n    strength: number;\r\n    strength_sig2_2sig2_gauss1: any[] = [];//给shader用的。避免创建对象\r\n    strength_sig2_native: Float32Array;//给native用的\r\n    renderFunc: any;//\r\n    /**\r\n     * 模糊滤镜\r\n     * @param\tstrength\t模糊滤镜的强度值\r\n     */\r\n    constructor(strength: number = 4) {\r\n        super();\r\n        this.strength = strength;\r\n        this._glRender = new BlurFilterGLRender();\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 当前滤镜的类型\r\n     * @override\r\n     */\r\n    get type(): number {\r\n        return Filter.BLUR;\r\n    }\r\n\r\n    getStrenth_sig2_2sig2_native(): Float32Array {\r\n        if (!this.strength_sig2_native) {\r\n            this.strength_sig2_native = new Float32Array(4);\r\n        }\r\n        //TODO James 不要每次进行计算\r\n        var sigma: number = this.strength / 3.0;\r\n        var sigma2: number = sigma * sigma;\r\n        this.strength_sig2_native[0] = this.strength;\r\n        this.strength_sig2_native[1] = sigma2;\r\n        this.strength_sig2_native[2] = 2.0 * sigma2;\r\n        this.strength_sig2_native[3] = 1.0 / (2.0 * Math.PI * sigma2);\r\n        return this.strength_sig2_native;\r\n    }\r\n}\r\n\r\n","import { FilterSetterBase } from \"././FilterSetterBase\";\r\nimport { BlurFilter } from \"../filters/BlurFilter\";\r\n/**\r\n * ...\r\n * @author ww\r\n */\r\nexport class BlurFilterSetter extends FilterSetterBase {\r\n    private _strength: number = 4;\r\n    constructor() {\r\n        super();\r\n        this._filter = new BlurFilter(this.strength);\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    protected buildFilter(): void {\r\n        this._filter = new BlurFilter(this.strength);\r\n        super.buildFilter();\r\n    }\r\n\r\n    get strength(): number {\r\n        return this._strength;\r\n    }\r\n\r\n    set strength(value: number) {\r\n        this._strength = value;\r\n    }\r\n}\r\n\r\n\r\n","import { Sprite } from \"../display/Sprite\";\r\nimport { Tween } from \"../utils/Tween\";\r\nimport { Event } from \"../events/Event\";\r\nimport { Ease } from \"../utils/Ease\";\r\nimport { Handler } from \"../utils/Handler\";\r\n\r\n/**\r\n * @Script {name:ButtonEffect}\r\n * @author ww\r\n */\r\nexport class ButtonEffect {\r\n\r\n    private _tar: Sprite;\r\n    private _curState: number = 0;\r\n    private _curTween: Tween;\r\n    /**\r\n     * effectScale\r\n     * @prop {name:effectScale,type:number, tips:\"缩放值\",default:\"1.5\"}\r\n     */\r\n    effectScale: number = 1.5;\r\n    /**\r\n     * tweenTime\r\n     * @prop {name:tweenTime,type:number, tips:\"缓动时长\",default:\"300\"}\r\n     */\r\n    tweenTime: number = 300;\r\n    /**\r\n     * effectEase\r\n     * @prop {name:effectEase,type:ease, tips:\"效果缓动类型\"}\r\n     */\r\n    effectEase: string;\r\n    /**\r\n     * backEase\r\n     * @prop {name:backEase,type:ease, tips:\"恢复缓动类型\"}\r\n     */\r\n    backEase: string;\r\n\r\n    /**\r\n     * 设置控制对象 \r\n     * @param tar\r\n     */\r\n    set target(tar: Sprite) {\r\n        this._tar = tar;\r\n        tar.on(Event.MOUSE_DOWN, this, this.toChangedState);\r\n        tar.on(Event.MOUSE_UP, this, this.toInitState);\r\n        tar.on(Event.MOUSE_OUT, this, this.toInitState);\r\n    }\r\n\r\n    private toChangedState(): void {\r\n        this._curState = 1;\r\n        if (this._curTween) Tween.clear(this._curTween);\r\n        this._curTween = Tween.to(this._tar, { scaleX: this.effectScale, scaleY: this.effectScale }, this.tweenTime, Ease[this.effectEase], Handler.create(this, this.tweenComplete));\r\n    }\r\n\r\n    private toInitState(): void {\r\n        if (this._curState == 2) return;\r\n        if (this._curTween) Tween.clear(this._curTween);\r\n        this._curState = 2;\r\n        this._curTween = Tween.to(this._tar, { scaleX: 1, scaleY: 1 }, this.tweenTime, Ease[this.backEase], Handler.create(this, this.tweenComplete));\r\n    }\r\n    private tweenComplete(): void {\r\n        this._curState = 0;\r\n        this._curTween = null;\r\n    }\r\n}\r\n\r\n\r\n","import { FilterSetterBase } from \"./FilterSetterBase\";\r\nimport { ColorFilter } from \"../filters/ColorFilter\";\r\nimport { ColorUtils } from \"../utils/ColorUtils\";\r\n\r\n/**\r\n * ...\r\n * @author ww\r\n */\r\nexport class ColorFilterSetter extends FilterSetterBase {\r\n    /**\r\n     * brightness 亮度,范围:-100~100\r\n     */\r\n    private _brightness: number = 0;\r\n    /**\r\n     * contrast 对比度,范围:-100~100\r\n     */\r\n    private _contrast: number = 0;\r\n    /**\r\n     * saturation 饱和度,范围:-100~100\r\n     */\r\n    private _saturation: number = 0;\r\n    /**\r\n     * hue 色调,范围:-180~180\r\n     */\r\n    private _hue: number = 0;\r\n\r\n    /**\r\n     * red red增量,范围:0~255\r\n     */\r\n    private _red: number = 0;\r\n\r\n    /**\r\n     * green green增量,范围:0~255\r\n     */\r\n    private _green: number = 0;\r\n\r\n    /**\r\n     * blue blue增量,范围:0~255\r\n     */\r\n    private _blue: number = 0;\r\n\r\n    /**\r\n     * alpha alpha增量,范围:0~255\r\n     */\r\n    private _alpha: number = 0;\r\n\r\n\r\n    constructor() {\r\n        super();\r\n        this._filter = new ColorFilter();\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    protected buildFilter(): void {\r\n        this._filter.reset();\r\n        //_filter = new ColorFilter();\r\n\r\n        this._filter.color(this.red, this.green, this.blue, this.alpha);\r\n\r\n        this._filter.adjustHue(this.hue);\r\n        this._filter.adjustContrast(this.contrast);\r\n        this._filter.adjustBrightness(this.brightness);\r\n        this._filter.adjustSaturation(this.saturation);\r\n        super.buildFilter();\r\n    }\r\n\r\n\r\n\r\n\r\n    get brightness(): number {\r\n        return this._brightness;\r\n    }\r\n\r\n    set brightness(value: number) {\r\n        this._brightness = value;\r\n        this.paramChanged();\r\n    }\r\n\r\n    get contrast(): number {\r\n        return this._contrast;\r\n    }\r\n\r\n    set contrast(value: number) {\r\n        this._contrast = value;\r\n        this.paramChanged();\r\n    }\r\n\r\n    get saturation(): number {\r\n        return this._saturation;\r\n    }\r\n\r\n    set saturation(value: number) {\r\n        this._saturation = value;\r\n        this.paramChanged();\r\n    }\r\n\r\n    get hue(): number {\r\n        return this._hue;\r\n    }\r\n\r\n    set hue(value: number) {\r\n        this._hue = value;\r\n        this.paramChanged();\r\n    }\r\n\r\n    get red(): number {\r\n        return this._red;\r\n    }\r\n\r\n    set red(value: number) {\r\n        this._red = value;\r\n        this.paramChanged();\r\n    }\r\n\r\n    get green(): number {\r\n        return this._green;\r\n    }\r\n\r\n    set green(value: number) {\r\n        this._green = value;\r\n        this.paramChanged();\r\n    }\r\n\r\n    get blue(): number {\r\n        return this._blue;\r\n    }\r\n\r\n    set blue(value: number) {\r\n        this._blue = value;\r\n        this.paramChanged();\r\n    }\r\n\r\n\r\n    private _color: string;\r\n    get color(): string {\r\n        return this._color;\r\n    }\r\n\r\n    set color(value: string) {\r\n        this._color = value;\r\n        var colorO: ColorUtils;\r\n        colorO = ColorUtils.create(value);\r\n        this._red = colorO.arrColor[0] * 255;\r\n        this._green = colorO.arrColor[1] * 255;\r\n        this._blue = colorO.arrColor[2] * 255;\r\n        this.paramChanged();\r\n    }\r\n\r\n    get alpha(): number {\r\n        return this._alpha;\r\n    }\r\n\r\n    set alpha(value: number) {\r\n        this._alpha = value;\r\n        this.paramChanged();\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { Handler } from \"../utils/Handler\";\r\nimport { Sprite } from \"../display/Sprite\";\r\nimport { Tween } from \"../utils/Tween\";\r\nimport { Component } from \"../components/Component\";\r\n\r\n/**\r\n * 效果插件基类，基于对象池管理\r\n */\r\nexport class EffectBase extends Component {\r\n    /**动画持续时间，单位为毫秒*/\r\n    duration: number = 1000;\r\n    /**动画延迟时间，单位为毫秒*/\r\n    delay: number = 0;\r\n    /**重复次数，默认为播放一次*/\r\n    repeat: number = 0;\r\n    /**缓动类型，如果为空，则默认为匀速播放*/\r\n    ease: string;\r\n    /**触发事件，如果为空，则创建时触发*/\r\n    eventName: string;\r\n    /**效用作用的目标对象，如果为空，则是脚本所在的节点本身*/\r\n    target: Sprite;\r\n    /**效果结束后，是否自动移除节点*/\r\n    autoDestroyAtComplete: boolean = true;\r\n\r\n    protected _comlete: Handler;\r\n    protected _tween: Tween;\r\n    /**\r\n     * @internal\r\n     * @override\r\n     */\r\n    _onAwake(): void {\r\n        this.target = this.target || (<Sprite>this.owner);\r\n        if (this.autoDestroyAtComplete) this._comlete = Handler.create(this.target, this.target.destroy, null, false);\r\n        if (this.eventName) this.owner.on(this.eventName, this, this._exeTween);\r\n        else this._exeTween();\r\n    }\r\n\r\n    protected _exeTween(): void {\r\n        this._tween = this._doTween();\r\n        this._tween.repeat = this.repeat;\r\n    }\r\n\r\n    protected _doTween(): Tween {\r\n        return null;\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    onReset(): void {\r\n        this.duration = 1000;\r\n        this.delay = 0;\r\n        this.repeat = 0;\r\n        this.ease = null;\r\n        this.target = null;\r\n        if (this.eventName) {\r\n            this.owner.off(this.eventName, this, this._exeTween);\r\n            this.eventName = null;\r\n        }\r\n        if (this._comlete) {\r\n            this._comlete.recover();\r\n            this._comlete = null;\r\n        }\r\n        if (this._tween) {\r\n            this._tween.clear();\r\n            this._tween = null;\r\n        }\r\n    }\r\n}\r\n\r\n","import { EffectBase } from \"././EffectBase\";\r\nimport { Tween } from \"../utils/Tween\";\r\nimport { Ease } from \"../utils/Ease\";\r\n\r\n/**\r\n * 淡入效果\r\n */\r\nexport class FadeIn extends EffectBase {\r\n\t/**\r\n\t * @override\r\n\t */\r\n    protected _doTween(): Tween {\r\n        this.target.alpha = 0;\r\n        return Tween.to(this.target, { alpha: 1 }, this.duration, Ease[this.ease], this._comlete, this.delay);\r\n    }\r\n}\r\n\r\n","import { EffectBase } from \"././EffectBase\";\r\nimport { Tween } from \"../utils/Tween\";\r\nimport { Ease } from \"../utils/Ease\";\r\n\r\n/**\r\n * 淡出效果\r\n */\r\nexport class FadeOut extends EffectBase {\r\n\t/**\r\n\t * @override\r\n\t */\r\n    protected _doTween(): Tween {\r\n        this.target.alpha = 1;\r\n        return Tween.to(this.target, { alpha: 0 }, this.duration, Ease[this.ease], this._comlete, this.delay);\r\n    }\r\n}\r\n\r\n","import { Matrix } from \"../maths/Matrix\"\r\nimport { Context } from \"../resource/Context\"\r\nimport { RenderTexture2D } from \"../resource/RenderTexture2D\"\r\nimport { ShaderDefines2D } from \"../webgl/shader/d2/ShaderDefines2D\"\r\nimport { Value2D } from \"../webgl/shader/d2/value/Value2D\"\r\nimport { GlowFilter } from \"./GlowFilter\";\r\n/**\r\n * @private\r\n */\r\nexport class GlowFilterGLRender {\r\n\tprivate setShaderInfo(shader: Value2D, w: number, h: number, data: GlowFilter): void {\r\n\t\tshader.defines.add(data.type);\r\n\t\tvar sv: any = (<any>shader);\r\n\t\tsv.u_blurInfo1 = data._sv_blurInfo1;// [data.blur, data.blur, data.offX, -data.offY];\r\n\t\tvar info2: any = data._sv_blurInfo2;\r\n\t\tinfo2[0] = w; info2[1] = h;\r\n\t\tsv.u_blurInfo2 = info2;\r\n\t\tsv.u_color = data.getColor();\r\n\t}\r\n\trender(rt: RenderTexture2D, ctx: Context, width: number, height: number, filter: GlowFilter): void {\r\n\t\tvar w: number = width, h: number = height;\r\n\t\tvar svBlur: Value2D = Value2D.create(ShaderDefines2D.TEXTURE2D, 0);\r\n\t\tthis.setShaderInfo(svBlur, w, h, filter);\r\n\t\tvar svCP: Value2D = Value2D.create(ShaderDefines2D.TEXTURE2D, 0);\r\n\t\tvar matI: Matrix = Matrix.TEMP.identity();\r\n\t\tctx.drawTarget(rt, 0, 0, w, h, matI, svBlur);\t//先画模糊的底\r\n\t\tctx.drawTarget(rt, 0, 0, w, h, matI, svCP);\t\t//再画原始图片\r\n\r\n\t}\r\n}\r\n\r\n","import { Filter } from \"./Filter\";\r\nimport { GlowFilterGLRender } from \"./GlowFilterGLRender\";\r\nimport { ColorUtils } from \"../utils/ColorUtils\"\r\nimport { BlurFilter } from \"./BlurFilter\";\r\n\r\n/**\r\n *  发光滤镜(也可以当成阴影滤使用）\r\n */\r\nexport class GlowFilter extends Filter {\r\n\r\n    /**数据的存储，顺序R,G,B,A,blurWidth,offX,offY;*/\r\n    private _elements: Float32Array = new Float32Array(9);\r\n    /**@internal */\r\n    _sv_blurInfo1: any[] = new Array(4);\t//给shader用\r\n    /**@internal */\r\n    _sv_blurInfo2: any[] = [0, 0, 1, 0];\r\n    /**滤镜的颜色*/\r\n    private _color: ColorUtils;\r\n    /**@internal */\r\n    _color_native: Float32Array;\r\n    /**@internal */\r\n    _blurInof1_native: Float32Array;\r\n    /**@internal */\r\n    _blurInof2_native: Float32Array;\r\n\r\n\t/**\r\n\t * 创建发光滤镜\r\n\t * @param\tcolor\t滤镜的颜色\r\n\t * @param\tblur\t边缘模糊的大小\r\n\t * @param\toffX\tX轴方向的偏移\r\n\t * @param\toffY\tY轴方向的偏移\r\n\t */\r\n    constructor(color: string, blur: number = 4, offX: number = 6, offY: number = 6) {\r\n        super();\r\n        this._color = new ColorUtils(color);\r\n        //限制最大效果为20\r\n        this.blur = Math.min(blur, 20);\r\n        this.offX = offX;\r\n        this.offY = offY;\r\n        this._sv_blurInfo1[0] = this._sv_blurInfo1[1] = this.blur; this._sv_blurInfo1[2] = offX; this._sv_blurInfo1[3] = -offY;\r\n        this._glRender = new GlowFilterGLRender();\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 滤镜类型\r\n     * @override\r\n     */\r\n    get type(): number {\r\n        return BlurFilter.GLOW;\r\n    }\r\n\r\n    /**@private */\r\n    get offY(): number {\r\n        return this._elements[6];\r\n    }\r\n\r\n    /**@private */\r\n    set offY(value: number) {\r\n        this._elements[6] = value;\r\n        this._sv_blurInfo1[3] = -value;\r\n    }\r\n\r\n    /**@private */\r\n    get offX(): number {\r\n        return this._elements[5];\r\n    }\r\n\r\n    /**@private */\r\n    set offX(value: number) {\r\n        this._elements[5] = value;\r\n        this._sv_blurInfo1[2] = value;\r\n    }\r\n\r\n    /**@private */\r\n    getColor(): any[] {\r\n        return this._color.arrColor;\r\n    }\r\n\r\n    /**@private */\r\n    get blur(): number {\r\n        return this._elements[4];\r\n    }\r\n\r\n    /**@private */\r\n    set blur(value: number) {\r\n        this._elements[4] = value;\r\n        this._sv_blurInfo1[0] = this._sv_blurInfo1[1] = value;\r\n    }\r\n\r\n    getColorNative(): Float32Array {\r\n        if (!this._color_native) {\r\n            this._color_native = new Float32Array(4);\r\n        }\r\n        //TODO James 不用每次赋值\r\n        var color: any[] = this.getColor();\r\n        this._color_native[0] = color[0];\r\n        this._color_native[1] = color[1];\r\n        this._color_native[2] = color[2];\r\n        this._color_native[3] = color[3];\r\n        return this._color_native;\r\n    }\r\n    getBlurInfo1Native(): Float32Array {\r\n        if (!this._blurInof1_native) {\r\n            this._blurInof1_native = new Float32Array(4);\r\n        }\r\n        //TODO James 不用每次赋值\r\n        this._blurInof1_native[0] = this._blurInof1_native[1] = this.blur;\r\n        this._blurInof1_native[2] = this.offX;\r\n        this._blurInof1_native[3] = this.offY;\r\n        return this._blurInof1_native;\r\n    }\r\n    getBlurInfo2Native(): Float32Array {\r\n        if (!this._blurInof2_native) {\r\n            this._blurInof2_native = new Float32Array(4);\r\n        }\r\n        //TODO James 不用每次赋值\r\n        this._blurInof2_native[2] = 1;\r\n        return this._blurInof2_native;\r\n    }\r\n}\r\n\r\n","import { FilterSetterBase } from \"././FilterSetterBase\";\r\nimport { GlowFilter } from \"../filters/GlowFilter\";\r\n/**\r\n * ...\r\n * @author ww\r\n */\r\nexport class GlowFilterSetter extends FilterSetterBase {\r\n\t/**\r\n\t * 滤镜的颜色\r\n\t */\r\n\tprivate _color: string = \"#ff0000\";\r\n\t/**\r\n\t * 边缘模糊的大小 0~20\r\n\t */\r\n\tprivate _blur: number = 4;\r\n\t/**\r\n\t * X轴方向的偏移\r\n\t */\r\n\tprivate _offX: number = 6;\r\n\t/**\r\n\t * Y轴方向的偏移\r\n\t */\r\n\tprivate _offY: number = 6;\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis._filter = new GlowFilter(this._color);\r\n\t}\r\n\t/**\r\n \t* @override\r\n\t */\r\n\tprotected buildFilter(): void {\r\n\r\n\t\tthis._filter = new GlowFilter(this.color, this.blur, this.offX, this.offY);\r\n\t\tsuper.buildFilter();\r\n\t}\r\n\r\n\tget color(): string {\r\n\t\treturn this._color;\r\n\t}\r\n\r\n\tset color(value: string) {\r\n\t\tthis._color = value;\r\n\t\tthis.paramChanged();\r\n\t}\r\n\r\n\tget blur(): number {\r\n\t\treturn this._blur;\r\n\t}\r\n\r\n\tset blur(value: number) {\r\n\t\tthis._blur = value;\r\n\t\tthis.paramChanged();\r\n\t}\r\n\r\n\tget offX(): number {\r\n\t\treturn this._offX;\r\n\t}\r\n\r\n\tset offX(value: number) {\r\n\t\tthis._offX = value;\r\n\t\tthis.paramChanged();\r\n\t}\r\n\r\n\tget offY(): number {\r\n\t\treturn this._offY;\r\n\t}\r\n\r\n\tset offY(value: number) {\r\n\t\tthis._offY = value;\r\n\t\tthis.paramChanged();\r\n\t}\r\n}\r\n\r\n\r\n","/**\r\n\t * <p><code>KeyLocation</code> 类包含表示在键盘或类似键盘的输入设备上按键位置的常量。</p>\r\n\t * <p><code>KeyLocation</code> 常数用在键盘事件对象的 <code>keyLocation </code>属性中。</p>\r\n\t */\r\nexport class KeyLocation {\r\n    /**\r\n     * 表示激活的键不区分位于左侧还是右侧，也不区分是否位于数字键盘（或者是使用对应于数字键盘的虚拟键激活的）。\r\n     */\r\n    static STANDARD: number = 0;\r\n    /**\r\n     * 表示激活的键在左侧键位置（此键有多个可能的位置）。\r\n     */\r\n    static LEFT: number = 1;\r\n    /**\r\n     * 表示激活的键在右侧键位置（此键有多个可能的位置）。\r\n     */\r\n    static RIGHT: number = 2;\r\n    /**\r\n     * <p>表示激活的键位于数字键盘或者是使用对应于数字键盘的虚拟键激活的。</p>\r\n     * <p>注意：此属性只在flash模式下有效。</p>\r\n     * */\r\n    static NUM_PAD: number = 3;\r\n\r\n}\r\n\r\n\r\n","/**\r\n\t * <code>Keyboard</code> 类的属性是一些常数，这些常数表示控制游戏时最常用的键。\r\n\t */\r\nexport class Keyboard {\r\n    /** 与 0 的键控代码值 (48) 关联的常数。*/\r\n    static NUMBER_0: number = 48;\r\n    /** 与 1 的键控代码值 (49) 关联的常数。*/\r\n    static NUMBER_1: number = 49;\r\n    /** 与 2 的键控代码值 (50) 关联的常数。*/\r\n    static NUMBER_2: number = 50;\r\n    /** 与 3 的键控代码值 (51) 关联的常数。*/\r\n    static NUMBER_3: number = 51;\r\n    /** 与 4 的键控代码值 (52) 关联的常数。*/\r\n    static NUMBER_4: number = 52;\r\n    /** 与 5 的键控代码值 (53) 关联的常数。*/\r\n    static NUMBER_5: number = 53;\r\n    /** 与 6 的键控代码值 (54) 关联的常数。*/\r\n    static NUMBER_6: number = 54;\r\n    /** 与 7 的键控代码值 (55) 关联的常数。*/\r\n    static NUMBER_7: number = 55;\r\n    /** 与 8 的键控代码值 (56) 关联的常数。*/\r\n    static NUMBER_8: number = 56;\r\n    /** 与 9 的键控代码值 (57) 关联的常数。*/\r\n    static NUMBER_9: number = 57;\r\n\r\n    /** 与 A 键的键控代码值 (65) 关联的常数。*/\r\n    static A: number = 65;\r\n    /** 与 B 键的键控代码值 (66) 关联的常数。*/\r\n    static B: number = 66;\r\n    /** 与 C 键的键控代码值 (67) 关联的常数。*/\r\n    static C: number = 67;\r\n    /** 与 D 键的键控代码值 (68) 关联的常数。*/\r\n    static D: number = 68;\r\n    /** 与 E 键的键控代码值 (69) 关联的常数。*/\r\n    static E: number = 69;\r\n    /** 与 F 键的键控代码值 (70) 关联的常数。*/\r\n    static F: number = 70;\r\n    /** 与 G 键的键控代码值 (71) 关联的常数。*/\r\n    static G: number = 71;\r\n    /** 与 H 键的键控代码值 (72) 关联的常数。*/\r\n    static H: number = 72;\r\n    /** 与 I 键的键控代码值 (73) 关联的常数。*/\r\n    static I: number = 73;\r\n    /** 与 J 键的键控代码值 (74) 关联的常数。*/\r\n    static J: number = 74;\r\n    /** 与 K 键的键控代码值 (75) 关联的常数。*/\r\n    static K: number = 75;\r\n    /** 与 L 键的键控代码值 (76) 关联的常数。*/\r\n    static L: number = 76;\r\n    /** 与 M 键的键控代码值 (77) 关联的常数。*/\r\n    static M: number = 77;\r\n    /** 与 N 键的键控代码值 (78) 关联的常数。*/\r\n    static N: number = 78;\r\n    /** 与 O 键的键控代码值 (79) 关联的常数。*/\r\n    static O: number = 79;\r\n    /** 与 P 键的键控代码值 (80) 关联的常数。*/\r\n    static P: number = 80;\r\n    /** 与 Q 键的键控代码值 (81) 关联的常数。*/\r\n    static Q: number = 81;\r\n    /** 与 R 键的键控代码值 (82) 关联的常数。*/\r\n    static R: number = 82;\r\n    /** 与 S 键的键控代码值 (83) 关联的常数。*/\r\n    static S: number = 83;\r\n    /** 与 T 键的键控代码值 (84) 关联的常数。*/\r\n    static T: number = 84;\r\n    /** 与 U 键的键控代码值 (85) 关联的常数。*/\r\n    static U: number = 85;\r\n    /** 与 V 键的键控代码值 (86) 关联的常数。*/\r\n    static V: number = 86;\r\n    /** 与 W 键的键控代码值 (87) 关联的常数。*/\r\n    static W: number = 87;\r\n    /** 与 X 键的键控代码值 (88) 关联的常数。*/\r\n    static X: number = 88;\r\n    /** 与 Y 键的键控代码值 (89) 关联的常数。*/\r\n    static Y: number = 89;\r\n    /** 与 Z 键的键控代码值 (90) 关联的常数。*/\r\n    static Z: number = 90;\r\n\r\n    /** 与 F1 的键控代码值 (112) 关联的常数。*/\r\n    static F1: number = 112;\r\n    /** 与 F2 的键控代码值 (113) 关联的常数。*/\r\n    static F2: number = 113;\r\n    /** 与 F3 的键控代码值 (114) 关联的常数。*/\r\n    static F3: number = 114;\r\n    /** 与 F4 的键控代码值 (115) 关联的常数。*/\r\n    static F4: number = 115;\r\n    /** 与 F5 的键控代码值 (116) 关联的常数。*/\r\n    static F5: number = 116;\r\n    /** 与 F6 的键控代码值 (117) 关联的常数。*/\r\n    static F6: number = 117;\r\n    /** 与 F7 的键控代码值 (118) 关联的常数。*/\r\n    static F7: number = 118;\r\n    /** 与 F8 的键控代码值 (119) 关联的常数。*/\r\n    static F8: number = 119;\r\n    /** 与 F9 的键控代码值 (120) 关联的常数。*/\r\n    static F9: number = 120;\r\n    /** 与 F10 的键控代码值 (121) 关联的常数。*/\r\n    static F10: number = 121;\r\n    /** 与 F11 的键控代码值 (122) 关联的常数。*/\r\n    static F11: number = 122;\r\n    /** 与 F12 的键控代码值 (123) 关联的常数。*/\r\n    static F12: number = 123;\r\n    /** 与 F13 的键控代码值 (124) 关联的常数。*/\r\n    static F13: number = 124;\r\n    /** 与 F14 的键控代码值 (125) 关联的常数。*/\r\n    static F14: number = 125;\r\n    /** 与 F15 的键控代码值 (126) 关联的常数。*/\r\n    static F15: number = 126;\r\n\r\n    /** 与数字键盘的伪键控代码 (21) 关联的常数。*/\r\n    static NUMPAD: number = 21;\r\n    /** 与数字键盘上的数字 0 的键控代码值 (96) 关联的常数。*/\r\n    static NUMPAD_0: number = 96;\r\n    /** 与数字键盘上的数字 1 的键控代码值 (97) 关联的常数。*/\r\n    static NUMPAD_1: number = 97;\r\n    /** 与数字键盘上的数字 2 的键控代码值 (98) 关联的常数。*/\r\n    static NUMPAD_2: number = 98;\r\n    /** 与数字键盘上的数字 3 的键控代码值 (99) 关联的常数。*/\r\n    static NUMPAD_3: number = 99;\r\n    /** 与数字键盘上的数字 4 的键控代码值 (100) 关联的常数。*/\r\n    static NUMPAD_4: number = 100;\r\n    /** 与数字键盘上的数字 5 的键控代码值 (101) 关联的常数。*/\r\n    static NUMPAD_5: number = 101;\r\n    /** 与数字键盘上的数字 6 的键控代码值 (102) 关联的常数。*/\r\n    static NUMPAD_6: number = 102;\r\n    /** 与数字键盘上的数字 7 的键控代码值 (103) 关联的常数。*/\r\n    static NUMPAD_7: number = 103;\r\n    /** 与数字键盘上的数字 8 的键控代码值 (104) 关联的常数。*/\r\n    static NUMPAD_8: number = 104;\r\n    /** 与数字键盘上的数字 9 的键控代码值 (105) 关联的常数。*/\r\n    static NUMPAD_9: number = 105;\r\n\r\n    /** 与数字键盘上的加号 (+) 的键控代码值 (107) 关联的常数。*/\r\n    static NUMPAD_ADD: number = 107;\r\n    /** 与数字键盘上的小数点 (.) 的键控代码值 (110) 关联的常数。*/\r\n    static NUMPAD_DECIMAL: number = 110;\r\n    /** 与数字键盘上的除号 (/) 的键控代码值 (111) 关联的常数。*/\r\n    static NUMPAD_DIVIDE: number = 111;\r\n    /** 与数字键盘上的 Enter 的键控代码值 (108) 关联的常数。*/\r\n    static NUMPAD_ENTER: number = 108;\r\n    /** 与数字键盘上的乘号 (*) 的键控代码值 (106) 关联的常数。*/\r\n    static NUMPAD_MULTIPLY: number = 106;\r\n    /** 与数字键盘上的减号 (-) 的键控代码值 (109) 关联的常数。*/\r\n    static NUMPAD_SUBTRACT: number = 109;\r\n    /** 与 ; 键的键控代码值 (186) 关联的常数。*/\r\n    static SEMICOLON: number = 186;\r\n    /** 与 = 键的键控代码值 (187) 关联的常数。*/\r\n    static EQUAL: number = 187;\r\n    /** 与 F15 的键控代码值 (188) 关联的常数。*/\r\n    static COMMA: number = 188;\r\n    /** 与 - 键的键控代码值 (189) 关联的常数。*/\r\n    static MINUS: number = 189;\r\n    /** 与 . 键的键控代码值 (190) 关联的常数。*/\r\n    static PERIOD: number = 190;\r\n    /** 与 / 键的键控代码值 (191) 关联的常数。*/\r\n    static SLASH: number = 191;\r\n    /** 与 ` 键的键控代码值 (192) 关联的常数。*/\r\n    static BACKQUOTE: number = 192;\r\n    /** 与 [ 键的键控代码值 (219) 关联的常数。*/\r\n    static LEFTBRACKET: number = 219;\r\n    /** 与 \\ 键的键控代码值 (220) 关联的常数。*/\r\n    static BACKSLASH: number = 220;\r\n    /** 与 ] 键的键控代码值 (221) 关联的常数。*/\r\n    static RIGHTBRACKET: number = 221;\r\n    /** 与 ' 键的键控代码值 (222) 关联的常数。*/\r\n    static QUOTE: number = 222;\r\n    /** 与 Alternate (Option) 键的键控代码值 (18) 关联的常数。*/\r\n    static ALTERNATE: number = 18;\r\n    /** 与 Backspace 的键控代码值 (8) 关联的常数。*/\r\n    static BACKSPACE: number = 8;\r\n    /** 与 Caps Lock 的键控代码值 (20) 关联的常数。*/\r\n    static CAPS_LOCK: number = 20;\r\n    /** 与 Mac 命令键 (15) 关联的常数。*/\r\n    static COMMAND: number = 15;\r\n    /** 与 Ctrl 的键控代码值 (17) 关联的常数。*/\r\n    static CONTROL: number = 17;\r\n    /** 与 Delete 的键控代码值 (46) 关联的常数。*/\r\n    static DELETE: number = 46;\r\n    /** 与 Enter 的键控代码值 (13) 关联的常数。*/\r\n    static ENTER: number = 13;\r\n    /** 与 Esc 的键控代码值 (27) 关联的常数。*/\r\n    static ESCAPE: number = 27;\r\n    /** 与 Page Up 的键控代码值 (33) 关联的常数。*/\r\n    static PAGE_UP: number = 33;\r\n    /** 与 Page Down 的键控代码值 (34) 关联的常数。*/\r\n    static PAGE_DOWN: number = 34;\r\n    /** 与 End 的键控代码值 (35) 关联的常数。*/\r\n    static END: number = 35;\r\n    /** 与 Home 的键控代码值 (36) 关联的常数。*/\r\n    static HOME: number = 36;\r\n    /** 与向左箭头键的键控代码值 (37) 关联的常数。*/\r\n    static LEFT: number = 37;\r\n    /** 与向上箭头键的键控代码值 (38) 关联的常数。*/\r\n    static UP: number = 38;\r\n    /** 与向右箭头键的键控代码值 (39) 关联的常数。*/\r\n    static RIGHT: number = 39;\r\n    /** 与向下箭头键的键控代码值 (40) 关联的常数。*/\r\n    static DOWN: number = 40;\r\n    /** 与 Shift 的键控代码值 (16) 关联的常数。*/\r\n    static SHIFT: number = 16;\r\n    /** 与空格键的键控代码值 (32) 关联的常数。*/\r\n    static SPACE: number = 32;\r\n    /** 与 Tab 的键控代码值 (9) 关联的常数。*/\r\n    static TAB: number = 9;\r\n    /** 与 Insert 的键控代码值 (45) 关联的常数。*/\r\n    static INSERT: number = 45;\r\n}\r\n\r\n\r\n","\r\n/**\r\n * @private\r\n * CommandEncoder\r\n */\r\nexport class CommandEncoder {\r\n    /**@internal */\r\n    _idata: any[] = [];\r\n\r\n    //TODO:coverage\r\n    constructor(layagl: any, reserveSize: number, adjustSize: number, isSyncToRenderThread: boolean) {\r\n    }\r\n\r\n    //TODO:coverage\r\n    getArrayData(): any[] {\r\n        return this._idata;\r\n    }\r\n\r\n    //TODO:coverage\r\n    getPtrID(): number {\r\n        return 0;\r\n    }\r\n\r\n    beginEncoding(): void {\r\n\r\n    }\r\n\r\n    endEncoding(): void {\r\n\r\n    }\r\n\r\n    //TODO:coverage\r\n    clearEncoding(): void {\r\n        this._idata.length = 0;\r\n    }\r\n\r\n    //TODO:coverage\r\n    getCount(): number {\r\n        return this._idata.length;\r\n    }\r\n\r\n    //TODO:coverage\r\n    add_ShaderValue(o: any): void {\r\n        this._idata.push(o);\r\n    }\r\n\r\n    //TODO:coverage\r\n    addShaderUniform(one: any): void {\r\n        this.add_ShaderValue(one);\r\n    }\r\n\r\n}\r\n\r\n","import { CommandEncoder } from \"./CommandEncoder\";\r\nimport { LayaGL } from \"./LayaGL\";\r\n\r\n/**\r\n * @internal\r\n * 普通命令执行器\r\n */\r\nexport class LayaGLRunner {\r\n\r\n    /**\r\n     * @private\r\n     * 批量上传ShaderUniforms。\r\n     */\r\n    static uploadShaderUniforms(layaGL: LayaGL, commandEncoder: CommandEncoder, shaderData: any, uploadUnTexture: boolean): number {\r\n        var data: any = shaderData._data;\r\n        var shaderUniform: any[] = commandEncoder.getArrayData();\r\n        var shaderCall: number = 0;\r\n        for (var i: number = 0, n: number = shaderUniform.length; i < n; i++) {\r\n            var one: any/*ShaderVariable*/ = shaderUniform[i];\r\n            if (uploadUnTexture || one.textureID !== -1) {//如uniform为纹理切换Shader时需要重新上传\r\n                var value: any = data[one.dataOffset];\r\n                if (value != null)\r\n                    shaderCall += one.fun.call(one.caller, one, value);\r\n            }\r\n        }\r\n        return shaderCall;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 上传ShaderUniform。\r\n     */\r\n    static uploadCustomUniform(layaGL: LayaGL, custom: any[], index: number, data: any): number {\r\n        var shaderCall: number = 0;\r\n        var one: any/*ShaderVariable*/ = custom[index];\r\n        if (one && data != null)\r\n            shaderCall += one.fun.call(one.caller, one, data);\r\n        return shaderCall;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 批量上传ShaderUniforms。\r\n     */\r\n    static uploadShaderUniformsForNative(layaGL: any, commandEncoder: CommandEncoder, shaderData: any): number {\r\n        var nType: number = LayaGL.UPLOAD_SHADER_UNIFORM_TYPE_ID;\r\n        if (shaderData._runtimeCopyValues.length > 0) {\r\n            nType = LayaGL.UPLOAD_SHADER_UNIFORM_TYPE_DATA;\r\n        }\r\n        var data: any = shaderData._data;\r\n        return (<any>LayaGL.instance).uploadShaderUniforms(commandEncoder, data, nType);\r\n    }\r\n\r\n}\r\n\r\n","import { Sprite } from \"../display/Sprite\"\r\nimport { SpriteConst } from \"../display/SpriteConst\"\r\nimport { Stage } from \"../display/Stage\"\r\nimport { RenderSprite } from \"../renders/RenderSprite\"\r\nimport { Context } from \"../resource/Context\"\r\nimport { ILaya } from \"../../ILaya\";\r\n/**\r\n * ...\r\n * @author ww\r\n */\r\nexport class QuickTestTool {\r\n\r\n    private static showedDic: any = {};\r\n    private static _rendertypeToStrDic: any = {};\r\n    private static _typeToNameDic: any = {};\r\n\r\n    //TODO:coverage\r\n    static getMCDName(type: number): string {\r\n        return QuickTestTool._typeToNameDic[type];\r\n    }\r\n\r\n    //TODO:coverage\r\n    static showRenderTypeInfo(type: any, force: boolean = false): void {\r\n        if (!force && QuickTestTool.showedDic[type])\r\n            return;\r\n        QuickTestTool.showedDic[type] = true;\r\n        if (!QuickTestTool._rendertypeToStrDic[type]) {\r\n            var arr: any[] = [];\r\n            var tType: number;\r\n            tType = 1;\r\n            while (tType <= type) {\r\n                if (tType & type) {\r\n                    arr.push(QuickTestTool.getMCDName(tType & type));\r\n                }\r\n                tType = tType << 1;\r\n            }\r\n            QuickTestTool._rendertypeToStrDic[type] = arr.join(\",\");\r\n        }\r\n        console.log(\"cmd:\", QuickTestTool._rendertypeToStrDic[type]);\r\n\r\n    }\r\n\r\n    //TODO:coverage\r\n    static __init__(): void {\r\n\r\n        QuickTestTool._typeToNameDic[SpriteConst.ALPHA] = \"ALPHA\";\r\n        QuickTestTool._typeToNameDic[SpriteConst.TRANSFORM] = \"TRANSFORM\";\r\n        QuickTestTool._typeToNameDic[SpriteConst.TEXTURE] = \"TEXTURE\";\r\n        QuickTestTool._typeToNameDic[SpriteConst.GRAPHICS] = \"GRAPHICS\";\r\n        QuickTestTool._typeToNameDic[SpriteConst.ONECHILD] = \"ONECHILD\";\r\n        QuickTestTool._typeToNameDic[SpriteConst.CHILDS] = \"CHILDS\";\r\n        QuickTestTool._typeToNameDic[SpriteConst.TRANSFORM | SpriteConst.ALPHA] = \"TRANSFORM|ALPHA\";\r\n\r\n        QuickTestTool._typeToNameDic[SpriteConst.CANVAS] = \"CANVAS\";\r\n        QuickTestTool._typeToNameDic[SpriteConst.BLEND] = \"BLEND\";\r\n        QuickTestTool._typeToNameDic[SpriteConst.FILTERS] = \"FILTERS\";\r\n        QuickTestTool._typeToNameDic[SpriteConst.MASK] = \"MASK\";\r\n        QuickTestTool._typeToNameDic[SpriteConst.CLIP] = \"CLIP\";\r\n        QuickTestTool._typeToNameDic[SpriteConst.LAYAGL3D] = \"LAYAGL3D\";\r\n    }\r\n    _renderType: number;\r\n    _repaint: number;\r\n    _x: number;\r\n    _y: number;\r\n    //TODO:coverage\r\n    constructor() {\r\n\r\n    }\r\n    /**\r\n     * 更新、呈现显示对象。由系统调用。\r\n     * @param\tcontext 渲染的上下文引用。\r\n     * @param\tx X轴坐标。\r\n     * @param\ty Y轴坐标。\r\n     */\r\n    //TODO:coverage\r\n    render(context: Context, x: number, y: number): void {\r\n        QuickTestTool._addType(this._renderType);\r\n        QuickTestTool.showRenderTypeInfo(this._renderType);\r\n        //if (_renderType == (SpriteConst.IMAGE | SpriteConst.GRAPHICS | SpriteConst.CHILDS))\r\n        //{\r\n        //debugger;\r\n        //}\r\n        RenderSprite.renders[this._renderType]._fun(this, context, x + this._x, y + this._y);\r\n        this._repaint = 0;\r\n    }\r\n\r\n    private static _PreStageRender: Function;\r\n\r\n    /**@internal */\r\n    //TODO:coverage\r\n    _stageRender(context: Context, x: number, y: number): void {\r\n        QuickTestTool._countStart();\r\n        QuickTestTool._PreStageRender.call(ILaya.stage, context, x, y);//TODO TS\r\n        QuickTestTool._countEnd();\r\n    }\r\n    private static _countDic: any = {};\r\n\r\n    //TODO:coverage\r\n    private static _countStart(): void {\r\n        var key: string;\r\n        for (key in QuickTestTool._countDic) {\r\n            QuickTestTool._countDic[key] = 0;\r\n        }\r\n    }\r\n    private static _i: number = 0;\r\n\r\n    //TODO:coverage\r\n    private static _countEnd(): void {\r\n        QuickTestTool._i++;\r\n        if (QuickTestTool._i > 60) {\r\n            QuickTestTool.showCountInfo();\r\n            QuickTestTool._i = 0;\r\n        }\r\n    }\r\n\r\n    /**@internal */\r\n    private static _addType(type: number): void {\r\n        if (!QuickTestTool._countDic[type]) {\r\n            QuickTestTool._countDic[type] = 1;\r\n        } else {\r\n            QuickTestTool._countDic[type] += 1;\r\n        }\r\n    }\r\n\r\n    //TODO:coverage\r\n    static showCountInfo(): void {\r\n        console.log(\"===================\");\r\n        var key: string;\r\n        for (key in QuickTestTool._countDic) {\r\n            console.log(\"count:\" + QuickTestTool._countDic[key]);\r\n            QuickTestTool.showRenderTypeInfo(key, true);\r\n        }\r\n    }\r\n\r\n    //TODO:coverage\r\n    static enableQuickTest(): void {\r\n        QuickTestTool.__init__();\r\n        Sprite[\"prototype\"][\"render\"] = QuickTestTool[\"prototype\"][\"render\"];\r\n        QuickTestTool._PreStageRender = Stage[\"prototype\"][\"render\"];\r\n        Stage[\"prototype\"][\"render\"] = QuickTestTool[\"prototype\"][\"_stageRender\"];\r\n    }\r\n}\r\n\r\n\r\n","import { SoundChannel } from \"./SoundChannel\";\r\nimport { EventDispatcher } from \"../events/EventDispatcher\"\r\n\r\n/**\r\n * <code>Sound</code> 类是用来播放控制声音的类。\r\n * 引擎默认有两套声音方案，优先使用WebAudio播放声音，如果WebAudio不可用，则用H5Audio播放，H5Audio在部分机器上有兼容问题（比如不能混音，播放有延迟等）。\r\n */\r\nexport class Sound extends EventDispatcher {\r\n\r\n    /**\r\n     * 加载声音。\r\n     * @param url 地址。\r\n     */\r\n    load(url: string): void {\r\n\r\n    }\r\n\r\n    /**\r\n     * 播放声音。\r\n     * @param startTime 开始时间,单位秒\r\n     * @param loops 循环次数,0表示一直循环\r\n     * @return 声道 SoundChannel 对象。\r\n     */\r\n    play(startTime: number = 0, loops: number = 0): SoundChannel {\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * 获取总时间。\r\n     */\r\n    get duration(): number {\r\n        return 0;\r\n    }\r\n\r\n    /**\r\n     * 释放声音资源。\r\n     */\r\n    dispose(): void {\r\n\r\n    }\r\n}\r\n\r\n","import { SoundChannel } from \"./SoundChannel\";\r\nimport { SoundManager } from \"./SoundManager\";\r\nimport { Sprite } from \"../display/Sprite\"\r\nimport { Event } from \"../events/Event\"\r\nimport { Handler } from \"../utils/Handler\"\r\nimport { ClassUtils } from \"../utils/ClassUtils\";\r\n\r\n/**\r\n * @private\r\n */\r\nexport class SoundNode extends Sprite {\r\n    url: string;\r\n    private _channel: SoundChannel;\r\n    private _tar: Sprite;\r\n    private _playEvents: string;\r\n    private _stopEvents: string;\r\n\r\n    constructor() {\r\n        super();\r\n        this.visible = false;\r\n        this.on(Event.ADDED, this, this._onParentChange);\r\n        this.on(Event.REMOVED, this, this._onParentChange);\r\n    }\r\n\r\n    /**@private */\r\n    private _onParentChange(): void {\r\n\r\n        this.target = (<Sprite>this.parent);\r\n    }\r\n\r\n    /**\r\n     * 播放\r\n     * @param loops 循环次数\r\n     * @param complete 完成回调\r\n     *\r\n     */\r\n    play(loops: number = 1, complete: Handler = null): void {\r\n        if (isNaN(loops)) {\r\n            loops = 1;\r\n        }\r\n        if (!this.url) return;\r\n        this.stop();\r\n        this._channel = SoundManager.playSound(this.url, loops, complete);\r\n    }\r\n\r\n    /**\r\n     * 停止播放\r\n     *\r\n     */\r\n    stop(): void {\r\n        if (this._channel && !this._channel.isStopped) {\r\n            this._channel.stop();\r\n        }\r\n        this._channel = null;\r\n    }\r\n\r\n    /**@private */\r\n    private _setPlayAction(tar: Sprite, event: string, action: string, add: boolean = true): void {\r\n        if (!this[action]) return;\r\n        if (!tar) return;\r\n        if (add) {\r\n            tar.on(event, this, this[action]);\r\n        } else {\r\n            tar.off(event, this, this[action]);\r\n        }\r\n\r\n    }\r\n\r\n    /**@private */\r\n    private _setPlayActions(tar: Sprite, events: string, action: string, add: boolean = true): void {\r\n        if (!tar) return;\r\n        if (!events) return;\r\n        var eventArr: any[] = events.split(\",\");\r\n        var i: number, len: number;\r\n        len = eventArr.length;\r\n        for (i = 0; i < len; i++) {\r\n            this._setPlayAction(tar, eventArr[i], action, add);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置触发播放的事件\r\n     * @param events\r\n     *\r\n     */\r\n    set playEvent(events: string) {\r\n        this._playEvents = events;\r\n        if (!events) return;\r\n        if (this._tar) {\r\n            this._setPlayActions(this._tar, events, \"play\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置控制播放的对象\r\n     * @param tar\r\n     *\r\n     */\r\n    set target(tar: Sprite) {\r\n        if (this._tar) {\r\n            this._setPlayActions(this._tar, this._playEvents, \"play\", false);\r\n            this._setPlayActions(this._tar, this._stopEvents, \"stop\", false);\r\n        }\r\n        this._tar = tar;\r\n        if (this._tar) {\r\n            this._setPlayActions(this._tar, this._playEvents, \"play\", true);\r\n            this._setPlayActions(this._tar, this._stopEvents, \"stop\", true);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置触发停止的事件\r\n     * @param events\r\n     *\r\n     */\r\n    set stopEvent(events: string) {\r\n        this._stopEvents = events;\r\n        if (!events) return;\r\n        if (this._tar) {\r\n            this._setPlayActions(this._tar, events, \"stop\");\r\n        }\r\n    }\r\n}\r\n\r\nClassUtils.regClass(\"laya.media.SoundNode\", SoundNode);\r\nClassUtils.regClass(\"Laya.SoundNode\", SoundNode);\r\n","import { Loader } from \"./Loader\";\r\nimport { URL } from \"./URL\";\r\nimport { Handler } from \"../utils/Handler\"\r\nimport { ILaya } from \"../../ILaya\";\r\n\r\n/**\r\n * <p>资源版本的生成由layacmd或IDE完成，使用 <code>ResourceVersion</code> 简化使用过程。</p>\r\n * <p>调用 <code>enable</code> 启用资源版本管理。</p>\r\n */\r\nexport class ResourceVersion {\r\n    /**基于文件夹的资源管理方式（老版本IDE默认类型）*/\r\n    static FOLDER_VERSION: number = 1;\r\n    /**基于文件名映射管理方式（新版本IDE默认类型）*/\r\n    static FILENAME_VERSION: number = 2;\r\n    /**版本清单*/\r\n    static manifest: any;\r\n    /**当前使用的版本管理类型*/\r\n    static type: number = ResourceVersion.FOLDER_VERSION;\r\n\r\n    /**\r\n     * <p>启用资源版本管理。</p>\r\n     * <p>由于只有发布版本需要资源管理。因此没有资源管理文件时，可以设置manifestFile为null或者不存在的路径。</p>\r\n     * @param\tmanifestFile\t清单（json）文件的路径。\r\n     * @param   callback\t\t清单（json）文件加载完成后执行。\r\n     * @param   type\t\t\tFOLDER_VERSION为基于文件夹管理方式（老版本IDE默认类型），FILENAME_VERSION为基于文件名映射管理（新版本IDE默认类型\r\n     */\r\n    static enable(manifestFile: string, callback: Handler, type: number = 2): void {\r\n        ResourceVersion.type = type;\r\n        ILaya.loader.load(manifestFile, Handler.create(null, ResourceVersion.onManifestLoaded, [callback]), null, Loader.JSON);\r\n    }\r\n\r\n    private static onManifestLoaded(callback: Handler, data: any): void {\r\n        ResourceVersion.manifest = data;\r\n        URL.customFormat = ResourceVersion.addVersionPrefix;\r\n        callback.run();\r\n        if (!data) {\r\n            console.warn(\"资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 为加载路径添加版本前缀。\r\n     * @param\toriginURL\t源路径。\r\n     * @return 格式化后的新路径。\r\n     */\r\n    static addVersionPrefix(originURL: string): string {\r\n        originURL = URL.getAdptedFilePath(originURL);\r\n        if (ResourceVersion.manifest && ResourceVersion.manifest[originURL]) {\r\n            if (ResourceVersion.type == ResourceVersion.FILENAME_VERSION) return ResourceVersion.manifest[originURL];\r\n            return ResourceVersion.manifest[originURL] + \"/\" + originURL;\r\n        }\r\n\r\n        return originURL;\r\n    }\r\n}\r\n\r\n","import { Event } from \"../events/Event\"\r\nimport { EventDispatcher } from \"../events/EventDispatcher\"\r\nimport { Browser } from \"../utils/Browser\"\r\nimport { Byte } from \"../utils/Byte\"\r\n\r\n/**\r\n * 连接建立成功后调度。\r\n * @eventType Event.OPEN\r\n * */\r\n/*[Event(name = \"open\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 接收到数据后调度。\r\n * @eventType Event.MESSAGE\r\n * */\r\n/*[Event(name = \"message\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 连接被关闭后调度。\r\n * @eventType Event.CLOSE\r\n * */\r\n/*[Event(name = \"close\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 出现异常后调度。\r\n * @eventType Event.ERROR\r\n * */\r\n/*[Event(name = \"error\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * <p> <code>Socket</code> 封装了 HTML5 WebSocket ，允许服务器端与客户端进行全双工（full-duplex）的实时通信，并且允许跨域通信。在建立连接后，服务器和 Browser/Client Agent 都能主动的向对方发送或接收文本和二进制数据。</p>\r\n * <p>要使用 <code>Socket</code> 类的方法，请先使用构造函数 <code>new Socket</code> 创建一个 <code>Socket</code> 对象。 <code>Socket</code> 以异步方式传输和接收数据。</p>\r\n */\r\nexport class Socket extends EventDispatcher {\r\n    /**\r\n     * <p>主机字节序，是 CPU 存放数据的两种不同顺序，包括小端字节序和大端字节序。</p>\r\n     * <p> LITTLE_ENDIAN ：小端字节序，地址低位存储值的低位，地址高位存储值的高位。</p>\r\n     * <p> BIG_ENDIAN ：大端字节序，地址低位存储值的高位，地址高位存储值的低位。有时也称之为网络字节序。</p>\r\n     */\r\n    static LITTLE_ENDIAN: string = \"littleEndian\";\r\n    /**\r\n     * <p>主机字节序，是 CPU 存放数据的两种不同顺序，包括小端字节序和大端字节序。</p>\r\n     * <p> BIG_ENDIAN ：大端字节序，地址低位存储值的高位，地址高位存储值的低位。有时也称之为网络字节序。</p>\r\n     * <p> LITTLE_ENDIAN ：小端字节序，地址低位存储值的低位，地址高位存储值的高位。</p>\r\n     */\r\n    static BIG_ENDIAN: string = \"bigEndian\";\r\n    /**@internal */\r\n    _endian: string;\r\n    /**@private */\r\n    protected _socket: any;\r\n    /**@private */\r\n    private _connected: boolean;\r\n    /**@private */\r\n    private _addInputPosition: number;\r\n    /**@private */\r\n    private _input: any;\r\n    /**@private */\r\n    private _output: any;\r\n\r\n    /**\r\n     * 不再缓存服务端发来的数据，如果传输的数据为字符串格式，建议设置为true，减少二进制转换消耗。\r\n     */\r\n    disableInput: boolean = false;\r\n    /**\r\n     * 用来发送和接收数据的 <code>Byte</code> 类。\r\n     */\r\n    private _byteClass: new () => any;\r\n    /**\r\n     * <p>子协议名称。子协议名称字符串，或由多个子协议名称字符串构成的数组。必须在调用 connect 或者 connectByUrl 之前进行赋值，否则无效。</p>\r\n     * <p>指定后，只有当服务器选择了其中的某个子协议，连接才能建立成功，否则建立失败，派发 Event.ERROR 事件。</p>\r\n     * @see https://html.spec.whatwg.org/multipage/comms.html#dom-websocket\r\n     */\r\n    protocols: any = [];\r\n\r\n    /**\r\n     * 缓存的服务端发来的数据。\r\n     */\r\n    get input(): any {\r\n        return this._input;\r\n    }\r\n\r\n    /**\r\n     * 表示需要发送至服务端的缓冲区中的数据。\r\n     */\r\n    get output(): any {\r\n        return this._output;\r\n    }\r\n\r\n    /**\r\n     * 表示此 Socket 对象目前是否已连接。\r\n     */\r\n    get connected(): boolean {\r\n        return this._connected;\r\n    }\r\n\r\n    /**\r\n     * <p>主机字节序，是 CPU 存放数据的两种不同顺序，包括小端字节序和大端字节序。</p>\r\n     * <p> LITTLE_ENDIAN ：小端字节序，地址低位存储值的低位，地址高位存储值的高位。</p>\r\n     * <p> BIG_ENDIAN ：大端字节序，地址低位存储值的高位，地址高位存储值的低位。</p>\r\n     */\r\n    get endian(): string {\r\n        return this._endian;\r\n    }\r\n\r\n    set endian(value: string) {\r\n        this._endian = value;\r\n        if (this._input != null) this._input.endian = value;\r\n        if (this._output != null) this._output.endian = value;\r\n    }\r\n\r\n    /**\r\n     * <p>创建新的 Socket 对象。默认字节序为 Socket.BIG_ENDIAN 。若未指定参数，将创建一个最初处于断开状态的套接字。若指定了有效参数，则尝试连接到指定的主机和端口。</p>\r\n     * @param host\t\t服务器地址。\r\n     * @param port\t\t服务器端口。\r\n     * @param byteClass\t用于接收和发送数据的 Byte 类。如果为 null ，则使用 Byte 类，也可传入 Byte 类的子类。\r\n     * @param protocols\t子协议名称。子协议名称字符串，或由多个子协议名称字符串构成的数组\r\n     * @see laya.utils.Byte\r\n     */\r\n    constructor(host: string|null = null, port: number = 0, byteClass: new () => any = null, protocols: any[]|null = null) {\r\n        super();\r\n        this._byteClass = byteClass ? byteClass : Byte;\r\n        this.protocols = protocols;\r\n        this.endian = Socket.BIG_ENDIAN;\r\n        if (host && port > 0 && port < 65535) this.connect(host, port);\r\n    }\r\n\r\n    /**\r\n     * <p>连接到指定的主机和端口。</p>\r\n     * <p>连接成功派发 Event.OPEN 事件；连接失败派发 Event.ERROR 事件；连接被关闭派发 Event.CLOSE 事件；接收到数据派发 Event.MESSAGE 事件； 除了 Event.MESSAGE 事件参数为数据内容，其他事件参数都是原生的 HTML DOM Event 对象。</p>\r\n     * @param host\t服务器地址。\r\n     * @param port\t服务器端口。\r\n     */\r\n    connect(host: string, port: number): void {\r\n        var url: string = \"ws://\" + host + \":\" + port;\r\n        this.connectByUrl(url);\r\n    }\r\n\r\n    /**\r\n     * <p>连接到指定的服务端 WebSocket URL。 URL 类似 ws://yourdomain:port。</p>\r\n     * <p>连接成功派发 Event.OPEN 事件；连接失败派发 Event.ERROR 事件；连接被关闭派发 Event.CLOSE 事件；接收到数据派发 Event.MESSAGE 事件； 除了 Event.MESSAGE 事件参数为数据内容，其他事件参数都是原生的 HTML DOM Event 对象。</p>\r\n     * @param url\t要连接的服务端 WebSocket URL。 URL 类似 ws://yourdomain:port。\r\n     */\r\n    connectByUrl(url: string): void {\r\n        if (this._socket != null) this.close();\r\n\r\n        this._socket && this.cleanSocket();\r\n\r\n        if (!this.protocols || this.protocols.length == 0) {\r\n            this._socket = new Browser.window.WebSocket(url);\r\n        } else {\r\n            this._socket = new Browser.window.WebSocket(url, this.protocols);\r\n        }\r\n\r\n        this._socket.binaryType = \"arraybuffer\";\r\n\r\n        this._output = new this._byteClass();\r\n        this._output.endian = this.endian;\r\n        this._input = new this._byteClass();\r\n        this._input.endian = this.endian;\r\n        this._addInputPosition = 0;\r\n\r\n        this._socket.onopen = (e: any) => {\r\n            this._onOpen(e);\r\n        };\r\n        this._socket.onmessage = (msg: any): void => {\r\n            this._onMessage(msg);\r\n        };\r\n        this._socket.onclose = (e: any): void => {\r\n            this._onClose(e);\r\n        };\r\n        this._socket.onerror = (e: any): void => {\r\n            this._onError(e);\r\n        };\r\n    }\r\n\r\n    /**\r\n     * 清理Socket：关闭Socket链接，关闭事件监听，重置Socket\r\n     */\r\n    cleanSocket(): void {\r\n        this.close();\r\n        this._connected = false;\r\n        this._socket.onopen = null;\r\n        this._socket.onmessage = null;\r\n        this._socket.onclose = null;\r\n        this._socket.onerror = null;\r\n        this._socket = null;\r\n    }\r\n\r\n    /**\r\n     * 关闭连接。\r\n     */\r\n    close(): void {\r\n        if (this._socket != null) {\r\n            try {\r\n                this._socket.close();\r\n            } catch (e) {\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 连接建立成功 。\r\n     */\r\n    protected _onOpen(e: any): void {\r\n        this._connected = true;\r\n        this.event(Event.OPEN, e);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 接收到数据处理方法。\r\n     * @param msg 数据。\r\n     */\r\n    protected _onMessage(msg: any): void {\r\n        if (!msg || !msg.data) return;\r\n        var data: any = msg.data;\r\n        if (this.disableInput && data) {\r\n            this.event(Event.MESSAGE, data);\r\n            return;\r\n        }\r\n        if (this._input.length > 0 && this._input.bytesAvailable < 1) {\r\n            this._input.clear();\r\n            this._addInputPosition = 0;\r\n        }\r\n        var pre: number = this._input.pos;\r\n        !this._addInputPosition && (this._addInputPosition = 0);\r\n        this._input.pos = this._addInputPosition;\r\n\r\n        if (data) {\r\n            if (typeof (data) == 'string') {\r\n                this._input.writeUTFBytes(data);\r\n            } else {\r\n                this._input.writeArrayBuffer(data);\r\n            }\r\n            this._addInputPosition = this._input.pos;\r\n            this._input.pos = pre;\r\n        }\r\n        this.event(Event.MESSAGE, data);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 连接被关闭处理方法。\r\n     */\r\n    protected _onClose(e: any): void {\r\n        this._connected = false;\r\n        this.event(Event.CLOSE, e)\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 出现异常处理方法。\r\n     */\r\n    protected _onError(e: any): void {\r\n        this.event(Event.ERROR, e)\r\n    }\r\n\r\n    /**\r\n     * 发送数据到服务器。\r\n     * @param\tdata 需要发送的数据，可以是String或者ArrayBuffer。\r\n     */\r\n    send(data: any): void {\r\n        this._socket.send(data);\r\n    }\r\n\r\n    /**\r\n     * 发送缓冲区中的数据到服务器。\r\n     */\r\n    flush(): void {\r\n        if (this._output && this._output.length > 0) {\r\n            var evt: any;\r\n            try {\r\n                this._socket && this._socket.send(this._output.__getBuffer().slice(0, this._output.length));\r\n            } catch (e) {\r\n                evt = e;\r\n            }\r\n            this._output.endian = this.endian;\r\n            this._output.clear();\r\n            if (evt) this.event(Event.ERROR, evt);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n","/**\r\n * 纹理解码格式。\r\n */\r\nexport enum TextureDecodeFormat {\r\n    /** 常规解码方式,直接采样纹理颜色。*/\r\n    Normal,\r\n    /** 按照RGBM方式解码并计算最终RGB颜色。 */\r\n    RGBM\r\n}","import { BaseTexture } from \"./BaseTexture\";\r\nimport { LayaGL } from \"../layagl/LayaGL\";\r\nimport { WarpMode } from \"./WrapMode\";\r\nimport { FilterMode } from \"./FilterMode\";\r\nimport { WebGLContext } from \"../webgl/WebGLContext\";\r\nimport { Laya } from \"../../Laya\";\r\n\r\n\r\n/**\r\n * <code>VideoTexture</code> 多媒体纹理\r\n */\r\nexport class VideoTexture extends BaseTexture {\r\n\t/**videoTexture对象池*/\r\n\tpublic static _videoTexturePool:Array<VideoTexture> = new Array<VideoTexture>();\r\n\t/**\r\n\t * @internal 会在场景中更新video文件\r\n\t */\r\n\tstatic _update(): void {\r\n\t\tvar pool: Array<VideoTexture> = VideoTexture._videoTexturePool;\r\n\t\tfor (var i: number = 0, n: number = pool.length; i < n; i++) {\r\n\t\t\tvar videoElement = pool[i] ;\r\n\t\t\t(videoElement)&&videoElement._updateVideoData();\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\tprivate _video:any;\r\n\tprivate _needUpdate:Boolean;\r\n\t/**\r\n\t * 创建VideoTexture对象，\r\n\t */\r\n\tconstructor(){\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tsuper(gl.RGB,false);\r\n\t\tthis._glTextureType = gl.TEXTURE_2D;\r\n\t\tthis._width = 1;\r\n\t\tthis._height = 1;\r\n\t\tthis._wrapModeU = this._wrapModeV = WarpMode.Clamp;\r\n\t\tthis._filterMode = FilterMode.Bilinear;\r\n\t\tthis._setWarpMode(gl.TEXTURE_WRAP_S, this._wrapModeU);\r\n\t\tthis._setWarpMode(gl.TEXTURE_WRAP_T, this._wrapModeV);\r\n\t\tthis._setFilterMode(this._filterMode);\r\n\t\tthis._needUpdate = false;\r\n\t\tthis._readyed = true;\r\n\t\tVideoTexture._videoTexturePool.push(this);\r\n\t}\r\n\r\n\t/**\r\n\t * 获得绑定的资源Video\r\n\t * return HTMLVideoElement\r\n\t */\r\n\tget video():any{\r\n\t\treturn this._video;\r\n\t}\r\n\t/**\r\n\t * @value\r\n\t * 输入Video资源\r\n\t */\r\n\tset video(value:any){\r\n\t\tif(!value||!(value instanceof HTMLVideoElement))\r\n\t\t\treturn;\r\n\t\tthis._video = value;\r\n\t\tif (Laya.Browser.onMobile) {\r\n\t\t\t//miner \r\n\t\t\tthis._video[\"x5-playsInline\"]=true;\r\n\t\t\tthis._video[\"x5-playsinline\"]=true;\r\n\t\t\tthis._video.x5PlaysInline=true;\r\n\t\t\tthis._video.playsInline=true;\r\n\t\t\tthis._video[\"webkit-playsInline\"]=true;\r\n\t\t\tthis._video[\"webkit-playsinline\"]=true;\r\n\t\t\tthis._video.webkitPlaysInline=true;\r\n\t\t\tthis._video.playsinline=true;\r\n\t\t\tthis._video.style.playsInline=true;\r\n\t\t\tthis._video.crossOrigin=\"anonymous\";\r\n\t\t\tthis._video.setAttribute('crossorigin', \"anonymous\");\r\n\t\t\tthis._video.setAttribute('playsinline', 'true')\r\n\t\t\tthis._video.setAttribute('x5-playsinline', 'true')\r\n\t\t\tthis._video.setAttribute('webkit-playsinline', 'true')\r\n\t\t\tthis._video.autoplay=true;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_updateVideoData(){\r\n\t\tif(!this._video||!this._needUpdate)\r\n\t\t\treturn;\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tWebGLContext.bindTexture(gl, this._glTextureType, this._glTexture);\r\n\t\tgl.texImage2D(this._glTextureType,0,gl.RGB,gl.RGB,gl.UNSIGNED_BYTE,this._video);\r\n\t}\r\n\r\n\t/**\r\n\t * 开始播放视频\r\n\t */\r\n\tvideoPlay(){\r\n\t\tthis._video.play();\r\n\t\tthis._needUpdate = true;\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * 暂停播放视频\r\n\t */\r\n\tvideoPause(){\r\n\t\tthis._video.pause();\r\n\t\tthis._needUpdate = false;\r\n\t}\r\n\r\n\tdestroy(){\r\n\t\tsuper.destroy();\r\n\t\tthis._video = null;\r\n\t}\r\n}\r\n\r\n","/**\r\n * @private\r\n */\r\nexport class System {\r\n    /**\r\n     * 替换指定名称的定义。用来动态更改类的定义。\r\n     * @param\tname 属性名。\r\n     * @param\tclassObj 属性值。\r\n     */\r\n    //TODO:coverage\r\n    static changeDefinition(name: string, classObj: any): void {\r\n        (window as any).Laya[name] = classObj;\r\n        var str: string = name + \"=classObj\";\r\n        window['eval'](str);\r\n    }\r\n}\r\n\r\n","import { Pool } from \"./Pool\";\r\n/**\r\n * @private\r\n * <code>HTMLChar</code> 是一个 HTML 字符类。\r\n */\r\nexport class HTMLChar {\r\n\r\n    private static _isWordRegExp: RegExp = new RegExp(\"[\\\\w\\.]\", \"\");\r\n\r\n    /** x坐标*/\r\n    x: number;\r\n    /** y坐标*/\r\n    y: number;\r\n    /** 宽*/\r\n    width: number;\r\n    /** 高*/\r\n    height: number;\r\n    /** 表示是否是正常单词(英文|.|数字)。*/\r\n    isWord: boolean;\r\n    /** 字符。*/\r\n    char: string|null;\r\n    /** 字符数量。*/\r\n    charNum: number;\r\n    /** CSS 样式。*/\r\n    style: any;\r\n\r\n    /**\r\n     * 创建实例\r\n     */\r\n    constructor() {\r\n        this.reset();\r\n    }\r\n\r\n    /**\r\n     * 根据指定的字符、宽高、样式，创建一个 <code>HTMLChar</code> 类的实例。\r\n     * @param\tchar 字符。\r\n     * @param\tw 宽度。\r\n     * @param\th 高度。\r\n     * @param\tstyle CSS 样式。\r\n     */\r\n    setData(char: string, w: number, h: number, style: any): HTMLChar {\r\n        this.char = char;\r\n        this.charNum = char.charCodeAt(0);\r\n        this.x = this.y = 0;\r\n        this.width = w;\r\n        this.height = h;\r\n        this.style = style;\r\n        this.isWord = !HTMLChar._isWordRegExp.test(char);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 重置\r\n     */\r\n    reset(): HTMLChar {\r\n        this.x = this.y = this.width = this.height = 0;\r\n        this.isWord = false;\r\n        this.char = null;\r\n        this.charNum = 0;\r\n        this.style = null;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 回收\r\n     */\r\n    //TODO:coverage\r\n    recover(): void {\r\n        Pool.recover(\"HTMLChar\", this.reset());\r\n    }\r\n\r\n    /**\r\n     * 创建\r\n     */\r\n    static create(): HTMLChar {\r\n        return Pool.getItemByClass(\"HTMLChar\", HTMLChar);\r\n    }\r\n\r\n    /** @internal */\r\n    _isChar(): boolean {\r\n        return true;\r\n    }\r\n\r\n    /** @internal */\r\n    _getCSSStyle(): any {\r\n        return this.style;\r\n    }\r\n}\r\n\r\n","import { Browser } from \"./Browser\";\r\n/**\r\n\t * <code>Log</code> 类用于在界面内显示日志记录信息。\r\n\t * 注意：在加速器内不可使用\r\n\t */\r\nexport class Log {\r\n\r\n    /**@private */\r\n    private static _logdiv: any;\r\n    /**@private */\r\n    private static _btn: any;\r\n    /**@private */\r\n    private static _count: number = 0;\r\n    /**最大打印数量，超过这个数量，则自动清理一次，默认为50次*/\r\n    static maxCount: number = 50;\r\n    /**是否自动滚动到底部，默认为true*/\r\n    static autoScrollToBottom: boolean = true;\r\n\r\n    /**\r\n     * 激活Log系统，使用方法Laya.init(800,600,Laya.Log);\r\n     */\r\n    static enable(): void {\r\n        if (!Log._logdiv) {\r\n            Log._logdiv = Browser.createElement('div');\r\n            Log._logdiv.style.cssText = \"border:white;padding:4px;overflow-y:auto;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;\";\r\n            Browser.document.body.appendChild(Log._logdiv);\r\n\r\n            Log._btn = Browser.createElement(\"button\");\r\n            Log._btn.innerText = \"Hide\";\r\n            Log._btn.style.cssText = \"z-index:1000001;position: absolute;left:10px;top:10px;\";\r\n            Log._btn.onclick = Log.toggle;\r\n            Browser.document.body.appendChild(Log._btn);\r\n        }\r\n    }\r\n\r\n    /**隐藏/显示日志面板*/\r\n    static toggle(): void {\r\n        var style: any = Log._logdiv.style;\r\n        if (style.display === \"\") {\r\n            Log._btn.innerText = \"Show\";\r\n            style.display = \"none\";\r\n        } else {\r\n            Log._btn.innerText = \"Hide\";\r\n            style.display = \"\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 增加日志内容。\r\n     * @param\tvalue 需要增加的日志内容。\r\n     */\r\n    static print(value: string): void {\r\n        if (Log._logdiv) {\r\n            //内容太多清理掉\r\n            if (Log._count >= Log.maxCount) Log.clear();\r\n            Log._count++;\r\n\r\n            Log._logdiv.innerText += value + \"\\n\";\r\n            //自动滚动\r\n            if (Log.autoScrollToBottom) {\r\n                if (Log._logdiv.scrollHeight - Log._logdiv.scrollTop - Log._logdiv.clientHeight < 50) {\r\n                    Log._logdiv.scrollTop = Log._logdiv.scrollHeight;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 清理日志\r\n     */\r\n    static clear(): void {\r\n        Log._logdiv.innerText = \"\";\r\n        Log._count = 0;\r\n    }\r\n}\r\n\r\n","//import { PerfHUD } from \"./PerfHUD\";\r\nlet DATANUM = 300;\r\nexport class PerfData {\r\n    id: number;\r\n    name: string;\r\n    color: number;\r\n    scale: number = 1.0;\r\n    datas: any[] = new Array(DATANUM);\r\n    datapos: number = 0;\r\n    constructor(id: number, color: number, name: string, scale: number) {\r\n        this.id = id;\r\n        this.color = color;\r\n        this.name = name;\r\n        this.scale = scale;\r\n    }\r\n    addData(v: number): void {\r\n        this.datas[this.datapos] = v;\r\n        this.datapos++;\r\n        this.datapos %= DATANUM;\r\n    }\r\n}\r\n\r\n","import { PerfData } from \"./PerfData\";\r\nimport { Sprite } from \"../display/Sprite\"\r\nimport { SpriteConst } from \"../display/SpriteConst\"\r\nimport { Context } from \"../resource/Context\"\r\nexport class PerfHUD extends Sprite {\r\n    private static _lastTm: number = 0;\t//perf Data\r\n    private static _now: () => number = null;\r\n    private datas: any[] = [];\r\n    static DATANUM: number = 300;\r\n\r\n    xdata: any[] = new Array(PerfHUD.DATANUM);\r\n    ydata: any[] = new Array(PerfHUD.DATANUM);\r\n\r\n    hud_width: number = 800;\r\n    hud_height: number = 200;\r\n\r\n    gMinV: number = 0;\r\n    gMaxV: number = 100;\r\n\r\n    private textSpace: number = 40;\t//留给刻度文字的\r\n    static inst: PerfHUD;\r\n\r\n    private _now: Function;\r\n    private sttm: number = 0;\r\n\r\n    static drawTexTm: number = 0;\r\n\r\n    //TODO:coverage\r\n    constructor() {\r\n        super();\r\n        PerfHUD.inst = this;\r\n        this._renderType |= SpriteConst.CUSTOM;\r\n        this._setRenderType(this._renderType);\r\n        this._setCustomRender();\r\n\r\n        this.addDataDef(0, 0xffffff, 'frame', 1.0);\r\n        this.addDataDef(1, 0x00ff00, 'update', 1.0);\r\n        this.addDataDef(2, 0xff0000, 'flush', 1.0);\r\n        PerfHUD._now = performance ? performance.now.bind(performance) : Date.now;\r\n    }\r\n\r\n    //TODO:coverage\r\n    now(): number {\r\n        return PerfHUD._now();\r\n    }\r\n\r\n    //TODO:coverage\r\n    start(): void {\r\n        this.sttm = PerfHUD._now();\r\n    }\r\n\r\n    //TODO:coverage\r\n    end(i: number): void {\r\n        var dt: number = PerfHUD._now() - this.sttm;\r\n        this.updateValue(i, dt);\r\n    }\r\n\r\n    //TODO:coverage\r\n    config(w: number, h: number): void {\r\n        this.hud_width = w;\r\n        this.hud_height = h;\r\n    }\r\n\r\n    //TODO:coverage\r\n    addDataDef(id: number, color: number, name: string, scale: number): void {\r\n        this.datas[id] = new PerfData(id, color, name, scale);\r\n    }\r\n\r\n    //TODO:coverage\r\n    updateValue(id: number, v: number): void {\r\n        this.datas[id].addData(v);\r\n    }\r\n\r\n    //TODO:coverage\r\n    v2y(v: number): number {\r\n        var bb: number = this._y + this.hud_height * (1 - (v - this.gMinV) / this.gMaxV);\r\n        return this._y + this.hud_height * (1 - (v - this.gMinV) / this.gMaxV);\r\n    }\r\n\r\n    //TODO:coverage\r\n    drawHLine(ctx: Context, v: number, color: string, text: string): void {\r\n        var sx: number = this._x;\r\n        var ex: number = this._x + this.hud_width;\r\n        var sy: number = this.v2y(v);\r\n        ctx.fillText(text, sx, sy - 6, null, 'green', null);\r\n        sx += this.textSpace;\r\n        ctx.fillStyle = color;\r\n        ctx.fillRect(sx, sy, this._x + this.hud_width, 1, null);\r\n    }\r\n\r\n    //TODO:coverage\r\n    /**\r\n     * \r\n     * @param ctx \r\n     * @param x \r\n     * @param y \r\n     * @override\r\n     */\r\n    customRender(ctx: Context, x: number, y: number): void {\r\n        var now: number = performance.now();;\r\n        if (PerfHUD._lastTm <= 0) PerfHUD._lastTm = now;\r\n        this.updateValue(0, now - PerfHUD._lastTm);\r\n        PerfHUD._lastTm = now;\r\n\r\n        ctx.save();\r\n        ctx.fillRect(this._x, this._y, this.hud_width, this.hud_height + 4, '#000000cc');\r\n        ctx.globalAlpha = 0.9;\r\n        /*\r\n        for ( var i = 0; i < gMaxV; i+=30) {\r\n            drawHLine(ctx, i, 'green', '' + i);// '' + Math.round(1000 / (i + 1)));\r\n        }\r\n        */\r\n        this.drawHLine(ctx, 0, 'green', '    0');\r\n        this.drawHLine(ctx, 10, 'green', '  10');\r\n        this.drawHLine(ctx, 16.667, 'red', ' ');\r\n        this.drawHLine(ctx, 20, 'green', '50|20');\r\n        this.drawHLine(ctx, 16.667 * 2, 'yellow', '');\r\n        this.drawHLine(ctx, 16.667 * 3, 'yellow', '');\r\n        this.drawHLine(ctx, 16.667 * 4, 'yellow', '');\r\n        this.drawHLine(ctx, 50, 'green', '20|50');\r\n        this.drawHLine(ctx, 100, 'green', '10|100');\r\n\r\n        //数据\r\n        for (var di: number = 0, sz: number = this.datas.length; di < sz; di++) {\r\n            var cd: PerfData = this.datas[di];\r\n            if (!cd) continue;\r\n            var dtlen: number = cd.datas.length;\r\n            var dx: number = (this.hud_width - this.textSpace) / dtlen;\r\n            var cx: number = cd.datapos;\r\n            var _cx: number = this._x + this.textSpace;\r\n            ctx.fillStyle = cd.color;\r\n            //开始部分\r\n            /*\r\n            ctx.beginPath();\r\n            ctx.strokeStyle = cd.color;\r\n            ctx.moveTo(_cx, v2y(cd.datas[cx]* cd.scale) );\r\n            cx++;\r\n            _cx += dx;\r\n            for ( var dtsz:int = dtlen; cx < dtsz; cx++) {\r\n                ctx.lineTo(_cx, v2y(cd.datas[cx]* cd.scale) );\r\n                _cx += dx;\r\n            }\r\n            //剩下的\r\n            for (cx = 0; cx < cd.datapos; cx++) {\r\n                ctx.lineTo(_cx, v2y(cd.datas[cx] * cd.scale));\r\n                _cx += dx;\r\n            }\r\n            ctx.stroke();\r\n            */\r\n            for (var dtsz: number = dtlen; cx < dtsz; cx++) {\r\n                var sty: number = this.v2y(cd.datas[cx] * cd.scale);\r\n                ctx.fillRect(_cx, sty, dx, this.hud_height + this._y - sty, null);\r\n                _cx += dx;\r\n            }\r\n            //剩下的\r\n            for (cx = 0; cx < cd.datapos; cx++) {\r\n                sty = this.v2y(cd.datas[cx] * cd.scale);\r\n                ctx.fillRect(_cx, sty, dx, this.hud_height + this._y - sty, null);\r\n                _cx += dx;\r\n            }\r\n\r\n        }\r\n        ctx.restore();\r\n    }\r\n}\r\n\r\n","import { CacheManger } from \"./CacheManger\";\r\nimport { Utils } from \"./Utils\";\r\nimport { Pool } from \"./Pool\";\r\n/**\r\n\t * @private\r\n\t * 基于个数的对象缓存管理器\r\n\t */\r\nexport class PoolCache {\r\n\r\n    //TODO:\r\n    /**\r\n     * 对象在Pool中的标识\r\n     */\r\n    sign: string;\r\n    /**\r\n     * 允许缓存的最大数量\r\n     */\r\n    maxCount: number = 1000;\r\n\r\n    /**\r\n     * 获取缓存的对象列表\r\n     * @return\r\n     *\r\n     */\r\n    getCacheList(): any[] {\r\n        return Pool.getPoolBySign(this.sign);\r\n    }\r\n\r\n    /**\r\n     * 尝试清理缓存\r\n     * @param force 是否强制清理\r\n     *\r\n     */\r\n    tryDispose(force: boolean): void {\r\n        var list: any[];\r\n        list = Pool.getPoolBySign(this.sign);\r\n        if (list.length > this.maxCount) {\r\n            list.splice(this.maxCount, list.length - this.maxCount);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 添加对象缓存管理\r\n     * @param sign 对象在Pool中的标识\r\n     * @param maxCount 允许缓存的最大数量\r\n     *\r\n     */\r\n    static addPoolCacheManager(sign: string, maxCount: number = 100): void {\r\n        var cache: PoolCache;\r\n        cache = new PoolCache();\r\n        cache.sign = sign;\r\n        cache.maxCount = maxCount;\r\n        CacheManger.regCacheByFunction(Utils.bind(cache.tryDispose, cache), Utils.bind(cache.getCacheList, cache));\r\n    }\r\n}\r\n\r\n","import { Pool } from \"./Pool\";\r\nimport { Tween } from \"./Tween\";\r\nimport { Browser } from \"./Browser\";\r\nimport { Handler } from \"./Handler\";\r\nimport { Utils } from \"./Utils\";\r\nimport { Event } from \"../events/Event\"\r\nimport { EventDispatcher } from \"../events/EventDispatcher\"\r\nimport { ILaya } from \"../../ILaya\";\r\n\r\n/**\r\n * 整个缓动结束的时候会调度\r\n * @eventType Event.COMPLETE\r\n */\r\n/*[Event(name = \"complete\", type = \"laya.events.Event\")]*/\r\n/**\r\n * 当缓动到达标签时会调度。\r\n * @eventType Event.LABEL\r\n */\r\n/*[Event(name = \"label\", type = \"laya.events.Event\")]*/\r\n\r\n/**\r\n * <code>TimeLine</code> 是一个用来创建时间轴动画的类。\r\n */\r\nexport class TimeLine extends EventDispatcher {\r\n\r\n    private _labelDic: any;\r\n    private _tweenDic: any = {};\r\n    private _tweenDataList: any[] = [];\r\n    private _endTweenDataList: any[];//以结束时间进行排序\r\n    private _currTime: number = 0;\r\n    private _lastTime: number = 0;\r\n    private _startTime: number = 0;\r\n    /**当前动画数据播放到第几个了*/\r\n    private _index: number = 0;\r\n    /**为TWEEN创建属于自己的唯一标识，方便管理*/\r\n    private _gidIndex: number = 0;\r\n    /**保留所有对象第一次注册动画时的状态（根据时间跳转时，需要把对象的恢复，再计算接下来的状态）*/\r\n    private _firstTweenDic: any = {};\r\n    /**是否需要排序*/\r\n    private _startTimeSort: boolean = false;\r\n    private _endTimeSort: boolean = false;\r\n    /**是否循环*/\r\n    private _loopKey: boolean = false;\r\n    /** 缩放动画播放的速度。*/\r\n    scale: number = 1;\r\n\r\n    private _frameRate: number = 60;\r\n    private _frameIndex: number = 0;\r\n    private _total: number = 0;\r\n\r\n    /**\r\n     * 控制一个对象，从当前点移动到目标点。\r\n     * @param\ttarget\t\t要控制的对象。\r\n     * @param\tprops\t\t要控制对象的属性。\r\n     * @param\tduration\t对象TWEEN的时间。\r\n     * @param\tease\t\t缓动类型\r\n     * @param\toffset\t\t相对于上一个对象，偏移多长时间（单位：毫秒）。\r\n     */\r\n    static to(target: any, props: any, duration: number, ease: Function = null, offset: number = 0): TimeLine {\r\n        return (new TimeLine()).to(target, props, duration, ease, offset);\r\n    }\r\n\r\n    /**\r\n     * 从 props 属性，缓动到当前状态。\r\n     * @param\ttarget\t\ttarget 目标对象(即将更改属性值的对象)\r\n     * @param\tprops\t\t要控制对象的属性\r\n     * @param\tduration\t对象TWEEN的时间\r\n     * @param\tease\t\t缓动类型\r\n     * @param\toffset\t\t相对于上一个对象，偏移多长时间（单位：毫秒）\r\n     */\r\n    static from(target: any, props: any, duration: number, ease: Function = null, offset: number = 0): TimeLine {\r\n        return (new TimeLine()).from(target, props, duration, ease, offset);\r\n    }\r\n\r\n    /**\r\n     * 控制一个对象，从当前点移动到目标点。\r\n     * @param\ttarget\t\t要控制的对象。\r\n     * @param\tprops\t\t要控制对象的属性。\r\n     * @param\tduration\t对象TWEEN的时间。\r\n     * @param\tease\t\t缓动类型\r\n     * @param\toffset\t\t相对于上一个对象，偏移多长时间（单位：毫秒）。\r\n     */\r\n    to(target: any, props: any, duration: number, ease: Function = null, offset: number = 0): TimeLine {\r\n        return this._create(target, props, duration, ease, offset, true);\r\n    }\r\n\r\n    /**\r\n     * 从 props 属性，缓动到当前状态。\r\n     * @param\ttarget\t\ttarget 目标对象(即将更改属性值的对象)\r\n     * @param\tprops\t\t要控制对象的属性\r\n     * @param\tduration\t对象TWEEN的时间\r\n     * @param\tease\t\t缓动类型\r\n     * @param\toffset\t\t相对于上一个对象，偏移多长时间（单位：毫秒）\r\n     */\r\n    from(target: any, props: any, duration: number, ease: Function = null, offset: number = 0): TimeLine {\r\n        return this._create(target, props, duration, ease, offset, false);\r\n    }\r\n\r\n    /** @private */\r\n    private _create(target: any, props: any, duration: number, ease: Function, offset: number, isTo: boolean): TimeLine {\r\n        var tTweenData: tweenData = Pool.getItemByClass(\"tweenData\", tweenData);\r\n        tTweenData.isTo = isTo;\r\n        tTweenData.type = 0;\r\n        tTweenData.target = target;\r\n        tTweenData.duration = duration;\r\n        tTweenData.data = props;\r\n        tTweenData.startTime = this._startTime + offset;\r\n        tTweenData.endTime = tTweenData.startTime + tTweenData.duration;\r\n        tTweenData.ease = ease;\r\n        this._startTime = Math.max(tTweenData.endTime, this._startTime);\r\n        this._tweenDataList.push(tTweenData);\r\n        this._startTimeSort = true;\r\n        this._endTimeSort = true;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 在时间队列中加入一个标签。\r\n     * @param\tlabel\t标签名称。\r\n     * @param\toffset\t标签相对于上个动画的偏移时间(单位：毫秒)。\r\n     */\r\n    addLabel(label: string, offset: number): TimeLine {\r\n        var tTweenData: tweenData = Pool.getItemByClass(\"tweenData\", tweenData);\r\n        tTweenData.type = 1;\r\n        tTweenData.data = label;\r\n        tTweenData.endTime = tTweenData.startTime = this._startTime + offset;\r\n        this._labelDic || (this._labelDic = {});\r\n        this._labelDic[label] = tTweenData;\r\n        this._tweenDataList.push(tTweenData);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 移除指定的标签\r\n     * @param\tlabel\r\n     */\r\n    removeLabel(label: string): void {\r\n        if (this._labelDic && this._labelDic[label]) {\r\n            var tTweenData: tweenData = this._labelDic[label];\r\n            if (tTweenData) {\r\n                var tIndex: number = this._tweenDataList.indexOf(tTweenData);\r\n                if (tIndex > -1) {\r\n                    this._tweenDataList.splice(tIndex, 1);\r\n                }\r\n            }\r\n            delete this._labelDic[label];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 动画从整个动画的某一时间开始。\r\n     * @param\ttime(单位：毫秒)。\r\n     */\r\n    gotoTime(time: number): void {\r\n        if (this._tweenDataList == null || this._tweenDataList.length == 0) return;\r\n        var tTween: Tween;\r\n        var tObject: any;\r\n        for (var p in this._firstTweenDic) {\r\n            tObject = this._firstTweenDic[p];\r\n            if (tObject) {\r\n                for (var tDataP in tObject) {\r\n                    if (tDataP in tObject.diyTarget) {\r\n                        tObject.diyTarget[tDataP] = tObject[tDataP];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        for (p in this._tweenDic) {\r\n            tTween = this._tweenDic[p];\r\n            tTween.clear();\r\n            delete this._tweenDic[p];\r\n        }\r\n        this._index = 0;\r\n        this._gidIndex = 0;\r\n        this._currTime = time;\r\n        this._lastTime = Browser.now();\r\n        var tTweenDataCopyList: any[];\r\n        if (this._endTweenDataList == null || this._endTimeSort) {\r\n            this._endTimeSort = false;\r\n            this._endTweenDataList = tTweenDataCopyList = this._tweenDataList.concat();\r\n            //对数据排序\r\n            function Compare(paraA: any, paraB: any): number {\r\n                if (paraA.endTime > paraB.endTime) {\r\n                    return 1;\r\n                } else if (paraA.endTime < paraB.endTime) {\r\n                    return -1;\r\n                } else {\r\n                    return 0;\r\n                }\r\n            }\r\n            tTweenDataCopyList.sort(Compare);\r\n        } else {\r\n            tTweenDataCopyList = this._endTweenDataList\r\n        }\r\n\r\n        var tTweenData: tweenData;\r\n        //叠加已经经过的关键帧数据\r\n        for (var i: number = 0, n: number = tTweenDataCopyList.length; i < n; i++) {\r\n            tTweenData = tTweenDataCopyList[i];\r\n            if (tTweenData.type == 0) {\r\n                if (time >= tTweenData.endTime) {\r\n                    this._index = Math.max(this._index, i + 1);\r\n                    //把经历过的属性加入到对象中\r\n                    var props: any = tTweenData.data;\r\n                    if (tTweenData.isTo) {\r\n                        for (var tP in props) {\r\n                            tTweenData.target[tP] = props[tP];\r\n                        }\r\n                    }\r\n                } else {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        //创建当前正在行动的TWEEN;\r\n        for (i = 0, n = this._tweenDataList.length; i < n; i++) {\r\n            tTweenData = this._tweenDataList[i];\r\n            if (tTweenData.type == 0) {\r\n                if (time >= tTweenData.startTime && time < tTweenData.endTime) {\r\n                    this._index = Math.max(this._index, i + 1);\r\n                    this._gidIndex++;\r\n                    tTween = Pool.getItemByClass(\"tween\", Tween);\r\n                    tTween._create(tTweenData.target, tTweenData.data, tTweenData.duration, tTweenData.ease, Handler.create(this, this._animComplete, [this._gidIndex]), 0, false, tTweenData.isTo, true, false);\r\n                    tTween.setStartTime(this._currTime - (time - tTweenData.startTime));\r\n                    tTween._updateEase(this._currTime);\r\n                    tTween.gid = this._gidIndex;\r\n                    this._tweenDic[this._gidIndex] = tTween;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 从指定的标签开始播。\r\n     * @param\tLabel 标签名。\r\n     */\r\n    gotoLabel(Label: string): void {\r\n        if (this._labelDic == null) return;\r\n        var tLabelData: tweenData = this._labelDic[Label];\r\n        if (tLabelData) this.gotoTime(tLabelData.startTime);\r\n    }\r\n\r\n    /**\r\n     * 暂停整个动画。\r\n     */\r\n    pause(): void {\r\n        ILaya.timer.clear(this, this._update);\r\n    }\r\n\r\n    /**\r\n     * 恢复暂停动画的播放。\r\n     */\r\n    resume(): void {\r\n        this.play(this._currTime, this._loopKey);\r\n    }\r\n\r\n    /**\r\n     * 播放动画。\r\n     * @param\ttimeOrLabel 开启播放的时间点或标签名。\r\n     * @param\tloop 是否循环播放。\r\n     */\r\n    play(timeOrLabel: any = 0, loop: boolean = false): void {\r\n        if (!this._tweenDataList) return;\r\n        if (this._startTimeSort) {\r\n            this._startTimeSort = false;\r\n            //对数据排序\r\n            function Compare(paraA: any, paraB: any): number {\r\n                if (paraA.startTime > paraB.startTime) {\r\n                    return 1;\r\n                } else if (paraA.startTime < paraB.startTime) {\r\n                    return -1;\r\n                } else {\r\n                    return 0;\r\n                }\r\n            }\r\n            this._tweenDataList.sort(Compare);\r\n\r\n            for (var i: number = 0, n: number = this._tweenDataList.length; i < n; i++) {\r\n                var tTweenData: tweenData = this._tweenDataList[i];\r\n                if (tTweenData != null && tTweenData.type == 0) {\r\n                    var tTarget: any = tTweenData.target;\r\n                    var gid: number = (tTarget.$_GID || (tTarget.$_GID = Utils.getGID()));\r\n                    var tSrcData: any = null;\r\n                    //把对象的初始属性保留下来，方便跳转时，回复到初始状态\r\n                    if (this._firstTweenDic[gid] == null) {\r\n                        tSrcData = {};\r\n                        tSrcData.diyTarget = tTarget;\r\n                        this._firstTweenDic[gid] = tSrcData;\r\n                    } else {\r\n                        tSrcData = this._firstTweenDic[gid];\r\n                    }\r\n                    for (var p in tTweenData.data) {\r\n                        if (tSrcData[p] == null) {\r\n                            tSrcData[p] = tTarget[p];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (typeof (timeOrLabel) == 'string') {\r\n            this.gotoLabel(timeOrLabel);\r\n        } else {\r\n            this.gotoTime(timeOrLabel);\r\n        }\r\n        this._loopKey = loop;\r\n        this._lastTime = Browser.now();\r\n        ILaya.timer.frameLoop(1, this, this._update);\r\n    }\r\n\r\n    /**\r\n     * 更新当前动画。\r\n     */\r\n    private _update(): void {\r\n        if (this._currTime >= this._startTime) {\r\n            if (this._loopKey) {\r\n                this._complete();\r\n                if (!this._tweenDataList) return;\r\n                this.gotoTime(0);\r\n            } else {\r\n                for (var p in this._tweenDic) {\r\n                    tTween = this._tweenDic[p];\r\n                    tTween.complete();\r\n                }\r\n                this.pause();\r\n                this._complete();\r\n                return;\r\n            }\r\n        }\r\n\r\n        var tNow: number = Browser.now();\r\n        var tFrameTime: number = tNow - this._lastTime;\r\n        var tCurrTime: number = this._currTime += tFrameTime * this.scale;\r\n        this._lastTime = tNow;\r\n\r\n        for (p in this._tweenDic) {\r\n            tTween = this._tweenDic[p];\r\n            tTween._updateEase(tCurrTime);\r\n        }\r\n\r\n        var tTween: Tween;\r\n        if (this._tweenDataList.length != 0 && this._index < this._tweenDataList.length) {\r\n            var tTweenData: tweenData = this._tweenDataList[this._index];\r\n            if (tCurrTime >= tTweenData.startTime) {\r\n                this._index++;\r\n                //创建TWEEN\r\n                if (tTweenData.type == 0) {\r\n                    this._gidIndex++;\r\n                    tTween = Pool.getItemByClass(\"tween\", Tween);\r\n                    tTween._create(tTweenData.target, tTweenData.data, tTweenData.duration, tTweenData.ease, Handler.create(this, this._animComplete, [this._gidIndex]), 0, false, tTweenData.isTo, true, false);\r\n                    tTween.setStartTime(tCurrTime);\r\n                    tTween.gid = this._gidIndex;\r\n                    this._tweenDic[this._gidIndex] = tTween;\r\n                    tTween._updateEase(tCurrTime);\r\n                } else {\r\n                    this.event(Event.LABEL, tTweenData.data);\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n\r\n    /**\r\n     * 指定的动画索引处的动画播放完成后，把此动画从列表中删除。\r\n     * @param\tindex\r\n     */\r\n    private _animComplete(index: number): void {\r\n        var tTween: Tween = this._tweenDic[index];\r\n        if (tTween) delete this._tweenDic[index];\r\n    }\r\n\r\n    /** @private */\r\n    private _complete(): void {\r\n        this.event(Event.COMPLETE);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 得到帧索引\r\n     */\r\n    get index(): number {\r\n        return this._frameIndex;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * 设置帧索引\r\n     */\r\n    set index(value: number) {\r\n        this._frameIndex = value;\r\n        this.gotoTime(this._frameIndex / this._frameRate * 1000);\r\n    }\r\n\r\n    /**\r\n     * 得到总帧数。\r\n     */\r\n    get total(): number {\r\n        this._total = Math.floor(this._startTime / 1000 * this._frameRate);\r\n        return this._total;\r\n    }\r\n\r\n    /**\r\n     * 重置所有对象，复用对象的时候使用。\r\n     */\r\n    reset(): void {\r\n        var p: any;\r\n        if (this._labelDic) {\r\n            for (p in this._labelDic) {\r\n                delete this._labelDic[p];\r\n            }\r\n        }\r\n        var tTween: Tween;\r\n        for (p in this._tweenDic) {\r\n            tTween = this._tweenDic[p];\r\n            tTween.clear();\r\n            delete this._tweenDic[p];\r\n        }\r\n        for (p in this._firstTweenDic) {\r\n            delete this._firstTweenDic[p];\r\n        }\r\n        this._endTweenDataList = null;\r\n        if (this._tweenDataList && this._tweenDataList.length) {\r\n            var i: number, len: number;\r\n            len = this._tweenDataList.length;\r\n            for (i = 0; i < len; i++) {\r\n                if (this._tweenDataList[i])\r\n                    this._tweenDataList[i].destroy();\r\n            }\r\n        }\r\n        this._tweenDataList.length = 0;\r\n        this._currTime = 0;\r\n        this._lastTime = 0;\r\n        this._startTime = 0;\r\n        this._index = 0;\r\n        this._gidIndex = 0;\r\n        this.scale = 1;\r\n        ILaya.timer.clear(this, this._update);\r\n    }\r\n\r\n    /**\r\n     * 彻底销毁此对象。\r\n     */\r\n    destroy(): void {\r\n        this.reset();\r\n        this._labelDic = null;\r\n        this._tweenDic = null;\r\n        this._tweenDataList = null;\r\n        this._firstTweenDic = null;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nclass tweenData {\r\n    type: number = 0;//0代表TWEEN,1代表标签\r\n    isTo: boolean = true;\r\n    startTime: number;\r\n    endTime: number;\r\n    target: any;\r\n    duration: number;\r\n    ease: Function;\r\n    data: any;\r\n    destroy(): void {\r\n        this.target = null;\r\n        this.ease = null;\r\n        this.data = null;\r\n        this.isTo = true;\r\n        this.type = 0;\r\n        Pool.recover(\"tweenData\", this);\r\n    }\r\n}\r\n","export class ShaderValue {\r\n    constructor() {\r\n\r\n    }\r\n}\r\n\r\n\r\n","\r\n/**\r\n * 阿拉伯文的转码。把unicode的阿拉伯文字母编码转成他们的老的能描述不同写法的编码。\r\n *  这个是从GitHub上 Javascript-Arabic-Reshaper 项目转来的\r\n * https://github.com/louy/Javascript-Arabic-Reshaper/blob/master/src/index.js\r\n */\r\n/**\r\n\t * Javascript Arabic Reshaper by Louy Alakkad\r\n\t * https://github.com/louy/Javascript-Arabic-Reshaper\r\n\t * Based on (http://git.io/vsnAd)\r\n\t */\r\nexport class ArabicReshaper {\r\n    private static charsMap: any[] = [[0x0621, 0xFE80, null, null, null], /* HAMZA */\r\n    [0x0622, 0xFE81, null, null, 0xFE82], /* ALEF_MADDA */\r\n    [0x0623, 0xFE83, null, null, 0xFE84], /* ALEF_HAMZA_ABOVE */\r\n    [0x0624, 0xFE85, null, null, 0xFE86], /* WAW_HAMZA */\r\n    [0x0625, 0xFE87, null, null, 0xFE88], /* ALEF_HAMZA_BELOW */\r\n    [0x0626, 0xFE89, 0xFE8B, 0xFE8C, 0xFE8A], /* YEH_HAMZA */\r\n    [0x0627, 0xFE8D, null, null, 0xFE8E], /* ALEF */\r\n    [0x0628, 0xFE8F, 0xFE91, 0xFE92, 0xFE90], /* BEH */\r\n    [0x0629, 0xFE93, null, null, 0xFE94], /* TEH_MARBUTA */\r\n    [0x062A, 0xFE95, 0xFE97, 0xFE98, 0xFE96], /* TEH */\r\n    [0x062B, 0xFE99, 0xFE9B, 0xFE9C, 0xFE9A], /* THEH */\r\n    [0x062C, 0xFE9D, 0xFE9F, 0xFEA0, 0xFE9E], /* JEEM */\r\n    [0x062D, 0xFEA1, 0xFEA3, 0xFEA4, 0xFEA2], /* HAH */\r\n    [0x062E, 0xFEA5, 0xFEA7, 0xFEA8, 0xFEA6], /* KHAH */\r\n    [0x062F, 0xFEA9, null, null, 0xFEAA], /* DAL */\r\n    [0x0630, 0xFEAB, null, null, 0xFEAC], /* THAL */\r\n    [0x0631, 0xFEAD, null, null, 0xFEAE], /* REH */\r\n    [0x0632, 0xFEAF, null, null, 0xFEB0], /* ZAIN */\r\n    [0x0633, 0xFEB1, 0xFEB3, 0xFEB4, 0xFEB2], /* SEEN */\r\n    [0x0634, 0xFEB5, 0xFEB7, 0xFEB8, 0xFEB6], /* SHEEN */\r\n    [0x0635, 0xFEB9, 0xFEBB, 0xFEBC, 0xFEBA], /* SAD */\r\n    [0x0636, 0xFEBD, 0xFEBF, 0xFEC0, 0xFEBE], /* DAD */\r\n    [0x0637, 0xFEC1, 0xFEC3, 0xFEC4, 0xFEC2], /* TAH */\r\n    [0x0638, 0xFEC5, 0xFEC7, 0xFEC8, 0xFEC6], /* ZAH */\r\n    [0x0639, 0xFEC9, 0xFECB, 0xFECC, 0xFECA], /* AIN */\r\n    [0x063A, 0xFECD, 0xFECF, 0xFED0, 0xFECE], /* GHAIN */\r\n    [0x0640, 0x0640, 0x0640, 0x0640, 0x0640], /* TATWEEL */\r\n    [0x0641, 0xFED1, 0xFED3, 0xFED4, 0xFED2], /* FEH */\r\n    [0x0642, 0xFED5, 0xFED7, 0xFED8, 0xFED6], /* QAF */\r\n    [0x0643, 0xFED9, 0xFEDB, 0xFEDC, 0xFEDA], /* KAF */\r\n    [0x0644, 0xFEDD, 0xFEDF, 0xFEE0, 0xFEDE], /* LAM */\r\n    [0x0645, 0xFEE1, 0xFEE3, 0xFEE4, 0xFEE2], /* MEEM */\r\n    [0x0646, 0xFEE5, 0xFEE7, 0xFEE8, 0xFEE6], /* NOON */\r\n    [0x0647, 0xFEE9, 0xFEEB, 0xFEEC, 0xFEEA], /* HEH */\r\n    [0x0648, 0xFEED, null, null, 0xFEEE], /* WAW */\r\n    [0x0649, 0xFEEF, null, null, 0xFEF0], /* ALEF_MAKSURA */\r\n    [0x064A, 0xFEF1, 0xFEF3, 0xFEF4, 0xFEF2], /* YEH */\r\n    [0x067E, 0xFB56, 0xFB58, 0xFB59, 0xFB57], /* PEH */\r\n    [0x06CC, 0xFBFC, 0xFBFE, 0xFBFF, 0xFBFD], /* Farsi Yeh */\r\n    [0x0686, 0xFB7A, 0xFB7C, 0xFB7D, 0xFB7B], /* Tcheh */\r\n    [0x06A9, 0xFB8E, 0xFB90, 0xFB91, 0xFB8F], /* Keheh */\r\n    [0x06AF, 0xFB92, 0xFB94, 0xFB95, 0xFB93], /* Gaf */\r\n    [0x0698, 0xFB8A, null, null, 0xFB8B]];\r\n    private static combCharsMap: any[] = [[[0x0644, 0x0622], 0xFEF5, null, null, 0xFEF6], /* LAM_ALEF_MADDA */\r\n    [[0x0644, 0x0623], 0xFEF7, null, null, 0xFEF8], /* LAM_ALEF_HAMZA_ABOVE */\r\n    [[0x0644, 0x0625], 0xFEF9, null, null, 0xFEFA], /* LAM_ALEF_HAMZA_BELOW */\r\n    [[0x0644, 0x0627], 0xFEFB, null, null, 0xFEFC]];\r\n    private static transChars: any[] = [0x0610, /* ARABIC SIGN SALLALLAHOU ALAYHE WASSALLAM */\r\n        0x0612, /* ARABIC SIGN ALAYHE ASSALLAM */\r\n        0x0613, /* ARABIC SIGN RADI ALLAHOU ANHU */\r\n        0x0614, /* ARABIC SIGN TAKHALLUS */\r\n        0x0615, /* ARABIC SMALL HIGH TAH */\r\n        0x064B, /* ARABIC FATHATAN */\r\n        0x064C, /* ARABIC DAMMATAN */\r\n        0x064D, /* ARABIC KASRATAN */\r\n        0x064E, /* ARABIC FATHA */\r\n        0x064F, /* ARABIC DAMMA */\r\n        0x0650, /* ARABIC KASRA */\r\n        0x0651, /* ARABIC SHADDA */\r\n        0x0652, /* ARABIC SUKUN */\r\n        0x0653, /* ARABIC MADDAH ABOVE */\r\n        0x0654, /* ARABIC HAMZA ABOVE */\r\n        0x0655, /* ARABIC HAMZA BELOW */\r\n        0x0656, /* ARABIC SUBSCRIPT ALEF */\r\n        0x0657, /* ARABIC INVERTED DAMMA */\r\n        0x0658, /* ARABIC MARK NOON GHUNNA */\r\n        0x0670, /* ARABIC LETTER SUPERSCRIPT ALEF */\r\n        0x06D6, /* ARABIC SMALL HIGH LIGATURE SAD WITH LAM WITH ALEF MAKSURA */\r\n        0x06D7, /* ARABIC SMALL HIGH LIGATURE QAF WITH LAM WITH ALEF MAKSURA */\r\n        0x06D8, /* ARABIC SMALL HIGH MEEM INITIAL FORM */\r\n        0x06D9, /* ARABIC SMALL HIGH LAM ALEF */\r\n        0x06DA, /* ARABIC SMALL HIGH JEEM */\r\n        0x06DB, /* ARABIC SMALL HIGH THREE DOTS */\r\n        0x06DC, /* ARABIC SMALL HIGH SEEN */\r\n        0x06DF, /* ARABIC SMALL HIGH ROUNDED ZERO */\r\n        0x06E0, /* ARABIC SMALL HIGH UPRIGHT RECTANGULAR ZERO */\r\n        0x06E1, /* ARABIC SMALL HIGH DOTLESS HEAD OF KHAH */\r\n        0x06E2, /* ARABIC SMALL HIGH MEEM ISOLATED FORM */\r\n        0x06E3, /* ARABIC SMALL LOW SEEN */\r\n        0x06E4, /* ARABIC SMALL HIGH MADDA */\r\n        0x06E7, /* ARABIC SMALL HIGH YEH */\r\n        0x06E8, /* ARABIC SMALL HIGH NOON */\r\n        0x06EA, /* ARABIC EMPTY CENTRE LOW STOP */\r\n        0x06EB, /* ARABIC EMPTY CENTRE HIGH STOP */\r\n        0x06EC, /* ARABIC ROUNDED HIGH STOP WITH FILLED CENTRE */\r\n        0x06ED];\r\n\r\n\r\n    //TODO:coverage\r\n    characterMapContains(c: number): boolean {\r\n        for (var i: number = 0; i < ArabicReshaper.charsMap.length; ++i) {\r\n            if (ArabicReshaper.charsMap[i][0] === c) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    //TODO:coverage\r\n    getCharRep(c: number): boolean {\r\n        for (var i: number = 0; i < ArabicReshaper.charsMap.length; ++i) {\r\n            if (ArabicReshaper.charsMap[i][0] === c) {\r\n                return ArabicReshaper.charsMap[i];\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    //TODO:coverage\r\n    getCombCharRep(c1, c2): boolean {\r\n        for (var i: number = 0; i < ArabicReshaper.combCharsMap.length; ++i) {\r\n            if (ArabicReshaper.combCharsMap[i][0][0] === c1 && ArabicReshaper.combCharsMap[i][0][1] === c2) {\r\n                return ArabicReshaper.combCharsMap[i];\r\n            }\r\n        }\r\n\r\n        // We should never reach here...\r\n        // istanbul ignore next\r\n        return false;\r\n    }\r\n\r\n    //TODO:coverage\r\n    isTransparent(c): boolean {\r\n        for (var i: number = 0; i < ArabicReshaper.transChars.length; ++i) {\r\n            if (ArabicReshaper.transChars[i] === c) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    //TODO:coverage\r\n    getOriginalCharsFromCode(code): string {\r\n        var j: number;\r\n\r\n        for (j = 0; j < ArabicReshaper.charsMap.length; ++j) {\r\n            if (ArabicReshaper.charsMap[j].indexOf(code) > -1) {\r\n                return String.fromCharCode(ArabicReshaper.charsMap[j][0]);\r\n            }\r\n        }\r\n\r\n        for (j = 0; j < ArabicReshaper.combCharsMap.length; ++j) {\r\n            if (ArabicReshaper.combCharsMap[j].indexOf(code) > -1) {\r\n                return String.fromCharCode(ArabicReshaper.combCharsMap[j][0][0]) +\r\n                    String.fromCharCode(ArabicReshaper.combCharsMap[j][0][1]);\r\n            }\r\n        }\r\n\r\n        return String.fromCharCode(code);\r\n    }\r\n\r\n    /**\r\n     * 转换函数。从normal转到presentB\r\n     * 这个返回的字符串可以直接按照从左到右的顺序渲染。\r\n     * 例如\r\n     * graphics.fillText(convertArabic('سلام'),....)\r\n     * \r\n    */\r\n    //TODO:coverage\r\n    convertArabic(normal): string {\r\n        var crep: any,\r\n            combcrep: any,\r\n            shaped: string = '';\r\n\r\n        for (var i: number = 0; i < normal.length; ++i) {\r\n            var current: number = normal.charCodeAt(i);\r\n            if (this.characterMapContains(current)) {\r\n                var prev: any = null,\r\n                    next: any = null,\r\n                    prevID: number = i - 1,\r\n                    nextID: number = i + 1;\r\n\r\n\t\t\t\t/*\r\n\t\t\t\t  Transparent characters have no effect in the shaping process.\r\n\t\t\t\t  So, ignore all the transparent characters that are BEFORE the\r\n\t\t\t\t  current character.\r\n\t\t\t\t  */\r\n                for (; prevID >= 0; --prevID) {\r\n                    if (!this.isTransparent(normal.charCodeAt(prevID))) {\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                prev = (prevID >= 0) ? normal.charCodeAt(prevID) : null;\r\n                crep = prev ? this.getCharRep(prev) : false;\r\n                if (!crep || crep[2] == null && crep[3] == null) {\r\n                    prev = null; // prev character doesn’t connect with its successor\r\n                }\r\n\r\n\t\t\t\t/*\r\n\t\t\t\t  Transparent characters have no effect in the shaping process.\r\n\t\t\t\t  So, ignore all the transparent characters that are AFTER the\r\n\t\t\t\t  current character.\r\n\t\t\t\t  */\r\n                for (; nextID < normal.length; ++nextID) {\r\n                    if (!this.isTransparent(normal.charCodeAt(nextID))) {\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                next = (nextID < normal.length) ? normal.charCodeAt(nextID) : null;\r\n                crep = next ? this.getCharRep(next) : false;\r\n                if (!crep || crep[3] == null && crep[4] == null) {\r\n                    next = null; // next character doesn’t connect with its predecessor\r\n                }\r\n\r\n                /* Combinations */\r\n                if (current === 0x0644 && next != null &&\r\n                    (next === 0x0622 || next === 0x0623 || next === 0x0625 || next === 0x0627)) {\r\n                    combcrep = this.getCombCharRep(current, next);\r\n                    if (prev != null) {\r\n                        shaped += String.fromCharCode(combcrep[4]);\r\n                    } else {\r\n                        shaped += String.fromCharCode(combcrep[1]);\r\n                    }\r\n\r\n                    ++i;\r\n                    continue;\r\n                }\r\n\r\n                crep = this.getCharRep(current);\r\n\r\n                /* Medial */\r\n                if (prev != null && next != null && crep[3] != null) {\r\n                    shaped += String.fromCharCode(crep[3]);\r\n                    continue;\r\n                } else /* Final */\r\n                    if (prev != null && crep[4] != null) {\r\n                        shaped += String.fromCharCode(crep[4]);\r\n                        continue;\r\n                    } else /* Initial */\r\n                        if (next != null && crep[2] != null) {\r\n                            shaped += String.fromCharCode(crep[2]);\r\n                            continue;\r\n                        } else /* Isolated */ {\r\n                            shaped += String.fromCharCode(crep[1]);\r\n                        }\r\n            } else {\r\n                shaped += String.fromCharCode(current);\r\n            }\r\n        }\r\n\r\n        return shaped;\r\n    }/*;*/\r\n\r\n    // convert from Arabic Presentation Forms B\r\n    //TODO:coverage\r\n    convertArabicBack(apfb): string {\r\n        var toReturn: string = '',\r\n            selectedChar: number;\r\n\r\n        var i: number;\r\n\r\n        for (i = 0; i < apfb.length; ++i) {\r\n            selectedChar = apfb.charCodeAt(i);\r\n\r\n            toReturn += this.getOriginalCharsFromCode(selectedChar);\r\n        }\r\n        return toReturn;\r\n    }\r\n}\r\n\r\n\r\n","export class MatirxArray {\r\n\r\n    /**\r\n     * 4*4矩阵数组相乘。\r\n     * o=a*b;\r\n     * @param\ta 4*4矩阵数组。\r\n     * @param\tb 4*4矩阵数组。\r\n     * @param\to 4*4矩阵数组。\r\n     */\r\n    //TODO:coverage\r\n    static ArrayMul(a: any[], b: any[], o: any[]): void {\r\n        if (!a) {\r\n            MatirxArray.copyArray(b, o);\r\n            return;\r\n        }\r\n\r\n        if (!b) {\r\n            MatirxArray.copyArray(a, o);\r\n            return;\r\n        }\r\n\r\n        var ai0: number, ai1: number, ai2: number, ai3: number;\r\n        for (var i: number = 0; i < 4; i++) {\r\n            ai0 = a[i];\r\n            ai1 = a[i + 4];\r\n            ai2 = a[i + 8];\r\n            ai3 = a[i + 12];\r\n            o[i] = ai0 * b[0] + ai1 * b[1] + ai2 * b[2] + ai3 * b[3];\r\n            o[i + 4] = ai0 * b[4] + ai1 * b[5] + ai2 * b[6] + ai3 * b[7];\r\n            o[i + 8] = ai0 * b[8] + ai1 * b[9] + ai2 * b[10] + ai3 * b[11];\r\n            o[i + 12] = ai0 * b[12] + ai1 * b[13] + ai2 * b[14] + ai3 * b[15];\r\n        }\r\n    }\r\n\r\n    //TODO:coverage\r\n    static copyArray(f: any[], t: any[]): void {\r\n        if (!f) return;\r\n        if (!t) return;\r\n        for (var i: number = 0; i < f.length; i++) {\r\n            t[i] = f[i];\r\n        }\r\n    }\r\n}\r\n\r\n"],"names":["FilterMode","TextureFormat","WarpMode","RenderTextureFormat","RenderTextureDepthFormat","LayaEvent","systemTimer","startTimer","lateTimer","updateTimer","timer","physicsTimer","loader","stage","render","TextureDecodeFormat"],"mappings":"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MAAM,CAAC;QACpC,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,CAAC;QACpC,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,CAAC;QACpC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;QACxC,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,CAAC;QACpC,CAAC,MAAM,EAAE,MAAM,EAAE,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"}