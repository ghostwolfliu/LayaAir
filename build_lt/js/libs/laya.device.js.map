{"version":3,"file":"laya.device.js","sources":["../../../src/layaAir/laya/device/motion/AccelerationInfo.ts","../../../src/layaAir/laya/device/motion/RotationInfo.ts","../../../src/layaAir/laya/device/motion/Accelerator.ts","../../../src/layaAir/laya/device/Shake.ts","../../../src/layaAir/laya/device/geolocation/GeolocationInfo.ts","../../../src/layaAir/laya/device/geolocation/Geolocation.ts","../../../src/layaAir/laya/device/media/HtmlVideo.ts","../../../src/layaAir/laya/device/media/Media.ts","../../../src/layaAir/laya/device/media/WebGLVideo.ts","../../../src/layaAir/laya/device/media/Video.ts","../../../src/layaAir/laya/device/motion/Gyroscope.ts"],"sourcesContent":["/**\r\n\t * 加速度x/y/z的单位均为m/s²。\r\n\t * 在硬件（陀螺仪）不支持的情况下，alpha、beta和gamma值为null。\r\n\t * \r\n\t * @author Survivor\r\n\t */\r\nexport class AccelerationInfo {\r\n\t/**\r\n\t * x轴上的加速度值。\r\n\t */\r\n\tx: number;\r\n\t/**\r\n\t * y轴上的加速度值。\r\n\t */\r\n\ty: number;\r\n\t/**\r\n\t * z轴上的加速度值。\r\n\t */\r\n\tz: number;\r\n\r\n\tconstructor() {\r\n\r\n\t}\r\n}\r\n\r\n","/**\r\n\t * 保存旋转信息的类。请勿修改本类的属性。\r\n\t * @author Survivor\r\n\t */\r\nexport class RotationInfo {\r\n\t/**\r\n\t * <p>\r\n\t * 指示设备是否可以提供绝对方位数据（指向地球坐标系），或者设备决定的任意坐标系。\r\n\t * 关于坐标系参见<i>https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Orientation_and_motion_data_explained</i>。\r\n\t * </p>\r\n\t * 需要注意的是，IOS环境下，该值始终为false。即使如此，你依旧可以从<code>alpha</code>中取得正确的值。\r\n\t */\r\n\tabsolute: boolean;\r\n\r\n\t/**\r\n\t * Z轴旋转角度，其值范围从0至360。\r\n\t * 若<code>absolute</code>为true或者在IOS中，alpha值是从北方到当前设备方向的角度值。\r\n\t */\r\n\talpha: number;\r\n\r\n\t/**\r\n\t * X轴旋转角度, 其值范围从-180至180。代表设备从前至后的运动。\r\n\t */\r\n\tbeta: number;\r\n\r\n\t/**\r\n\t * Y轴旋转角度，其值范围从-90至90。代表设备从左至右的运动。\r\n\t */\r\n\tgamma: number;\r\n\r\n\t/**\r\n\t * 罗盘数据的精确度（角度）。仅IOS可用。\r\n\t */\r\n\tcompassAccuracy: number;\r\n\r\n\tconstructor() {\r\n\r\n\t}\r\n}\r\n\r\n","import { AccelerationInfo } from \"./AccelerationInfo\";\r\nimport { RotationInfo } from \"./RotationInfo\";\r\nimport { EventDispatcher } from \"../../events/EventDispatcher\";\r\nimport { ILaya } from \"../../../ILaya\";\r\nimport { Event } from \"../../events/Event\";\r\n\r\n/**\r\n * Accelerator.instance获取唯一的Accelerator引用，请勿调用构造函数。\r\n *\r\n * <p>\r\n * listen()的回调处理器接受四个参数：\r\n * <ol>\r\n * <li><b>acceleration</b>: 表示用户给予设备的加速度。</li>\r\n * <li><b>accelerationIncludingGravity</b>: 设备受到的总加速度（包含重力）。</li>\r\n * <li><b>rotationRate</b>: 设备的自转速率。</li>\r\n * <li><b>interval</b>: 加速度获取的时间间隔（毫秒）。</li>\r\n * </ol>\r\n * </p>\r\n * <p>\r\n * <b>NOTE</b><br/>\r\n * 如，rotationRate的alpha在apple和moz文档中都是z轴旋转角度，但是实测是x轴旋转角度。为了使各属性表示的值与文档所述相同，实际值与其他属性进行了对调。\r\n * 其中：\r\n * <ul>\r\n * <li>alpha使用gamma值。</li>\r\n * <li>beta使用alpha值。</li>\r\n * <li>gamma使用beta。</li>\r\n * </ul>\r\n * 目前孰是孰非尚未可知，以此为注。\r\n * </p>\r\n */\r\nexport class Accelerator extends EventDispatcher {\r\n    /**\r\n     * Accelerator的唯一引用。\r\n     */\r\n    private static _instance: Accelerator;\r\n\r\n    static get instance(): Accelerator {\r\n        Accelerator._instance = Accelerator._instance || new Accelerator(0)\r\n        return Accelerator._instance;\r\n    }\r\n\r\n    private static acceleration: AccelerationInfo = new AccelerationInfo();\r\n    private static accelerationIncludingGravity: AccelerationInfo = new AccelerationInfo();\r\n    private static rotationRate: RotationInfo = new RotationInfo();\r\n\r\n    constructor(singleton: number) {\r\n        super();\r\n        this.onDeviceOrientationChange = this.onDeviceOrientationChange.bind(this);\r\n    }\r\n\r\n    /**\r\n     * 侦听加速器运动。\r\n     * @param observer\t回调函数接受4个参数，见类说明。\r\n     * @override\r\n     */\r\n    on(type: string, caller: any, listener: Function, args: any[] = null): EventDispatcher {\r\n        super.on(type, caller, listener, args);\r\n        ILaya.Browser.window.addEventListener('devicemotion', this.onDeviceOrientationChange);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 取消侦听加速器。\r\n     * @param\thandle\t侦听加速器所用处理器。\r\n     * @override\r\n     */\r\n    off(type: string, caller: any, listener: Function, onceOnly: boolean = false): EventDispatcher {\r\n        if (!this.hasListener(type))\r\n            ILaya.Browser.window.removeEventListener('devicemotion', this.onDeviceOrientationChange)\r\n\r\n        return super.off(type, caller, listener, onceOnly);\r\n    }\r\n\r\n    private onDeviceOrientationChange(e: any): void {\r\n        var interval: number = e.interval;\r\n\r\n        Accelerator.acceleration.x = e.acceleration.x;\r\n        Accelerator.acceleration.y = e.acceleration.y;\r\n        Accelerator.acceleration.z = e.acceleration.z;\r\n\r\n        Accelerator.accelerationIncludingGravity.x = e.accelerationIncludingGravity.x;\r\n        Accelerator.accelerationIncludingGravity.y = e.accelerationIncludingGravity.y;\r\n        Accelerator.accelerationIncludingGravity.z = e.accelerationIncludingGravity.z;\r\n\r\n        Accelerator.rotationRate.alpha = e.rotationRate.gamma * -1;\r\n        Accelerator.rotationRate.beta = e.rotationRate.alpha * -1;\r\n        Accelerator.rotationRate.gamma = e.rotationRate.beta;\r\n\r\n        if (ILaya.Browser.onAndroid) {\r\n            if (ILaya.Browser.userAgent.indexOf(\"Chrome\") > -1) {\r\n                Accelerator.rotationRate.alpha *= 180 / Math.PI;\r\n                Accelerator.rotationRate.beta *= 180 / Math.PI;\r\n                Accelerator.rotationRate.gamma *= 180 / Math.PI;\r\n            }\r\n\r\n            Accelerator.acceleration.x *= -1;\r\n            Accelerator.accelerationIncludingGravity.x *= -1;\r\n        }\r\n        else if (ILaya.Browser.onIOS) {\r\n            Accelerator.acceleration.y *= -1;\r\n            Accelerator.acceleration.z *= -1;\r\n\r\n            Accelerator.accelerationIncludingGravity.y *= -1;\r\n            Accelerator.accelerationIncludingGravity.z *= -1;\r\n\r\n            interval *= 1000;\r\n        }\r\n        this.event(Event.CHANGE, [Accelerator.acceleration, Accelerator.accelerationIncludingGravity, Accelerator.rotationRate, interval]);\r\n    }\r\n\r\n    private static transformedAcceleration: AccelerationInfo;\r\n    /**\r\n     * 把加速度值转换为视觉上正确的加速度值。依赖于Browser.window.orientation，可能在部分低端机无效。\r\n     * @param\tacceleration\r\n     * @return\r\n     */\r\n    static getTransformedAcceleration(acceleration: AccelerationInfo): AccelerationInfo {\r\n        Accelerator.transformedAcceleration = Accelerator.transformedAcceleration || new AccelerationInfo();\r\n        Accelerator.transformedAcceleration.z = acceleration.z;\r\n\r\n        if (ILaya.Browser.window.orientation == 90) {\r\n            Accelerator.transformedAcceleration.x = acceleration.y;\r\n            Accelerator.transformedAcceleration.y = -acceleration.x;\r\n        }\r\n        else if (ILaya.Browser.window.orientation == -90) {\r\n            Accelerator.transformedAcceleration.x = -acceleration.y;\r\n            Accelerator.transformedAcceleration.y = acceleration.x;\r\n        }\r\n        else if (!ILaya.Browser.window.orientation) {\r\n            Accelerator.transformedAcceleration.x = acceleration.x;\r\n            Accelerator.transformedAcceleration.y = acceleration.y;\r\n        }\r\n        else if (ILaya.Browser.window.orientation == 180) {\r\n            Accelerator.transformedAcceleration.x = -acceleration.x;\r\n            Accelerator.transformedAcceleration.y = -acceleration.y;\r\n        }\r\n\r\n        var tx: number;\r\n        if (ILaya.stage.canvasDegree == -90) {\r\n            tx = Accelerator.transformedAcceleration.x;\r\n            Accelerator.transformedAcceleration.x = -Accelerator.transformedAcceleration.y;\r\n            Accelerator.transformedAcceleration.y = tx;\r\n        }\r\n        else if (ILaya.stage.canvasDegree == 90) {\r\n            tx = Accelerator.transformedAcceleration.x;\r\n            Accelerator.transformedAcceleration.x = Accelerator.transformedAcceleration.y;\r\n            Accelerator.transformedAcceleration.y = -tx;\r\n        }\r\n\r\n        return Accelerator.transformedAcceleration;\r\n    }\r\n}\r\n\r\n\r\n\r\n","import { AccelerationInfo } from \"./motion/AccelerationInfo\"\r\nimport { Accelerator } from \"./motion/Accelerator\"\r\nimport { RotationInfo } from \"./motion/RotationInfo\"\r\nimport { EventDispatcher } from \"../events/EventDispatcher\";\r\nimport { Handler } from \"../utils/Handler\";\r\nimport { Event } from \"../events/Event\";\r\nimport { ILaya } from \"../../ILaya\";\r\n\r\n\r\n/**\r\n * Shake只能在支持此操作的设备上有效。\r\n * \r\n */\r\nexport class Shake extends EventDispatcher {\r\n    private throushold: number;\r\n    private shakeInterval: number;\r\n    private callback: Handler;\r\n\r\n    private lastX: number;\r\n    private lastY: number;\r\n    private lastZ: number;\r\n\r\n    private lastMillSecond: number;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n\r\n    }\r\n\r\n    private static _instance: Shake;\r\n    static get instance(): Shake {\r\n        Shake._instance = Shake._instance || new Shake();\r\n        return Shake._instance;\r\n    }\r\n\r\n    /**\r\n     * 开始响应设备摇晃。\r\n     * @param\tthroushold\t响应的瞬时速度阈值，轻度摇晃的值约在5~10间。\r\n     * @param\ttimeout\t\t设备摇晃的响应间隔时间。\r\n     * @param\tcallback\t在设备摇晃触发时调用的处理器。\r\n     */\r\n    start(throushold: number, interval: number): void {\r\n        this.throushold = throushold;\r\n        this.shakeInterval = interval;\r\n\r\n        this.lastX = this.lastY = this.lastZ = NaN;\r\n\r\n        // 使用加速器监听设备运动。\r\n        Accelerator.instance.on(Event.CHANGE, this, this.onShake);\r\n    }\r\n\r\n    /**\r\n     * 停止响应设备摇晃。\r\n     */\r\n    stop(): void {\r\n        Accelerator.instance.off(Event.CHANGE, this, this.onShake);\r\n    }\r\n\r\n    private onShake(acceleration: AccelerationInfo, accelerationIncludingGravity: AccelerationInfo, rotationRate: RotationInfo, interval: number): void {\r\n        // 设定摇晃的初始状态。\r\n        if (isNaN(this.lastX)) {\r\n            this.lastX = accelerationIncludingGravity.x;\r\n            this.lastY = accelerationIncludingGravity.y;\r\n            this.lastZ = accelerationIncludingGravity.z;\r\n\r\n            this.lastMillSecond = ILaya.Browser.now();\r\n            return;\r\n        }\r\n\r\n        // 速度增量计算。\r\n        var deltaX: number = Math.abs(this.lastX - accelerationIncludingGravity.x);\r\n        var deltaY: number = Math.abs(this.lastY - accelerationIncludingGravity.y);\r\n        var deltaZ: number = Math.abs(this.lastZ - accelerationIncludingGravity.z);\r\n\r\n        // 是否满足摇晃选项。\r\n        if (this.isShaked(deltaX, deltaY, deltaZ)) {\r\n            var deltaMillSecond: number = ILaya.Browser.now() - this.lastMillSecond;\r\n\r\n            // 按照设定间隔触发摇晃。\r\n            if (deltaMillSecond > this.shakeInterval) {\r\n                this.event(Event.CHANGE);\r\n                this.lastMillSecond = ILaya.Browser.now();\r\n            }\r\n        }\r\n\r\n        this.lastX = accelerationIncludingGravity.x;\r\n        this.lastY = accelerationIncludingGravity.y;\r\n        this.lastZ = accelerationIncludingGravity.z;\r\n    }\r\n\r\n    // 通过任意两个分量判断是否满足摇晃设定。\r\n    private isShaked(deltaX: number, deltaY: number, deltaZ: number): boolean {\r\n        return (deltaX > this.throushold && deltaY > this.throushold) ||\r\n            (deltaX > this.throushold && deltaZ > this.throushold) ||\r\n            (deltaY > this.throushold && deltaZ > this.throushold)\r\n    }\r\n}\r\n\r\n","export class GeolocationInfo {\r\n\tprivate pos: any;\r\n\tprivate coords: any;\r\n\r\n\tsetPosition(pos: any): void {\r\n\t\tthis.pos = pos;\r\n\t\tthis.coords = pos.coords;\r\n\t}\r\n\r\n\tget latitude(): number {\r\n\t\treturn this.coords.latitude;\r\n\t}\r\n\r\n\tget longitude(): number {\r\n\t\treturn this.coords.longitude;\r\n\t}\r\n\r\n\tget altitude(): number {\r\n\t\treturn this.coords.altitude;\r\n\t}\r\n\r\n\tget accuracy(): number {\r\n\t\treturn this.coords.accuracy;\r\n\t}\r\n\r\n\tget altitudeAccuracy(): number {\r\n\t\treturn this.coords.altitudeAccuracy;\r\n\t}\r\n\r\n\tget heading(): number {\r\n\t\treturn this.coords.heading;\r\n\t}\r\n\r\n\tget speed(): number {\r\n\t\treturn this.coords.speed;\r\n\t}\r\n\r\n\tget timestamp(): number {\r\n\t\treturn this.pos.timestamp;\r\n\t}\r\n}\r\n\r\n","import { GeolocationInfo } from \"./GeolocationInfo\";\r\nimport { ILaya } from \"../../../ILaya\";\r\nimport { Handler } from \"../../utils/Handler\";\r\n\r\n\r\n/**\r\n * 使用前可用<code>supported</code>查看浏览器支持。\r\n */\r\nexport class Geolocation {\r\n    private static navigator = navigator;\r\n    private static position: GeolocationInfo = new GeolocationInfo();\r\n\r\n    /**\r\n     * 由于权限被拒绝造成的地理信息获取失败。\r\n     */\r\n    static PERMISSION_DENIED: number = 1;\r\n    /**\r\n     * 由于内部位置源返回了内部错误导致地理信息获取失败。\r\n     */\r\n    static POSITION_UNAVAILABLE: number = 2;\r\n    /**\r\n     * 信息获取所用时长超出<code>timeout</code>所设置时长。\r\n     */\r\n    static TIMEOUT: number = 3;\r\n\r\n    /**\r\n     * 是否支持。\r\n     */\r\n    static supported: boolean = !!Geolocation.navigator.geolocation;\r\n\r\n    /**\r\n     * 如果<code>enableHighAccuracy</code>为true，并且设备能够提供一个更精确的位置，则会获取最佳可能的结果。\r\n     * 请注意,这可能会导致较慢的响应时间或增加电量消耗（如使用GPS）。\r\n     * 另一方面，如果设置为false，将会得到更快速的响应和更少的电量消耗。\r\n     * 默认值为false。\r\n     */\r\n    static enableHighAccuracy: boolean = false;\r\n    /**\r\n     * 表示允许设备获取位置的最长时间。默认为Infinity，意味着getCurentPosition()直到位置可用时才会返回信息。\r\n     */\r\n\r\n    static timeout: number = 1E10;\r\n    /**\r\n     * 表示可被返回的缓存位置信息的最大时限。\r\n     * 如果设置为0，意味着设备不使用缓存位置，并且尝试获取实时位置。\r\n     * 如果设置为Infinity，设备必须返回缓存位置而无论其时限。\r\n     */\r\n    static maximumAge: number = 0;\r\n\r\n    constructor() {\r\n    }\r\n\r\n    /**\r\n     * 获取设备当前位置。\r\n     * @param\tonSuccess\t带有唯一<code>Position</code>参数的回调处理器。\r\n     * @param\tonError\t\t可选的。带有错误信息的回调处理器。错误代码为Geolocation.PERMISSION_DENIED、Geolocation.POSITION_UNAVAILABLE和Geolocation.TIMEOUT之一。\r\n     */\r\n    static getCurrentPosition(onSuccess: Handler, onError: Handler = null): void {\r\n        Geolocation.navigator.geolocation.getCurrentPosition(function (pos: any): void {\r\n            Geolocation.position.setPosition(pos);\r\n            onSuccess.runWith(Geolocation.position);\r\n        },\r\n            function (error: any): void {\r\n                onError.runWith(error);\r\n            },\r\n            {\r\n                enableHighAccuracy: Geolocation.enableHighAccuracy,\r\n                timeout: Geolocation.timeout,\r\n                maximumAge: Geolocation.maximumAge\r\n            });\r\n    }\r\n\r\n    /**\r\n     * 监视设备当前位置。回调处理器在设备位置改变时被执行。\r\n     * @param\tonSuccess\t带有唯一<code>Position</code>参数的回调处理器。\r\n     * @param\tonError\t\t可选的。带有错误信息的回调处理器。错误代码为Geolocation.PERMISSION_DENIED、Geolocation.POSITION_UNAVAILABLE和Geolocation.TIMEOUT之一。\r\n     */\r\n    static watchPosition(onSuccess: Handler, onError: Handler): number {\r\n        return Geolocation.navigator.geolocation.watchPosition(function (pos: any): void {\r\n            Geolocation.position.setPosition(pos);\r\n            onSuccess.runWith(Geolocation.position);\r\n        },\r\n            function (error: any): void {\r\n                onError.runWith(error);\r\n            },\r\n            {\r\n                enableHighAccuracy: Geolocation.enableHighAccuracy,\r\n                timeout: Geolocation.timeout,\r\n                maximumAge: Geolocation.maximumAge\r\n            });\r\n    }\r\n\r\n    /**\r\n     * 移除<code>watchPosition</code>安装的指定处理器。\r\n     * @param\tid\r\n     */\r\n    static clearWatch(id: number): void {\r\n        Geolocation.navigator.geolocation.clearWatch(id);\r\n    }\r\n}\r\n\r\n","import { VIDEOTYPE } from \"./Video\";\r\nimport { Bitmap } from \"../../resource/Bitmap\";\r\nimport { ILaya } from \"../../../ILaya\";\r\n\r\n\r\n/**\r\n * <HtmlVideo>html多媒体数据<HtmlVideo>\r\n */\r\nexport class HtmlVideo extends Bitmap {\r\n    public video: HTMLVideoElement;\r\n\tprotected _source: any;\r\n\tprotected _w=0;\r\n\tprotected _h=0;\r\n    constructor() {\r\n        super();\r\n\r\n        this._width = 1;\r\n        this._height = 1;\r\n\r\n        this.createDomElement();\r\n    }\r\n\r\n    static create: Function = function (): HtmlVideo {\r\n        return new HtmlVideo();\r\n    }\r\n\r\n    private createDomElement(): void {\r\n        this._source = this.video = ILaya.Browser.createElement(\"video\");\r\n\r\n        var style: any = this.video.style;\r\n        style.position = 'absolute';\r\n        style.top = '0px';\r\n        style.left = '0px';\r\n\r\n        this.video.addEventListener(\"loadedmetadata\", ()=> {\r\n            this._w = this.video.videoWidth;\r\n            this._h = this.video.videoHeight;\r\n        });\r\n    }\r\n\r\n    setSource(url: string, extension: number): void {\r\n        while (this.video.childElementCount)\r\n            this.video.firstChild.remove();\r\n\r\n        if (extension & VIDEOTYPE.MP4)\r\n            this.appendSource(url, \"video/mp4\");\r\n        if (extension & VIDEOTYPE.OGG)\r\n            this.appendSource(url + \".ogg\", \"video/ogg\");\r\n    }\r\n\r\n    private appendSource(source: string, type: string): void {\r\n        var sourceElement: any = ILaya.Browser.createElement(\"source\");\r\n        sourceElement.src = source;\r\n        sourceElement.type = type;\r\n        this.video.appendChild(sourceElement);\r\n    }\r\n\r\n    getVideo(): any {\r\n        return this.video;\r\n    }\r\n    /**\r\n     * @internal\r\n     * @override\r\n     */\r\n    _getSource(): any {\r\n        // TODO Auto Generated method stub\r\n        return this._source;\r\n    }\r\n\r\n    /**\r\n     * @override\r\n     */\r\n    destroy(): void {\r\n        super.destroy();\r\n\r\n        var isConchApp: boolean = ILaya.Render.isConchApp;\r\n        if (isConchApp) {\r\n            (<any>this.video)._destroy();\r\n        }\r\n    }\r\n\r\n}\r\n\r\n","import { ILaya } from \"../../../ILaya\";\r\nimport { Handler } from \"../../utils/Handler\";\r\n\r\n\r\n/**\r\n * Media用于捕捉摄像头和麦克风。可以捕捉任意之一，或者同时捕捉两者。<code>getCamera</code>前可以使用<code>supported()</code>检查当前浏览器是否支持。\r\n * <b>NOTE:</b>\r\n * <p>目前Media在移动平台只支持Android，不支持IOS。只可在FireFox完整地使用，Chrome测试时无法捕捉视频。</p>\r\n */\r\nexport class Media {\r\n    constructor() {\r\n\r\n    }\r\n\r\n    /**\r\n     * 检查浏览器兼容性。\r\n     */\r\n    static supported(): boolean {\r\n        return !!ILaya.Browser.window.navigator.getUserMedia;\r\n    }\r\n\r\n    /**\r\n     * 获取用户媒体。\r\n     * @param\toptions\t简单的可选项可以使<code>{ audio:true, video:true }</code>表示同时捕捉两者。详情见<i>https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia</i>。\r\n     * @param\tonSuccess 获取成功的处理器，唯一参数返回媒体的Blob地址，可以将其传给Video。\r\n     * @param\tonError\t获取失败的处理器，唯一参数是Error。\r\n     */\r\n    static getMedia(options: any, onSuccess: Handler, onError: Handler): void {\r\n        if (ILaya.Browser.window.navigator.getUserMedia) {\r\n            ILaya.Browser.window.navigator.getUserMedia(options, function (stream: string): void {\r\n                onSuccess.runWith(ILaya.Browser.window.URL.createObjectURL(stream));\r\n            }, function (err: Error): void {\r\n                    onError.runWith(err);\r\n                });\r\n        }\r\n    }\r\n}\r\n\r\n","import { HtmlVideo } from \"./HtmlVideo\";\r\nimport { LayaGL } from \"../../layagl/LayaGL\";\r\nimport { ILaya } from \"../../../ILaya\";\r\nimport { WebGLContext } from \"../../webgl/WebGLContext\";\r\n\r\n\r\n/**\r\n * @internal\r\n */\r\nexport class WebGLVideo extends HtmlVideo {\r\n\tprivate gl: WebGLRenderingContext;\r\n\r\n\tprivate static curBindSource: any;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\t// if (!ILaya.Render.isConchApp && ILaya.Browser.onIPhone)\r\n\t\t// \treturn;\r\n\t\tthis.gl = ILaya.Render.isConchApp ? (window as any).LayaGLContext.instance : WebGLContext.mainContext;\r\n\t\tthis._source = this.gl.createTexture();\r\n\r\n\t\t//preTarget = WebGLContext.curBindTexTarget; \r\n\t\t//preTexture = WebGLContext.curBindTexValue;\r\n\r\n\t\tWebGLContext.bindTexture(this.gl, gl.TEXTURE_2D, this._source);\r\n\r\n\t\tthis.gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n\t\tthis.gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n\t\tthis.gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n\t\tthis.gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n\r\n\t\tWebGLContext.bindTexture(this.gl, gl.TEXTURE_2D, null);\r\n\r\n\t\t//(preTarget && preTexture) && (WebGLContext.bindTexture(gl, preTarget, preTexture));\r\n\t}\r\n\r\n\tupdateTexture(): void {\r\n\t\t// if (!ILaya.Render.isConchApp && ILaya.Browser.onIPhone)\r\n\t\t// \treturn;\r\n\t\tvar gl: WebGLRenderingContext = LayaGL.instance;\r\n\t\tWebGLContext.bindTexture(this.gl, gl.TEXTURE_2D, this._source);\r\n\r\n\t\tthis.gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, this.video);\r\n\r\n\t\tWebGLVideo.curBindSource = this._source;\r\n\t}\r\n\r\n\tget _glTexture(): any {\r\n\t\treturn this._source;\r\n\t}\r\n\t\t/**\r\n\t\t * @override\r\n\t\t */\r\n\t\tdestroy(): void {\r\n\t\tif (this._source) {\r\n\t\t\tthis.gl = ILaya.Render.isConchApp ? (window as any).LayaGLContext.instance : WebGLContext.mainContext;\r\n\t\t\tif(this.gl){\r\n\t\t\t\tif (WebGLVideo.curBindSource == this._source) {\r\n\t\t\t\t\tWebGLContext.bindTexture(this.gl, this.gl.TEXTURE_2D, null);\r\n\t\t\t\t\tWebGLVideo.curBindSource = null;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.gl.deleteTexture(this._source);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n}\r\n\r\n","import { HtmlVideo } from \"./HtmlVideo\";\r\nimport { WebGLVideo } from \"./WebGLVideo\";\r\nimport { Sprite } from \"../../display/Sprite\";\r\nimport { Texture } from \"../../resource/Texture\";\r\nimport { ILaya } from \"../../../ILaya\";\r\nimport { Rectangle } from \"../../maths/Rectangle\";\r\nimport { Stage } from \"../../display/Stage\";\r\nimport { Browser } from \"../../utils/Browser\";\r\n\r\nexport const enum VIDEOTYPE {\r\n\tMP4 = 1,\r\n\tOGG = 2,\r\n\tCAMERA = 4,\r\n\tWEBM = 8,\r\n}\r\n\r\n/**\r\n * <code>Video</code>将视频显示到Canvas上。<code>Video</code>可能不会在所有浏览器有效。\r\n * <p>关于Video支持的所有事件参见：<i>http://www.w3school.com.cn/tags/html_ref_audio_video_dom.asp</i>。</p>\r\n * <p>\r\n * <b>注意：</b><br/>\r\n * 在PC端可以在任何时机调用<code>play()</code>因此，可以在程序开始运行时就使Video开始播放。但是在移动端，只有在用户第一次触碰屏幕后才可以调用play()，所以移动端不可能在程序开始运行时就自动开始播放Video。\r\n * </p>\r\n *\r\n * <p>MDN Video链接： <i>https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video</i></p>\r\n */\r\nexport class Video extends Sprite {\r\n\tstatic MP4: number = 1;\r\n\tstatic OGG: number = 2;\r\n\tstatic CAMERA: number = 4;\r\n\tstatic WEBM: number = 8;\r\n\r\n\t/** 表示最有可能支持。 */\r\n\tstatic SUPPORT_PROBABLY: string = \"probably\";\r\n\t/** 表示可能支持。*/\r\n\tstatic SUPPORT_MAYBY: string = \"maybe\";\r\n\t/** 表示不支持。 */\r\n\tstatic SUPPORT_NO: string = \"\";\r\n\r\n\tprivate htmlVideo: HtmlVideo;\r\n\tpublic videoElement: any;\r\n\tprivate internalTexture: Texture;\r\n\tprivate _clickhandle:Function;\r\n\tconstructor(width: number = 320, height: number = 240) {\r\n\t\tsuper();\r\n\r\n\t\tthis.htmlVideo = new WebGLVideo();\r\n\r\n\t\tthis.videoElement = this.htmlVideo.getVideo();\r\n\t\tthis.videoElement.layaTarget = this;\r\n\r\n\t\tthis.internalTexture = new Texture(this.htmlVideo as any);\r\n\r\n\t\tthis.videoElement.addEventListener(\"abort\", Video.onAbort);\r\n\t\tthis.videoElement.addEventListener(\"canplay\", Video.onCanplay);\r\n\t\tthis.videoElement.addEventListener(\"canplaythrough\", Video.onCanplaythrough);\r\n\t\tthis.videoElement.addEventListener(\"durationchange\", Video.onDurationchange);\r\n\t\tthis.videoElement.addEventListener(\"emptied\", Video.onEmptied);\r\n\t\tthis.videoElement.addEventListener(\"error\", Video.onError);\r\n\t\tthis.videoElement.addEventListener(\"loadeddata\", Video.onLoadeddata);\r\n\t\tthis.videoElement.addEventListener(\"loadedmetadata\", Video.onLoadedmetadata);\r\n\t\tthis.videoElement.addEventListener(\"loadstart\", Video.onLoadstart);\r\n\t\tthis.videoElement.addEventListener(\"pause\", Video.onPause);\r\n\t\tthis.videoElement.addEventListener(\"play\", Video.onPlay);\r\n\t\tthis.videoElement.addEventListener(\"playing\", Video.onPlaying);\r\n\t\tthis.videoElement.addEventListener(\"progress\", Video.onProgress);\r\n\t\tthis.videoElement.addEventListener(\"ratechange\", Video.onRatechange);\r\n\t\tthis.videoElement.addEventListener(\"seeked\", Video.onSeeked);\r\n\t\tthis.videoElement.addEventListener(\"seeking\", Video.onSeeking);\r\n\t\tthis.videoElement.addEventListener(\"stalled\", Video.onStalled);\r\n\t\tthis.videoElement.addEventListener(\"suspend\", Video.onSuspend);\r\n\t\tthis.videoElement.addEventListener(\"timeupdate\", Video.onTimeupdate);\r\n\t\tthis.videoElement.addEventListener(\"volumechange\", Video.onVolumechange);\r\n\t\tthis.videoElement.addEventListener(\"waiting\", Video.onWaiting);\r\n\t\tthis.videoElement.addEventListener(\"ended\", this.onPlayComplete['bind'](this));\r\n\r\n\t\tthis.size(width, height);\r\n\t\tif (ILaya.Browser.onMobile) {\r\n\t\t\tthis.videoElement[\"x5-playsInline\"]=true;\r\n\t\t\tthis.videoElement[\"x5-playsinline\"]=true;\r\n\t\t\tthis.videoElement.x5PlaysInline=true;\r\n\t\t\tthis.videoElement.playsInline=true;\r\n\t\t\tthis.videoElement[\"webkit-playsInline\"]=true;\r\n\t\t\tthis.videoElement[\"webkit-playsinline\"]=true;\r\n\t\t\tthis.videoElement.webkitPlaysInline=true;\r\n\t\t\tthis.videoElement.playsinline=true;\r\n\t\t\tthis.videoElement.style.playsInline=true;\r\n\t\t\tthis.videoElement.crossOrigin=\"anonymous\";\r\n\t\t\tthis.videoElement.setAttribute('crossorigin', \"anonymous\");\r\n\r\n\t\t\tthis.videoElement.setAttribute('playsinline', 'true')\r\n\t\t\tthis.videoElement.setAttribute('x5-playsinline', 'true')\r\n\t\t\tthis.videoElement.setAttribute('webkit-playsinline', 'true')\r\n\t\t\tthis.videoElement.autoplay=true;\r\n\t\t\tthis._clickhandle = this.onDocumentClick.bind(this);\r\n\t\t\tILaya.Browser.document.addEventListener(\"touchend\", this._clickhandle);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static onAbort(e: any): void { e.target.layaTarget.event(\"abort\") }\r\n\r\n\tprivate static onCanplay(e: any): void { e.target.layaTarget.event(\"canplay\") }\r\n\r\n\tprivate static onCanplaythrough(e: any): void { e.target.layaTarget.event(\"canplaythrough\") }\r\n\r\n\tprivate static onDurationchange(e: any): void { e.target.layaTarget.event(\"durationchange\") }\r\n\r\n\tprivate static onEmptied(e: any): void { e.target.layaTarget.event(\"emptied\") }\r\n\r\n\tprivate static onError(e: any): void { e.target.layaTarget.event(\"error\") }\r\n\r\n\tprivate static onLoadeddata(e: any): void { e.target.layaTarget.event(\"loadeddata\") }\r\n\r\n\tprivate static onLoadedmetadata(e: any): void { e.target.layaTarget.event(\"loadedmetadata\") }\r\n\r\n\tprivate static onLoadstart(e: any): void { e.target.layaTarget.event(\"loadstart\") }\r\n\r\n\tprivate static onPause(e: any): void { e.target.layaTarget.event(\"pause\") }\r\n\r\n\tprivate static onPlay(e: any): void { e.target.layaTarget.event(\"play\") }\r\n\r\n\tprivate static onPlaying(e: any): void { e.target.layaTarget.event(\"playing\") }\r\n\r\n\tprivate static onProgress(e: any): void { e.target.layaTarget.event(\"progress\") }\r\n\r\n\tprivate static onRatechange(e: any): void { e.target.layaTarget.event(\"ratechange\") }\r\n\r\n\tprivate static onSeeked(e: any): void { e.target.layaTarget.event(\"seeked\") }\r\n\r\n\tprivate static onSeeking(e: any): void { e.target.layaTarget.event(\"seeking\") }\r\n\r\n\tprivate static onStalled(e: any): void { e.target.layaTarget.event(\"stalled\") }\r\n\r\n\tprivate static onSuspend(e: any): void { e.target.layaTarget.event(\"suspend\") }\r\n\r\n\tprivate static onTimeupdate(e: any): void { e.target.layaTarget.event(\"timeupdate\") }\r\n\r\n\tprivate static onVolumechange(e: any): void { e.target.layaTarget.event(\"volumechange\") }\r\n\r\n\tprivate static onWaiting(e: any): void { e.target.layaTarget.event(\"waiting\") }\r\n\r\n\tprivate onPlayComplete(e: any): void {\r\n\t\tif (!ILaya.Render.isConchApp || !this.videoElement || !this.videoElement.loop)\r\n\t\t\tILaya.timer.clear(this, this.renderCanvas);\r\n\t\tthis.event(\"ended\");\r\n\t}\r\n\r\n\t/**\r\n\t * 设置播放源。\r\n\t * @param url\t播放源路径。\r\n\t */\r\n\tload(url: string): void {\r\n\t\t// Camera\r\n\t\tif (url.indexOf(\"blob:\") == 0)\r\n\t\t\tthis.videoElement.src = url;\r\n\t\telse\r\n\t\t\tthis.htmlVideo.setSource(url, VIDEOTYPE.MP4);\r\n\t}\r\n\r\n\t/**\r\n\t * 开始播放视频。\r\n\t */\r\n\tplay(): void {\r\n\t\tthis.videoElement.play();\r\n\t\tILaya.timer.frameLoop(1, this, this.renderCanvas);\r\n\t}\r\n\r\n\t/**\r\n\t * 暂停视频播放。\r\n\t */\r\n\tpause(): void {\r\n\t\tthis.videoElement.pause();\r\n\r\n\t\tILaya.timer.clear(this, this.renderCanvas);\r\n\t}\r\n\r\n\t/**\r\n\t * 重新加载视频。\r\n\t */\r\n\treload(): void {\r\n\t\tthis.videoElement.load();\r\n\t}\r\n\r\n\t/**\r\n\t * 检测是否支持播放指定格式视频。\r\n\t * @param type\t参数为Video.MP4 / Video.OGG / Video.WEBM之一。\r\n\t * @return 表示支持的级别。可能的值：\r\n\t * <ul>\r\n\t * <li>\"probably\"，Video.SUPPORT_PROBABLY - 浏览器最可能支持该音频/视频类型</li>\r\n\t * <li>\"maybe\"，Video.SUPPORT_MAYBY - 浏览器也许支持该音频/视频类型</li>\r\n\t * <li>\"\"，Video.SUPPORT_NO- （空字符串）浏览器不支持该音频/视频类型</li>\r\n\t * </ul>\r\n\t */\r\n\tcanPlayType(type: number): string {\r\n\t\tvar typeString: string;\r\n\t\tswitch (type) {\r\n\t\t\tcase VIDEOTYPE.MP4:\r\n\t\t\t\ttypeString = \"video/mp4\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase VIDEOTYPE.OGG:\r\n\t\t\t\ttypeString = \"video/ogg\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase VIDEOTYPE.WEBM:\r\n\t\t\t\ttypeString = \"video/webm\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn this.videoElement.canPlayType(typeString);\r\n\t}\r\n\r\n\tprivate renderCanvas(): void {\r\n\t\tif (this.readyState === 0)\r\n\t\t\treturn;\r\n\r\n\t\tthis.htmlVideo['updateTexture']();\r\n\r\n\t\tthis.graphics.clear();\r\n\t\tthis.graphics.drawTexture(this.internalTexture, 0, 0, this.width, this.height);\r\n\t}\r\n\r\n\tprivate onDocumentClick(): void {\r\n\t\tif(!this.videoElement||this.videoElement!=0)\r\n\t\t\treturn;\r\n\t\tif(Browser.onIOS){\r\n\t\t\tthis.videoElement.load();\r\n\t\t}else{\r\n\t\t\tthis.videoElement.play();\r\n\t\t\tthis.videoElement.pause();\r\n\t\t}\r\n\t\tILaya.Browser.document.removeEventListener(\"touchend\", this._clickhandle);\r\n\t}\r\n\r\n\t/**\r\n\t * buffered 属性返回 TimeRanges(JS)对象。TimeRanges 对象表示用户的音视频缓冲范围。缓冲范围指的是已缓冲音视频的时间范围。如果用户在音视频中跳跃播放，会得到多个缓冲范围。\r\n\t * <p>buffered.length返回缓冲范围个数。如获取第一个缓冲范围则是buffered.start(0)和buffered.end(0)。以秒计。</p>\r\n\t * @return TimeRanges(JS)对象\r\n\t */\r\n\tget buffered(): any {\r\n\t\treturn this.videoElement.buffered;\r\n\t}\r\n\r\n\t/**\r\n\t * 获取当前播放源路径。\r\n\t */\r\n\tget currentSrc(): string {\r\n\t\treturn this.videoElement.currentSrc;\r\n\t}\r\n\r\n\t/**\r\n\t * 设置和获取当前播放头位置。\r\n\t */\r\n\tget currentTime(): number {\r\n\t\treturn this.videoElement.currentTime;\r\n\t}\r\n\r\n\tset currentTime(value: number) {\r\n\t\tthis.videoElement.currentTime = value;\r\n\t\tthis.renderCanvas();\r\n\t}\r\n\r\n\t/**\r\n\t * 设置和获取当前音量。\r\n\t */\r\n\tset volume(value: number) {\r\n\t\tthis.videoElement.volume = value;\r\n\t}\r\n\r\n\tget volume(): number {\r\n\t\treturn this.videoElement.volume;\r\n\t}\r\n\r\n\t/**\r\n\t * 表示视频元素的就绪状态：\r\n\t * <ul>\r\n\t * <li>0 = HAVE_NOTHING - 没有关于音频/视频是否就绪的信息</li>\r\n\t * <li>1 = HAVE_METADATA - 关于音频/视频就绪的元数据</li>\r\n\t * <li>2 = HAVE_CURRENT_DATA - 关于当前播放位置的数据是可用的，但没有足够的数据来播放下一帧/毫秒</li>\r\n\t * <li>3 = HAVE_FUTURE_DATA - 当前及至少下一帧的数据是可用的</li>\r\n\t * <li>4 = HAVE_ENOUGH_DATA - 可用数据足以开始播放</li>\r\n\t * </ul>\r\n\t */\r\n\tget readyState(): any {\r\n\t\treturn this.videoElement.readyState;\r\n\t}\r\n\r\n\t/**\r\n\t * 获取视频源尺寸。ready事件触发后可用。\r\n\t */\r\n\tget videoWidth(): number {\r\n\t\treturn this.videoElement.videoWidth;\r\n\t}\r\n\r\n\tget videoHeight(): number {\r\n\t\treturn this.videoElement.videoHeight;\r\n\t}\r\n\r\n\t/**\r\n\t * 获取视频长度（秒）。ready事件触发后可用。\r\n\t */\r\n\tget duration(): number {\r\n\t\treturn this.videoElement.duration;\r\n\t}\r\n\r\n\t/**\r\n\t * 返回音频/视频的播放是否已结束\r\n\t */\r\n\tget ended(): boolean {\r\n\t\treturn this.videoElement.ended;\r\n\t}\r\n\r\n\t/**\r\n\t * 返回表示音频/视频错误状态的 MediaError（JS）对象。\r\n\t */\r\n\tget error(): boolean {\r\n\t\treturn this.videoElement.error;\r\n\t}\r\n\r\n\t/**\r\n\t * 设置或返回音频/视频是否应在结束时重新播放。\r\n\t */\r\n\tget loop(): boolean {\r\n\t\treturn this.videoElement.loop;\r\n\t}\r\n\r\n\tset loop(value: boolean) {\r\n\t\tthis.videoElement.loop = value;\r\n\t}\r\n\r\n\t/**\r\n\t * 设置视频的x坐标\r\n\t * @override\r\n\t */\r\n\tset x(val: number) {\r\n\t\tsuper.x = val;\r\n\t\tif (ILaya.Render.isConchApp) {\r\n\t\t\tvar transform: any = ILaya.Utils.getTransformRelativeToWindow(this, 0, 0);\r\n\t\t\tthis.videoElement.style.left = transform.x;\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tget x() {\r\n\t\treturn super.x;\r\n\t}\r\n\r\n\t/**\r\n\t * 设置视频的y坐标\r\n\t * @override\r\n\t */\r\n\tset y(val: number) {\r\n\t\tsuper.y = val;\r\n\t\tif (ILaya.Render.isConchApp) {\r\n\t\t\tvar transform: any = ILaya.Utils.getTransformRelativeToWindow(this, 0, 0);\r\n\t\t\tthis.videoElement.style.top = transform.y;\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tget y() {\r\n\t\treturn super.y;\r\n\t}\r\n\r\n\t/**\r\n\t * playbackRate 属性设置或返回音频/视频的当前播放速度。如：\r\n\t * <ul>\r\n\t * <li>1.0 正常速度</li>\r\n\t * <li>0.5 半速（更慢）</li>\r\n\t * <li>2.0 倍速（更快）</li>\r\n\t * <li>-1.0 向后，正常速度</li>\r\n\t * <li>-0.5 向后，半速</li>\r\n\t * </ul>\r\n\t * <p>只有 Google Chrome 和 Safari 支持 playbackRate 属性。</p>\r\n\t */\r\n\tget playbackRate(): number {\r\n\t\treturn this.videoElement.playbackRate;\r\n\t}\r\n\r\n\tset playbackRate(value: number) {\r\n\t\tthis.videoElement.playbackRate = value;\r\n\t}\r\n\r\n\t/**\r\n\t * 获取和设置静音状态。\r\n\t */\r\n\tget muted(): boolean {\r\n\t\treturn this.videoElement.muted;\r\n\t}\r\n\r\n\tset muted(value: boolean) {\r\n\t\tthis.videoElement.muted = value;\r\n\t}\r\n\r\n\t/**\r\n\t * 返回视频是否暂停\r\n\t */\r\n\tget paused(): boolean {\r\n\t\treturn this.videoElement.paused;\r\n\t}\r\n\r\n\t/**\r\n\t * preload 属性设置或返回是否在页面加载后立即加载视频。可赋值如下：\r\n\t * <ul>\r\n\t * <li>auto\t指示一旦页面加载，则开始加载视频。</li>\r\n\t * <li>metadata\t指示当页面加载后仅加载音频/视频的元数据。</li>\r\n\t * <li>none\t指示页面加载后不应加载音频/视频。</li>\r\n\t * </ul>\r\n\t */\r\n\tget preload(): string {\r\n\t\treturn this.videoElement.preload;\r\n\t}\r\n\r\n\tset preload(value: string) {\r\n\t\tthis.videoElement.preload = value;\r\n\t}\r\n\r\n\t/**\r\n\t * 参见 <i>http://www.w3school.com.cn/tags/av_prop_seekable.asp</i>。\r\n\t */\r\n\tget seekable(): any {\r\n\t\treturn this.videoElement.seekable;\r\n\t}\r\n\r\n\t/**\r\n\t * seeking 属性返回用户目前是否在音频/视频中寻址。\r\n\t * 寻址中（Seeking）指的是用户在音频/视频中移动/跳跃到新的位置。\r\n\t */\r\n\tget seeking(): boolean {\r\n\t\treturn this.videoElement.seeking;\r\n\t}\r\n\t/**\r\n\t * \r\n\t * @param width \r\n\t * @param height \r\n\t * @override\r\n\t */\r\n\tsize(width: number, height: number): Sprite {\r\n\t\tsuper.size(width, height)\r\n\r\n\t\tif (ILaya.Render.isConchApp) {\r\n\t\t\tvar transform: any = ILaya.Utils.getTransformRelativeToWindow(this, 0, 0);\r\n\t\t\tthis.videoElement.width = width * transform.scaleX;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.videoElement.width = width / ILaya.Browser.pixelRatio;\r\n\t\t\tthis.videoElement.height=height / Browser.pixelRatio;\r\n\t\t}\r\n\r\n\t\tif (this.paused) this.renderCanvas();\r\n\t\treturn this;\r\n\t}\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tset width(value: number) {\r\n\t\tif (ILaya.Render.isConchApp) {\r\n\t\t\tvar transform: any = ILaya.Utils.getTransformRelativeToWindow(this, 0, 0);\r\n\t\t\tthis.videoElement.width = value * transform.scaleX;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.videoElement.width = this.width / ILaya.Browser.pixelRatio;\r\n\t\t}\r\n\r\n\t\tsuper.width = value;\r\n\t\tif (this.paused) this.renderCanvas();\r\n\t}\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tget width() {\r\n\t\treturn super.width;\r\n\t}\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tset height(value: number) {\r\n\t\tif (ILaya.Render.isConchApp) {\r\n\t\t\tvar transform: any = ILaya.Utils.getTransformRelativeToWindow(this, 0, 0);\r\n\t\t\tthis.videoElement.height = value * transform.scaleY;\r\n\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.videoElement.height = this.height / ILaya.Browser.pixelRatio;\r\n\t\t}\r\n\t\tsuper.height = value;\r\n\t}\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tget height() {\r\n\t\treturn super.height;\r\n\t}\r\n\r\n\t/**\r\n\t * 销毁内部事件绑定。\r\n\t * @override\r\n\t */\r\n\tdestroy(detroyChildren: boolean = true): void {\r\n\t\tsuper.destroy(detroyChildren);\r\n\r\n\t\tthis.videoElement.removeEventListener(\"abort\", Video.onAbort);\r\n\t\tthis.videoElement.removeEventListener(\"canplay\", Video.onCanplay);\r\n\t\tthis.videoElement.removeEventListener(\"canplaythrough\", Video.onCanplaythrough);\r\n\t\tthis.videoElement.removeEventListener(\"durationchange\", Video.onDurationchange);\r\n\t\tthis.videoElement.removeEventListener(\"emptied\", Video.onEmptied);\r\n\t\tthis.videoElement.removeEventListener(\"error\", Video.onError);\r\n\t\tthis.videoElement.removeEventListener(\"loadeddata\", Video.onLoadeddata);\r\n\t\tthis.videoElement.removeEventListener(\"loadedmetadata\", Video.onLoadedmetadata);\r\n\t\tthis.videoElement.removeEventListener(\"loadstart\", Video.onLoadstart);\r\n\t\tthis.videoElement.removeEventListener(\"pause\", Video.onPause);\r\n\t\tthis.videoElement.removeEventListener(\"play\", Video.onPlay);\r\n\t\tthis.videoElement.removeEventListener(\"playing\", Video.onPlaying);\r\n\t\tthis.videoElement.removeEventListener(\"progress\", Video.onProgress);\r\n\t\tthis.videoElement.removeEventListener(\"ratechange\", Video.onRatechange);\r\n\t\tthis.videoElement.removeEventListener(\"seeked\", Video.onSeeked);\r\n\t\tthis.videoElement.removeEventListener(\"seeking\", Video.onSeeking);\r\n\t\tthis.videoElement.removeEventListener(\"stalled\", Video.onStalled);\r\n\t\tthis.videoElement.removeEventListener(\"suspend\", Video.onSuspend);\r\n\t\tthis.videoElement.removeEventListener(\"timeupdate\", Video.onTimeupdate);\r\n\t\tthis.videoElement.removeEventListener(\"volumechange\", Video.onVolumechange);\r\n\t\tthis.videoElement.removeEventListener(\"waiting\", Video.onWaiting);\r\n\t\tthis.videoElement.removeEventListener(\"ended\", this.onPlayComplete);\r\n\r\n\t\tthis.pause();\r\n\t\tthis.videoElement.layaTarget = null\r\n\t\tthis.videoElement = null;\r\n\t\tthis.htmlVideo.destroy();\r\n\t}\r\n\r\n\tprivate syncVideoPosition(): void {\r\n\t\tvar stage: Stage = ILaya.stage;\r\n\t\tvar rec: Rectangle;\r\n\t\trec = ILaya.Utils.getGlobalPosAndScale(this);\r\n\r\n\t\tvar a: number = stage._canvasTransform.a, d: number = stage._canvasTransform.d;\r\n\t\tvar x: number = rec.x * stage.clientScaleX * a + stage.offset.x;\r\n\t\tvar y: number = rec.y * stage.clientScaleY * d + stage.offset.y;\r\n\t\tthis.videoElement.style.left = x + 'px';\r\n\t\t;\r\n\t\tthis.videoElement.style.top = y + 'px';\r\n\t\tthis.videoElement.width = this.width / ILaya.Browser.pixelRatio;\r\n\t\tthis.videoElement.height = this.height / ILaya.Browser.pixelRatio;\r\n\t}\r\n}\r\n\r\n","import { RotationInfo } from \"./RotationInfo\";\r\nimport { Event } from \"../../events/Event\";\r\nimport { EventDispatcher } from \"../../events/EventDispatcher\";\r\nimport { ILaya } from \"../../../ILaya\";\r\n\r\n\r\n/**\r\n * 使用Gyroscope.instance获取唯一的Gyroscope引用，请勿调用构造函数。\r\n * \r\n * <p>\r\n * listen()的回调处理器接受两个参数：\r\n * <code>function onOrientationChange(absolute:Boolean, info:RotationInfo):void</code>\r\n * <ol>\r\n * <li><b>absolute</b>: 指示设备是否可以提供绝对方位数据（指向地球坐标系），或者设备决定的任意坐标系。关于坐标系参见<i>https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Orientation_and_motion_data_explained</i>。</li>\r\n * <li><b>info</b>: <code>RotationInfo</code>类型参数，保存设备的旋转值。</li>\r\n * </ol>\r\n * </p>\r\n * \r\n * <p>\r\n * 浏览器兼容性参见：<i>http://caniuse.com/#search=deviceorientation</i>\r\n * </p>\r\n */\r\nexport class Gyroscope extends EventDispatcher {\r\n    private static info: RotationInfo = new RotationInfo();\r\n\r\n    /**\r\n     * Gyroscope的唯一引用。\r\n     */\r\n    private static _instance: Gyroscope;\r\n    static get instance(): Gyroscope {\r\n        Gyroscope._instance = Gyroscope._instance || new Gyroscope(0);\r\n        return Gyroscope._instance;\r\n    }\r\n\r\n    constructor(singleton: number) {\r\n        super();\r\n        this.onDeviceOrientationChange = this.onDeviceOrientationChange.bind(this);\r\n    }\r\n\r\n    /**\r\n     * 监视陀螺仪运动。\r\n     * @param\tobserver\t回调函数接受一个Boolean类型的<code>absolute</code>和<code>GyroscopeInfo</code>类型参数。\r\n     * @override\r\n     */\r\n    on(type: string, caller: any, listener: Function, args: any[] = null): EventDispatcher {\r\n        super.on(type, caller, listener, args);\r\n        ILaya.Browser.window.addEventListener('deviceorientation', this.onDeviceOrientationChange);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 取消指定处理器对陀螺仪的监视。\r\n     * @param\tobserver\r\n     * @override\r\n     */\r\n    off(type: string, caller: any, listener: Function, onceOnly: boolean = false): EventDispatcher {\r\n        if (!this.hasListener(type))\r\n            ILaya.Browser.window.removeEventListener('deviceorientation', this.onDeviceOrientationChange);\r\n\r\n        return super.off(type, caller, listener, onceOnly);\r\n    }\r\n\r\n    private onDeviceOrientationChange(e: any): void {\r\n        Gyroscope.info.alpha = e.alpha;\r\n        Gyroscope.info.beta = e.beta;\r\n        Gyroscope.info.gamma = e.gamma;\r\n\r\n        // 在Safari中\r\n        if (e.webkitCompassHeading) {\r\n            Gyroscope.info.alpha = e.webkitCompassHeading * -1;\r\n            Gyroscope.info.compassAccuracy = e.webkitCompassAccuracy;\r\n        }\r\n\r\n        this.event(Event.CHANGE, [e.absolute, Gyroscope.info]);\r\n    }\r\n}\r\n\r\n"],"names":["EventDispatcher","ILaya","Event","Bitmap","LayaGL","WebGLContext","Sprite","Texture","Browser"],"mappings":"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"}